<main>
  @if(dataSource.data.length>0){
  <div dir="rtl">
    <mat-form-field>
      <mat-label>חפש</mat-label>
      <input matInput (keyup)="applyFilter($event)" placeholder="" #input />
    </mat-form-field>
  </div>

  <div>
    <table
      mat-table
      [dataSource]="dataSource"
      class="mat-elevation-z8"
      dir="rtl"
    >
      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef><b> שם מסמך </b></th>
        <td mat-cell *matCellDef="let element">
          {{ element.task_description }}
        </td>
      </ng-container>

      <ng-container matColumnDef="type">
        <th mat-header-cell *matHeaderCellDef><b> סוג עסקה </b></th>
        <td mat-cell *matCellDef="let element">
          {{ changeTransacTypeToString(element.document_type_id) }}
        </td>
      </ng-container>

      <ng-container matColumnDef="status">
        <th mat-header-cell *matHeaderCellDef><b> סטטוס </b></th>
        <td mat-cell *matCellDef="let element">
          {{ changeDocStatusToString(element.status) }}
        </td>
      </ng-container>

      <ng-container matColumnDef="icon">
        <th mat-header-cell *matHeaderCellDef></th>
        <td mat-cell *matCellDef="let element">
          @if(element.status==0){
          <button
            mat-icon-button
            aria-label="upload file"
            mat-icon-button
            (click)="fileInput.click()"
            matTooltip="צירוף מסמך"
            matTooltipPosition="left"
          >
            <mat-icon>attach_file</mat-icon>
            <input
              type="file"
              #fileInput
              (change)="onFileSelected($event, element)"
              style="display: none"
            />
          </button>
          } @if (element.status==1) {
          {{ selectedDocuments[element.id].name }}
          <button mat-button (click)="xfunc(element)">ביטול</button>
          } @if (element.status==2) {
          {{ selectedDocuments[element.id].name }}
          }
        </td>
      </ng-container>

      <ng-container matColumnDef="date">
        <th mat-header-cell *matHeaderCellDef><b> תאריך עדכון </b></th>
        <td mat-cell *matCellDef="let element">
          {{ formatDate(element.created_at) }}
        </td>
      </ng-container>

      <ng-container matColumnDef="approval">
        <th mat-header-cell *matHeaderCellDef><b> אישור פעולה </b></th>
        <td mat-cell *matCellDef="let element">
          <!-- @if (element.status === 1) { -->
          <section class="example-section">
            <mat-checkbox
              class="example-margin"
              [disabled]="element.status !== 1"
              [matTooltip]="element.status === 0 ? 'עדיין לא נבחר מסמך' : ''"
            ></mat-checkbox>
          </section>
          <!-- } -->
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
    </table>
  </div>

  <div class="send-all">
    <div class="example-button-row">
      <button mat-flat-button>
        <span class="button-text">שלח מסמכים שנבחרו</span>
        <span class="icon-container"
          ><i class="fa-regular fa-paper-plane"></i>
        </span>
      </button>
    </div>
  </div>

  } @else {
  <div>כרגע אין מסמכים</div>
  }
</main>
