import './polyfills.server.mjs';
import{$ as rh,A as Fr,Ba as Bi,C as Yd,Ca as uh,D as Xd,Da as ch,E as Zd,Ea as lh,F as ht,G as Li,H as Pr,Ia as dh,J as Qd,K as Jd,L as eh,M as th,Ma as hh,N as hr,Na as fh,O as Mr,P as Br,Pa as Ui,Q as Ur,Qa as ft,R as jr,Ra as qt,S as Hr,Sa as Ke,T as Wr,U as zr,V as Gr,W as $r,X as Vr,Y as Fi,Z as xt,_ as Kr,a as Xo,aa as nh,b as zd,ba as Dt,c as Ii,ca as Tt,d as ki,da as Qo,e as Oi,ea as ih,f as Ri,fa as oh,g as Ni,ga as Pn,h as Zo,ha as ah,i as Et,ia as Pi,ja as qr,k as cr,ka as fr,la as Yr,m as Nt,ma as Xr,n as rt,na as Zr,o as Lt,oa as Qr,p as lr,pa as sh,qa as Mi,r as Gd,s as $d,t as Vd,u as dr,v as Kd,w as qd,wa as Ft,x as Rr,xa as Pt,y as Nr,ya as Mt,z as Lr}from"./chunk-IRS7FO4G.mjs";import{a as Vo,b as Ko,c as Si,d as Md,e as dt,r as Or,s as Hd,u as ct,v as Ai,w as Wd}from"./chunk-TIRFLIF6.mjs";import{$b as Nn,$c as Fd,Ab as Ad,B as Ve,Bb as Id,Cb as W,Db as H,Ea as xd,Eb as Ce,F as fi,Fa as Go,Fb as He,Gb as We,Ib as ze,Jb as kd,Lb as xe,Nb as ye,Nc as Di,R as Ir,S as bd,Sb as yt,Tb as _t,Ub as vt,Uc as Ld,V as Je,Vb as Rn,Wb as Q,Xa as wi,Xb as Ze,Xc as ur,Yb as je,Yc as bt,Z as Xe,Za as le,_ as mi,_a as _e,_b as Od,aa as ar,ab as Dd,ac as Ln,ad as Ti,bc as Fn,bd as Pd,ca as Ie,cc as bi,cd as Ci,da as wt,dc as kr,ec as Rd,ed as $o,f as Vt,g as At,gb as yi,ha as Be,hc as Ei,ia as pi,ic as xi,jb as Td,l as kn,ld as Bd,m as di,md as Ud,nb as _i,pa as Le,pd as qo,q as Kt,qa as Fe,qd as Yo,rb as be,sb as vi,sd as jd,tb as we,v as hi,va as sr,vb as Cd,xa as gi,y as vd,yb as lt,z as On,za as Ed,zb as Sd,zc as Nd}from"./chunk-ZE4Y54UW.mjs";import{a as gt,b as In,c as up,e as cp,g as lp,h as li}from"./chunk-NDYDZJSS.mjs";var Ch=cp((la,da)=>{"use strict";(function(t,e){typeof define=="function"&&define.amd?define([],e):typeof la<"u"?e():(e(),t.FileSaver={})})(la,function(){"use strict";function t(a,l){return typeof l>"u"?l={autoBom:!1}:typeof l!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),l={autoBom:!l}),l.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}function e(a,l,g){var _=new XMLHttpRequest;_.open("GET",a),_.responseType="blob",_.onload=function(){s(_.response,l,g)},_.onerror=function(){console.error("could not download file")},_.send()}function r(a){var l=new XMLHttpRequest;l.open("HEAD",a,!1);try{l.send()}catch{}return 200<=l.status&&299>=l.status}function n(a){try{a.dispatchEvent(new MouseEvent("click"))}catch{var l=document.createEvent("MouseEvents");l.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),a.dispatchEvent(l)}}var i=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof global=="object"&&global.global===global?global:void 0,o=i.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),s=i.saveAs||(typeof window!="object"||window!==i?function(){}:"download"in HTMLAnchorElement.prototype&&!o?function(a,l,g){var _=i.URL||i.webkitURL,b=document.createElement("a");l=l||a.name||"download",b.download=l,b.rel="noopener",typeof a=="string"?(b.href=a,b.origin===location.origin?n(b):r(b.href)?e(a,l,g):n(b,b.target="_blank")):(b.href=_.createObjectURL(a),setTimeout(function(){_.revokeObjectURL(b.href)},4e4),setTimeout(function(){n(b)},0))}:"msSaveOrOpenBlob"in navigator?function(a,l,g){if(l=l||a.name||"download",typeof a!="string")navigator.msSaveOrOpenBlob(t(a,g),l);else if(r(a))e(a,l,g);else{var _=document.createElement("a");_.href=a,_.target="_blank",setTimeout(function(){n(_)})}}:function(a,l,g,_){if(_=_||open("","_blank"),_&&(_.document.title=_.document.body.innerText="downloading..."),typeof a=="string")return e(a,l,g);var b=a.type==="application/octet-stream",T=/constructor/i.test(i.HTMLElement)||i.safari,w=/CriOS\/[\d]+/.test(navigator.userAgent);if((w||b&&T||o)&&typeof FileReader<"u"){var x=new FileReader;x.onloadend=function(){var m=x.result;m=w?m:m.replace(/^data:[^;]*;/,"data:attachment/file;"),_?_.location.href=m:location=m,_=null},x.readAsDataURL(a)}else{var v=i.URL||i.webkitURL,C=v.createObjectURL(a);_?_.location=C:location.href=C,_=null,setTimeout(function(){v.revokeObjectURL(C)},4e4)}});i.saveAs=s.saveAs=s,typeof da<"u"&&(da.exports=s)})});var en=(()=>{let e=class e{constructor(n){this.http=n,this.basicURL=ft.apiURL+"/api/",this.customersSubject=new At([]),this.customers$=this.customersSubject.asObservable()}fetchCustomers(){return this.http.get(`${this.basicURL}Customers`).pipe(Je(n=>this.customersSubject.next(n)),Ve(n=>{throw n}))}deleteCustomer(n){let i=`${this.basicURL}Customers/${n}`;return this.http.delete(i).pipe(Je(()=>{let o=this.customersSubject.getValue().filter(s=>s.id!==n);this.customersSubject.next(o)}),Ve(o=>{throw o}))}getCustomers(){return this.customersSubject.asObservable()}getCustomerById(n){return this.customersSubject.getValue().find(s=>s.id===n)}getById(n){return this.http.get(`${this.basicURL}Customers/${n}`)}getLeadById(n){return this.http.get(`${this.basicURL}Leads/${n}`)}sendLink(n){return`${this.basicURL}/${n}/SendLink`}createCustomer(n){return this.http.post(`${this.basicURL}Customers`,n)}createCustomerForLead(n,i){return this.http.post(`${this.basicURL}Customers/Lead${i}`,n)}updateCustomer(n,i){return console.log("customer",i),this.http.put(`${this.basicURL}Customers/${n}`,i).pipe(Je(()=>{let o=this.customersSubject.getValue(),s=o.findIndex(a=>a.id===n);s!==-1&&(o[s]=i,this.customersSubject.next([...o]),this.fetchCustomers().subscribe())}))}};e.\u0275fac=function(i){return new(i||e)(Ie(dt))},e.\u0275prov=Xe({token:e,factory:e.\u0275fac});let t=e;return t})();var tn=(()=>{let e=class e{constructor(n,i,o){this.http=n,this.customerService=i,this.loginService=o,this.apiUrl=ft.apiURL+"/api",this.documentsSubject=new At([]),this.documents$=this.documentsSubject.asObservable(),this.selectedDocumentsSubject=new At([]),this.selectedDocuments$=this.selectedDocumentsSubject.asObservable(),this._selectedDocuments=[],this.hasNotSavedDoc=!1,this.hasPendingDocuments=!1}get selectedDocuments(){return this._selectedDocuments}set selectedDocuments(n){this._selectedDocuments=n,this.selectedDocumentsSubject.next(n)}getDocumentsTypesById(n){return this.http.get(`${this.apiUrl}/DocumentTypes/${n}`)}getDocumentById(n){return this.http.get(`${this.apiUrl}/CustomerTasksControllercs/${n}`)}addDocument(n){return this.http.post(`${this.apiUrl}/CustomerTasksControllercs`,n)}getAllDocuments(){return this.http.get(`${this.apiUrl}/CustomerTasksControllercs`)}getAllDocumentType(){return this.http.get(`${this.apiUrl}/DocumentTypes`)}fetchDocumentsByCustomerId(n){return this.http.get(`${this.apiUrl}/CustomerTasksControllercs/customerId/${n}`).pipe(Je(i=>this.documentsSubject.next(i)),Ve(i=>{throw console.error("Error fetching documents:",i),i}))}updateMultipleDocuments(n){return this.http.put(this.apiUrl+"/CustomerTasksControllercs",n).pipe(Ve(i=>(console.error("\u05E9\u05D2\u05D9\u05D0\u05D4 \u05D1\u05E2\u05D3\u05DB\u05D5\u05DF \u05DE\u05E1\u05DE\u05DB\u05D9\u05DD \u05D1\u05E9\u05E8\u05EA:",i),di("\u05DE\u05E9\u05D4\u05D5 \u05D4\u05E9\u05EA\u05D1\u05E9 \u05D1\u05E2\u05D3\u05DB\u05D5\u05DF \u05D4\u05DE\u05E1\u05DE\u05DB\u05D9\u05DD. \u05E0\u05E1\u05D4 \u05E9\u05D5\u05D1 \u05DE\u05D0\u05D5\u05D7\u05E8 \u05D9\u05D5\u05EA\u05E8."))))}deleteDocument(n){return this.http.delete(`${this.apiUrl}/CustomerTasksControllercs/${n}`)}updateDocument(n,i){return this.http.put(`${this.apiUrl}/CustomerTasksControllercs/${n}`,i)}createDocument(n){return this.http.post(`${this.apiUrl}/CustomerTasksControllercs`,n)}getCustomerByDocumentId(n){console.log(n);var i=this.customerService.getCustomerById(n?.customer_Id||0);return console.log("customer="+i),i}checkPendingDocuments(){this.fetchDocumentsByCustomerId(this.loginService.GetCurrentUser().customerId).subscribe(n=>{this.documentsSubject.next(n),this.documents$.subscribe(i=>{this.hasNotSavedDoc=this.selectedDocuments.filter(o=>o!=null&&o!=null).length>0,this.hasPendingDocuments=i.some(o=>o.status===0)},i=>{console.error("\u05E9\u05D2\u05D9\u05D0\u05D4 \u05D1\u05D8\u05E2\u05D9\u05E0\u05EA ")})},n=>{console.error("Error fetching documents:",n)})}};e.\u0275fac=function(i){return new(i||e)(Ie(dt),Ie(en),Ie(Ke))},e.\u0275prov=Xe({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var ta=function(t){return t[t["\u05D1\u05D7\u05E8 \u05DE\u05E1\u05DE\u05DA"]=0]="\u05D1\u05D7\u05E8 \u05DE\u05E1\u05DE\u05DA",t[t["\u05DE\u05DE\u05EA\u05D9\u05DF \u05DC\u05E9\u05DC\u05D9\u05D7\u05D4"]=1]="\u05DE\u05DE\u05EA\u05D9\u05DF \u05DC\u05E9\u05DC\u05D9\u05D7\u05D4",t[t.\u05D4\u05D5\u05E9\u05DC\u05DD=2]="\u05D4\u05D5\u05E9\u05DC\u05DD",t}(ta||{});var Bt=function(t){return t[t[" \u05D7\u05D3\u05E9"]=0]=" \u05D7\u05D3\u05E9",t[t[" \u05D9\u05E9\u05DF"]=1]=" \u05D9\u05E9\u05DF",t[t[" \u05E9\u05D9\u05E4\u05D5\u05E5"]=2]=" \u05E9\u05D9\u05E4\u05D5\u05E5",t[t[" \u05D0\u05D7\u05E8"]=3]=" \u05D0\u05D7\u05E8",t[t["\u05DE\u05D7\u05D9\u05E8 \u05DC\u05DE\u05E9\u05EA\u05DB\u05DF"]=4]="\u05DE\u05D7\u05D9\u05E8 \u05DC\u05DE\u05E9\u05EA\u05DB\u05DF",t}(Bt||{});function pp(t,e){}var _r=class{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.ariaModal=!0,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.closeOnNavigation=!0,this.closeOnDestroy=!0,this.closeOnOverlayDetachments=!0}};var ia=(()=>{let e=class e extends oh{constructor(n,i,o,s,a,l,g,_){super(),this._elementRef=n,this._focusTrapFactory=i,this._config=s,this._interactivityChecker=a,this._ngZone=l,this._overlayRef=g,this._focusMonitor=_,this._platform=wt(zd),this._focusTrap=null,this._elementFocusedBeforeDialogWasOpened=null,this._closeInteractionType=null,this._ariaLabelledByQueue=[],this._changeDetectorRef=wt(Nd),this._injector=wt(sr),this._isDestroyed=!1,this.attachDomPortal=b=>{this._portalOutlet.hasAttached();let T=this._portalOutlet.attachDomPortal(b);return this._contentAttached(),T},this._document=o,this._config.ariaLabelledBy&&this._ariaLabelledByQueue.push(this._config.ariaLabelledBy)}_addAriaLabelledBy(n){this._ariaLabelledByQueue.push(n),this._changeDetectorRef.markForCheck()}_removeAriaLabelledBy(n){let i=this._ariaLabelledByQueue.indexOf(n);i>-1&&(this._ariaLabelledByQueue.splice(i,1),this._changeDetectorRef.markForCheck())}_contentAttached(){this._initializeFocusTrap(),this._handleBackdropClicks(),this._captureInitialFocus()}_captureInitialFocus(){this._trapFocus()}ngOnDestroy(){this._isDestroyed=!0,this._restoreFocus()}attachComponentPortal(n){this._portalOutlet.hasAttached();let i=this._portalOutlet.attachComponentPortal(n);return this._contentAttached(),i}attachTemplatePortal(n){this._portalOutlet.hasAttached();let i=this._portalOutlet.attachTemplatePortal(n);return this._contentAttached(),i}_recaptureFocus(){this._containsFocus()||this._trapFocus()}_forceFocus(n,i){this._interactivityChecker.isFocusable(n)||(n.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{let o=()=>{n.removeEventListener("blur",o),n.removeEventListener("mousedown",o),n.removeAttribute("tabindex")};n.addEventListener("blur",o),n.addEventListener("mousedown",o)})),n.focus(i)}_focusByCssSelector(n,i){let o=this._elementRef.nativeElement.querySelector(n);o&&this._forceFocus(o,i)}_trapFocus(){this._isDestroyed||Td(()=>{let n=this._elementRef.nativeElement;switch(this._config.autoFocus){case!1:case"dialog":this._containsFocus()||n.focus();break;case!0:case"first-tabbable":this._focusTrap?.focusInitialElement()||this._focusDialogContainer();break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this._config.autoFocus);break}},{injector:this._injector})}_restoreFocus(){let n=this._config.restoreFocus,i=null;if(typeof n=="string"?i=this._document.querySelector(n):typeof n=="boolean"?i=n?this._elementFocusedBeforeDialogWasOpened:null:n&&(i=n),this._config.restoreFocus&&i&&typeof i.focus=="function"){let o=Ii(),s=this._elementRef.nativeElement;(!o||o===this._document.body||o===s||s.contains(o))&&(this._focusMonitor?(this._focusMonitor.focusVia(i,this._closeInteractionType),this._closeInteractionType=null):i.focus())}this._focusTrap&&this._focusTrap.destroy()}_focusDialogContainer(){this._elementRef.nativeElement.focus&&this._elementRef.nativeElement.focus()}_containsFocus(){let n=this._elementRef.nativeElement,i=Ii();return n===i||n.contains(i)}_initializeFocusTrap(){this._platform.isBrowser&&(this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._document&&(this._elementFocusedBeforeDialogWasOpened=Ii()))}_handleBackdropClicks(){this._overlayRef.backdropClick().subscribe(()=>{this._config.disableClose&&this._recaptureFocus()})}};e.\u0275fac=function(i){return new(i||e)(_e(gi),_e(Ri),_e(Di,8),_e(_r),_e(Oi),_e(yi),_e(qr),_e(Ni))},e.\u0275cmp=Be({type:e,selectors:[["cdk-dialog-container"]],viewQuery:function(i,o){if(i&1&&yt(Pn,7),i&2){let s;_t(s=vt())&&(o._portalOutlet=s.first)}},hostAttrs:["tabindex","-1",1,"cdk-dialog-container"],hostVars:6,hostBindings:function(i,o){i&2&&vi("id",o._config.id||null)("role",o._config.role)("aria-modal",o._config.ariaModal)("aria-labelledby",o._config.ariaLabel?null:o._ariaLabelledByQueue[0])("aria-label",o._config.ariaLabel)("aria-describedby",o._config.ariaDescribedBy||null)},standalone:!0,features:[_i,kr],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(i,o){i&1&&be(0,pp,0,0,"ng-template",0)},dependencies:[Pn],styles:[".cdk-dialog-container{display:block;width:100%;height:100%;min-height:inherit;max-height:inherit}"],encapsulation:2});let t=e;return t})(),Mn=class{constructor(e,r){this.overlayRef=e,this.config=r,this.closed=new Vt,this.disableClose=r.disableClose,this.backdropClick=e.backdropClick(),this.keydownEvents=e.keydownEvents(),this.outsidePointerEvents=e.outsidePointerEvents(),this.id=r.id,this.keydownEvents.subscribe(n=>{n.keyCode===27&&!this.disableClose&&!ki(n)&&(n.preventDefault(),this.close(void 0,{focusOrigin:"keyboard"}))}),this.backdropClick.subscribe(()=>{this.disableClose||this.close(void 0,{focusOrigin:"mouse"})}),this._detachSubscription=e.detachments().subscribe(()=>{r.closeOnOverlayDetachments!==!1&&this.close()})}close(e,r){if(this.containerInstance){let n=this.closed;this.containerInstance._closeInteractionType=r?.focusOrigin||"program",this._detachSubscription.unsubscribe(),this.overlayRef.dispose(),n.next(e),n.complete(),this.componentInstance=this.containerInstance=null}}updatePosition(){return this.overlayRef.updatePosition(),this}updateSize(e="",r=""){return this.overlayRef.updateSize({width:e,height:r}),this}addPanelClass(e){return this.overlayRef.addPanelClass(e),this}removePanelClass(e){return this.overlayRef.removePanelClass(e),this}},gp=new ar("DialogScrollStrategy",{providedIn:"root",factory:()=>{let t=wt(fr);return()=>t.scrollStrategies.block()}}),wp=new ar("DialogData"),yp=new ar("DefaultDialogConfig");var _p=0,mh=(()=>{let e=class e{get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}constructor(n,i,o,s,a,l){this._overlay=n,this._injector=i,this._defaultOptions=o,this._parentDialog=s,this._overlayContainer=a,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new Vt,this._afterOpenedAtThisLevel=new Vt,this._ariaHiddenElements=new Map,this.afterAllClosed=hi(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(Ir(void 0))),this._scrollStrategy=l}open(n,i){let o=this._defaultOptions||new _r;i=gt(gt({},o),i),i.id=i.id||`cdk-dialog-${_p++}`,i.id&&this.getDialogById(i.id);let s=this._getOverlayConfig(i),a=this._overlay.create(s),l=new Mn(a,i),g=this._attachContainer(a,l,i);return l.containerInstance=g,this._attachDialogContent(n,l,g,i),this.openDialogs.length||this._hideNonDialogContentFromAssistiveTechnology(),this.openDialogs.push(l),l.closed.subscribe(()=>this._removeOpenDialog(l,!0)),this.afterOpened.next(l),l}closeAll(){ra(this.openDialogs,n=>n.close())}getDialogById(n){return this.openDialogs.find(i=>i.id===n)}ngOnDestroy(){ra(this._openDialogsAtThisLevel,n=>{n.config.closeOnDestroy===!1&&this._removeOpenDialog(n,!1)}),ra(this._openDialogsAtThisLevel,n=>n.close()),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete(),this._openDialogsAtThisLevel=[]}_getOverlayConfig(n){let i=new ah({positionStrategy:n.positionStrategy||this._overlay.position().global().centerHorizontally().centerVertically(),scrollStrategy:n.scrollStrategy||this._scrollStrategy(),panelClass:n.panelClass,hasBackdrop:n.hasBackdrop,direction:n.direction,minWidth:n.minWidth,minHeight:n.minHeight,maxWidth:n.maxWidth,maxHeight:n.maxHeight,width:n.width,height:n.height,disposeOnNavigation:n.closeOnNavigation});return n.backdropClass&&(i.backdropClass=n.backdropClass),i}_attachContainer(n,i,o){let s=o.injector||o.viewContainerRef?.injector,a=[{provide:_r,useValue:o},{provide:Mn,useValue:i},{provide:qr,useValue:n}],l;o.container?typeof o.container=="function"?l=o.container:(l=o.container.type,a.push(...o.container.providers(o))):l=ia;let g=new Qo(l,o.viewContainerRef,sr.create({parent:s||this._injector,providers:a}),o.componentFactoryResolver);return n.attach(g).instance}_attachDialogContent(n,i,o,s){if(n instanceof Dd){let a=this._createInjector(s,i,o,void 0),l={$implicit:s.data,dialogRef:i};s.templateContext&&(l=gt(gt({},l),typeof s.templateContext=="function"?s.templateContext():s.templateContext)),o.attachTemplatePortal(new ih(n,null,l,a))}else{let a=this._createInjector(s,i,o,this._injector),l=o.attachComponentPortal(new Qo(n,s.viewContainerRef,a,s.componentFactoryResolver));i.componentRef=l,i.componentInstance=l.instance}}_createInjector(n,i,o,s){let a=n.injector||n.viewContainerRef?.injector,l=[{provide:wp,useValue:n.data},{provide:Mn,useValue:i}];return n.providers&&(typeof n.providers=="function"?l.push(...n.providers(i,n,o)):l.push(...n.providers)),n.direction&&(!a||!a.get(Zo,null,{optional:!0}))&&l.push({provide:Zo,useValue:{value:n.direction,change:kn()}}),sr.create({parent:a||s,providers:l})}_removeOpenDialog(n,i){let o=this.openDialogs.indexOf(n);o>-1&&(this.openDialogs.splice(o,1),this.openDialogs.length||(this._ariaHiddenElements.forEach((s,a)=>{s?a.setAttribute("aria-hidden",s):a.removeAttribute("aria-hidden")}),this._ariaHiddenElements.clear(),i&&this._getAfterAllClosed().next()))}_hideNonDialogContentFromAssistiveTechnology(){let n=this._overlayContainer.getContainerElement();if(n.parentElement){let i=n.parentElement.children;for(let o=i.length-1;o>-1;o--){let s=i[o];s!==n&&s.nodeName!=="SCRIPT"&&s.nodeName!=="STYLE"&&!s.hasAttribute("aria-live")&&(this._ariaHiddenElements.set(s,s.getAttribute("aria-hidden")),s.setAttribute("aria-hidden","true"))}}}_getAfterAllClosed(){let n=this._parentDialog;return n?n._getAfterAllClosed():this._afterAllClosedAtThisLevel}};e.\u0275fac=function(i){return new(i||e)(Ie(fr),Ie(sr),Ie(yp,8),Ie(e,12),Ie(Pi),Ie(gp))},e.\u0275prov=Xe({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function ra(t,e){let r=t.length;for(;r--;)e(t[r])}function vp(t,e){}var Bn=class{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.ariaModal=!0,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.delayFocusTrap=!0,this.closeOnNavigation=!0}},oa="mdc-dialog--open",ph="mdc-dialog--opening",gh="mdc-dialog--closing",bp=150,Ep=75,xp=(()=>{let e=class e extends ia{constructor(n,i,o,s,a,l,g,_,b){super(n,i,o,s,a,l,g,b),this._animationMode=_,this._animationStateChanged=new Ed,this._animationsEnabled=this._animationMode!=="NoopAnimations",this._actionSectionCount=0,this._hostElement=this._elementRef.nativeElement,this._enterAnimationDuration=this._animationsEnabled?yh(this._config.enterAnimationDuration)??bp:0,this._exitAnimationDuration=this._animationsEnabled?yh(this._config.exitAnimationDuration)??Ep:0,this._animationTimer=null,this._finishDialogOpen=()=>{this._clearAnimationClasses(),this._openAnimationDone(this._enterAnimationDuration)},this._finishDialogClose=()=>{this._clearAnimationClasses(),this._animationStateChanged.emit({state:"closed",totalTime:this._exitAnimationDuration})}}_contentAttached(){super._contentAttached(),this._startOpenAnimation()}_startOpenAnimation(){this._animationStateChanged.emit({state:"opening",totalTime:this._enterAnimationDuration}),this._animationsEnabled?(this._hostElement.style.setProperty(wh,`${this._enterAnimationDuration}ms`),this._requestAnimationFrame(()=>this._hostElement.classList.add(ph,oa)),this._waitForAnimationToComplete(this._enterAnimationDuration,this._finishDialogOpen)):(this._hostElement.classList.add(oa),Promise.resolve().then(()=>this._finishDialogOpen()))}_startExitAnimation(){this._animationStateChanged.emit({state:"closing",totalTime:this._exitAnimationDuration}),this._hostElement.classList.remove(oa),this._animationsEnabled?(this._hostElement.style.setProperty(wh,`${this._exitAnimationDuration}ms`),this._requestAnimationFrame(()=>this._hostElement.classList.add(gh)),this._waitForAnimationToComplete(this._exitAnimationDuration,this._finishDialogClose)):Promise.resolve().then(()=>this._finishDialogClose())}_updateActionSectionCount(n){this._actionSectionCount+=n,this._changeDetectorRef.markForCheck()}_clearAnimationClasses(){this._hostElement.classList.remove(ph,gh)}_waitForAnimationToComplete(n,i){this._animationTimer!==null&&clearTimeout(this._animationTimer),this._animationTimer=setTimeout(i,n)}_requestAnimationFrame(n){this._ngZone.runOutsideAngular(()=>{typeof requestAnimationFrame=="function"?requestAnimationFrame(n):n()})}_captureInitialFocus(){this._config.delayFocusTrap||this._trapFocus()}_openAnimationDone(n){this._config.delayFocusTrap&&this._trapFocus(),this._animationStateChanged.next({state:"opened",totalTime:n})}ngOnDestroy(){super.ngOnDestroy(),this._animationTimer!==null&&clearTimeout(this._animationTimer)}attachComponentPortal(n){let i=super.attachComponentPortal(n);return i.location.nativeElement.classList.add("mat-mdc-dialog-component-host"),i}};e.\u0275fac=function(i){return new(i||e)(_e(gi),_e(Ri),_e(Di,8),_e(Bn),_e(Oi),_e(yi),_e(qr),_e(Go,8),_e(Ni))},e.\u0275cmp=Be({type:e,selectors:[["mat-dialog-container"]],hostAttrs:["tabindex","-1",1,"mat-mdc-dialog-container","mdc-dialog"],hostVars:10,hostBindings:function(i,o){i&2&&(kd("id",o._config.id),vi("aria-modal",o._config.ariaModal)("role",o._config.role)("aria-labelledby",o._config.ariaLabel?null:o._ariaLabelledByQueue[0])("aria-label",o._config.ariaLabel)("aria-describedby",o._config.ariaDescribedBy||null),Cd("_mat-animation-noopable",!o._animationsEnabled)("mat-mdc-dialog-container-with-actions",o._actionSectionCount>0))},standalone:!0,features:[_i,kr],decls:3,vars:0,consts:[[1,"mat-mdc-dialog-inner-container","mdc-dialog__container"],[1,"mat-mdc-dialog-surface","mdc-dialog__surface"],["cdkPortalOutlet",""]],template:function(i,o){i&1&&(W(0,"div",0)(1,"div",1),be(2,vp,0,0,"ng-template",2),H()())},dependencies:[Pn],styles:['.mat-mdc-dialog-container{width:100%;height:100%;display:block;box-sizing:border-box;max-height:inherit;min-height:inherit;min-width:inherit;max-width:inherit;outline:0}.cdk-overlay-pane.mat-mdc-dialog-panel{max-width:var(--mat-dialog-container-max-width, 80vw);min-width:var(--mat-dialog-container-min-width, 0)}@media(max-width: 599px){.cdk-overlay-pane.mat-mdc-dialog-panel{max-width:var(--mat-dialog-container-small-max-width, 80vw)}}.mat-mdc-dialog-inner-container{display:flex;flex-direction:row;align-items:center;justify-content:space-around;box-sizing:border-box;height:100%;opacity:0;transition:opacity linear var(--mat-dialog-transition-duration, 0ms);max-height:inherit;min-height:inherit;min-width:inherit;max-width:inherit}.mdc-dialog--closing .mat-mdc-dialog-inner-container{transition:opacity 75ms linear;transform:none}.mdc-dialog--open .mat-mdc-dialog-inner-container{opacity:1}._mat-animation-noopable .mat-mdc-dialog-inner-container{transition:none}.mat-mdc-dialog-surface{display:flex;flex-direction:column;flex-grow:0;flex-shrink:0;box-sizing:border-box;width:100%;height:100%;position:relative;overflow-y:auto;outline:0;transform:scale(0.8);transition:transform var(--mat-dialog-transition-duration, 0ms) cubic-bezier(0, 0, 0.2, 1);max-height:inherit;min-height:inherit;min-width:inherit;max-width:inherit;box-shadow:var(--mat-dialog-container-elevation-shadow, 0px 11px 15px -7px rgba(0, 0, 0, 0.2), 0px 24px 38px 3px rgba(0, 0, 0, 0.14), 0px 9px 46px 8px rgba(0, 0, 0, 0.12));border-radius:var(--mdc-dialog-container-shape, 4px);background-color:var(--mdc-dialog-container-color, white)}[dir=rtl] .mat-mdc-dialog-surface{text-align:right}.mdc-dialog--open .mat-mdc-dialog-surface,.mdc-dialog--closing .mat-mdc-dialog-surface{transform:none}._mat-animation-noopable .mat-mdc-dialog-surface{transition:none}.mat-mdc-dialog-surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:2px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}.mat-mdc-dialog-title{display:block;margin-top:0;position:relative;flex-shrink:0;box-sizing:border-box;margin:0 0 1px;padding:var(--mat-dialog-headline-padding, 0 24px 9px)}.mat-mdc-dialog-title::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}[dir=rtl] .mat-mdc-dialog-title{text-align:right}.mat-mdc-dialog-container .mat-mdc-dialog-title{color:var(--mdc-dialog-subhead-color, rgba(0, 0, 0, 0.87));font-family:var(--mdc-dialog-subhead-font, Roboto, sans-serif);line-height:var(--mdc-dialog-subhead-line-height, 1.5rem);font-size:var(--mdc-dialog-subhead-size, 1rem);font-weight:var(--mdc-dialog-subhead-weight, 400);letter-spacing:var(--mdc-dialog-subhead-tracking, 0.03125em)}.mat-mdc-dialog-content{display:block;flex-grow:1;box-sizing:border-box;margin:0;overflow:auto;max-height:65vh}.mat-mdc-dialog-content>:first-child{margin-top:0}.mat-mdc-dialog-content>:last-child{margin-bottom:0}.mat-mdc-dialog-container .mat-mdc-dialog-content{color:var(--mdc-dialog-supporting-text-color, rgba(0, 0, 0, 0.6));font-family:var(--mdc-dialog-supporting-text-font, Roboto, sans-serif);line-height:var(--mdc-dialog-supporting-text-line-height, 1.5rem);font-size:var(--mdc-dialog-supporting-text-size, 1rem);font-weight:var(--mdc-dialog-supporting-text-weight, 400);letter-spacing:var(--mdc-dialog-supporting-text-tracking, 0.03125em)}.mat-mdc-dialog-container .mat-mdc-dialog-content{padding:var(--mat-dialog-content-padding, 20px 24px)}.mat-mdc-dialog-container-with-actions .mat-mdc-dialog-content{padding:var(--mat-dialog-with-actions-content-padding, 20px 24px)}.mat-mdc-dialog-container .mat-mdc-dialog-title+.mat-mdc-dialog-content{padding-top:0}.mat-mdc-dialog-actions{display:flex;position:relative;flex-shrink:0;flex-wrap:wrap;align-items:center;justify-content:flex-end;box-sizing:border-box;min-height:52px;margin:0;padding:8px;border-top:1px solid rgba(0,0,0,0);padding:var(--mat-dialog-actions-padding, 8px);justify-content:var(--mat-dialog-actions-alignment, start)}.cdk-high-contrast-active .mat-mdc-dialog-actions{border-top-color:CanvasText}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-start,.mat-mdc-dialog-actions[align=start]{justify-content:start}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-center,.mat-mdc-dialog-actions[align=center]{justify-content:center}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-end,.mat-mdc-dialog-actions[align=end]{justify-content:flex-end}.mat-mdc-dialog-actions .mat-button-base+.mat-button-base,.mat-mdc-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-mdc-dialog-actions .mat-button-base+.mat-button-base,[dir=rtl] .mat-mdc-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:0;margin-right:8px}.mat-mdc-dialog-component-host{display:contents}'],encapsulation:2});let t=e;return t})(),wh="--mat-dialog-transition-duration";function yh(t){return t==null?null:typeof t=="number"?t:t.endsWith("ms")?Xo(t.substring(0,t.length-2)):t.endsWith("s")?Xo(t.substring(0,t.length-1))*1e3:t==="0"?0:null}var ji=function(t){return t[t.OPEN=0]="OPEN",t[t.CLOSING=1]="CLOSING",t[t.CLOSED=2]="CLOSED",t}(ji||{}),Un=class{constructor(e,r,n){this._ref=e,this._containerInstance=n,this._afterOpened=new Vt,this._beforeClosed=new Vt,this._state=ji.OPEN,this.disableClose=r.disableClose,this.id=e.id,e.addPanelClass("mat-mdc-dialog-panel"),n._animationStateChanged.pipe(On(i=>i.state==="opened"),fi(1)).subscribe(()=>{this._afterOpened.next(),this._afterOpened.complete()}),n._animationStateChanged.pipe(On(i=>i.state==="closed"),fi(1)).subscribe(()=>{clearTimeout(this._closeFallbackTimeout),this._finishDialogClose()}),e.overlayRef.detachments().subscribe(()=>{this._beforeClosed.next(this._result),this._beforeClosed.complete(),this._finishDialogClose()}),vd(this.backdropClick(),this.keydownEvents().pipe(On(i=>i.keyCode===27&&!this.disableClose&&!ki(i)))).subscribe(i=>{this.disableClose||(i.preventDefault(),Dp(this,i.type==="keydown"?"keyboard":"mouse"))})}close(e){this._result=e,this._containerInstance._animationStateChanged.pipe(On(r=>r.state==="closing"),fi(1)).subscribe(r=>{this._beforeClosed.next(e),this._beforeClosed.complete(),this._ref.overlayRef.detachBackdrop(),this._closeFallbackTimeout=setTimeout(()=>this._finishDialogClose(),r.totalTime+100)}),this._state=ji.CLOSING,this._containerInstance._startExitAnimation()}afterOpened(){return this._afterOpened}afterClosed(){return this._ref.closed}beforeClosed(){return this._beforeClosed}backdropClick(){return this._ref.backdropClick}keydownEvents(){return this._ref.keydownEvents}updatePosition(e){let r=this._ref.config.positionStrategy;return e&&(e.left||e.right)?e.left?r.left(e.left):r.right(e.right):r.centerHorizontally(),e&&(e.top||e.bottom)?e.top?r.top(e.top):r.bottom(e.bottom):r.centerVertically(),this._ref.updatePosition(),this}updateSize(e="",r=""){return this._ref.updateSize(e,r),this}addPanelClass(e){return this._ref.addPanelClass(e),this}removePanelClass(e){return this._ref.removePanelClass(e),this}getState(){return this._state}_finishDialogClose(){this._state=ji.CLOSED,this._ref.close(this._result,{focusOrigin:this._closeInteractionType}),this.componentInstance=null}};function Dp(t,e,r){return t._closeInteractionType=e,t.close(r)}var aa=new ar("MatMdcDialogData"),Tp=new ar("mat-mdc-dialog-default-options"),Cp=new ar("mat-mdc-dialog-scroll-strategy",{providedIn:"root",factory:()=>{let t=wt(fr);return()=>t.scrollStrategies.block()}});var Sp=0,Hi=(()=>{let e=class e{get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}_getAfterAllClosed(){let n=this._parentDialog;return n?n._getAfterAllClosed():this._afterAllClosedAtThisLevel}constructor(n,i,o,s,a,l,g,_){this._overlay=n,this._defaultOptions=s,this._scrollStrategy=a,this._parentDialog=l,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new Vt,this._afterOpenedAtThisLevel=new Vt,this.dialogConfigClass=Bn,this.afterAllClosed=hi(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(Ir(void 0))),this._dialog=i.get(mh),this._dialogRefConstructor=Un,this._dialogContainerType=xp,this._dialogDataToken=aa}open(n,i){let o;i=gt(gt({},this._defaultOptions||new Bn),i),i.id=i.id||`mat-mdc-dialog-${Sp++}`,i.scrollStrategy=i.scrollStrategy||this._scrollStrategy();let s=this._dialog.open(n,In(gt({},i),{positionStrategy:this._overlay.position().global().centerHorizontally().centerVertically(),disableClose:!0,closeOnDestroy:!1,closeOnOverlayDetachments:!1,container:{type:this._dialogContainerType,providers:()=>[{provide:this.dialogConfigClass,useValue:i},{provide:_r,useValue:i}]},templateContext:()=>({dialogRef:o}),providers:(a,l,g)=>(o=new this._dialogRefConstructor(a,i,g),o.updatePosition(i?.position),[{provide:this._dialogContainerType,useValue:g},{provide:this._dialogDataToken,useValue:l.data},{provide:this._dialogRefConstructor,useValue:o}])}));return o.componentRef=s.componentRef,o.componentInstance=s.componentInstance,this.openDialogs.push(o),this.afterOpened.next(o),o.afterClosed().subscribe(()=>{let a=this.openDialogs.indexOf(o);a>-1&&(this.openDialogs.splice(a,1),this.openDialogs.length||this._getAfterAllClosed().next())}),o}closeAll(){this._closeDialogs(this.openDialogs)}getDialogById(n){return this.openDialogs.find(i=>i.id===n)}ngOnDestroy(){this._closeDialogs(this._openDialogsAtThisLevel),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete()}_closeDialogs(n){let i=n.length;for(;i--;)n[i].close()}};e.\u0275fac=function(i){return new(i||e)(Ie(fr),Ie(sr),Ie(Ld,8),Ie(Tp,8),Ie(Cp),Ie(e,12),Ie(Pi),Ie(Go,8))},e.\u0275prov=Xe({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Hn=(()=>{let e=class e{constructor(n,i,o){this.dialogRef=n,this.data=i,this.loginService=o}onNoClick(){this.dialogRef.close(!1)}onYesClick(){this.dialogRef.close(!0)}getTitle(){return this.data.customer?"\u05DE\u05D7\u05D9\u05E7\u05EA \u05DC\u05E7\u05D5\u05D7":this.data.DocumentType?"\u05DE\u05D7\u05D9\u05E7\u05EA \u05DE\u05E1\u05DE\u05DA":this.data.lead?"\u05DE\u05D7\u05D9\u05E7\u05EA \u05DC\u05D9\u05D3":this.data.document?"\u05D4\u05D0\u05DD \u05D0\u05EA\u05D4 \u05D1\u05D8\u05D5\u05D7 \u05E8\u05D5\u05E6\u05D4 \u05DC\u05D4\u05E1\u05D9\u05E8?":this.data.notification?"\u05DE\u05D7\u05D9\u05E7\u05EA \u05D4\u05D5\u05D3\u05E2\u05D4":"\u05DE\u05D7\u05D9\u05E7\u05EA \u05E4\u05E8\u05D9\u05D8"}getContent(){var n="?\u05D1\u05D8\u05D5\u05D7 \u05E9\u05D0\u05EA\u05D4 \u05E8\u05D5\u05E6\u05D4 \u05DC\u05DE\u05D7\u05D5\u05E7 \u05D0\u05EA  ";return this.data.customer?n+`${this.data.customer.first_Name}`:this.data.documentType?n+` ${this.data.documentType.document_Name}`:this.data.lead?n+`${this.data.lead.first_Name}`:this.data.document1&&this.loginService.isAdmin()?n+`${this.data.document1.document_path2}`:this.data.document1?n+`${this.data.document1.document_path}`:this.data.notification?n+"\u05D4\u05D4\u05D5\u05D3\u05E2\u05D4 \u05D4\u05D6\u05D5":n+" \u05D4\u05E4\u05E8\u05D9\u05D8 \u05D4\u05D6\u05D4"}};e.\u0275fac=function(i){return new(i||e)(_e(Un),_e(aa),_e(Ke))},e.\u0275cmp=Be({type:e,selectors:[["confirm-dialog"]],decls:14,vars:2,consts:[[1,"confirm-dialog-container"],[1,"what_icon"],[1,"fa-regular","fa-circle-question"],["mat-dialog-title","","dir","rtl",1,"title"],["mat-dialog-content","",1,"mat-dialog-container"],["mat-dialog-actions","",1,"mat-dialog-actions"],["mat-button","",1,"mat-button",3,"click"],["mat-button","","color","primary","cdkFocusInitial","",1,"mat-button","cancel-button",3,"click"]],template:function(i,o){i&1&&(W(0,"div",0)(1,"div",1),Ce(2,"i",2),H(),Ce(3,"br"),W(4,"b")(5,"p",3),Q(6),H()(),W(7,"p",4),Q(8),H(),W(9,"div",5)(10,"button",6),xe("click",function(){return o.onNoClick()}),Q(11,"\u05DC\u05D0"),H(),W(12,"button",7),xe("click",function(){return o.onYesClick()}),Q(13,"\u05DB\u05DF"),H()()()),i&2&&(le(6),Ze(o.getTitle()),le(2),je(" ",o.getContent()," "))},dependencies:[Et,ht],styles:['@charset "UTF-8";.confirm-dialog-container[_ngcontent-%COMP%]{text-align:center;padding:20px;border-radius:8px;background-color:#f9f9f9}.mat-dialog-title[_ngcontent-%COMP%]{font-size:24px;text-align:center;font-weight:700}.title[_ngcontent-%COMP%]{font-size:18px;font-family:Segoe UI,sans-serif;margin-bottom:20px}.mat-dialog-content[_ngcontent-%COMP%]{font-size:16px;margin-bottom:20px}.mat-dialog-actions[_ngcontent-%COMP%]{justify-content:center;margin-top:20px}button.mat-button[_ngcontent-%COMP%]{margin:3px}.save-button[_ngcontent-%COMP%]{color:#fff;background-color:#f44336;border:none}.save-button[_ngcontent-%COMP%]:hover{background-color:#d32f2f}.what_icon[_ngcontent-%COMP%]{color:#dc143c;display:flex;align-items:center;justify-content:center;font-size:36px;margin-bottom:10px}']});let t=e;return t})();var _h=(()=>{let e=class e{constructor(n,i,o){this.http=n,this.loginService=i,this.documentService=o,this.baseUrl=ft.apiURL+"/api/Dropbox"}uploadFiles(n){let i=new FormData;var o,s;n&&n.forEach((l,g)=>{l&&(o=l.id,s=l.id2,this.loginService.isAdmin()?i.append("files",l.adminFile,`${o}_${s}_${l.document_path2}`):i.append("files",l.customerFile,`${o}_${l.document_path}`))}),console.log("after foreach");let a=new Ko("POST",`${this.baseUrl}/uploadfiles`,i,{reportProgress:!0});return this.http.request(a).pipe(Kt(l=>l.type===Si.UploadProgress&&l.total?{status:"progress",message:Math.round(100*l.loaded/l.total)}:l instanceof Md?l.body:`Unhandled event: ${l.type}`),Ve(l=>(console.error("Upload error:",l),di(l))))}uploadFile(n,i){let o=new FormData;n&&this.loginService.isAdmin()?o.append("file",n,`${i}_${n.name}`):n&&o.append("file",n,`${i}_${n.name}`);let s=new Ko("POST",`${this.baseUrl}/upload`,o,{reportProgress:!0});return this.http.request(s).pipe(Kt(a=>a.type===Si.UploadProgress&&a.total?{status:"progress",message:Math.round(100*a.loaded/a.total)}:a.type===Si.Response?a.body:`Unhandled event: ${a.type}`))}downloadFile(n){return this.http.get(`${this.baseUrl}/download/${n}`,{observe:"response",responseType:"blob"})}};e.\u0275fac=function(i){return new(i||e)(Ie(dt),Ie(Ke),Ie(tn))},e.\u0275prov=Xe({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Rp=["myCheckbox"];function Np(t,e){if(t&1&&(W(0,"mat-option",21),Q(1),H()),t&2){let r=e.$implicit;we("value",r),le(),Od(" ",r.first_Name," ",r.last_Name," ",r.phone," ")}}function Lp(t,e){if(t&1){let r=ze();W(0,"mat-form-field",8)(1,"mat-label"),Q(2,"\u05D7\u05E4\u05E9 \u05DC\u05E7\u05D5\u05D7"),H(),Ce(3,"input",17),W(4,"mat-autocomplete",18,0),xe("optionSelected",function(i){Le(r);let o=ye();return Fe(o.onCustomerSelected(i.option.value))}),be(6,Np,2,4,"mat-option",19),Ei(7,"async"),H(),W(8,"mat-icon",20),Q(9,"search"),H(),W(10,"mat-hint"),Q(11,"\u05D7\u05E4\u05E9 \u05DC\u05E7\u05D5\u05D7 \u05E2\u05DC \u05DE\u05E0\u05EA \u05DC\u05E0\u05D4\u05DC \u05D0\u05EA \u05D4\u05DE\u05E1\u05DE\u05DB\u05D9\u05DD \u05E9\u05DC\u05D5"),H()()}if(t&2){let r=Rn(5),n=ye();le(3),we("formControl",n.customerControl)("matAutocomplete",r),le(),we("displayWith",n.displayCustomer),le(2),we("ngForOf",xi(7,4,n.filteredCustomers))}}function Fp(t,e){t&1&&(W(0,"mat-header-cell"),Q(1,"\u05E9\u05DD"),H())}function Pp(t,e){if(t&1&&(W(0,"mat-cell"),Q(1),H()),t&2){let r=e.$implicit;le(),Ze(r.task_description)}}function Mp(t,e){t&1&&(W(0,"mat-header-cell"),Q(1,"\u05E1\u05D5\u05D2"),H())}function Bp(t,e){if(t&1&&(W(0,"mat-cell"),Q(1),H()),t&2){let r=e.$implicit,n=ye(2);le(),Ze(n.changeTransacTypeToString(r.document_type_id))}}function Up(t,e){t&1&&(W(0,"mat-header-cell"),Q(1,"\u05E1\u05D8\u05D8\u05D5\u05E1 \u05DE\u05E1\u05DE\u05DA \u05D4\u05DC\u05E7\u05D5\u05D7"),H())}function jp(t,e){if(t&1&&(W(0,"mat-cell"),Q(1),H()),t&2){let r=e.$implicit,n=ye(2);le(),Ze(n.changeDocStatusToString(r.status))}}function Hp(t,e){t&1&&(W(0,"mat-header-cell"),Q(1,"\u05DE\u05E1\u05DE\u05DA \u05DC\u05E7\u05D5\u05D7"),H())}function Wp(t,e){if(t&1){let r=ze();W(0,"span",40),xe("click",function(){Le(r);let i=ye(2).$implicit,o=ye(2);return Fe(o.download(i.document_path,i.id+""))}),Q(1),H()}if(t&2){let r=ye(2).$implicit;le(),Ze(r.document_path)}}function zp(t,e){t&1&&(W(0,"span"),Q(1,"\u05DC\u05D0 \u05D4\u05D5\u05E2\u05DC\u05D4"),H())}function Gp(t,e){if(t&1&&be(0,Wp,2,1,"span",39)(1,zp,2,0,"span"),t&2){let r=ye().$implicit;we("ngIf",r.status==2),le(),lt(r.status!=2?1:-1)}}function $p(t,e){if(t&1){let r=ze();W(0,"button",43),xe("click",function(){Le(r);let i=Rn(4);return Fe(i.click())}),W(1,"mat-icon"),Q(2,"attach_file"),H(),W(3,"input",44,1),xe("change",function(i){Le(r);let o=ye(2).$implicit,s=ye(2);return Fe(s.onFileSelected(i,o))}),H()()}}function Vp(t,e){if(t&1){let r=ze();W(0,"span")(1,"mat-icon",45),xe("click",function(){Le(r);let i=ye(2).$implicit,o=ye(2);return Fe(o.cancelDocument(i))}),Q(2,"cancel"),H(),W(3,"span",40),xe("click",function(){Le(r);let i=ye(2).$implicit,o=ye(2);return Fe(o.viewDocument(i.customerFile))}),Q(4),H()()}if(t&2){let r=ye(2).$implicit;le(4),Ze(r.document_path)}}function Kp(t,e){if(t&1){let r=ze();W(0,"span",40),xe("click",function(){Le(r);let i=ye(2).$implicit,o=ye(2);return Fe(o.download(i.document_path,i.id+""))}),Q(1),H()}if(t&2){let r=ye(2).$implicit;le(),Ze(r.document_path)}}function qp(t,e){if(t&1&&be(0,$p,5,0,"button",41)(1,Vp,5,1,"span",42)(2,Kp,2,1,"span",39),t&2){let r=ye().$implicit;we("ngIf",r.status==0),le(),we("ngIf",r.status==1),le(),we("ngIf",r.status==2)}}function Yp(t,e){if(t&1&&(W(0,"mat-cell"),be(1,Gp,2,2)(2,qp,3,3),H()),t&2){let r=ye(2);le(),lt(r.loginService.isAdmin()?1:2)}}function Xp(t,e){t&1&&(W(0,"mat-header-cell"),Q(1,"\u05DE\u05E1\u05DE\u05DA \u05DE\u05E0\u05D4\u05DC"),H())}function Zp(t,e){if(t&1){let r=ze();W(0,"button",43),xe("click",function(){Le(r);let i=Rn(4);return Fe(i.click())}),W(1,"mat-icon"),Q(2,"attach_file"),H(),W(3,"input",44,1),xe("change",function(i){Le(r);let o=ye(2).$implicit,s=ye(2);return Fe(s.onFileSelected(i,o))}),H()()}}function Qp(t,e){if(t&1){let r=ze();W(0,"span")(1,"mat-icon",45),xe("click",function(){Le(r);let i=ye(2).$implicit,o=ye(2);return Fe(o.cancelDocument(i))}),Q(2,"cancel"),H(),W(3,"span",40),xe("click",function(){Le(r);let i=ye(2).$implicit,o=ye(2);return Fe(o.viewDocument(i.adminFile))}),Q(4),H()()}if(t&2){let r=ye(2).$implicit;le(4),Ze(r.document_path2)}}function Jp(t,e){if(t&1){let r=ze();W(0,"span",40),xe("click",function(){Le(r);let i=ye(2).$implicit,o=ye(2);return Fe(o.download(i.document_path2,i.id+"_"+i.id2))}),Q(1),H()}if(t&2){let r=ye(2).$implicit;le(),je(" ",r.document_path2,"")}}function e0(t,e){if(t&1&&be(0,Zp,5,0,"button",41)(1,Qp,5,1,"span",42)(2,Jp,2,1,"span",39),t&2){let r=ye().$implicit;we("ngIf",r.status2==0),le(),we("ngIf",r.status2==1),le(),we("ngIf",r.status2==2)}}function t0(t,e){if(t&1){let r=ze();W(0,"span",40),xe("click",function(){Le(r);let i=ye(2).$implicit,o=ye(2);return Fe(o.download(i.document_path2,i.id+"_"+i.id2))}),Q(1),H()}if(t&2){let r=ye(2).$implicit;le(),je(" ",r.document_path,"")}}function r0(t,e){t&1&&(W(0,"span"),Q(1,"\u05DC\u05D0 \u05D4\u05D5\u05E2\u05DC\u05D4"),H())}function n0(t,e){if(t&1&&be(0,t0,2,1,"span",39)(1,r0,2,0,"span"),t&2){let r=ye().$implicit;we("ngIf",r.status2==2),le(),lt(r.status2!=2?1:-1)}}function i0(t,e){if(t&1&&(W(0,"mat-cell"),be(1,e0,3,3)(2,n0,2,2),H()),t&2){let r=ye(2);le(),lt(r.loginService.isAdmin()?1:2)}}function o0(t,e){t&1&&(W(0,"mat-header-cell"),Q(1,"\u05EA\u05D0\u05E8\u05D9\u05DA \u05E2\u05D3\u05DB\u05D5\u05DF"),H())}function a0(t,e){if(t&1&&(W(0,"mat-cell"),Q(1),H()),t&2){let r=e.$implicit,n=ye(2);le(),je(" ",r.status==2?n.formatDate(r.created_at):"\u05DC\u05D0 \u05D6\u05DE\u05D9\u05DF"," ")}}function s0(t,e){t&1&&(W(0,"mat-header-cell"),Q(1,"\u05D0\u05D9\u05E9\u05D5\u05E8"),H())}function u0(t,e){if(t&1&&Ce(0,"mat-checkbox",46),t&2){let r=ye(2).$implicit;we("disabled",!0)("matTooltip",r.status2===2?"\u05E0\u05D1\u05D7\u05E8 \u05DE\u05E1\u05DE\u05DA":"\u05E2\u05D3\u05D9\u05D9\u05DF \u05DC\u05D0 \u05E0\u05D1\u05D7\u05E8 \u05DE\u05E1\u05DE\u05DA")}}function c0(t,e){if(t&1){let r=ze();W(0,"mat-checkbox",47),xe("change",function(i){Le(r);let o=ye(2).$implicit,s=ye(2);return Fe(s.onCheckboxChange(i.checked,o))}),H()}if(t&2){let r=ye(2).$implicit;we("disabled",r.status2!==1)("matTooltip","\u05D0\u05E9\u05E8 \u05DE\u05E1\u05DE\u05DA")}}function l0(t,e){if(t&1&&be(0,u0,1,2,"mat-checkbox",46)(1,c0,1,2,"mat-checkbox",46),t&2){let r=ye().$implicit;lt(r.status2==2||r.status2==0?0:1)}}function d0(t,e){if(t&1&&Ce(0,"mat-checkbox",46),t&2){let r=ye(2).$implicit;we("disabled",!0)("matTooltip",r.status===2?"\u05E0\u05D1\u05D7\u05E8 \u05DE\u05E1\u05DE\u05DA":"\u05E2\u05D3\u05D9\u05D9\u05DF \u05DC\u05D0 \u05E0\u05D1\u05D7\u05E8 \u05DE\u05E1\u05DE\u05DA")}}function h0(t,e){if(t&1){let r=ze();W(0,"mat-checkbox",47),xe("change",function(i){Le(r);let o=ye(2).$implicit,s=ye(2);return Fe(s.onCheckboxChange(i.checked,o))}),H()}if(t&2){let r=ye(2).$implicit;we("disabled",r.status!==1)("matTooltip","\u05D0\u05E9\u05E8 \u05DE\u05E1\u05DE\u05DA")}}function f0(t,e){if(t&1&&be(0,d0,1,2,"mat-checkbox",46)(1,h0,1,2,"mat-checkbox",46),t&2){let r=ye().$implicit;lt(r.status==2||r.status==0?0:1)}}function m0(t,e){if(t&1&&(W(0,"mat-cell"),be(1,l0,2,1)(2,f0,2,1),H()),t&2){let r=ye(2);le(),lt(r.loginService.isAdmin()?1:2)}}function p0(t,e){t&1&&(W(0,"mat-header-cell"),Q(1," \u05E4\u05E2\u05D5\u05DC\u05D5\u05EA \u05E0\u05D5\u05E1\u05E4\u05D5\u05EA "),H())}function g0(t,e){if(t&1){let r=ze();W(0,"button",48)(1,"mat-icon"),Q(2,"more_vert"),H()(),W(3,"mat-menu",null,2)(5,"button",49),xe("click",function(){Le(r);let i=ye().$implicit,o=ye(2);return Fe(o.editTask(i))}),W(6,"mat-icon"),Q(7,"edit"),H(),W(8,"span"),Q(9,"\u05E2\u05E8\u05D9\u05DB\u05EA \u05DE\u05E9\u05D9\u05DE\u05D4"),H()(),W(10,"button",50),xe("click",function(){Le(r);let i=ye().$implicit,o=ye(2);return Fe(o.deleteTask(i))}),W(11,"mat-icon"),Q(12,"delete"),H(),W(13,"span"),Q(14,"\u05DE\u05D7\u05D9\u05E7\u05EA \u05DE\u05E9\u05D9\u05DE\u05D4"),H()()()}if(t&2){let r=Rn(4);we("matMenuTriggerFor",r)}}function w0(t,e){t&1&&Q(0," \u05D0\u05D9\u05DF \u05D2\u05D9\u05E9\u05D4 ")}function y0(t,e){if(t&1&&(W(0,"mat-cell"),be(1,g0,15,1)(2,w0,1,0),H()),t&2){let r=ye(2);le(),lt(r.loginService.isAdmin()?1:2)}}function _0(t,e){t&1&&Ce(0,"mat-header-row")}function v0(t,e){t&1&&Ce(0,"mat-row")}function b0(t,e){if(t&1){let r=ze();W(0,"mat-table",22),He(1,23),be(2,Fp,2,0,"mat-header-cell",24)(3,Pp,2,1,"mat-cell",25),We(),He(4,26),be(5,Mp,2,0,"mat-header-cell",24)(6,Bp,2,1,"mat-cell",25),We(),He(7,27),be(8,Up,2,0,"mat-header-cell",24)(9,jp,2,1,"mat-cell",25),We(),He(10,28),be(11,Hp,2,0,"mat-header-cell",24)(12,Yp,3,1,"mat-cell",25),We(),He(13,29),be(14,Xp,2,0,"mat-header-cell",24)(15,i0,3,1,"mat-cell",25),We(),He(16,30),be(17,o0,2,0,"mat-header-cell",24)(18,a0,2,1,"mat-cell",25),We(),He(19,31),be(20,s0,2,0,"mat-header-cell",24)(21,m0,3,1,"mat-cell",25),We(),He(22,32),be(23,p0,2,0,"mat-header-cell",24)(24,y0,3,1,"mat-cell",25),We(),be(25,_0,1,0,"mat-header-row",33)(26,v0,1,0,"mat-row",34),H(),W(27,"div",35)(28,"button",36),xe("click",function(){Le(r);let i=ye();return Fe(i.saveFiles())}),W(29,"mat-icon",37),Q(30,"send"),H(),W(31,"span",38),Q(32,"\u05E9\u05DC\u05D7 \u05DE\u05E1\u05DE\u05DB\u05D9\u05DD \u05E9\u05E0\u05D1\u05D7\u05E8\u05D5"),H()()()}if(t&2){let r=ye();we("dataSource",r.dataSource),le(25),we("matHeaderRowDef",r.displayedColumns),le(),we("matRowDefColumns",r.displayedColumns)}}function E0(t,e){t&1&&(W(0,"div",10)(1,"mat-card",51)(2,"mat-card-content"),Q(3,"\u05DC\u05D0 \u05E0\u05DE\u05E6\u05D0\u05D5 \u05E2\u05D1\u05D5\u05E8\u05DA \u05DE\u05E1\u05DE\u05DB\u05D9\u05DD"),H()()())}function x0(t,e){if(t&1){let r=ze();W(0,"button",52),xe("click",function(){Le(r);let i=ye();return Fe(i.addTask())}),W(1,"mat-icon",53),Q(2,"add"),H()()}}var c1=(()=>{let e=class e{constructor(n,i,o,s,a,l,g,_){this.documentService=n,this.datePipe=i,this.dialog=o,this.fileService=s,this._snackBar=a,this.router=l,this.loginService=g,this.customerService=_,this.displayedColumns=["task_description","document_type_id","status","document_path","document_path2","created_at","isOk","actions"],this.isOkCount=0,this.documentStatusString="",this.transactionTypeString="",this.dataSource=new Fi,this.customerControl=new $d,this.customers=[],this.documentTypes=[],this.loginService.isAdmin()&&this.customerService.fetchCustomers().subscribe()}_filterCustomers(n){let i=n.toLowerCase();return this.customers.filter(o=>o.first_Name?.toLowerCase().includes(i))}displayCustomer(n){return n&&n.first_Name?n.first_Name:""}onCustomerSelected(n){return li(this,null,function*(){this.customerId=n.id,window.sessionStorage!=null&&window.sessionStorage.setItem("customerId",this.customerId.toString()),this.documentService.fetchDocumentsByCustomerId(n.id||0).subscribe({next:i=>{this.dataSource.data=i,this.dataSource.paginator=this.paginator},error:i=>{console.error("Error loading documents for customer:",i)}})})}loadCustomers(){this.customerService.getCustomers().subscribe(n=>{this.customers=n,this.filteredCustomers=this.customerControl.valueChanges.pipe(Ir(""),Kt(i=>typeof i=="string"?i:i.first_Name),Kt(i=>i?this._filterCustomers(i):n.slice()))})}ngOnInit(){if(this.loadDocuments(),this.loginService.isAdmin()){if(window.sessionStorage!=null){let n=+window.sessionStorage.getItem("customerId");n&&(this.fetchDocumentTypes(),this.customerId=n)}this.loadDocuments(),this.loadCustomers()}else this.fetchDocumentTypes(),this.customerId=this.loginService.GetCurrentUser().customerId;this.loadDocuments(),this.customerId&&this.documentService.fetchDocumentsByCustomerId(this.customerId).subscribe({next:n=>{n.forEach(i=>{let o=this.documentService.selectedDocuments.filter(s=>s.id==i.id);o[0]&&(this.loginService.isAdmin()?(i.status2=o[0].status2,i.document_path2=o[0].document_path2,i.adminFile=o[0].adminFile):(i.status=o[0].status,i.document_path=o[0].document_path,i.customerFile=o[0].customerFile)),this.documentService.selectedDocuments.push(i)}),this.dataSource.data=n,this.dataSource.paginator=this.paginator},error:n=>{console.error("Error loading documents for customer:",n)}})}ngAfterViewInit(){this.checkboxes.forEach((n,i)=>{})}getCheckboxStatus(n){let i=this.checkboxes.toArray();return i[n]?i[n].checked:!1}loadDocuments(){console.log("in load"),this.documentSubscription=this.documentService.documents$.subscribe({next:n=>{this.dataSource.data=n,this.dataSource.paginator=this.paginator},error:n=>{console.error("Error loading documents:",n)}})}applyFilter(n){let i=n.target.value;this.dataSource.filter=i.trim().toLowerCase()}fetchDocumentTypes(){this.documentService.getAllDocumentType().subscribe(n=>{this.documentTypes=n},n=>{console.error("Error fetching document types:",n)})}onCheckboxChange(n,i){n==!0?(this.isOkCount++,console.log("this.isOkCount="+this.isOkCount),i.isOk=!0):(this.isOkCount--,console.log("this.isOkCount="+this.isOkCount),i.isOk=!1)}changeDocStatusToString(n){return this.documentStatusString=ta[n],this.documentStatusString}changeTransacTypeToString(n){let i;return this.documentTypes.length>0&&(i=this.documentTypes?.find(o=>o.id==n)?.transaction_Type),this.transactionTypeString=Bt[i],this.transactionTypeString}onFileSelected(n,i){let o=n.target.files;for(let a=0;a<o.length;a++){let l=o[a];this.loginService.isAdmin()?(i.adminFile=l,i.document_path2=l.name,i.status2=1,console.log("in select doc="+i)):(i.customerFile=l,i.document_path=l.name,i.status=1),this.documentService.selectedDocuments.forEach(g=>{g.id==i.id&&(this.loginService.isAdmin()?(g.adminFile=l,g.document_path2=l.name,g.status2=1):(g.customerFile=l,g.document_path=l.name,g.status=1))});var s=this.documentService.selectedDocuments;this.documentService.selectedDocuments=s}}cancelDocument(n){this.dialog.open(Hn,{data:{document1:n}}).afterClosed().subscribe(o=>{if(o){this.loginService.isAdmin()?(n.adminFile=void 0,n.status2=0,n.document_path2=void 0):(n.customerFile=void 0,n.status=0,n.document_path=void 0),n.isOk&&this.isOkCount--;var s=this.documentService.selectedDocuments;this.documentService.selectedDocuments=s}})}formatDate(n){return this.datePipe.transform(n,"dd/MM/yyyy")}viewDocument(n){if(n){let i=URL.createObjectURL(n);window.open(i)}}openSnackBar(n,i){this._snackBar.open(n,i,{duration:5e3,horizontalPosition:"center",verticalPosition:"bottom",direction:"rtl",panelClass:["custom-snackbar"]})}saveFiles(){console.log("data=:"),console.log(this.dataSource.data),this.loginService.isAdmin()?this.documentService.selectedDocuments=this.dataSource.data.filter(i=>i.adminFile!==void 0&&i.adminFile!==null):this.documentService.selectedDocuments=this.dataSource.data.filter(i=>i.customerFile!==void 0&&i.customerFile!==null);let n=this.documentService.selectedDocuments.filter(i=>i!=null).length;if(console.log("this.isOkCount="+this.isOkCount+"  countNotNullOrUndefined="+n),n!=this.isOkCount){this.openSnackBar(" \u05D9\u05E9 \u05DC\u05D0\u05E9\u05E8 \u05EA\u05D7\u05D9\u05DC\u05D4 \u05D0\u05EA \u05DB\u05DC \u05D4\u05DE\u05E1\u05DE\u05DB\u05D9\u05DD \u05E9\u05E0\u05D1\u05D7\u05E8\u05D5.","\u05D1\u05D8\u05DC");return}if(n==0){this.openSnackBar("\u05E2\u05D3\u05D9\u05D9\u05DF \u05DC\u05D0 \u05E0\u05D1\u05D7\u05E8\u05D5 \u05DE\u05E1\u05DE\u05DB\u05D9\u05DD.","\u05D1\u05D8\u05DC");return}this.fileService.uploadFiles(this.documentService.selectedDocuments)?.subscribe(i=>{if(i.status!=="progress"){if(!i.includes("Unhandled")){for(let o=0;o<this.documentService.selectedDocuments.length;o++)this.dataSource.data.forEach(s=>{s.customerFile?(s.status=2,s.updated_at=new Date):s.adminFile&&(s.status2=2,s.updated_at=new Date)});n=0,this.documentService.selectedDocuments=[],this.isOkCount=0,this.onSaveChangesInServer(),this.openSnackBar("\u05D4\u05DE\u05E1\u05DE\u05DB\u05D9\u05DD \u05D4\u05D5\u05E2\u05DC\u05D5 \u05D1\u05D4\u05E6\u05DC\u05D7\u05D4!","x")}}},i=>{this.openSnackBar("\u05D0\u05E8\u05E2\u05D4 \u05E9\u05D2\u05D9\u05D0\u05D4. \u05DC\u05D0 \u05D4\u05EA\u05D1\u05E6\u05E2\u05D4 \u05E9\u05DC\u05D9\u05D7\u05D4 :(","x"),console.error("Upload error:",i)})}onSaveChangesInServer(){var n;this.loginService.isAdmin()?n=this.dataSource.data.filter(i=>i.adminFile):n=this.dataSource.data.filter(i=>i.customerFile),this.documentService.updateMultipleDocuments(n).subscribe(()=>{console.log("The documents have been successfully updated on the server")},i=>{console.error("Error updating the documents on the server:",i)})}download(n,i){this._snackBar.open("\u05D4\u05D4\u05D5\u05E8\u05D3\u05D4 \u05DE\u05EA\u05D7\u05D9\u05DC\u05D4","X"),this.fileService.downloadFile(i).subscribe(o=>{let s=o.headers.get("Content-Disposition");this.saveDownloadFile(o.body,n)},o=>{alert("Error downloading file"),console.log(o)})}saveDownloadFile(n,i){let o=document.createElement("a");o.href=window.URL.createObjectURL(n),o.download=i,o.click(),window.URL.revokeObjectURL(o.href)}deleteTask(n){this.dialog.open(Hn,{width:"300px",data:{message:"\u05D4\u05D0\u05DD \u05D0\u05EA\u05D4 \u05D1\u05D8\u05D5\u05D7 \u05E9\u05D1\u05E8\u05E6\u05D5\u05E0\u05DA \u05DC\u05DE\u05D7\u05D5\u05E7 \u05D0\u05EA \u05D4\u05DE\u05E1\u05DE\u05DA?"}}).afterClosed().subscribe(o=>{o===!0&&this.documentService.deleteDocument(n.id).subscribe(s=>{console.log(s),this.dataSource.data=this.dataSource.data.filter(a=>a.id!==n.id),this.openSnackBar("\u05D4\u05DE\u05E1\u05DE\u05DA \u05E0\u05DE\u05D7\u05E7 \u05D1\u05D4\u05E6\u05DC\u05D7\u05D4","\u05D1\u05D8\u05DC")},s=>{console.error("Error deleting document:",s),this.openSnackBar("\u05D0\u05E8\u05E2\u05D4 \u05E9\u05D2\u05D9\u05D0\u05D4 \u05D1\u05E2\u05EA \u05DE\u05D7\u05D9\u05E7\u05EA \u05D4\u05DE\u05E1\u05DE\u05DA","\u05D1\u05D8\u05DC")})})}editTask(n){window.sessionStorage!=null&&window.sessionStorage.setItem("customerId",n.customer_Id.toString()),this.router.navigate([`admin/task-edit/${n.id}`])}addTask(){this.documentService.customerId=this.customerId,window.sessionStorage!=null&&window.sessionStorage.setItem("customerId",this.customerId.toString()),this.router.navigate(["admin/task-edit/-1"])}};e.\u0275fac=function(i){return new(i||e)(_e(tn),_e(Ti),_e(Hi),_e(_h),_e(Bi),_e(ct),_e(Ke),_e(en))},e.\u0275cmp=Be({type:e,selectors:[["documents-list-customer"]],viewQuery:function(i,o){if(i&1&&(yt(Zr,5),yt(Rp,5)),i&2){let s;_t(s=vt())&&(o.paginator=s.first),_t(s=vt())&&(o.checkboxes=s)}},features:[bi([Ti])],decls:29,vars:3,consts:[["auto","matAutocomplete"],["fileInput",""],["actionsMenu","matMenu"],[2,"background-color","rgba(255, 255, 255, 0.708)","padding-bottom","150px","padding-top","20px"],[1,"header-container"],[1,"header-content"],[1,"header-title"],[1,"header-subtitle"],["appearance","outline",2,"width","68vw","margin-left","50px","margin-right","50px"],[1,"content-container"],[1,"no-docs-message"],[1,"tips-container"],[1,"tips-card"],[1,"tips-title"],[1,"tips-content"],[1,"tips-item"],["mat-fab","","color","primary","matTooltip","\u05D4\u05D5\u05E1\u05E4\u05EA \u05DE\u05E9\u05D9\u05DE\u05D4","matTooltipPosition","above",1,"add-button",2,"position","fixed","bottom","8vh","left","2vw","z-index","1000"],["type","text","matInput","",3,"formControl","matAutocomplete"],[3,"optionSelected","displayWith"],[3,"value",4,"ngFor","ngForOf"],["matSuffix",""],[3,"value"],["matSort","",3,"dataSource"],["matColumnDef","task_description"],[4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","document_type_id"],["matColumnDef","status"],["matColumnDef","document_path"],["matColumnDef","document_path2"],["matColumnDef","created_at"],["matColumnDef","isOk"],["matColumnDef","actions"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],[1,"send-container"],["mat-flat-button","","dir","rtl",1,"send-button",3,"click"],[1,"send-icon"],[1,"button-text"],["class","download","matTooltip","\u05E6\u05E4\u05D4 \u05D1\u05DE\u05E1\u05DE\u05DA",3,"click",4,"ngIf"],["matTooltip","\u05E6\u05E4\u05D4 \u05D1\u05DE\u05E1\u05DE\u05DA",1,"download",3,"click"],["mat-icon-button","","aria-label","upload file","matTooltip","\u05E6\u05E8\u05E3 \u05DE\u05E1\u05DE\u05DA","matTooltipPosition","left",3,"click",4,"ngIf"],[4,"ngIf"],["mat-icon-button","","aria-label","upload file","matTooltip","\u05E6\u05E8\u05E3 \u05DE\u05E1\u05DE\u05DA","matTooltipPosition","left",3,"click"],["type","file",2,"display","none",3,"change"],[3,"click"],[3,"disabled","matTooltip"],[3,"change","disabled","matTooltip"],["mat-icon-button","","matTooltip","\u05D0\u05E4\u05E9\u05E8\u05D5\u05D9\u05D5\u05EA \u05E0\u05D5\u05E1\u05E4\u05D5\u05EA","matTooltipPosition","left",1,"icon-button",3,"matMenuTriggerFor"],["mat-menu-item","",1,"icon-button","edit",3,"click"],["mat-menu-item","",1,"icon-button","delete",3,"click"],[1,"no-docs-card"],["mat-fab","","color","primary","matTooltip","\u05D4\u05D5\u05E1\u05E4\u05EA \u05DE\u05E9\u05D9\u05DE\u05D4","matTooltipPosition","above",1,"add-button",2,"position","fixed","bottom","8vh","left","2vw","z-index","1000",3,"click"],[1,"add-icon"]],template:function(i,o){i&1&&(W(0,"main",3)(1,"header",4)(2,"div",5)(3,"h1",6),Q(4,"\u05E0\u05D9\u05D4\u05D5\u05DC \u05DE\u05E1\u05DE\u05DB\u05D9\u05DD"),H(),W(5,"h2",7),Q(6,"\u05D4\u05E2\u05DC\u05D4, \u05E0\u05D4\u05DC \u05D5\u05E6\u05E4\u05D4 \u05D1\u05DE\u05E1\u05DE\u05DB\u05D9\u05DD \u05E9\u05DC\u05DA \u05D1\u05E7\u05DC\u05D5\u05EA"),H()(),be(7,Lp,12,6,"mat-form-field",8),H(),W(8,"div",9),be(9,b0,33,3)(10,E0,4,0,"div",10),H()(),W(11,"div",11)(12,"mat-card",12)(13,"mat-card-title",13),Q(14,"\u05D8\u05D9\u05E4\u05D9\u05DD \u05DC\u05E0\u05D9\u05D4\u05D5\u05DC \u05DE\u05E1\u05DE\u05DB\u05D9\u05DD"),H(),W(15,"mat-card-content",14)(16,"div",15)(17,"b"),Q(18,"\u05E9\u05DE\u05D5\u05E8 \u05E2\u05DC \u05E1\u05D3\u05E8:"),H(),Q(19," \u05D0\u05E8\u05D2\u05DF \u05D0\u05EA \u05D4\u05DE\u05E1\u05DE\u05DB\u05D9\u05DD \u05E9\u05DC\u05DA \u05DC\u05E4\u05D9 \u05E7\u05D8\u05D2\u05D5\u05E8\u05D9\u05D5\u05EA \u05D1\u05E8\u05D5\u05E8\u05D5\u05EA \u05DB\u05D3\u05D9 \u05DC\u05DE\u05E6\u05D5\u05D0 \u05D0\u05D5\u05EA\u05DD \u05D1\u05E7\u05DC\u05D5\u05EA. "),H(),W(20,"div",15)(21,"b"),Q(22,"\u05D2\u05D9\u05D1\u05D5\u05D9 \u05EA\u05E7\u05D5\u05E4\u05EA\u05D9:"),H(),Q(23," \u05D5\u05D3\u05D0 \u05E9\u05D9\u05E9 \u05DC\u05DA \u05D2\u05D9\u05D1\u05D5\u05D9 \u05DE\u05E1\u05D5\u05D3\u05E8 \u05E9\u05DC \u05D4\u05DE\u05E1\u05DE\u05DB\u05D9\u05DD \u05D4\u05D7\u05E9\u05D5\u05D1\u05D9\u05DD \u05E9\u05DC\u05DA. "),H(),W(24,"div",15)(25,"b"),Q(26,"\u05E2\u05D3\u05DB\u05D5\u05DF \u05E9\u05D5\u05D8\u05E3:"),H(),Q(27," \u05D1\u05D3\u05D5\u05E7 \u05D0\u05EA \u05D4\u05DE\u05E1\u05DE\u05DB\u05D9\u05DD \u05E9\u05DC\u05DA \u05DE\u05D3\u05D9 \u05E4\u05E2\u05DD \u05DB\u05D3\u05D9 \u05DC\u05D4\u05D1\u05D8\u05D9\u05D7 \u05E9\u05D4\u05DD \u05DE\u05E2\u05D5\u05D3\u05DB\u05E0\u05D9\u05DD \u05D5\u05EA\u05E7\u05D9\u05E0\u05D9\u05DD. "),H()()()(),be(28,x0,3,0,"button",16)),i&2&&(le(7),lt(o.loginService.isAdmin()?7:-1),le(2),lt(o.dataSource.data.length>0?9:10),le(19),lt(o.loginService.isAdmin()?28:-1))},dependencies:[ur,bt,Et,Mr,Ur,zr,jr,Br,Gr,Hr,Wr,$r,Vr,Ft,Mt,Pt,hr,Dt,xt,rh,nh,Qr,Tt,ht,Pr,Li,Mi,cr,Xr,ch,uh,lh,Nt,Lt,hh,fh,qd,Fd],styles:[".header-card[_ngcontent-%COMP%]{margin:20px;background-color:#e3f2fd;padding:20px;border-radius:8px}.header-card[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{font-size:24px;font-weight:700;color:#0d47a1}.header-card[_ngcontent-%COMP%]   mat-card-subtitle[_ngcontent-%COMP%]{font-size:16px;color:#1565c0}.header-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{margin-top:10px;font-size:14px;color:#424242}.search-container[_ngcontent-%COMP%]{position:absolute;right:3vw}.search-field[_ngcontent-%COMP%]{width:100%}mat-form-field[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#1976d2}.document-actions[_ngcontent-%COMP%]{align-items:center}.content-container[_ngcontent-%COMP%]{margin:20px auto;width:60vw}.cards-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:20px}.document-card[_ngcontent-%COMP%]{width:100%;max-width:300px;background-color:#fff;border-radius:8px;box-shadow:0 4px 6px #0000001a;padding-bottom:0}mat-card-title[_ngcontent-%COMP%]{font-size:18px;color:#0d47a1}mat-card-subtitle[_ngcontent-%COMP%]{font-size:14px;color:#1565c0}mat-card-content[_ngcontent-%COMP%]{font-size:14px;color:#424242}mat-card-actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.send-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin:20px}.no-docs-message[_ngcontent-%COMP%]{display:flex;justify-content:center;margin:20px}.no-docs-card[_ngcontent-%COMP%]{padding:20px;background-color:#7098bb69;color:#000;border-radius:8px}.document-name[_ngcontent-%COMP%]{text-decoration:underline;color:#1565c0}.document-name[_ngcontent-%COMP%]:hover{cursor:pointer;color:#0d47a1}.header-container[_ngcontent-%COMP%]{margin:0 auto;width:75vw;background:linear-gradient(to right,#e3f2fd38,#bbdefb67);padding:20px;border-radius:8px;box-shadow:0 4px 8px #00000014}.header-content[_ngcontent-%COMP%]{text-align:center;margin-bottom:20px}.header-title[_ngcontent-%COMP%]{font-size:28px;font-weight:600;color:#0d47a1;margin:0}.header-subtitle[_ngcontent-%COMP%]{font-size:18px;color:#1565c0;margin:0}.tips-container[_ngcontent-%COMP%]{width:100%;background-color:#ffffff8f}.tips-card[_ngcontent-%COMP%]{background-color:#f0f4f8c5;padding:20px;border-radius:8px;box-shadow:0 2px 4px #0000001a}.tips-title[_ngcontent-%COMP%]{font-size:22px;font-weight:700;color:#0d47a1;text-align:center;margin-bottom:15px}.tips-content[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-around;font-size:16px;color:#424242}.tips-item[_ngcontent-%COMP%]{width:45%;margin-bottom:15px;line-height:1.6}.icon-button[_ngcontent-%COMP%]{float:left}.separator[_ngcontent-%COMP%]{margin-right:10px}span[_ngcontent-%COMP%]:hover{cursor:pointer}.download[_ngcontent-%COMP%]{color:#00005c;text-decoration:underline}.download[_ngcontent-%COMP%]:hover{color:#020223}mat-header-cell[_ngcontent-%COMP%]{background-color:#aabdca27!important}mat-row[_ngcontent-%COMP%]:hover{background-color:#e0dcdc22}"],data:{animation:[Bd("detailExpand",[Yo("collapsed,void",qo({height:"0px",minHeight:"0"})),Yo("expanded",qo({height:"*"})),jd("expanded <=> collapsed",Ud("225ms cubic-bezier(0.4, 0.0, 0.2, 1)"))])]}});let t=e;return t})();var D0=["footer"],h1=(()=>{let e=class e{ngAfterViewInit(){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Be({type:e,selectors:[["app-footer"]],viewQuery:function(i,o){if(i&1&&yt(D0,5),i&2){let s;_t(s=vt())&&(o.footer=s.first)}},decls:6,vars:0,consts:[["footer",""],[1,"footer"],[1,"site-info"],[1,"footer-text"],["src","assets/logo_diversi.png","alt","Logo Image",1,"footer-image"]],template:function(i,o){i&1&&(W(0,"div",1,0),Ce(2,"div",2),W(3,"p",3),Q(4,"\xA9 2024 Y.B by DiversiTech. All rights reserved."),H(),Ce(5,"img",4),H())},styles:[".footer[_ngcontent-%COMP%]{position:relative;bottom:0;width:100%;text-align:center;padding:20px 0;box-shadow:0 -2px 5px #15161533;height:60px;background-color:#b2bdca;margin:0 auto;display:flex;justify-content:space-between;font-family:Segoe UI Black;color:#ffffffe9}.footer[_ngcontent-%COMP%]   img.footer-image[_ngcontent-%COMP%]{height:80px;width:80px;margin-right:60px;border-radius:3px}.footer-text[_ngcontent-%COMP%]{font-size:20px;margin-top:20px;text-align:center}p[_ngcontent-%COMP%]{margin:0!important}"]});let t=e;return t})();var Gi=(()=>{let e=class e{constructor(){this.isOpen=!1}toggle(){this.isOpen=!this.isOpen}isOpened(){return this.isOpen}setOpen(n){this.isOpen=n}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Xe({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var T0=["sidenav"];function C0(t,e){if(t&1&&(W(0,"a",5)(1,"span"),Q(2),H(),W(3,"mat-icon"),Q(4),H()()),t&2){let r=e.$implicit;we("routerLink",r.path),le(2),Ze(r.name),le(2),Ze(r.icon)}}var xh=(()=>{let e=class e{constructor(n,i){this.platformId=n,this.navigationMenuService=i}ngOnInit(){$o(this.platformId)&&setTimeout(()=>{this.toggleSidenav(window.innerWidth)})}get componentsList(){return this._componentsList}set componentsList(n){this._componentsList=n}toggleSidenav(n){n<900?(this.navigationMenuService.setOpen(!1),this.sidenav?.close()):(this.navigationMenuService.setOpen(!0),this.sidenav?.open())}onResize(n){if($o(this.platformId)){let i=n.target;setTimeout(()=>{this.toggleSidenav(i.innerWidth)})}}};e.\u0275fac=function(i){return new(i||e)(_e(xd),_e(Gi))},e.\u0275cmp=Be({type:e,selectors:[["navigation-menu"]],viewQuery:function(i,o){if(i&1&&yt(T0,5),i&2){let s;_t(s=vt())&&(o.sidenav=s.first)}},hostBindings:function(i,o){i&1&&xe("resize",function(a){return o.onResize(a)},!1,wi)},inputs:{componentsList:"componentsList"},decls:10,vars:1,consts:[["sidenav",""],[1,"container"],[1,"sidenav-container",2,"background","transparent"],["mode","side","position","end","dir","rtl",1,"sidenav",3,"opened"],["dir","rtl"],["mat-list-item","",3,"routerLink"],["dir","rtl",1,"main-content",2,"background-image","url(../../../assets/background.jpg)"],[1,"content"]],template:function(i,o){i&1&&(W(0,"div",1)(1,"mat-sidenav-container",2)(2,"mat-sidenav",3,0)(4,"mat-nav-list",4),Ad(5,C0,5,3,"a",5,Sd),H()(),W(7,"mat-sidenav-content",6)(8,"div",7),Ce(9,"router-outlet"),H()()()()),i&2&&(le(2),we("opened",o.navigationMenuService.isOpened()),le(3),Id(o.componentsList))},dependencies:[Et,Zd,Xd,Jd,eh,Qd,hr,Hd,Ai],styles:['.content[_ngcontent-%COMP%]{background-image:url("./media/background-M3CTWIGI.jpg")}.sidenav-container[_ngcontent-%COMP%]{min-height:100vh;height:100vh;flex-grow:1;overflow:auto}.mat-icon[_ngcontent-%COMP%]{float:right;margin-left:10px}.sidenav[_ngcontent-%COMP%]{width:13vw;margin:0;min-width:max-content;height:100vh}@media only screen and (max-width: 900px){a[_ngcontent-%COMP%]{padding:5px}span[_ngcontent-%COMP%]{font-size:18px}}']});let t=e;return t})();var Dh=(()=>{let e=class e{constructor(n,i){this.http=n,this.loginService=i,this.apiUrl=`${ft.apiURL}/api/Notification`,this.hasUnreadNotifications=!1,this.unreadNotificationsCount=0}getNotificationsByCustomerId(n){return this.http.get(`${this.apiUrl}/${n}`)}sendNotification(n){return this.http.post(this.apiUrl,n)}deleteNotification(n){return this.http.delete(`${this.apiUrl}/${n}`)}updateNotification(n){return this.http.put(`${this.apiUrl}/${n.id}`,n)}updateNotificationsStatus(n){return this.http.put(`${this.apiUrl}`,n)}checkNotifications(){let n=0;typeof window<"u"&&window.sessionStorage&&(n=this.loginService.decodeToken(sessionStorage.getItem("token")||"").customerId||-1),this.getNotificationsByCustomerId(n).subscribe(i=>{let o=i.filter(s=>!s.isRead);this.unreadNotificationsCount=o.length,this.hasUnreadNotifications=this.unreadNotificationsCount>0},i=>{console.error("\u05E9\u05D2\u05D9\u05D0\u05D4 \u05D1\u05D8\u05E2\u05D9\u05E0\u05EA \u05D4\u05EA\u05E8\u05D0\u05D5\u05EA:",i),this.unreadNotificationsCount=0,this.hasUnreadNotifications=!1})}};e.\u0275fac=function(i){return new(i||e)(Ie(dt),Ie(Ke))},e.\u0275prov=Xe({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function A0(t,e){if(t&1){let r=ze();W(0,"button",10),xe("click",function(){Le(r);let i=ye(2);return Fe(i.openDocuments())}),W(1,"mat-icon"),Q(2,"description"),H()()}}function I0(t,e){if(t&1){let r=ze();W(0,"button",7),xe("click",function(){Le(r);let i=ye();return Fe(i.openNotifications())}),W(1,"mat-icon",8),Q(2,"notifications"),H()(),be(3,A0,3,0,"button",9)}if(t&2){let r=ye();le(),we("matBadge",r.notificationService.unreadNotificationsCount)("matBadgeHidden",!r.notificationService.hasUnreadNotifications),le(2),we("ngIf",r.documentService.hasPendingDocuments)}}var W1=(()=>{let e=class e{constructor(n,i,o,s,a,l){this.NavigationMenuToggleService=n,this.notificationService=i,this.documentService=o,this.customerService=s,this.loginService=a,this.router=l,this.isLoggedIn=!1,this.user="\u05D0\u05D5\u05E8\u05D7",this.notifications=[]}ngOnInit(){this.NavigationMenuToggleService.toggle(),this.notificationService.checkNotifications(),this.subscription=this.documentService.selectedDocuments$.subscribe(()=>{this.documentService.checkPendingDocuments()})}logOut(){this.loginService.isLoggedIn()&&this.loginService.Logout()}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}logout(){window.sessionStorage!=null&&sessionStorage.removeItem("token"),this.router.navigate(["auth/login"])}loginOrLogout(){this.notificationService.checkNotifications(),this.documentService.checkPendingDocuments()}toggleNavigationMenu(){this.NavigationMenuToggleService.toggle()}unloadNotification(n){this.documentService.hasNotSavedDoc&&(n.returnValue="\u05E9\u05D9\u05E0\u05D5\u05D9\u05D9\u05DD \u05E9\u05D1\u05D9\u05E6\u05E2\u05EA \u05DC\u05D0 \u05D9\u05E9\u05DE\u05E8\u05D5 \u05D0\u05DD \u05EA\u05E2\u05D6\u05D5\u05D1 \u05D0\u05EA \u05D4\u05D3\u05E3!")}openNotifications(){this.router.navigate([`customer/notifications/${this.loginService.GetCurrentUser().customerId}`])}openDocuments(){this.router.navigate([`customer/document-list/${this.loginService.GetCurrentUser().customerId}`])}};e.\u0275fac=function(i){return new(i||e)(_e(Gi),_e(Dh),_e(tn),_e(en),_e(Ke),_e(ct))},e.\u0275cmp=Be({type:e,selectors:[["app-toolbar"]],hostBindings:function(i,o){i&1&&xe("beforeunload",function(a){return o.unloadNotification(a)},!1,wi)},features:[bi([xh])],decls:15,vars:4,consts:[["color","primary",1,"toolbar"],[1,"toolbar-content"],[1,"logo-container"],["src","assets/logo.png","alt","Logo",1,"logo"],["mat-button","","routerLink","/auth/login",1,"buttonLog",3,"click"],[1,"welcome-message"],[1,"span"],["mat-icon-button","",3,"click"],["aria-hidden","false","matBadgeColor","warn",3,"matBadge","matBadgeHidden"],["mat-icon-button","","matBadge","!","matBadgeSize","large","class","demo-section","matTooltip","\u05D9\u05E9\u05E0\u05DD \u05DE\u05E1\u05DE\u05DB\u05D9\u05DD \u05E9\u05E2\u05D3\u05D9\u05D9\u05DF \u05DC\u05D0 \u05D4\u05E2\u05DC\u05D9\u05EA","matTooltipPosition","below",3,"click",4,"ngIf"],["mat-icon-button","","matBadge","!","matBadgeSize","large","matTooltip","\u05D9\u05E9\u05E0\u05DD \u05DE\u05E1\u05DE\u05DB\u05D9\u05DD \u05E9\u05E2\u05D3\u05D9\u05D9\u05DF \u05DC\u05D0 \u05D4\u05E2\u05DC\u05D9\u05EA","matTooltipPosition","below",1,"demo-section",3,"click"]],template:function(i,o){i&1&&(W(0,"mat-toolbar",0)(1,"div",1)(2,"div",2),Ce(3,"img",3),H(),W(4,"button",4),xe("click",function(){return o.logOut()}),W(5,"mat-icon"),Q(6),H(),Q(7),H(),W(8,"div",5)(9,"span",6),Q(10),H(),be(11,I0,4,3),H()(),W(12,"button",7),xe("click",function(){return o.toggleNavigationMenu()}),W(13,"mat-icon"),Q(14,"menu"),H()()()),i&2&&(le(6),Ze(o.loginService.isLoggedIn()?"logout":"login"),le(),je(" ",o.loginService.isLoggedIn()?"\u05D9\u05E6\u05D9\u05D0\u05D4":"\u05D4\u05EA\u05D7\u05D1\u05E8\u05D5\u05EA"," "),le(3),je("!\u05E9\u05DC\u05D5\u05DD ",o.loginService.GetCurrentUser().userName!=null?o.loginService.GetCurrentUser().userName:"\u05D0\u05D5\u05E8\u05D7",""),le(),lt(o.loginService.isAdmin()?-1:11))},dependencies:[bt,th,hr,ht,Pr,Xr,dh,Ai],styles:["*[_ngcontent-%COMP%]{color:#000}[_nghost-%COMP%]{background-color:transparent}.mat-toolbar[_ngcontent-%COMP%]{display:flex;justify-content:space-between;background-color:#b2bdca;background:linear-gradient(135deg,#ced5dd,#a9b2bb);padding:0 16px}.toolbar-content[_ngcontent-%COMP%]{display:flex;align-items:center}.logo-container[_ngcontent-%COMP%]{display:flex;align-items:center;margin-right:16px}.logo[_ngcontent-%COMP%]{height:90px;width:110px}.buttonLog[_ngcontent-%COMP%]{height:40px;border-radius:20px;font-size:.875rem;font-weight:600;text-align:center;color:#000;padding:0 16px;background-color:#fff;transition:background-color .3s,transform .3s;margin-right:16px}.buttonLog[_ngcontent-%COMP%]:hover{background-color:#d4e6f1;transform:scale(1.05)}.welcome-message[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:1.25rem;font-weight:500;color:#fff;opacity:0;animation:_ngcontent-%COMP%_fadeIn 1s forwards}mat-toolbar[_ngcontent-%COMP%]{display:flex;height:13vh;justify-content:space-between}mat-icon[_ngcontent-%COMP%]{margin-right:8px}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}"]});let t=e;return t})();var tb=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=pi({type:e}),e.\u0275inj=mi({imports:[Ci,Ui,Wd]});let t=e;return t})();var Th=class{constructor(e,r,n){this.name="home",this.path="/home",this.name=e,this.path=r,this.icon=n}};var ha=(()=>{let e=class e{constructor(n,i){this.http=n,this.loginService=i,this.basicURL=ft.apiURL+"/api/",this.LeadsSubject=new At([]),this.leads$=this.LeadsSubject.asObservable(),this.loginService.isAdmin()&&this.fetchLeads().subscribe()}fetchLeads(){return this.http.get(`${this.basicURL}Leads`).pipe(Je(n=>this.LeadsSubject.next(n)),Ve(n=>{throw console.error("Error fetching leads:",n),n}))}getLeads(){return this.fetchLeads()}getLeadById(n){return this.http.get(`${this.basicURL}Leads/${n}`).pipe(Ve(i=>{throw console.error("Error fetching lead:",i),i}))}deleteCustomer(n){let i=`${this.basicURL}Leads/${n}`;return this.http.delete(i).pipe(Je(()=>{let o=this.LeadsSubject.getValue().filter(s=>s.id!==n);this.LeadsSubject.next(o)}),Ve(o=>{throw console.error("Error deleting customer:",o),o}))}updateLead(n){let i=`${this.basicURL}Leads/${n.id}`;return console.log(n),this.http.put(i,n).pipe(Je(()=>{let o=this.LeadsSubject.getValue(),s=o.findIndex(a=>a.id===n?.id);s!==-1&&(o[s]=n,this.LeadsSubject.next([...o]))}),Ve(o=>{throw o}))}addLead(n){let i=`${this.basicURL}Leads/`;return this.http.post(i,n).pipe(Je(o=>{let s=this.LeadsSubject.getValue();this.LeadsSubject.next([...s,o])}),Ve(o=>{throw console.error("Error adding lead:",o),o}))}sendLink(){return"http://localhost:4200/"}checkToken(n){console.log(n,"token id");debugger;return this.http.get(`${this.basicURL}Email/validate-magic-link/${n}`,{observe:"response",responseType:"text"})}};e.\u0275fac=function(i){return new(i||e)(Ie(dt),Ie(Ke))},e.\u0275prov=Xe({token:e,factory:e.\u0275fac});let t=e;return t})();var Sh=(()=>{let e=class e{constructor(n,i){this.http=n,this.loginservice=i,this.basicURL=ft.apiURL+"/api/",this.usersSubject=new At([]),this.users$=this.usersSubject.asObservable(),this.loginservice.isAdmin()&&this.fetchUsers().subscribe()}fetchUsers(){let n={headers:new Vo({"Content-Type":"application/json"}),withCredentials:!0};return this.http.get(`${this.basicURL}Users`,n).pipe(Je(i=>this.usersSubject.next(i)),Ve(i=>{throw console.error("Error fetching users:",i),i}))}createUser(n){let i=new FormData;return n.id!==void 0&&i.append("Id",n.id.toString()),n.userName!==void 0&&i.append("UserName",n.userName),n.password!==void 0&&i.append("Password",n.password),n.email!==void 0&&i.append("Email",n.email),n.role!==void 0&&i.append("Role",n.role.toString()),n.created_at!==void 0&&i.append("Created_at",n.created_at.toISOString()),n.updated_at!==void 0&&i.append("Updated_at",n.updated_at.toISOString()),this.http.post(`${this.basicURL}Users`,n)}createUserForLead(n,i){let o=new FormData;n.id!==void 0&&o.append("Id",n.id.toString()),n.userName!==void 0&&o.append("UserName",n.userName),n.password!==void 0&&o.append("Password",n.password),n.email!==void 0&&o.append("Email",n.email),n.role!==void 0&&o.append("Role",n.role.toString()),n.created_at!==void 0&&o.append("Created_at",n.created_at.toISOString()),n.updated_at!==void 0&&o.append("Updated_at",n.updated_at.toISOString());let s;return n.role==qt.Admin?s=0:s=1,this.http.post(`${this.basicURL}Users/Lead${i}`,In(gt({},n),{role:s}))}IsExist(n){let i=new Vo({"Content-Type":"application/json"});console.log("Checking if user exists:",n);let o=n.role==qt.Admin?0:1;return this.http.post(this.basicURL+"Users/login",In(gt({},n),{role:o,headers:i,responseType:"text"})).pipe(Kt(s=>(console.log("IsExist response:",s),s&&s.token?(console.log("User exists"),sessionStorage.setItem("token",s.token),"200"):(console.log("User does not exist"),"404"))),Ve(s=>(console.error("Error checking if user exists:",s),s.status===404?(console.log("User not found:",s.error),kn("404")):kn("Error: Unable to access the server"))))}updateUser(n){return this.http.put(`${this.basicURL}Users/${n.id}`,n).pipe(Je(()=>{let o=this.usersSubject.getValue().findIndex(s=>s.id===n?.id);this.fetchUsers().subscribe()}))}getUserById(n){return this.users$.pipe(Kt(i=>i.find(o=>o.id===n)))}addUser(n){return this.http.post(`${this.basicURL}Users`,n).pipe(Je(()=>{this.fetchUsers().subscribe()}))}};e.\u0275fac=function(i){return new(i||e)(Ie(dt),Ie(Ke))},e.\u0275prov=Xe({token:e,factory:e.\u0275fac});let t=e;return t})();function R0(t,e){t&1&&(W(0,"mat-error"),Q(1,"\u05E9\u05D3\u05D4 \u05D6\u05D4 \u05D4\u05D9\u05E0\u05D5 \u05D7\u05D5\u05D1\u05D4"),H())}function N0(t,e){t&1&&(W(0,"mat-error"),Q(1," \u05DE\u05D9\u05D9\u05DC \u05DC\u05D0 \u05EA\u05E7\u05D9\u05DF"),H())}function L0(t,e){t&1&&(W(0,"mat-error"),Q(1,"\u05E9\u05D3\u05D4 \u05D6\u05D4 \u05D4\u05D9\u05E0\u05D5 \u05D7\u05D5\u05D1\u05D4"),H())}function F0(t,e){t&1&&(W(0,"mat-error"),Q(1,"\u05D9\u05E9 \u05DC\u05D4\u05DB\u05E0\u05D9\u05E1 \u05DC\u05E4\u05D7\u05D5\u05EA 6 \u05EA\u05D5\u05D5\u05D9\u05DD"),H())}function P0(t,e){t&1&&(W(0,"mat-error"),Q(1,"\u05E9\u05D3\u05D4 \u05D6\u05D4 \u05D4\u05D9\u05E0\u05D5 \u05D7\u05D5\u05D1\u05D4"),H())}function M0(t,e){t&1&&(W(0,"mat-error"),Q(1," \u05DE\u05D9\u05D9\u05DC \u05DC\u05D0 \u05EA\u05E7\u05D9\u05DF"),H())}function B0(t,e){if(t&1&&(W(0,"mat-option",14),Q(1),H()),t&2){let r=e.$implicit;we("value",r),le(),Ze(r)}}var Db=(()=>{let e=class e{constructor(n,i,o,s){this.fb=n,this.route=i,this.router=o,this.userService=s,this.roles=["\u05DE\u05E0\u05D4\u05DC \u05DE\u05E2\u05E8\u05DB\u05EA","\u05DC\u05E7\u05D5\u05D7"],this.formattedCreatedAt="",this.formattedUpdatedAt="",this.userForm=this.fb.group({userName:["",[rt.required,rt.email]],password:["",[rt.required,rt.minLength(6)]],email:["",[rt.required,rt.email]],role:["",[rt.required,rt.pattern(/[' '].*['']/)]],created_at:[{value:"",disabled:!0}],updated_at:[{value:"",disabled:!0}]})}ngOnInit(){this.route.params.subscribe(n=>{this.userId=+n.id,this.userId!==-1&&this.getUserById(this.userId)})}getUserById(n){this.userService.getUserById(n).subscribe(i=>{if(this.user=i,this.user){let o=new Date(this.user.created_at);this.formattedCreatedAt=`${o.getDate()}-${String(o.getMonth()+1).padStart(2,"0")}-${String(o.getFullYear()).padStart(2,"0")}`;let s=new Date(this.user.updated_at);this.formattedUpdatedAt=`${s.getDate()}-${String(s.getMonth()+1).padStart(2,"0")}-${String(s.getFullYear()).padStart(2,"0")}`,this.userForm.patchValue({userName:this.user.userName,password:this.user.password,email:this.user.email,role:this.user.role===qt.Admin?"\u05DE\u05E0\u05D4\u05DC \u05DE\u05E2\u05E8\u05DB\u05EA":"\u05DC\u05E7\u05D5\u05D7",created_at:this.user.created_at,updated_at:this.user.updated_at})}})}onEmailInput(){let n=this.userForm.get("email")?.value;this.userForm.patchValue({userName:n})}saveUser(){if(this.userForm.valid){let n=this.userForm.value;this.userId===-1?(n.created_at=new Date,n.userName=this.userForm.value.email,n.email=this.userForm.value.email,n.password=this.userForm.value.password,n.updated_at=new Date,n.role=this.userForm.value.role==="\u05DE\u05E0\u05D4\u05DC \u05DE\u05E2\u05E8\u05DB\u05EA"?qt.Admin:qt.Customer,this.userService.addUser(n).subscribe({next:()=>{this.router.navigate(["admin/user-list"])}})):(n.id=this.user.id,n.created_at=this.user.created_at,n.userName=n.email,n.email=this.userForm.value.email,n.password=this.userForm.value.password,n.updated_at=new Date,n.role=this.userForm.value.role==="\u05DE\u05E0\u05D4\u05DC \u05DE\u05E2\u05E8\u05DB\u05EA"?qt.Admin:qt.Customer,this.userService.updateUser(n).subscribe({next:i=>{this.router.navigate(["admin/user-list"])}}))}}cancel(){this.router.navigate(["admin/user-list"])}};e.\u0275fac=function(i){return new(i||e)(_e(Fr),_e(Or),_e(ct),_e(Sh))},e.\u0275cmp=Be({type:e,selectors:[["app-user-detail"]],standalone:!0,features:[kr],decls:43,vars:11,consts:[["id","content"],[1,"user-edit-card"],[1,"mat-card-content",3,"ngSubmit","formGroup"],["appearance","fill",1,"mat-form-field"],["matInput","","formControlName","email","placeholder","\u05DC\u05D3\u05D5\u05D2. \u05D9\u05D5\u05E1\u05D9 "],[4,"ngIf"],["matInput","","formControlName","password","placeholder","\u05DC\u05D3\u05D5\u05D2. 12dfgh11 "],["matInput","","formControlName","email","placeholder","\u05DC\u05D3\u05D5\u05D2. example@gmail.com",3,"input"],["formControlName","role","placeholder","","required",""],[3,"value",4,"ngFor","ngForOf"],["matInput","","disabled","",3,"value"],[1,"button-group"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["mat-raised-button","","color","warn","type","button",3,"click"],[3,"value"]],template:function(i,o){if(i&1&&(W(0,"div",0)(1,"mat-card",1)(2,"mat-card-title"),Q(3,"\u05E4\u05E8\u05D8\u05D9 \u05DE\u05E9\u05EA\u05DE\u05E9"),H(),W(4,"mat-card-content")(5,"form",2),xe("ngSubmit",function(){return o.saveUser()}),W(6,"mat-form-field",3)(7,"mat-label"),Q(8,"\u05E9\u05DD"),H(),Ce(9,"input",4),be(10,R0,2,0,"mat-error",5)(11,N0,2,0,"mat-error",5),H(),W(12,"mat-form-field",3)(13,"mat-label"),Q(14,"\u05E1\u05D9\u05E1\u05DE\u05D0"),H(),Ce(15,"input",6),be(16,L0,2,0,"mat-error",5)(17,F0,2,0,"mat-error",5),H(),W(18,"mat-form-field",3)(19,"mat-label"),Q(20,"\u05DE\u05D9\u05D9\u05DC"),H(),W(21,"input",7),xe("input",function(){return o.onEmailInput()}),H(),be(22,P0,2,0,"mat-error",5)(23,M0,2,0,"mat-error",5),H(),Ce(24,"br"),W(25,"mat-form-field",3)(26,"mat-label"),Q(27,"\u05EA\u05E4\u05E7\u05D9\u05D3"),H(),W(28,"mat-select",8),be(29,B0,2,2,"mat-option",9),H()(),W(30,"mat-form-field",3)(31,"mat-label"),Q(32,"\u05E0\u05D5\u05E6\u05E8 \u05D1\u05EA\u05D0\u05E8\u05D9\u05DA"),H(),Ce(33,"input",10),H(),W(34,"mat-form-field",3)(35,"mat-label"),Q(36,"\u05E2\u05D5\u05D3\u05DB\u05DF \u05D1\u05EA\u05D0\u05E8\u05D9\u05DA"),H(),Ce(37,"input",10),H(),W(38,"div",11)(39,"button",12),Q(40,"\u05E9\u05DE\u05D5\u05E8"),H(),W(41,"button",13),xe("click",function(){return o.cancel()}),Q(42,"\u05D1\u05D9\u05D8\u05D5\u05DC"),H()()()()()()),i&2){let s,a,l,g,_,b;le(5),we("formGroup",o.userForm),le(5),we("ngIf",(s=o.userForm.get("email"))==null?null:s.hasError("required")),le(),we("ngIf",(a=o.userForm.get("email"))==null?null:a.hasError("email")),le(5),we("ngIf",(l=o.userForm.get("password"))==null?null:l.hasError("required")),le(),we("ngIf",(g=o.userForm.get("password"))==null?null:g.hasError("minlength")),le(5),we("ngIf",(_=o.userForm.get("email"))==null?null:_.hasError("required")),le(),we("ngIf",(b=o.userForm.get("email"))==null?null:b.hasError("email")),le(6),we("ngForOf",o.roles),le(4),we("value",o.formattedCreatedAt),le(4),we("value",o.formattedUpdatedAt),le(2),we("disabled",o.userForm.invalid)}},dependencies:[Ui,Ft,Mt,Pt,Dt,xt,Kr,Tt,ht,Yr,cr,dr,Nt,Lt,lr,Lr,Yd,Rr,Nr,Ci,ur,bt],styles:[".user-edit-card[_ngcontent-%COMP%]{max-width:800px;margin:auto;padding:20px;box-shadow:0 0 20px #000000b3}.button-group[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-top:20px}.mat-form-field[_ngcontent-%COMP%]{margin:10px!important;width:12vw}#content[_ngcontent-%COMP%]{background-color:#ffffff9a;padding:25px;border-radius:40px;min-width:max-content;height:70vh}@media screen and (max-width: 900px){.mat-form-field[_ngcontent-%COMP%]{margin:10px!important;width:15vw;font-size:small;height:70px}mat-label[_ngcontent-%COMP%]{font-size:small}}"]});let t=e;return t})();function U0(t,e){t&1&&(W(0,"mat-error"),Q(1,"\u05E9\u05D3\u05D4 \u05D6\u05D4 \u05D4\u05D9\u05E0\u05D5 \u05D7\u05D5\u05D1\u05D4"),H())}function j0(t,e){t&1&&(W(0,"mat-error"),Q(1,"\u05E9\u05D3\u05D4 \u05D6\u05D4 \u05D4\u05D9\u05E0\u05D5 \u05D7\u05D5\u05D1\u05D4"),H())}function H0(t,e){t&1&&(W(0,"mat-error"),Q(1,"\u05DE\u05E1\u05E4\u05E8 \u05D8\u05DC\u05E4\u05D5\u05DF \u05DC\u05D0 \u05EA\u05E7\u05D9\u05DF"),H())}function W0(t,e){t&1&&(W(0,"mat-error"),Q(1,"\u05E9\u05D3\u05D4 \u05D6\u05D4 \u05D4\u05D9\u05E0\u05D5 \u05D7\u05D5\u05D1\u05D4"),H())}function z0(t,e){t&1&&(W(0,"mat-error"),Q(1,"\u05DB\u05EA\u05D5\u05D1\u05EA \u05DE\u05D9\u05D9\u05DC \u05DC\u05D0 \u05EA\u05E7\u05D9\u05E0\u05D4"),H())}var Ob=(()=>{let e=class e{constructor(n,i,o,s){this.fb=n,this.route=i,this.router=o,this.leadService=s,this.leadForm=this.fb.group({first_Name:["",[rt.required]],phone:["",[rt.required,rt.pattern(/^\d{10}$/)]],email:["",[rt.required,rt.email]],created_at:[{value:"",disabled:!0}],updated_at:[{value:"",disabled:!0}],token:[{value:"",disabled:!0}],expiration:[{value:"",disabled:!0}]})}ngOnInit(){this.route.params.pipe(bd(n=>(this.leadId=+n.id,this.leadService.getLeads()))).subscribe(n=>{this.lead=n.find(i=>i.id===this.leadId),this.lead&&this.leadForm.patchValue(this.lead)})}saveLead(){if(this.leadForm.valid){let n=this.leadForm.value;n.id=this.lead?.id||0,n.created_at=this.lead?.created_at||new Date,n.updated_at=this.lead?.updated_at||new Date,n.expiration=this.lead?.expiration||new Date,n.token="",this.leadId==-1?this.leadService.addLead(n).subscribe(i=>{this.router.navigate(["admin/lead-list"])}):this.leadService.updateLead(n).subscribe(i=>{this.router.navigate(["admin/lead-list"])})}}cancel(){this.router.navigate(["admin/lead-list"])}};e.\u0275fac=function(i){return new(i||e)(_e(Fr),_e(Or),_e(ct),_e(ha))},e.\u0275cmp=Be({type:e,selectors:[["lead-detail-modal"]],decls:37,vars:9,consts:[[1,"mainAll"],["dir","rtl",1,"lead-edit-card"],[3,"ngSubmit","formGroup"],["appearance","fill",1,"mat-form-field"],["matInput","","formControlName","first_Name","placeholder","\u05DC\u05D3\u05D5\u05D2. \u05D9\u05D5\u05E1\u05D9 "],[4,"ngIf"],["matInput","","formControlName","phone","placeholder","\u05DC\u05D3\u05D5\u05D2. 0501234567"],["matInput","","formControlName","email","placeholder","\u05DC\u05D3\u05D5\u05D2. example@example.com"],["matInput","","formControlName","created_at",3,"readonly"],["matInput","","formControlName","updated_at",3,"readonly"],[1,"button-group"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["mat-raised-button","","color","warn","type","button",3,"click"]],template:function(i,o){if(i&1&&(W(0,"div",0)(1,"mat-card",1)(2,"mat-card-title"),Q(3,"\u05E2\u05D3\u05DB\u05D5\u05DF \u05DC\u05D9\u05D3 "),H(),W(4,"mat-card-content")(5,"form",2),xe("ngSubmit",function(){return o.saveLead()}),W(6,"mat-form-field",3)(7,"mat-label"),Q(8,"\u05E9\u05DD"),H(),Ce(9,"input",4),be(10,U0,2,0,"mat-error",5),H(),W(11,"mat-form-field",3)(12,"mat-label"),Q(13,"\u05D8\u05DC\u05E4\u05D5\u05DF"),H(),Ce(14,"input",6),be(15,j0,2,0,"mat-error",5)(16,H0,2,0,"mat-error",5),H(),W(17,"mat-form-field",3)(18,"mat-label"),Q(19,"\u05DE\u05D9\u05D9\u05DC"),H(),Ce(20,"input",7),be(21,W0,2,0,"mat-error",5)(22,z0,2,0,"mat-error",5),H(),Ce(23,"br"),W(24,"mat-form-field",3)(25,"mat-label"),Q(26,"\u05E0\u05D5\u05E6\u05E8 \u05D1\u05EA\u05D0\u05E8\u05D9\u05DA"),H(),Ce(27,"input",8),H(),W(28,"mat-form-field",3)(29,"mat-label"),Q(30,"\u05E2\u05D5\u05D3\u05DB\u05DF \u05D1\u05EA\u05D0\u05E8\u05D9\u05DA"),H(),Ce(31,"input",9),H(),W(32,"div",10)(33,"button",11),Q(34,"\u05E9\u05DE\u05D5\u05E8"),H(),W(35,"button",12),xe("click",function(){return o.cancel()}),Q(36,"\u05D1\u05D9\u05D8\u05D5\u05DC"),H()()()()()()),i&2){let s,a,l,g,_;le(5),we("formGroup",o.leadForm),le(5),we("ngIf",(s=o.leadForm.get("first_Name"))==null?null:s.hasError("required")),le(5),we("ngIf",(a=o.leadForm.get("phone"))==null?null:a.hasError("required")),le(),we("ngIf",(l=o.leadForm.get("phone"))==null?null:l.hasError("pattern")),le(5),we("ngIf",(g=o.leadForm.get("email"))==null?null:g.hasError("required")),le(),we("ngIf",(_=o.leadForm.get("email"))==null?null:_.hasError("email")),le(5),we("readonly",!0),le(4),we("readonly",!0),le(2),we("disabled",o.leadForm.invalid)}},dependencies:[bt,dr,Nt,Lt,lr,Et,Ft,Mt,Pt,Dt,xt,Kr,Tt,ht,Rr,Nr],styles:[".lead-edit-card[_ngcontent-%COMP%]{max-width:800px;margin:auto;padding:20px;box-shadow:0 0 20px #000000b3}.button-group[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-top:20px}.mat-form-field[_ngcontent-%COMP%]{margin:10px!important;width:12vw}#content[_ngcontent-%COMP%]{background-color:#ffffff9a;padding:25px;border-radius:40px;min-width:max-content;height:70vh}@media screen and (max-width: 900px){.mat-form-field[_ngcontent-%COMP%]{margin:10px!important;width:15vw;font-size:small;height:70px}mat-label[_ngcontent-%COMP%]{font-size:small}}"]});let t=e;return t})();var G0={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Ih=(t,e,r)=>{let n,i=G0[t];return typeof i=="string"?n=i:e===1?n=i.one:n=i.other.replace("{{count}}",e.toString()),r?.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function $i(t){return(e={})=>{let r=e.width?String(e.width):t.defaultWidth;return t.formats[r]||t.formats[t.defaultWidth]}}var $0={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},V0={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},K0={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},kh={date:$i({formats:$0,defaultWidth:"full"}),time:$i({formats:V0,defaultWidth:"full"}),dateTime:$i({formats:K0,defaultWidth:"full"})};var q0={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Oh=(t,e,r,n)=>q0[t];function on(t){return(e,r)=>{let n=r?.context?String(r.context):"standalone",i;if(n==="formatting"&&t.formattingValues){let s=t.defaultFormattingWidth||t.defaultWidth,a=r?.width?String(r.width):s;i=t.formattingValues[a]||t.formattingValues[s]}else{let s=t.defaultWidth,a=r?.width?String(r.width):t.defaultWidth;i=t.values[a]||t.values[s]}let o=t.argumentCallback?t.argumentCallback(e):e;return i[o]}}var Y0={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},X0={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Z0={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Q0={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},J0={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},eg={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},tg=(t,e)=>{let r=Number(t),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},Rh={ordinalNumber:tg,era:on({values:Y0,defaultWidth:"wide"}),quarter:on({values:X0,defaultWidth:"wide",argumentCallback:t=>t-1}),month:on({values:Z0,defaultWidth:"wide"}),day:on({values:Q0,defaultWidth:"wide"}),dayPeriod:on({values:J0,defaultWidth:"wide",formattingValues:eg,defaultFormattingWidth:"wide"})};function an(t){return(e,r={})=>{let n=r.width,i=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],o=e.match(i);if(!o)return null;let s=o[0],a=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],l=Array.isArray(a)?ng(a,b=>b.test(s)):rg(a,b=>b.test(s)),g;g=t.valueCallback?t.valueCallback(l):l,g=r.valueCallback?r.valueCallback(g):g;let _=e.slice(s.length);return{value:g,rest:_}}}function rg(t,e){for(let r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e(t[r]))return r}function ng(t,e){for(let r=0;r<t.length;r++)if(e(t[r]))return r}function Nh(t){return(e,r={})=>{let n=e.match(t.matchPattern);if(!n)return null;let i=n[0],o=e.match(t.parsePattern);if(!o)return null;let s=t.valueCallback?t.valueCallback(o[0]):o[0];s=r.valueCallback?r.valueCallback(s):s;let a=e.slice(i.length);return{value:s,rest:a}}}var ig=/^(\d+)(th|st|nd|rd)?/i,og=/\d+/i,ag={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},sg={any:[/^b/i,/^(a|c)/i]},ug={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},cg={any:[/1/i,/2/i,/3/i,/4/i]},lg={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},dg={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},hg={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},fg={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},mg={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},pg={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Lh={ordinalNumber:Nh({matchPattern:ig,parsePattern:og,valueCallback:t=>parseInt(t,10)}),era:an({matchPatterns:ag,defaultMatchWidth:"wide",parsePatterns:sg,defaultParseWidth:"any"}),quarter:an({matchPatterns:ug,defaultMatchWidth:"wide",parsePatterns:cg,defaultParseWidth:"any",valueCallback:t=>t+1}),month:an({matchPatterns:lg,defaultMatchWidth:"wide",parsePatterns:dg,defaultParseWidth:"any"}),day:an({matchPatterns:hg,defaultMatchWidth:"wide",parsePatterns:fg,defaultParseWidth:"any"}),dayPeriod:an({matchPatterns:mg,defaultMatchWidth:"any",parsePatterns:pg,defaultParseWidth:"any"})};var fa={code:"en-US",formatDistance:Ih,formatLong:kh,formatRelative:Oh,localize:Rh,match:Lh,options:{weekStartsOn:0,firstWeekContainsDate:1}};var gg={};function pr(){return gg}var wg=Math.pow(10,8)*24*60*60*1e3,tE=-wg,Vi=6048e5,Fh=864e5,ma=6e4,pa=36e5;var yg=3600;var Ph=yg*24,rE=Ph*7,_g=Ph*365.2425,vg=_g/12,nE=vg*3;function Ge(t){let e=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&e==="[object Date]"?new t.constructor(+t):typeof t=="number"||e==="[object Number]"||typeof t=="string"||e==="[object String]"?new Date(t):new Date(NaN)}function ga(t){let e=Ge(t);return e.setHours(0,0,0,0),e}function wa(t){let e=Ge(t),r=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return r.setUTCFullYear(e.getFullYear()),+t-+r}function Mh(t,e){let r=ga(t),n=ga(e),i=+r-wa(r),o=+n-wa(n);return Math.round((i-o)/Fh)}function Ct(t,e){return t instanceof Date?new t.constructor(e):new Date(e)}function Bh(t){let e=Ge(t),r=Ct(t,0);return r.setFullYear(e.getFullYear(),0,1),r.setHours(0,0,0,0),r}function Uh(t){let e=Ge(t);return Mh(e,Bh(e))+1}function Yt(t,e){let r=pr(),n=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,i=Ge(t),o=i.getDay(),s=(o<n?7:0)+o-n;return i.setDate(i.getDate()-s),i.setHours(0,0,0,0),i}function br(t){return Yt(t,{weekStartsOn:1})}function Ki(t){let e=Ge(t),r=e.getFullYear(),n=Ct(t,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);let i=br(n),o=Ct(t,0);o.setFullYear(r,0,4),o.setHours(0,0,0,0);let s=br(o);return e.getTime()>=i.getTime()?r+1:e.getTime()>=s.getTime()?r:r-1}function jh(t){let e=Ki(t),r=Ct(t,0);return r.setFullYear(e,0,4),r.setHours(0,0,0,0),br(r)}function Hh(t){let e=Ge(t),r=+br(e)-+jh(e);return Math.round(r/Vi)+1}function qi(t,e){let r=Ge(t),n=r.getFullYear(),i=pr(),o=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??i.firstWeekContainsDate??i.locale?.options?.firstWeekContainsDate??1,s=Ct(t,0);s.setFullYear(n+1,0,o),s.setHours(0,0,0,0);let a=Yt(s,e),l=Ct(t,0);l.setFullYear(n,0,o),l.setHours(0,0,0,0);let g=Yt(l,e);return r.getTime()>=a.getTime()?n+1:r.getTime()>=g.getTime()?n:n-1}function Wh(t,e){let r=pr(),n=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,i=qi(t,e),o=Ct(t,0);return o.setFullYear(i,0,n),o.setHours(0,0,0,0),Yt(o,e)}function zh(t,e){let r=Ge(t),n=+Yt(r,e)-+Wh(r,e);return Math.round(n/Vi)+1}function Re(t,e){let r=t<0?"-":"",n=Math.abs(t).toString().padStart(e,"0");return r+n}var Xt={y(t,e){let r=t.getFullYear(),n=r>0?r:1-r;return Re(e==="yy"?n%100:n,e.length)},M(t,e){let r=t.getMonth();return e==="M"?String(r+1):Re(r+1,2)},d(t,e){return Re(t.getDate(),e.length)},a(t,e){let r=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(t,e){return Re(t.getHours()%12||12,e.length)},H(t,e){return Re(t.getHours(),e.length)},m(t,e){return Re(t.getMinutes(),e.length)},s(t,e){return Re(t.getSeconds(),e.length)},S(t,e){let r=e.length,n=t.getMilliseconds(),i=Math.trunc(n*Math.pow(10,r-3));return Re(i,e.length)}};var sn={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},ya={G:function(t,e,r){let n=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(t,e,r){if(e==="yo"){let n=t.getFullYear(),i=n>0?n:1-n;return r.ordinalNumber(i,{unit:"year"})}return Xt.y(t,e)},Y:function(t,e,r,n){let i=qi(t,n),o=i>0?i:1-i;if(e==="YY"){let s=o%100;return Re(s,2)}return e==="Yo"?r.ordinalNumber(o,{unit:"year"}):Re(o,e.length)},R:function(t,e){let r=Ki(t);return Re(r,e.length)},u:function(t,e){let r=t.getFullYear();return Re(r,e.length)},Q:function(t,e,r){let n=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(n);case"QQ":return Re(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(t,e,r){let n=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(n);case"qq":return Re(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(t,e,r){let n=t.getMonth();switch(e){case"M":case"MM":return Xt.M(t,e);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(t,e,r){let n=t.getMonth();switch(e){case"L":return String(n+1);case"LL":return Re(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(t,e,r,n){let i=zh(t,n);return e==="wo"?r.ordinalNumber(i,{unit:"week"}):Re(i,e.length)},I:function(t,e,r){let n=Hh(t);return e==="Io"?r.ordinalNumber(n,{unit:"week"}):Re(n,e.length)},d:function(t,e,r){return e==="do"?r.ordinalNumber(t.getDate(),{unit:"date"}):Xt.d(t,e)},D:function(t,e,r){let n=Uh(t);return e==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):Re(n,e.length)},E:function(t,e,r){let n=t.getDay();switch(e){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(t,e,r,n){let i=t.getDay(),o=(i-n.weekStartsOn+8)%7||7;switch(e){case"e":return String(o);case"ee":return Re(o,2);case"eo":return r.ordinalNumber(o,{unit:"day"});case"eee":return r.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(i,{width:"short",context:"formatting"});case"eeee":default:return r.day(i,{width:"wide",context:"formatting"})}},c:function(t,e,r,n){let i=t.getDay(),o=(i-n.weekStartsOn+8)%7||7;switch(e){case"c":return String(o);case"cc":return Re(o,e.length);case"co":return r.ordinalNumber(o,{unit:"day"});case"ccc":return r.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(i,{width:"narrow",context:"standalone"});case"cccccc":return r.day(i,{width:"short",context:"standalone"});case"cccc":default:return r.day(i,{width:"wide",context:"standalone"})}},i:function(t,e,r){let n=t.getDay(),i=n===0?7:n;switch(e){case"i":return String(i);case"ii":return Re(i,e.length);case"io":return r.ordinalNumber(i,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(t,e,r){let i=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(t,e,r){let n=t.getHours(),i;switch(n===12?i=sn.noon:n===0?i=sn.midnight:i=n/12>=1?"pm":"am",e){case"b":case"bb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(t,e,r){let n=t.getHours(),i;switch(n>=17?i=sn.evening:n>=12?i=sn.afternoon:n>=4?i=sn.morning:i=sn.night,e){case"B":case"BB":case"BBB":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(t,e,r){if(e==="ho"){let n=t.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return Xt.h(t,e)},H:function(t,e,r){return e==="Ho"?r.ordinalNumber(t.getHours(),{unit:"hour"}):Xt.H(t,e)},K:function(t,e,r){let n=t.getHours()%12;return e==="Ko"?r.ordinalNumber(n,{unit:"hour"}):Re(n,e.length)},k:function(t,e,r){let n=t.getHours();return n===0&&(n=24),e==="ko"?r.ordinalNumber(n,{unit:"hour"}):Re(n,e.length)},m:function(t,e,r){return e==="mo"?r.ordinalNumber(t.getMinutes(),{unit:"minute"}):Xt.m(t,e)},s:function(t,e,r){return e==="so"?r.ordinalNumber(t.getSeconds(),{unit:"second"}):Xt.s(t,e)},S:function(t,e){return Xt.S(t,e)},X:function(t,e,r){let n=t.getTimezoneOffset();if(n===0)return"Z";switch(e){case"X":return $h(n);case"XXXX":case"XX":return Er(n);case"XXXXX":case"XXX":default:return Er(n,":")}},x:function(t,e,r){let n=t.getTimezoneOffset();switch(e){case"x":return $h(n);case"xxxx":case"xx":return Er(n);case"xxxxx":case"xxx":default:return Er(n,":")}},O:function(t,e,r){let n=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+Gh(n,":");case"OOOO":default:return"GMT"+Er(n,":")}},z:function(t,e,r){let n=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+Gh(n,":");case"zzzz":default:return"GMT"+Er(n,":")}},t:function(t,e,r){let n=Math.trunc(t.getTime()/1e3);return Re(n,e.length)},T:function(t,e,r){let n=t.getTime();return Re(n,e.length)}};function Gh(t,e=""){let r=t>0?"-":"+",n=Math.abs(t),i=Math.trunc(n/60),o=n%60;return o===0?r+String(i):r+String(i)+e+Re(o,2)}function $h(t,e){return t%60===0?(t>0?"-":"+")+Re(Math.abs(t)/60,2):Er(t,e)}function Er(t,e=""){let r=t>0?"-":"+",n=Math.abs(t),i=Re(Math.trunc(n/60),2),o=Re(n%60,2);return r+i+e+o}var Vh=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},Kh=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},bg=(t,e)=>{let r=t.match(/(P+)(p+)?/)||[],n=r[1],i=r[2];if(!i)return Vh(t,e);let o;switch(n){case"P":o=e.dateTime({width:"short"});break;case"PP":o=e.dateTime({width:"medium"});break;case"PPP":o=e.dateTime({width:"long"});break;case"PPPP":default:o=e.dateTime({width:"full"});break}return o.replace("{{date}}",Vh(n,e)).replace("{{time}}",Kh(i,e))},qh={p:Kh,P:bg};var Eg=/^D+$/,xg=/^Y+$/,Dg=["D","DD","YY","YYYY"];function Yh(t){return Eg.test(t)}function Xh(t){return xg.test(t)}function Zh(t,e,r){let n=Tg(t,e,r);if(console.warn(n),Dg.includes(t))throw new RangeError(n)}function Tg(t,e,r){let n=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}function Qh(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function Jh(t){if(!Qh(t)&&typeof t!="number")return!1;let e=Ge(t);return!isNaN(Number(e))}var Cg=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Sg=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Ag=/^'([^]*?)'?$/,Ig=/''/g,kg=/[a-zA-Z]/;function Tx(t,e,r){let n=pr(),i=r?.locale??n.locale??fa,o=r?.firstWeekContainsDate??r?.locale?.options?.firstWeekContainsDate??n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,s=r?.weekStartsOn??r?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,a=Ge(t);if(!Jh(a))throw new RangeError("Invalid time value");let l=e.match(Sg).map(_=>{let b=_[0];if(b==="p"||b==="P"){let T=qh[b];return T(_,i.formatLong)}return _}).join("").match(Cg).map(_=>{if(_==="''")return{isToken:!1,value:"'"};let b=_[0];if(b==="'")return{isToken:!1,value:Og(_)};if(ya[b])return{isToken:!0,value:_};if(b.match(kg))throw new RangeError("Format string contains an unescaped latin alphabet character `"+b+"`");return{isToken:!1,value:_}});i.localize.preprocessor&&(l=i.localize.preprocessor(a,l));let g={firstWeekContainsDate:o,weekStartsOn:s,locale:i};return l.map(_=>{if(!_.isToken)return _.value;let b=_.value;(!r?.useAdditionalWeekYearTokens&&Xh(b)||!r?.useAdditionalDayOfYearTokens&&Yh(b))&&Zh(b,e,String(t));let T=ya[b[0]];return T(a,b,i.localize,g)}).join("")}function Og(t){let e=t.match(Ag);return e?e[1].replace(Ig,"'"):t}function Ax(t,e){let r=e?.additionalDigits??2,n=Fg(t),i;if(n.date){let l=Pg(n.date,r);i=Mg(l.restDateString,l.year)}if(!i||isNaN(i.getTime()))return new Date(NaN);let o=i.getTime(),s=0,a;if(n.time&&(s=Bg(n.time),isNaN(s)))return new Date(NaN);if(n.timezone){if(a=Ug(n.timezone),isNaN(a))return new Date(NaN)}else{let l=new Date(o+s),g=new Date(0);return g.setFullYear(l.getUTCFullYear(),l.getUTCMonth(),l.getUTCDate()),g.setHours(l.getUTCHours(),l.getUTCMinutes(),l.getUTCSeconds(),l.getUTCMilliseconds()),g}return new Date(o+s+a)}var Yi={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},Rg=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,Ng=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,Lg=/^([+-])(\d{2})(?::?(\d{2}))?$/;function Fg(t){let e={},r=t.split(Yi.dateTimeDelimiter),n;if(r.length>2)return e;if(/:/.test(r[0])?n=r[0]:(e.date=r[0],n=r[1],Yi.timeZoneDelimiter.test(e.date)&&(e.date=t.split(Yi.timeZoneDelimiter)[0],n=t.substr(e.date.length,t.length))),n){let i=Yi.timezone.exec(n);i?(e.time=n.replace(i[1],""),e.timezone=i[1]):e.time=n}return e}function Pg(t,e){let r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+e)+"})|(\\d{2}|[+-]\\d{"+(2+e)+"})$)"),n=t.match(r);if(!n)return{year:NaN,restDateString:""};let i=n[1]?parseInt(n[1]):null,o=n[2]?parseInt(n[2]):null;return{year:o===null?i:o*100,restDateString:t.slice((n[1]||n[2]).length)}}function Mg(t,e){if(e===null)return new Date(NaN);let r=t.match(Rg);if(!r)return new Date(NaN);let n=!!r[4],i=Gn(r[1]),o=Gn(r[2])-1,s=Gn(r[3]),a=Gn(r[4]),l=Gn(r[5])-1;if(n)return Gg(e,a,l)?jg(e,a,l):new Date(NaN);{let g=new Date(0);return!Wg(e,o,s)||!zg(e,i)?new Date(NaN):(g.setUTCFullYear(e,o,Math.max(i,s)),g)}}function Gn(t){return t?parseInt(t):1}function Bg(t){let e=t.match(Ng);if(!e)return NaN;let r=_a(e[1]),n=_a(e[2]),i=_a(e[3]);return $g(r,n,i)?r*pa+n*ma+i*1e3:NaN}function _a(t){return t&&parseFloat(t.replace(",","."))||0}function Ug(t){if(t==="Z")return 0;let e=t.match(Lg);if(!e)return 0;let r=e[1]==="+"?-1:1,n=parseInt(e[2]),i=e[3]&&parseInt(e[3])||0;return Vg(n,i)?r*(n*pa+i*ma):NaN}function jg(t,e,r){let n=new Date(0);n.setUTCFullYear(t,0,4);let i=n.getUTCDay()||7,o=(e-1)*7+r+1-i;return n.setUTCDate(n.getUTCDate()+o),n}var Hg=[31,null,31,30,31,30,31,31,30,31,30,31];function ef(t){return t%400===0||t%4===0&&t%100!==0}function Wg(t,e,r){return e>=0&&e<=11&&r>=1&&r<=(Hg[e]||(ef(t)?29:28))}function zg(t,e){return e>=1&&e<=(ef(t)?366:365)}function Gg(t,e,r){return e>=1&&e<=53&&r>=0&&r<=6}function $g(t,e,r){return t===24?e===0&&r===0:r>=0&&r<60&&e>=0&&e<60&&t>=0&&t<25}function Vg(t,e){return e>=0&&e<=59}var Xi=(()=>{let e=class e{constructor(n,i){this.http=n,this.loginService=i,this.basicURL=ft.apiURL+"/api/",this.documentSubject=new At([]),this.documentTypes$=this.documentSubject.asObservable();debugger;this.loginService.isAdmin()&&this.fetchDocumentTypes().subscribe();debugger}fetchDocumentTypes(){return this.http.get(`${this.basicURL}DocumentTypes`).pipe(Je(n=>this.documentSubject.next(n)),Ve(n=>{throw n}))}deleteDocumentType(n){let i=`${this.basicURL}DocumentTypes/${n}`;return this.http.delete(i).pipe(Je(()=>{let o=this.documentSubject.getValue().filter(s=>s.id!==n);this.documentSubject.next(o)}),Ve(o=>{throw o}))}addDocumentType(n){return this.http.post(`${this.basicURL}DocumentTypes`,n)}editDocumentType(n,i){return this.http.put(`${this.basicURL}DocumentTypes/${i}`,n).pipe(Je(()=>{let o=this.documentSubject.getValue(),s=o.findIndex(a=>a.id===i);s!==-1&&(o[s]=n,this.documentSubject.next([...o]))}),Ve(o=>{throw console.error("Error updating document type:",o),o}))}getDocTypeById(n){return this.http.get(`${this.basicURL}DocumentTypes/${n}`)}getDocsByTransactionType(n){return this.http.get(`${this.basicURL}DocumentTypes/TypesDocument/${n}`)}};e.\u0275fac=function(i){return new(i||e)(Ie(dt),Ie(Ke))},e.\u0275prov=Xe({token:e,factory:e.\u0275fac});let t=e;return t})();function Kg(t,e){if(t&1&&(W(0,"mat-option",15),Q(1),H()),t&2){let r=e.$implicit;we("value",r),le(),je(" ",r," ")}}function qg(t,e){t&1&&(W(0,"mat-error"),Q(1," \u05E9\u05D3\u05D4 \u05D6\u05D4 \u05D4\u05D9\u05E0\u05D5 \u05D7\u05D5\u05D1\u05D4 "),H())}function Yg(t,e){t&1&&(W(0,"mat-error"),Q(1," \u05E9\u05D3\u05D4 \u05D6\u05D4 \u05D4\u05D9\u05E0\u05D5 \u05D7\u05D5\u05D1\u05D4 "),H())}var Ux=(()=>{let e=class e{constructor(n,i,o,s,a){this.route=n,this.router=i,this.fb=o,this.documentTypeService=s,this.snackBar=a,this.docTypeId=null,this.transactionTypes=Object.values(Bt).filter(l=>isNaN(Number(l))),this.documentTypeForm=this.fb.group({required:[!0],transaction_Type:["",rt.required],document_Name:["",[rt.required]]})}ngOnInit(){this.route.paramMap.subscribe(n=>{this.docTypeId=Number(n.get("id")),isNaN(this.docTypeId)==!1&&this.setFormValues(this.docTypeId)})}setFormValues(n){this.docTypeId!=-1&&this.documentTypeService.getDocTypeById(n).subscribe(i=>{i!=null&&(this.docType=i,this.docType.transaction_Type=Bt[this.docType.transaction_Type],this.documentTypeForm.patchValue(this.docType))})}onSubmit(){if(this.documentTypeForm.valid){let n=this.documentTypeForm.value,i={document_Name:n.document_Name,required:n.required,transaction_Type:Bt[n.transaction_Type]};this.docTypeId!=-1?this.documentTypeService.editDocumentType(i,this.docTypeId).subscribe(()=>{this.snackBar.open("\u05E1\u05D5\u05D2 \u05D4\u05DE\u05E1\u05DE\u05DA \u05E2\u05D5\u05D3\u05DB\u05DF \u05D1\u05D4\u05E6\u05DC\u05D7\u05D4!!","Close",{}),this.clearFormFields()}):this.documentTypeService.addDocumentType(i).subscribe(()=>{this.snackBar.open("\u05E1\u05D5\u05D2 \u05D4\u05DE\u05E1\u05DE\u05DA \u05E0\u05D5\u05E1\u05E3 \u05D1\u05D4\u05E6\u05DC\u05D7\u05D4!!","Close",{}),this.clearFormFields()}),this.router.navigate(["admin/document-type-list"])}}cancel(){this.router.navigate(["admin/document-type-list"])}clearFormFields(){let n=this.documentTypeForm.get("transaction_Type")?.value;console.log(n),this.documentTypeForm.reset({transaction_Type:n})}};e.\u0275fac=function(i){return new(i||e)(_e(Or),_e(ct),_e(Fr),_e(Xi),_e(Bi))},e.\u0275cmp=Be({type:e,selectors:[["document-type-details"]],decls:25,vars:5,consts:[["id","content"],[1,"document-type-edit-card"],[1,"card-content"],[3,"ngSubmit","formGroup"],[1,"div-warp-fields"],["appearance","fill",1,"type-field"],["formControlName","transaction_Type","required",""],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["appearance","fill",1,"name-field"],["matInput","","formControlName","document_Name","placeholder",""],["formControlName","required"],[1,"button-group"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["mat-raised-button","","color","warn","type","button",3,"click"],[3,"value"]],template:function(i,o){if(i&1&&(W(0,"div",0)(1,"mat-card",1)(2,"mat-card-title"),Q(3,"\u05E0\u05D9\u05D4\u05D5\u05DC \u05E1\u05D5\u05D2 \u05DE\u05E1\u05DE\u05DA"),H(),W(4,"mat-card-content",2)(5,"form",3),xe("ngSubmit",function(){return o.onSubmit()}),W(6,"div",4)(7,"mat-form-field",5)(8,"mat-label"),Q(9,"\u05E1\u05D5\u05D2 \u05D4\u05E2\u05E1\u05E7\u05D4"),H(),W(10,"mat-select",6),be(11,Kg,2,2,"mat-option",7),H(),be(12,qg,2,0,"mat-error",8),H(),W(13,"mat-form-field",9)(14,"mat-label"),Q(15,"\u05E9\u05DD \u05D4\u05DE\u05E1\u05DE\u05DA"),H(),Ce(16,"input",10),be(17,Yg,2,0,"mat-error",8),H(),W(18,"mat-checkbox",11),Q(19,"\u05E0\u05D3\u05E8\u05E9"),H()(),W(20,"div",12)(21,"button",13),Q(22,"\u05E9\u05DE\u05D5\u05E8"),H(),W(23,"button",14),xe("click",function(){return o.cancel()}),Q(24,"\u05D1\u05D9\u05D8\u05D5\u05DC"),H()()()()()()),i&2){let s,a;le(5),we("formGroup",o.documentTypeForm),le(6),we("ngForOf",o.transactionTypes),le(),we("ngIf",(s=o.documentTypeForm.get("transaction_Type"))==null?null:s.hasError("required")),le(5),we("ngIf",(a=o.documentTypeForm.get("document_Name"))==null?null:a.hasError("required")),le(4),we("disabled",o.documentTypeForm.invalid)}},dependencies:[ur,bt,dr,Nt,Lt,lr,Lr,Ft,Mt,Pt,Dt,xt,Kr,Tt,ht,Mi,Yr,cr,Rr,Nr],styles:[".document-type-edit-card[_ngcontent-%COMP%]{max-width:800px;margin:auto;padding:20px;box-shadow:0 0 20px #000000b3;height:40vh}.div-warp-fields[_ngcontent-%COMP%]{display:flex;justify-content:space-evenly;align-items:center}.button-group[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-top:20px}mat-checkbox[_ngcontent-%COMP%]{margin-right:8%}#content[_ngcontent-%COMP%]{background-color:#ffffff9a;padding:8%;border-radius:40px;height:55vh}.card-content[_ngcontent-%COMP%]{margin-top:3%}@media screen and (max-width: 431px){.div-warp-fields[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-wrap:wrap}}"]});let t=e;return t})();var Xg=()=>[10,20,30];function Zg(t,e){t&1&&(W(0,"th",18),Q(1,"\u05E9\u05DD \u05DE\u05E1\u05DE\u05DA"),H())}function Qg(t,e){if(t&1&&(W(0,"td",19),Q(1),H()),t&2){let r=e.$implicit;le(),Ze(r.document_Name)}}function Jg(t,e){t&1&&(W(0,"th",18),Q(1,"\u05E0\u05D3\u05E8\u05E9"),H())}function ew(t,e){if(t&1&&(W(0,"td",19),Q(1),H()),t&2){let r=e.$implicit,n=ye();le(),je(" ",n.changeRequired(r.required),"")}}function tw(t,e){t&1&&(W(0,"th",18),Q(1,"\u05E1\u05D5\u05D2 \u05DE\u05E1\u05DE\u05DA"),H())}function rw(t,e){if(t&1&&(W(0,"td",19),Q(1),H()),t&2){let r=e.$implicit,n=ye();le(),Ze(n.changeDocStatusToString(r.transaction_Type))}}function nw(t,e){t&1&&(W(0,"th",20),Q(1,"\u05E4\u05E2\u05D5\u05DC\u05D5\u05EA"),H())}function iw(t,e){if(t&1){let r=ze();W(0,"td",19)(1,"button",21),xe("click",function(){let i=Le(r).$implicit,o=ye();return Fe(o.editDocument(i))}),W(2,"mat-icon"),Q(3,"edit"),H()(),W(4,"button",22),xe("click",function(){let i=Le(r).$implicit,o=ye();return Fe(o.deleteDocument(i))}),W(5,"mat-icon"),Q(6,"delete"),H()()()}}function ow(t,e){t&1&&Ce(0,"tr",23)}function aw(t,e){t&1&&Ce(0,"tr",24)}var Yx=(()=>{let e=class e{constructor(n,i,o){this._documentTypeservice=n,this.router=i,this.dialog=o,this.doctransactionTypeString=Bt[0],this.displayedColumns=["name","required","TransactionType","actions"],this.dataSource=new Fi}ngOnInit(){this.loadDocumentType()}loadDocumentType(){this.documentSubscription=this._documentTypeservice.documentTypes$.subscribe({next:n=>{this.dataSource.data=n,this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator},error:n=>{console.error("Error loading customers:",n)}})}ngOnDestroy(){this.documentSubscription&&this.documentSubscription.unsubscribe()}ngAfterViewInit(){this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator}applyFilter(n){let i=n.target.value;this.dataSource.filter=i.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}addCustomer(){this.router.navigate(["admin/documentType-details",-1])}editDocument(n){this.router.navigate(["admin/documentType-details",n.id])}deleteDocument(n){this.dialog.open(Hn,{data:{documentType:n}}).afterClosed().subscribe(o=>{o&&this._documentTypeservice.deleteDocumentType(n.id).subscribe({next:()=>{console.log("Customer deleted successfully")},error:s=>{console.error("Error deleting customer:",s)}})})}changeDocStatusToString(n){return this.doctransactionTypeString=Bt[n],this.doctransactionTypeString}changeRequired(n){return n==!1?"\u05DC\u05D0":"\u05DB\u05DF"}};e.\u0275fac=function(i){return new(i||e)(_e(Xi),_e(ct),_e(Hi))},e.\u0275cmp=Be({type:e,selectors:[["document-type-list"]],viewQuery:function(i,o){if(i&1&&(yt(Qr,5),yt(Zr,5)),i&2){let s;_t(s=vt())&&(o.sort=s.first),_t(s=vt())&&(o.paginator=s.first)}},decls:28,vars:5,consts:[[1,"mainAll"],[1,"component-title"],["id","content"],["dir","rtl"],["matInput","","placeholder","\u05D7\u05E4\u05E9...",3,"keyup"],["mat-table","","matSort","","dir","rtl",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","required"],["matColumnDef","TransactionType"],["matColumnDef","actions"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","","dir","rtl",3,"pageSizeOptions"],["mat-fab","","color","primary",1,"add-button",2,"position","fixed","bottom","8vh","left","2vw","z-index","1000",3,"click"],[1,"add-icon"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell",""],["mat-icon-button","","color","primary",3,"click"],["mat-icon-button","","color","warn",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(i,o){i&1&&(W(0,"div",0)(1,"h2",1),Q(2,"\u05E8\u05E9\u05D9\u05DE\u05EA \u05E1\u05D5\u05D2\u05D9 \u05D4\u05DE\u05E1\u05DE\u05DB\u05D9\u05DD"),H(),W(3,"div",2)(4,"mat-form-field",3)(5,"mat-label"),Q(6,"\u05D7\u05E4\u05E9"),H(),W(7,"input",4),xe("keyup",function(a){return o.applyFilter(a)}),H()(),W(8,"table",5),He(9,6),be(10,Zg,2,0,"th",7)(11,Qg,2,1,"td",8),We(),He(12,9),be(13,Jg,2,0,"th",7)(14,ew,2,1,"td",8),We(),He(15,10),be(16,tw,2,0,"th",7)(17,rw,2,1,"td",8),We(),He(18,11),be(19,nw,2,0,"th",12)(20,iw,7,0,"td",8),We(),be(21,ow,1,0,"tr",13)(22,aw,1,0,"tr",14),H(),Ce(23,"br")(24,"mat-paginator",15),W(25,"button",16),xe("click",function(){return o.addCustomer()}),W(26,"mat-icon",17),Q(27,"add"),H()()()()),i&2&&(le(8),we("dataSource",o.dataSource),le(13),we("matHeaderRowDef",o.displayedColumns),le(),we("matRowDefColumns",o.displayedColumns),le(2),we("pageSizeOptions",Rd(4,Xg)))},dependencies:[Et,Mr,Ur,zr,jr,Br,Gr,Hr,Wr,$r,Vr,hr,Dt,xt,Zr,Qr,sh,Tt,Pr,Li],styles:["#content[_ngcontent-%COMP%]{background-color:#ffffff9a;padding:25px;border-radius:10px;border:5px solid rgba(128,128,128,.13);min-width:max-content;min-height:60vh;max-width:60vw;margin:0 auto}[_nghost-%COMP%]{background-color:transparent}.component-title[_ngcontent-%COMP%]{font-size:1.5em;font-weight:700;margin-bottom:20px;text-align:right;color:#333}"]});let t=e;return t})();var ip=lp(Ch());var sw=Object.defineProperty,uw=Object.defineProperties,cw=Object.getOwnPropertyDescriptors,rf=Object.getOwnPropertySymbols,lw=Object.prototype.hasOwnProperty,dw=Object.prototype.propertyIsEnumerable,us=(t,e,r)=>e in t?sw(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Oe=(t,e)=>{for(var r in e||(e={}))lw.call(e,r)&&us(t,r,e[r]);if(rf)for(var r of rf(e))dw.call(e,r)&&us(t,r,e[r]);return t},wn=(t,e)=>uw(t,cw(e)),X=(t,e,r)=>(us(t,typeof e!="symbol"?e+"":e,r),r),Zi=(t,e,r)=>new Promise((n,i)=>{var o=l=>{try{a(r.next(l))}catch(g){i(g)}},s=l=>{try{a(r.throw(l))}catch(g){i(g)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(o,s);a((r=r.apply(t,e)).next())}),yn=class{constructor(e){X(this,"rootKey"),this.rootKey=e}},hw=Object.seal({}),Y=class extends yn{constructor(e){super(e),X(this,"root"),this.root=new Array}prepForXml(e){var r;e.stack.push(this);let n=this.root.map(i=>i instanceof yn?i.prepForXml(e):i).filter(i=>i!==void 0);return e.stack.pop(),{[this.rootKey]:n.length?n.length===1&&((r=n[0])!=null&&r._attr)?n[0]:n:hw}}addChildElement(e){return this.root.push(e),this}},kt=class extends Y{prepForXml(e){let r=super.prepForXml(e);if(r&&(typeof r[this.rootKey]!="object"||Object.keys(r[this.rootKey]).length))return r}},me=class extends yn{constructor(e){super("_attr"),X(this,"xmlKeys"),this.root=e}prepForXml(e){let r={};return Object.keys(this.root).forEach(n=>{let i=this.root[n];if(i!==void 0){let o=this.xmlKeys&&this.xmlKeys[n]||n;r[o]=i}}),{_attr:r}}},Ot=class extends yn{constructor(e){super("_attr"),this.root=e}prepForXml(e){return{_attr:Object.values(this.root).filter(({value:n})=>n!==void 0).reduce((n,{key:i,value:o})=>wn(Oe({},n),{[i]:o}),{})}}},Ue=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{val:"w:val",color:"w:color",fill:"w:fill",space:"w:space",sz:"w:sz",type:"w:type",rsidR:"w:rsidR",rsidRPr:"w:rsidRPr",rsidSect:"w:rsidSect",w:"w:w",h:"w:h",top:"w:top",right:"w:right",bottom:"w:bottom",left:"w:left",header:"w:header",footer:"w:footer",gutter:"w:gutter",linePitch:"w:linePitch",pos:"w:pos"})}},zt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function sm(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var um={},rd={exports:{}},fn=typeof Reflect=="object"?Reflect:null,nf=fn&&typeof fn.apply=="function"?fn.apply:function(e,r,n){return Function.prototype.apply.call(e,r,n)},oo;fn&&typeof fn.ownKeys=="function"?oo=fn.ownKeys:Object.getOwnPropertySymbols?oo=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:oo=function(e){return Object.getOwnPropertyNames(e)};function fw(t){console&&console.warn&&console.warn(t)}var cm=Number.isNaN||function(e){return e!==e};function Pe(){Pe.init.call(this)}rd.exports=Pe;rd.exports.once=ww;Pe.EventEmitter=Pe;Pe.prototype._events=void 0;Pe.prototype._eventsCount=0;Pe.prototype._maxListeners=void 0;var of=10;function Bo(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(Pe,"defaultMaxListeners",{enumerable:!0,get:function(){return of},set:function(t){if(typeof t!="number"||t<0||cm(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");of=t}});Pe.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Pe.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||cm(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function lm(t){return t._maxListeners===void 0?Pe.defaultMaxListeners:t._maxListeners}Pe.prototype.getMaxListeners=function(){return lm(this)};Pe.prototype.emit=function(e){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var i=e==="error",o=this._events;if(o!==void 0)i=i&&o.error===void 0;else if(!i)return!1;if(i){var s;if(r.length>0&&(s=r[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var l=o[e];if(l===void 0)return!1;if(typeof l=="function")nf(l,this,r);else for(var g=l.length,_=pm(l,g),n=0;n<g;++n)nf(_[n],this,r);return!0};function dm(t,e,r,n){var i,o,s;if(Bo(r),o=t._events,o===void 0?(o=t._events=Object.create(null),t._eventsCount=0):(o.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),o=t._events),s=o[e]),s===void 0)s=o[e]=r,++t._eventsCount;else if(typeof s=="function"?s=o[e]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),i=lm(t),i>0&&s.length>i&&!s.warned){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=s.length,fw(a)}return t}Pe.prototype.addListener=function(e,r){return dm(this,e,r,!1)};Pe.prototype.on=Pe.prototype.addListener;Pe.prototype.prependListener=function(e,r){return dm(this,e,r,!0)};function mw(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function hm(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=mw.bind(n);return i.listener=r,n.wrapFn=i,i}Pe.prototype.once=function(e,r){return Bo(r),this.on(e,hm(this,e,r)),this};Pe.prototype.prependOnceListener=function(e,r){return Bo(r),this.prependListener(e,hm(this,e,r)),this};Pe.prototype.removeListener=function(e,r){var n,i,o,s,a;if(Bo(r),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||r));else if(typeof n!="function"){for(o=-1,s=n.length-1;s>=0;s--)if(n[s]===r||n[s].listener===r){a=n[s].listener,o=s;break}if(o<0)return this;o===0?n.shift():pw(n,o),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||r)}return this};Pe.prototype.off=Pe.prototype.removeListener;Pe.prototype.removeAllListeners=function(e){var r,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var o=Object.keys(n),s;for(i=0;i<o.length;++i)s=o[i],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(i=r.length-1;i>=0;i--)this.removeListener(e,r[i]);return this};function fm(t,e,r){var n=t._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?r?[i.listener||i]:[i]:r?gw(i):pm(i,i.length)}Pe.prototype.listeners=function(e){return fm(this,e,!0)};Pe.prototype.rawListeners=function(e){return fm(this,e,!1)};Pe.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):mm.call(t,e)};Pe.prototype.listenerCount=mm;function mm(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Pe.prototype.eventNames=function(){return this._eventsCount>0?oo(this._events):[]};function pm(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function pw(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function gw(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function ww(t,e){return new Promise(function(r,n){function i(s){t.removeListener(e,o),n(s)}function o(){typeof t.removeListener=="function"&&t.removeListener("error",i),r([].slice.call(arguments))}gm(t,e,o,{once:!0}),e!=="error"&&yw(t,i,{once:!0})})}function yw(t,e,r){typeof t.on=="function"&&gm(t,"error",e,r)}function gm(t,e,r,n){if(typeof t.on=="function")n.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(o){n.once&&t.removeEventListener(e,i),r(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var nd=rd.exports,cs={exports:{}};typeof Object.create=="function"?cs.exports=function(e,r){r&&(e.super_=r,e.prototype=Object.create(r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:cs.exports=function(e,r){if(r){e.super_=r;var n=function(){};n.prototype=r.prototype,e.prototype=new n,e.prototype.constructor=e}};var Ar=cs.exports;function _w(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var wm={exports:{}},Ye=wm.exports={},jt,Ht;function ls(){throw new Error("setTimeout has not been defined")}function ds(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?jt=setTimeout:jt=ls}catch{jt=ls}try{typeof clearTimeout=="function"?Ht=clearTimeout:Ht=ds}catch{Ht=ds}})();function ym(t){if(jt===setTimeout)return setTimeout(t,0);if((jt===ls||!jt)&&setTimeout)return jt=setTimeout,setTimeout(t,0);try{return jt(t,0)}catch{try{return jt.call(null,t,0)}catch{return jt.call(this,t,0)}}}function vw(t){if(Ht===clearTimeout)return clearTimeout(t);if((Ht===ds||!Ht)&&clearTimeout)return Ht=clearTimeout,clearTimeout(t);try{return Ht(t)}catch{try{return Ht.call(null,t)}catch{return Ht.call(this,t)}}}var Jt=[],mn=!1,Dr,ao=-1;function bw(){!mn||!Dr||(mn=!1,Dr.length?Jt=Dr.concat(Jt):ao=-1,Jt.length&&_m())}function _m(){if(!mn){var t=ym(bw);mn=!0;for(var e=Jt.length;e;){for(Dr=Jt,Jt=[];++ao<e;)Dr&&Dr[ao].run();ao=-1,e=Jt.length}Dr=null,mn=!1,vw(t)}}Ye.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];Jt.push(new vm(t,e)),Jt.length===1&&!mn&&ym(_m)};function vm(t,e){this.fun=t,this.array=e}vm.prototype.run=function(){this.fun.apply(null,this.array)};Ye.title="browser";Ye.browser=!0;Ye.env={};Ye.argv=[];Ye.version="";Ye.versions={};function ir(){}Ye.on=ir;Ye.addListener=ir;Ye.once=ir;Ye.off=ir;Ye.removeListener=ir;Ye.removeAllListeners=ir;Ye.emit=ir;Ye.prependListener=ir;Ye.prependOnceListener=ir;Ye.listeners=function(t){return[]};Ye.binding=function(t){throw new Error("process.binding is not supported")};Ye.cwd=function(){return"/"};Ye.chdir=function(t){throw new Error("process.chdir is not supported")};Ye.umask=function(){return 0};var Ew=wm.exports,Ae=_w(Ew),va,af;function bm(){return af||(af=1,va=nd.EventEmitter),va}var ba={},$n={},sf;function xw(){if(sf)return $n;sf=1,$n.byteLength=a,$n.toByteArray=g,$n.fromByteArray=T;for(var t=[],e=[],r=typeof Uint8Array<"u"?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,o=n.length;i<o;++i)t[i]=n[i],e[n.charCodeAt(i)]=i;e[45]=62,e[95]=63;function s(w){var x=w.length;if(x%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var v=w.indexOf("=");v===-1&&(v=x);var C=v===x?0:4-v%4;return[v,C]}function a(w){var x=s(w),v=x[0],C=x[1];return(v+C)*3/4-C}function l(w,x,v){return(x+v)*3/4-v}function g(w){var x,v=s(w),C=v[0],m=v[1],D=new r(l(w,C,m)),S=0,N=m>0?C-4:C,M;for(M=0;M<N;M+=4)x=e[w.charCodeAt(M)]<<18|e[w.charCodeAt(M+1)]<<12|e[w.charCodeAt(M+2)]<<6|e[w.charCodeAt(M+3)],D[S++]=x>>16&255,D[S++]=x>>8&255,D[S++]=x&255;return m===2&&(x=e[w.charCodeAt(M)]<<2|e[w.charCodeAt(M+1)]>>4,D[S++]=x&255),m===1&&(x=e[w.charCodeAt(M)]<<10|e[w.charCodeAt(M+1)]<<4|e[w.charCodeAt(M+2)]>>2,D[S++]=x>>8&255,D[S++]=x&255),D}function _(w){return t[w>>18&63]+t[w>>12&63]+t[w>>6&63]+t[w&63]}function b(w,x,v){for(var C,m=[],D=x;D<v;D+=3)C=(w[D]<<16&16711680)+(w[D+1]<<8&65280)+(w[D+2]&255),m.push(_(C));return m.join("")}function T(w){for(var x,v=w.length,C=v%3,m=[],D=16383,S=0,N=v-C;S<N;S+=D)m.push(b(w,S,S+D>N?N:S+D));return C===1?(x=w[v-1],m.push(t[x>>2]+t[x<<4&63]+"==")):C===2&&(x=(w[v-2]<<8)+w[v-1],m.push(t[x>>10]+t[x>>4&63]+t[x<<2&63]+"=")),m.join("")}return $n}var Qi={};var uf;function Dw(){return uf||(uf=1,Qi.read=function(t,e,r,n,i){var o,s,a=i*8-n-1,l=(1<<a)-1,g=l>>1,_=-7,b=r?i-1:0,T=r?-1:1,w=t[e+b];for(b+=T,o=w&(1<<-_)-1,w>>=-_,_+=a;_>0;o=o*256+t[e+b],b+=T,_-=8);for(s=o&(1<<-_)-1,o>>=-_,_+=n;_>0;s=s*256+t[e+b],b+=T,_-=8);if(o===0)o=1-g;else{if(o===l)return s?NaN:(w?-1:1)*(1/0);s=s+Math.pow(2,n),o=o-g}return(w?-1:1)*s*Math.pow(2,o-n)},Qi.write=function(t,e,r,n,i,o){var s,a,l,g=o*8-i-1,_=(1<<g)-1,b=_>>1,T=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,w=n?0:o-1,x=n?1:-1,v=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=_):(s=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-s))<1&&(s--,l*=2),s+b>=1?e+=T/l:e+=T*Math.pow(2,1-b),e*l>=2&&(s++,l/=2),s+b>=_?(a=0,s=_):s+b>=1?(a=(e*l-1)*Math.pow(2,i),s=s+b):(a=e*Math.pow(2,b-1)*Math.pow(2,i),s=0));i>=8;t[r+w]=a&255,w+=x,a/=256,i-=8);for(s=s<<i|a,g+=i;g>0;t[r+w]=s&255,w+=x,s/=256,g-=8);t[r+w-x]|=v*128}),Qi}var cf;function Uo(){return cf||(cf=1,function(t){var e=xw(),r=Dw(),n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=a,t.SlowBuffer=D,t.INSPECT_MAX_BYTES=50;var i=2147483647;t.kMaxLength=i,a.TYPED_ARRAY_SUPPORT=o(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function o(){try{var y=new Uint8Array(1),u={foo:function(){return 42}};return Object.setPrototypeOf(u,Uint8Array.prototype),Object.setPrototypeOf(y,u),y.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function s(y){if(y>i)throw new RangeError('The value "'+y+'" is invalid for option "size"');var u=new Uint8Array(y);return Object.setPrototypeOf(u,a.prototype),u}function a(y,u,c){if(typeof y=="number"){if(typeof u=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return b(y)}return l(y,u,c)}a.poolSize=8192;function l(y,u,c){if(typeof y=="string")return T(y,u);if(ArrayBuffer.isView(y))return x(y);if(y==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof y);if(re(y,ArrayBuffer)||y&&re(y.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(re(y,SharedArrayBuffer)||y&&re(y.buffer,SharedArrayBuffer)))return v(y,u,c);if(typeof y=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var d=y.valueOf&&y.valueOf();if(d!=null&&d!==y)return a.from(d,u,c);var R=C(y);if(R)return R;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof y[Symbol.toPrimitive]=="function")return a.from(y[Symbol.toPrimitive]("string"),u,c);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof y)}a.from=function(y,u,c){return l(y,u,c)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function g(y){if(typeof y!="number")throw new TypeError('"size" argument must be of type number');if(y<0)throw new RangeError('The value "'+y+'" is invalid for option "size"')}function _(y,u,c){return g(y),y<=0?s(y):u!==void 0?typeof c=="string"?s(y).fill(u,c):s(y).fill(u):s(y)}a.alloc=function(y,u,c){return _(y,u,c)};function b(y){return g(y),s(y<0?0:m(y)|0)}a.allocUnsafe=function(y){return b(y)},a.allocUnsafeSlow=function(y){return b(y)};function T(y,u){if((typeof u!="string"||u==="")&&(u="utf8"),!a.isEncoding(u))throw new TypeError("Unknown encoding: "+u);var c=S(y,u)|0,d=s(c),R=d.write(y,u);return R!==c&&(d=d.slice(0,R)),d}function w(y){for(var u=y.length<0?0:m(y.length)|0,c=s(u),d=0;d<u;d+=1)c[d]=y[d]&255;return c}function x(y){if(re(y,Uint8Array)){var u=new Uint8Array(y);return v(u.buffer,u.byteOffset,u.byteLength)}return w(y)}function v(y,u,c){if(u<0||y.byteLength<u)throw new RangeError('"offset" is outside of buffer bounds');if(y.byteLength<u+(c||0))throw new RangeError('"length" is outside of buffer bounds');var d;return u===void 0&&c===void 0?d=new Uint8Array(y):c===void 0?d=new Uint8Array(y,u):d=new Uint8Array(y,u,c),Object.setPrototypeOf(d,a.prototype),d}function C(y){if(a.isBuffer(y)){var u=m(y.length)|0,c=s(u);return c.length===0||y.copy(c,0,0,u),c}if(y.length!==void 0)return typeof y.length!="number"||h(y.length)?s(0):w(y);if(y.type==="Buffer"&&Array.isArray(y.data))return w(y.data)}function m(y){if(y>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return y|0}function D(y){return+y!=y&&(y=0),a.alloc(+y)}a.isBuffer=function(u){return u!=null&&u._isBuffer===!0&&u!==a.prototype},a.compare=function(u,c){if(re(u,Uint8Array)&&(u=a.from(u,u.offset,u.byteLength)),re(c,Uint8Array)&&(c=a.from(c,c.offset,c.byteLength)),!a.isBuffer(u)||!a.isBuffer(c))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(u===c)return 0;for(var d=u.length,R=c.length,U=0,P=Math.min(d,R);U<P;++U)if(u[U]!==c[U]){d=u[U],R=c[U];break}return d<R?-1:R<d?1:0},a.isEncoding=function(u){switch(String(u).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(u,c){if(!Array.isArray(u))throw new TypeError('"list" argument must be an Array of Buffers');if(u.length===0)return a.alloc(0);var d;if(c===void 0)for(c=0,d=0;d<u.length;++d)c+=u[d].length;var R=a.allocUnsafe(c),U=0;for(d=0;d<u.length;++d){var P=u[d];if(re(P,Uint8Array))U+P.length>R.length?a.from(P).copy(R,U):Uint8Array.prototype.set.call(R,P,U);else if(a.isBuffer(P))P.copy(R,U);else throw new TypeError('"list" argument must be an Array of Buffers');U+=P.length}return R};function S(y,u){if(a.isBuffer(y))return y.length;if(ArrayBuffer.isView(y)||re(y,ArrayBuffer))return y.byteLength;if(typeof y!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof y);var c=y.length,d=arguments.length>2&&arguments[2]===!0;if(!d&&c===0)return 0;for(var R=!1;;)switch(u){case"ascii":case"latin1":case"binary":return c;case"utf8":case"utf-8":return f(y).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return c*2;case"hex":return c>>>1;case"base64":return I(y).length;default:if(R)return d?-1:f(y).length;u=(""+u).toLowerCase(),R=!0}}a.byteLength=S;function N(y,u,c){var d=!1;if((u===void 0||u<0)&&(u=0),u>this.length||((c===void 0||c>this.length)&&(c=this.length),c<=0)||(c>>>=0,u>>>=0,c<=u))return"";for(y||(y="utf8");;)switch(y){case"hex":return oe(this,u,c);case"utf8":case"utf-8":return E(this,u,c);case"ascii":return J(this,u,c);case"latin1":case"binary":return ve(this,u,c);case"base64":return K(this,u,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ge(this,u,c);default:if(d)throw new TypeError("Unknown encoding: "+y);y=(y+"").toLowerCase(),d=!0}}a.prototype._isBuffer=!0;function M(y,u,c){var d=y[u];y[u]=y[c],y[c]=d}a.prototype.swap16=function(){var u=this.length;if(u%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var c=0;c<u;c+=2)M(this,c,c+1);return this},a.prototype.swap32=function(){var u=this.length;if(u%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var c=0;c<u;c+=4)M(this,c,c+3),M(this,c+1,c+2);return this},a.prototype.swap64=function(){var u=this.length;if(u%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var c=0;c<u;c+=8)M(this,c,c+7),M(this,c+1,c+6),M(this,c+2,c+5),M(this,c+3,c+4);return this},a.prototype.toString=function(){var u=this.length;return u===0?"":arguments.length===0?E(this,0,u):N.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(u){if(!a.isBuffer(u))throw new TypeError("Argument must be a Buffer");return this===u?!0:a.compare(this,u)===0},a.prototype.inspect=function(){var u="",c=t.INSPECT_MAX_BYTES;return u=this.toString("hex",0,c).replace(/(.{2})/g,"$1 ").trim(),this.length>c&&(u+=" ... "),"<Buffer "+u+">"},n&&(a.prototype[n]=a.prototype.inspect),a.prototype.compare=function(u,c,d,R,U){if(re(u,Uint8Array)&&(u=a.from(u,u.offset,u.byteLength)),!a.isBuffer(u))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof u);if(c===void 0&&(c=0),d===void 0&&(d=u?u.length:0),R===void 0&&(R=0),U===void 0&&(U=this.length),c<0||d>u.length||R<0||U>this.length)throw new RangeError("out of range index");if(R>=U&&c>=d)return 0;if(R>=U)return-1;if(c>=d)return 1;if(c>>>=0,d>>>=0,R>>>=0,U>>>=0,this===u)return 0;for(var P=U-R,ae=d-c,de=Math.min(P,ae),se=this.slice(R,U),fe=u.slice(c,d),Ee=0;Ee<de;++Ee)if(se[Ee]!==fe[Ee]){P=se[Ee],ae=fe[Ee];break}return P<ae?-1:ae<P?1:0};function te(y,u,c,d,R){if(y.length===0)return-1;if(typeof c=="string"?(d=c,c=0):c>2147483647?c=2147483647:c<-2147483648&&(c=-2147483648),c=+c,h(c)&&(c=R?0:y.length-1),c<0&&(c=y.length+c),c>=y.length){if(R)return-1;c=y.length-1}else if(c<0)if(R)c=0;else return-1;if(typeof u=="string"&&(u=a.from(u,d)),a.isBuffer(u))return u.length===0?-1:V(y,u,c,d,R);if(typeof u=="number")return u=u&255,typeof Uint8Array.prototype.indexOf=="function"?R?Uint8Array.prototype.indexOf.call(y,u,c):Uint8Array.prototype.lastIndexOf.call(y,u,c):V(y,[u],c,d,R);throw new TypeError("val must be string, number or Buffer")}function V(y,u,c,d,R){var U=1,P=y.length,ae=u.length;if(d!==void 0&&(d=String(d).toLowerCase(),d==="ucs2"||d==="ucs-2"||d==="utf16le"||d==="utf-16le")){if(y.length<2||u.length<2)return-1;U=2,P/=2,ae/=2,c/=2}function de(ut,or){return U===1?ut[or]:ut.readUInt16BE(or*U)}var se;if(R){var fe=-1;for(se=c;se<P;se++)if(de(y,se)===de(u,fe===-1?0:se-fe)){if(fe===-1&&(fe=se),se-fe+1===ae)return fe*U}else fe!==-1&&(se-=se-fe),fe=-1}else for(c+ae>P&&(c=P-ae),se=c;se>=0;se--){for(var Ee=!0,De=0;De<ae;De++)if(de(y,se+De)!==de(u,De)){Ee=!1;break}if(Ee)return se}return-1}a.prototype.includes=function(u,c,d){return this.indexOf(u,c,d)!==-1},a.prototype.indexOf=function(u,c,d){return te(this,u,c,d,!0)},a.prototype.lastIndexOf=function(u,c,d){return te(this,u,c,d,!1)};function ne(y,u,c,d){c=Number(c)||0;var R=y.length-c;d?(d=Number(d),d>R&&(d=R)):d=R;var U=u.length;d>U/2&&(d=U/2);for(var P=0;P<d;++P){var ae=parseInt(u.substr(P*2,2),16);if(h(ae))return P;y[c+P]=ae}return P}function A(y,u,c,d){return O(f(u,y.length-c),y,c,d)}function ce(y,u,c,d){return O(B(u),y,c,d)}function pe(y,u,c,d){return O(I(u),y,c,d)}function L(y,u,c,d){return O(F(u,y.length-c),y,c,d)}a.prototype.write=function(u,c,d,R){if(c===void 0)R="utf8",d=this.length,c=0;else if(d===void 0&&typeof c=="string")R=c,d=this.length,c=0;else if(isFinite(c))c=c>>>0,isFinite(d)?(d=d>>>0,R===void 0&&(R="utf8")):(R=d,d=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var U=this.length-c;if((d===void 0||d>U)&&(d=U),u.length>0&&(d<0||c<0)||c>this.length)throw new RangeError("Attempt to write outside buffer bounds");R||(R="utf8");for(var P=!1;;)switch(R){case"hex":return ne(this,u,c,d);case"utf8":case"utf-8":return A(this,u,c,d);case"ascii":case"latin1":case"binary":return ce(this,u,c,d);case"base64":return pe(this,u,c,d);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,u,c,d);default:if(P)throw new TypeError("Unknown encoding: "+R);R=(""+R).toLowerCase(),P=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function K(y,u,c){return u===0&&c===y.length?e.fromByteArray(y):e.fromByteArray(y.slice(u,c))}function E(y,u,c){c=Math.min(y.length,c);for(var d=[],R=u;R<c;){var U=y[R],P=null,ae=U>239?4:U>223?3:U>191?2:1;if(R+ae<=c){var de,se,fe,Ee;switch(ae){case 1:U<128&&(P=U);break;case 2:de=y[R+1],(de&192)===128&&(Ee=(U&31)<<6|de&63,Ee>127&&(P=Ee));break;case 3:de=y[R+1],se=y[R+2],(de&192)===128&&(se&192)===128&&(Ee=(U&15)<<12|(de&63)<<6|se&63,Ee>2047&&(Ee<55296||Ee>57343)&&(P=Ee));break;case 4:de=y[R+1],se=y[R+2],fe=y[R+3],(de&192)===128&&(se&192)===128&&(fe&192)===128&&(Ee=(U&15)<<18|(de&63)<<12|(se&63)<<6|fe&63,Ee>65535&&Ee<1114112&&(P=Ee))}}P===null?(P=65533,ae=1):P>65535&&(P-=65536,d.push(P>>>10&1023|55296),P=56320|P&1023),d.push(P),R+=ae}return he(d)}var Z=4096;function he(y){var u=y.length;if(u<=Z)return String.fromCharCode.apply(String,y);for(var c="",d=0;d<u;)c+=String.fromCharCode.apply(String,y.slice(d,d+=Z));return c}function J(y,u,c){var d="";c=Math.min(y.length,c);for(var R=u;R<c;++R)d+=String.fromCharCode(y[R]&127);return d}function ve(y,u,c){var d="";c=Math.min(y.length,c);for(var R=u;R<c;++R)d+=String.fromCharCode(y[R]);return d}function oe(y,u,c){var d=y.length;(!u||u<0)&&(u=0),(!c||c<0||c>d)&&(c=d);for(var R="",U=u;U<c;++U)R+=q[y[U]];return R}function ge(y,u,c){for(var d=y.slice(u,c),R="",U=0;U<d.length-1;U+=2)R+=String.fromCharCode(d[U]+d[U+1]*256);return R}a.prototype.slice=function(u,c){var d=this.length;u=~~u,c=c===void 0?d:~~c,u<0?(u+=d,u<0&&(u=0)):u>d&&(u=d),c<0?(c+=d,c<0&&(c=0)):c>d&&(c=d),c<u&&(c=u);var R=this.subarray(u,c);return Object.setPrototypeOf(R,a.prototype),R};function G(y,u,c){if(y%1!==0||y<0)throw new RangeError("offset is not uint");if(y+u>c)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(u,c,d){u=u>>>0,c=c>>>0,d||G(u,c,this.length);for(var R=this[u],U=1,P=0;++P<c&&(U*=256);)R+=this[u+P]*U;return R},a.prototype.readUintBE=a.prototype.readUIntBE=function(u,c,d){u=u>>>0,c=c>>>0,d||G(u,c,this.length);for(var R=this[u+--c],U=1;c>0&&(U*=256);)R+=this[u+--c]*U;return R},a.prototype.readUint8=a.prototype.readUInt8=function(u,c){return u=u>>>0,c||G(u,1,this.length),this[u]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(u,c){return u=u>>>0,c||G(u,2,this.length),this[u]|this[u+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(u,c){return u=u>>>0,c||G(u,2,this.length),this[u]<<8|this[u+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(u,c){return u=u>>>0,c||G(u,4,this.length),(this[u]|this[u+1]<<8|this[u+2]<<16)+this[u+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(u,c){return u=u>>>0,c||G(u,4,this.length),this[u]*16777216+(this[u+1]<<16|this[u+2]<<8|this[u+3])},a.prototype.readIntLE=function(u,c,d){u=u>>>0,c=c>>>0,d||G(u,c,this.length);for(var R=this[u],U=1,P=0;++P<c&&(U*=256);)R+=this[u+P]*U;return U*=128,R>=U&&(R-=Math.pow(2,8*c)),R},a.prototype.readIntBE=function(u,c,d){u=u>>>0,c=c>>>0,d||G(u,c,this.length);for(var R=c,U=1,P=this[u+--R];R>0&&(U*=256);)P+=this[u+--R]*U;return U*=128,P>=U&&(P-=Math.pow(2,8*c)),P},a.prototype.readInt8=function(u,c){return u=u>>>0,c||G(u,1,this.length),this[u]&128?(255-this[u]+1)*-1:this[u]},a.prototype.readInt16LE=function(u,c){u=u>>>0,c||G(u,2,this.length);var d=this[u]|this[u+1]<<8;return d&32768?d|4294901760:d},a.prototype.readInt16BE=function(u,c){u=u>>>0,c||G(u,2,this.length);var d=this[u+1]|this[u]<<8;return d&32768?d|4294901760:d},a.prototype.readInt32LE=function(u,c){return u=u>>>0,c||G(u,4,this.length),this[u]|this[u+1]<<8|this[u+2]<<16|this[u+3]<<24},a.prototype.readInt32BE=function(u,c){return u=u>>>0,c||G(u,4,this.length),this[u]<<24|this[u+1]<<16|this[u+2]<<8|this[u+3]},a.prototype.readFloatLE=function(u,c){return u=u>>>0,c||G(u,4,this.length),r.read(this,u,!0,23,4)},a.prototype.readFloatBE=function(u,c){return u=u>>>0,c||G(u,4,this.length),r.read(this,u,!1,23,4)},a.prototype.readDoubleLE=function(u,c){return u=u>>>0,c||G(u,8,this.length),r.read(this,u,!0,52,8)},a.prototype.readDoubleBE=function(u,c){return u=u>>>0,c||G(u,8,this.length),r.read(this,u,!1,52,8)};function k(y,u,c,d,R,U){if(!a.isBuffer(y))throw new TypeError('"buffer" argument must be a Buffer instance');if(u>R||u<U)throw new RangeError('"value" argument is out of bounds');if(c+d>y.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(u,c,d,R){if(u=+u,c=c>>>0,d=d>>>0,!R){var U=Math.pow(2,8*d)-1;k(this,u,c,d,U,0)}var P=1,ae=0;for(this[c]=u&255;++ae<d&&(P*=256);)this[c+ae]=u/P&255;return c+d},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(u,c,d,R){if(u=+u,c=c>>>0,d=d>>>0,!R){var U=Math.pow(2,8*d)-1;k(this,u,c,d,U,0)}var P=d-1,ae=1;for(this[c+P]=u&255;--P>=0&&(ae*=256);)this[c+P]=u/ae&255;return c+d},a.prototype.writeUint8=a.prototype.writeUInt8=function(u,c,d){return u=+u,c=c>>>0,d||k(this,u,c,1,255,0),this[c]=u&255,c+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(u,c,d){return u=+u,c=c>>>0,d||k(this,u,c,2,65535,0),this[c]=u&255,this[c+1]=u>>>8,c+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(u,c,d){return u=+u,c=c>>>0,d||k(this,u,c,2,65535,0),this[c]=u>>>8,this[c+1]=u&255,c+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(u,c,d){return u=+u,c=c>>>0,d||k(this,u,c,4,4294967295,0),this[c+3]=u>>>24,this[c+2]=u>>>16,this[c+1]=u>>>8,this[c]=u&255,c+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(u,c,d){return u=+u,c=c>>>0,d||k(this,u,c,4,4294967295,0),this[c]=u>>>24,this[c+1]=u>>>16,this[c+2]=u>>>8,this[c+3]=u&255,c+4},a.prototype.writeIntLE=function(u,c,d,R){if(u=+u,c=c>>>0,!R){var U=Math.pow(2,8*d-1);k(this,u,c,d,U-1,-U)}var P=0,ae=1,de=0;for(this[c]=u&255;++P<d&&(ae*=256);)u<0&&de===0&&this[c+P-1]!==0&&(de=1),this[c+P]=(u/ae>>0)-de&255;return c+d},a.prototype.writeIntBE=function(u,c,d,R){if(u=+u,c=c>>>0,!R){var U=Math.pow(2,8*d-1);k(this,u,c,d,U-1,-U)}var P=d-1,ae=1,de=0;for(this[c+P]=u&255;--P>=0&&(ae*=256);)u<0&&de===0&&this[c+P+1]!==0&&(de=1),this[c+P]=(u/ae>>0)-de&255;return c+d},a.prototype.writeInt8=function(u,c,d){return u=+u,c=c>>>0,d||k(this,u,c,1,127,-128),u<0&&(u=255+u+1),this[c]=u&255,c+1},a.prototype.writeInt16LE=function(u,c,d){return u=+u,c=c>>>0,d||k(this,u,c,2,32767,-32768),this[c]=u&255,this[c+1]=u>>>8,c+2},a.prototype.writeInt16BE=function(u,c,d){return u=+u,c=c>>>0,d||k(this,u,c,2,32767,-32768),this[c]=u>>>8,this[c+1]=u&255,c+2},a.prototype.writeInt32LE=function(u,c,d){return u=+u,c=c>>>0,d||k(this,u,c,4,2147483647,-2147483648),this[c]=u&255,this[c+1]=u>>>8,this[c+2]=u>>>16,this[c+3]=u>>>24,c+4},a.prototype.writeInt32BE=function(u,c,d){return u=+u,c=c>>>0,d||k(this,u,c,4,2147483647,-2147483648),u<0&&(u=4294967295+u+1),this[c]=u>>>24,this[c+1]=u>>>16,this[c+2]=u>>>8,this[c+3]=u&255,c+4};function z(y,u,c,d,R,U){if(c+d>y.length)throw new RangeError("Index out of range");if(c<0)throw new RangeError("Index out of range")}function $(y,u,c,d,R){return u=+u,c=c>>>0,R||z(y,u,c,4),r.write(y,u,c,d,23,4),c+4}a.prototype.writeFloatLE=function(u,c,d){return $(this,u,c,!0,d)},a.prototype.writeFloatBE=function(u,c,d){return $(this,u,c,!1,d)};function ie(y,u,c,d,R){return u=+u,c=c>>>0,R||z(y,u,c,8),r.write(y,u,c,d,52,8),c+8}a.prototype.writeDoubleLE=function(u,c,d){return ie(this,u,c,!0,d)},a.prototype.writeDoubleBE=function(u,c,d){return ie(this,u,c,!1,d)},a.prototype.copy=function(u,c,d,R){if(!a.isBuffer(u))throw new TypeError("argument should be a Buffer");if(d||(d=0),!R&&R!==0&&(R=this.length),c>=u.length&&(c=u.length),c||(c=0),R>0&&R<d&&(R=d),R===d||u.length===0||this.length===0)return 0;if(c<0)throw new RangeError("targetStart out of bounds");if(d<0||d>=this.length)throw new RangeError("Index out of range");if(R<0)throw new RangeError("sourceEnd out of bounds");R>this.length&&(R=this.length),u.length-c<R-d&&(R=u.length-c+d);var U=R-d;return this===u&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(c,d,R):Uint8Array.prototype.set.call(u,this.subarray(d,R),c),U},a.prototype.fill=function(u,c,d,R){if(typeof u=="string"){if(typeof c=="string"?(R=c,c=0,d=this.length):typeof d=="string"&&(R=d,d=this.length),R!==void 0&&typeof R!="string")throw new TypeError("encoding must be a string");if(typeof R=="string"&&!a.isEncoding(R))throw new TypeError("Unknown encoding: "+R);if(u.length===1){var U=u.charCodeAt(0);(R==="utf8"&&U<128||R==="latin1")&&(u=U)}}else typeof u=="number"?u=u&255:typeof u=="boolean"&&(u=Number(u));if(c<0||this.length<c||this.length<d)throw new RangeError("Out of range index");if(d<=c)return this;c=c>>>0,d=d===void 0?this.length:d>>>0,u||(u=0);var P;if(typeof u=="number")for(P=c;P<d;++P)this[P]=u;else{var ae=a.isBuffer(u)?u:a.from(u,R),de=ae.length;if(de===0)throw new TypeError('The value "'+u+'" is invalid for argument "value"');for(P=0;P<d-c;++P)this[P+c]=ae[P%de]}return this};var j=/[^+/0-9A-Za-z-_]/g;function p(y){if(y=y.split("=")[0],y=y.trim().replace(j,""),y.length<2)return"";for(;y.length%4!==0;)y=y+"=";return y}function f(y,u){u=u||1/0;for(var c,d=y.length,R=null,U=[],P=0;P<d;++P){if(c=y.charCodeAt(P),c>55295&&c<57344){if(!R){if(c>56319){(u-=3)>-1&&U.push(239,191,189);continue}else if(P+1===d){(u-=3)>-1&&U.push(239,191,189);continue}R=c;continue}if(c<56320){(u-=3)>-1&&U.push(239,191,189),R=c;continue}c=(R-55296<<10|c-56320)+65536}else R&&(u-=3)>-1&&U.push(239,191,189);if(R=null,c<128){if((u-=1)<0)break;U.push(c)}else if(c<2048){if((u-=2)<0)break;U.push(c>>6|192,c&63|128)}else if(c<65536){if((u-=3)<0)break;U.push(c>>12|224,c>>6&63|128,c&63|128)}else if(c<1114112){if((u-=4)<0)break;U.push(c>>18|240,c>>12&63|128,c>>6&63|128,c&63|128)}else throw new Error("Invalid code point")}return U}function B(y){for(var u=[],c=0;c<y.length;++c)u.push(y.charCodeAt(c)&255);return u}function F(y,u){for(var c,d,R,U=[],P=0;P<y.length&&!((u-=2)<0);++P)c=y.charCodeAt(P),d=c>>8,R=c%256,U.push(R),U.push(d);return U}function I(y){return e.toByteArray(p(y))}function O(y,u,c,d){for(var R=0;R<d&&!(R+c>=u.length||R>=y.length);++R)u[R+c]=y[R];return R}function re(y,u){return y instanceof u||y!=null&&y.constructor!=null&&y.constructor.name!=null&&y.constructor.name===u.name}function h(y){return y!==y}var q=function(){for(var y="0123456789abcdef",u=new Array(256),c=0;c<16;++c)for(var d=c*16,R=0;R<16;++R)u[d+R]=y[c]+y[R];return u}()}(ba)),ba}var Ea={},xa={},Da,lf;function Em(){return lf||(lf=1,Da=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},r=Symbol("test"),n=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var i=42;e[r]=i;for(r in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var o=Object.getOwnPropertySymbols(e);if(o.length!==1||o[0]!==r||!Object.prototype.propertyIsEnumerable.call(e,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var s=Object.getOwnPropertyDescriptor(e,r);if(s.value!==i||s.enumerable!==!0)return!1}return!0}),Da}var Ta,df;function id(){if(df)return Ta;df=1;var t=Em();return Ta=function(){return t()&&!!Symbol.toStringTag},Ta}var Ca,hf;function Tw(){if(hf)return Ca;hf=1;var t=typeof Symbol<"u"&&Symbol,e=Em();return Ca=function(){return typeof t!="function"||typeof Symbol!="function"||typeof t("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},Ca}var Sa,ff;function Cw(){if(ff)return Sa;ff=1;var t={foo:{}},e=Object;return Sa=function(){return{__proto__:t}.foo===t.foo&&!({__proto__:null}instanceof e)},Sa}var Aa,mf;function Sw(){if(mf)return Aa;mf=1;var t="Function.prototype.bind called on incompatible ",e=Object.prototype.toString,r=Math.max,n="[object Function]",i=function(l,g){for(var _=[],b=0;b<l.length;b+=1)_[b]=l[b];for(var T=0;T<g.length;T+=1)_[T+l.length]=g[T];return _},o=function(l,g){for(var _=[],b=g||0,T=0;b<l.length;b+=1,T+=1)_[T]=l[b];return _},s=function(a,l){for(var g="",_=0;_<a.length;_+=1)g+=a[_],_+1<a.length&&(g+=l);return g};return Aa=function(l){var g=this;if(typeof g!="function"||e.apply(g)!==n)throw new TypeError(t+g);for(var _=o(arguments,1),b,T=function(){if(this instanceof b){var m=g.apply(this,i(_,arguments));return Object(m)===m?m:this}return g.apply(l,i(_,arguments))},w=r(0,g.length-_.length),x=[],v=0;v<w;v++)x[v]="$"+v;if(b=Function("binder","return function ("+s(x,",")+"){ return binder.apply(this,arguments); }")(T),g.prototype){var C=function(){};C.prototype=g.prototype,b.prototype=new C,C.prototype=null}return b},Aa}var Ia,pf;function od(){if(pf)return Ia;pf=1;var t=Sw();return Ia=Function.prototype.bind||t,Ia}var ka,gf;function Aw(){if(gf)return ka;gf=1;var t=Function.prototype.call,e=Object.prototype.hasOwnProperty,r=od();return ka=r.call(t,e),ka}var Oa,wf;function Tn(){if(wf)return Oa;wf=1;var t,e=SyntaxError,r=Function,n=TypeError,i=function(L){try{return r('"use strict"; return ('+L+").constructor;")()}catch{}},o=Object.getOwnPropertyDescriptor;if(o)try{o({},"")}catch{o=null}var s=function(){throw new n},a=o?function(){try{return arguments.callee,s}catch{try{return o(arguments,"callee").get}catch{return s}}}():s,l=Tw()(),g=Cw()(),_=Object.getPrototypeOf||(g?function(L){return L.__proto__}:null),b={},T=typeof Uint8Array>"u"||!_?t:_(Uint8Array),w={"%AggregateError%":typeof AggregateError>"u"?t:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?t:ArrayBuffer,"%ArrayIteratorPrototype%":l&&_?_([][Symbol.iterator]()):t,"%AsyncFromSyncIteratorPrototype%":t,"%AsyncFunction%":b,"%AsyncGenerator%":b,"%AsyncGeneratorFunction%":b,"%AsyncIteratorPrototype%":b,"%Atomics%":typeof Atomics>"u"?t:Atomics,"%BigInt%":typeof BigInt>"u"?t:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?t:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?t:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?t:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?t:Float32Array,"%Float64Array%":typeof Float64Array>"u"?t:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?t:FinalizationRegistry,"%Function%":r,"%GeneratorFunction%":b,"%Int8Array%":typeof Int8Array>"u"?t:Int8Array,"%Int16Array%":typeof Int16Array>"u"?t:Int16Array,"%Int32Array%":typeof Int32Array>"u"?t:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":l&&_?_(_([][Symbol.iterator]())):t,"%JSON%":typeof JSON=="object"?JSON:t,"%Map%":typeof Map>"u"?t:Map,"%MapIteratorPrototype%":typeof Map>"u"||!l||!_?t:_(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?t:Promise,"%Proxy%":typeof Proxy>"u"?t:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?t:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?t:Set,"%SetIteratorPrototype%":typeof Set>"u"||!l||!_?t:_(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?t:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":l&&_?_(""[Symbol.iterator]()):t,"%Symbol%":l?Symbol:t,"%SyntaxError%":e,"%ThrowTypeError%":a,"%TypedArray%":T,"%TypeError%":n,"%Uint8Array%":typeof Uint8Array>"u"?t:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?t:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?t:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?t:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?t:WeakMap,"%WeakRef%":typeof WeakRef>"u"?t:WeakRef,"%WeakSet%":typeof WeakSet>"u"?t:WeakSet};if(_)try{null.error}catch(L){var x=_(_(L));w["%Error.prototype%"]=x}var v=function L(K){var E;if(K==="%AsyncFunction%")E=i("async function () {}");else if(K==="%GeneratorFunction%")E=i("function* () {}");else if(K==="%AsyncGeneratorFunction%")E=i("async function* () {}");else if(K==="%AsyncGenerator%"){var Z=L("%AsyncGeneratorFunction%");Z&&(E=Z.prototype)}else if(K==="%AsyncIteratorPrototype%"){var he=L("%AsyncGenerator%");he&&_&&(E=_(he.prototype))}return w[K]=E,E},C={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},m=od(),D=Aw(),S=m.call(Function.call,Array.prototype.concat),N=m.call(Function.apply,Array.prototype.splice),M=m.call(Function.call,String.prototype.replace),te=m.call(Function.call,String.prototype.slice),V=m.call(Function.call,RegExp.prototype.exec),ne=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,A=/\\(\\)?/g,ce=function(K){var E=te(K,0,1),Z=te(K,-1);if(E==="%"&&Z!=="%")throw new e("invalid intrinsic syntax, expected closing `%`");if(Z==="%"&&E!=="%")throw new e("invalid intrinsic syntax, expected opening `%`");var he=[];return M(K,ne,function(J,ve,oe,ge){he[he.length]=oe?M(ge,A,"$1"):ve||J}),he},pe=function(K,E){var Z=K,he;if(D(C,Z)&&(he=C[Z],Z="%"+he[0]+"%"),D(w,Z)){var J=w[Z];if(J===b&&(J=v(Z)),typeof J>"u"&&!E)throw new n("intrinsic "+K+" exists, but is not available. Please file an issue!");return{alias:he,name:Z,value:J}}throw new e("intrinsic "+K+" does not exist!")};return Oa=function(K,E){if(typeof K!="string"||K.length===0)throw new n("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof E!="boolean")throw new n('"allowMissing" argument must be a boolean');if(V(/^%?[^%]*%?$/,K)===null)throw new e("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var Z=ce(K),he=Z.length>0?Z[0]:"",J=pe("%"+he+"%",E),ve=J.name,oe=J.value,ge=!1,G=J.alias;G&&(he=G[0],N(Z,S([0,1],G)));for(var k=1,z=!0;k<Z.length;k+=1){var $=Z[k],ie=te($,0,1),j=te($,-1);if((ie==='"'||ie==="'"||ie==="`"||j==='"'||j==="'"||j==="`")&&ie!==j)throw new e("property names with quotes must have matching quotes");if(($==="constructor"||!z)&&(ge=!0),he+="."+$,ve="%"+he+"%",D(w,ve))oe=w[ve];else if(oe!=null){if(!($ in oe)){if(!E)throw new n("base intrinsic for "+K+" exists, but the property is not available.");return}if(o&&k+1>=Z.length){var p=o(oe,$);z=!!p,z&&"get"in p&&!("originalValue"in p.get)?oe=p.get:oe=oe[$]}else z=D(oe,$),oe=oe[$];z&&!ge&&(w[ve]=oe)}}return oe},Oa}var Ra={exports:{}},Na,yf;function xm(){if(yf)return Na;yf=1;var t=Tn(),e=t("%Object.defineProperty%",!0),r=function(){if(e)try{return e({},"a",{value:1}),!0}catch{return!1}return!1};return r.hasArrayLengthDefineBug=function(){if(!r())return null;try{return e([],"length",{value:1}).length!==1}catch{return!0}},Na=r,Na}var La,_f;function ad(){if(_f)return La;_f=1;var t=Tn(),e=t("%Object.getOwnPropertyDescriptor%",!0);if(e)try{e([],"length")}catch{e=null}return La=e,La}var Fa,vf;function Iw(){if(vf)return Fa;vf=1;var t=xm()(),e=Tn(),r=t&&e("%Object.defineProperty%",!0);if(r)try{r({},"a",{value:1})}catch{r=!1}var n=e("%SyntaxError%"),i=e("%TypeError%"),o=ad();return Fa=function(a,l,g){if(!a||typeof a!="object"&&typeof a!="function")throw new i("`obj` must be an object or a function`");if(typeof l!="string"&&typeof l!="symbol")throw new i("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new i("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new i("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new i("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new i("`loose`, if provided, must be a boolean");var _=arguments.length>3?arguments[3]:null,b=arguments.length>4?arguments[4]:null,T=arguments.length>5?arguments[5]:null,w=arguments.length>6?arguments[6]:!1,x=!!o&&o(a,l);if(r)r(a,l,{configurable:T===null&&x?x.configurable:!T,enumerable:_===null&&x?x.enumerable:!_,value:g,writable:b===null&&x?x.writable:!b});else if(w||!_&&!b&&!T)a[l]=g;else throw new n("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},Fa}var Pa,bf;function kw(){if(bf)return Pa;bf=1;var t=Tn(),e=Iw(),r=xm()(),n=ad(),i=t("%TypeError%"),o=t("%Math.floor%");return Pa=function(a,l){if(typeof a!="function")throw new i("`fn` is not a function");if(typeof l!="number"||l<0||l>4294967295||o(l)!==l)throw new i("`length` must be a positive 32-bit integer");var g=arguments.length>2&&!!arguments[2],_=!0,b=!0;if("length"in a&&n){var T=n(a,"length");T&&!T.configurable&&(_=!1),T&&!T.writable&&(b=!1)}return(_||b||!g)&&(r?e(a,"length",l,!0,!0):e(a,"length",l)),a},Pa}var Ef;function Dm(){return Ef||(Ef=1,function(t){var e=od(),r=Tn(),n=kw(),i=r("%TypeError%"),o=r("%Function.prototype.apply%"),s=r("%Function.prototype.call%"),a=r("%Reflect.apply%",!0)||e.call(s,o),l=r("%Object.defineProperty%",!0),g=r("%Math.max%");if(l)try{l({},"a",{value:1})}catch{l=null}t.exports=function(T){if(typeof T!="function")throw new i("a function is required");var w=a(e,s,arguments);return n(w,1+g(0,T.length-(arguments.length-1)),!0)};var _=function(){return a(e,o,arguments)};l?l(t.exports,"apply",{value:_}):t.exports.apply=_}(Ra)),Ra.exports}var Ma,xf;function Tm(){if(xf)return Ma;xf=1;var t=Tn(),e=Dm(),r=e(t("String.prototype.indexOf"));return Ma=function(i,o){var s=t(i,!!o);return typeof s=="function"&&r(i,".prototype.")>-1?e(s):s},Ma}var Ba,Df;function Ow(){if(Df)return Ba;Df=1;var t=id()(),e=Tm(),r=e("Object.prototype.toString"),n=function(a){return t&&a&&typeof a=="object"&&Symbol.toStringTag in a?!1:r(a)==="[object Arguments]"},i=function(a){return n(a)?!0:a!==null&&typeof a=="object"&&typeof a.length=="number"&&a.length>=0&&r(a)!=="[object Array]"&&r(a.callee)==="[object Function]"},o=function(){return n(arguments)}();return n.isLegacyArguments=i,Ba=o?n:i,Ba}var Ua,Tf;function Rw(){if(Tf)return Ua;Tf=1;var t=Object.prototype.toString,e=Function.prototype.toString,r=/^\s*(?:function)?\*/,n=id()(),i=Object.getPrototypeOf,o=function(){if(!n)return!1;try{return Function("return function*() {}")()}catch{}},s;return Ua=function(l){if(typeof l!="function")return!1;if(r.test(e.call(l)))return!0;if(!n){var g=t.call(l);return g==="[object GeneratorFunction]"}if(!i)return!1;if(typeof s>"u"){var _=o();s=_?i(_):!1}return i(l)===s},Ua}var ja,Cf;function Nw(){if(Cf)return ja;Cf=1;var t=Function.prototype.toString,e=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,r,n;if(typeof e=="function"&&typeof Object.defineProperty=="function")try{r=Object.defineProperty({},"length",{get:function(){throw n}}),n={},e(function(){throw 42},null,r)}catch(D){D!==n&&(e=null)}else e=null;var i=/^\s*class\b/,o=function(S){try{var N=t.call(S);return i.test(N)}catch{return!1}},s=function(S){try{return o(S)?!1:(t.call(S),!0)}catch{return!1}},a=Object.prototype.toString,l="[object Object]",g="[object Function]",_="[object GeneratorFunction]",b="[object HTMLAllCollection]",T="[object HTML document.all class]",w="[object HTMLCollection]",x=typeof Symbol=="function"&&!!Symbol.toStringTag,v=!(0 in[,]),C=function(){return!1};if(typeof document=="object"){var m=document.all;a.call(m)===a.call(document.all)&&(C=function(S){if((v||!S)&&(typeof S>"u"||typeof S=="object"))try{var N=a.call(S);return(N===b||N===T||N===w||N===l)&&S("")==null}catch{}return!1})}return ja=e?function(S){if(C(S))return!0;if(!S||typeof S!="function"&&typeof S!="object")return!1;try{e(S,null,r)}catch(N){if(N!==n)return!1}return!o(S)&&s(S)}:function(S){if(C(S))return!0;if(!S||typeof S!="function"&&typeof S!="object")return!1;if(x)return s(S);if(o(S))return!1;var N=a.call(S);return N!==g&&N!==_&&!/^\[object HTML/.test(N)?!1:s(S)},ja}var Ha,Sf;function Lw(){if(Sf)return Ha;Sf=1;var t=Nw(),e=Object.prototype.toString,r=Object.prototype.hasOwnProperty,n=function(l,g,_){for(var b=0,T=l.length;b<T;b++)r.call(l,b)&&(_==null?g(l[b],b,l):g.call(_,l[b],b,l))},i=function(l,g,_){for(var b=0,T=l.length;b<T;b++)_==null?g(l.charAt(b),b,l):g.call(_,l.charAt(b),b,l)},o=function(l,g,_){for(var b in l)r.call(l,b)&&(_==null?g(l[b],b,l):g.call(_,l[b],b,l))},s=function(l,g,_){if(!t(g))throw new TypeError("iterator must be a function");var b;arguments.length>=3&&(b=_),e.call(l)==="[object Array]"?n(l,g,b):typeof l=="string"?i(l,g,b):o(l,g,b)};return Ha=s,Ha}var Wa,Af;function Fw(){if(Af)return Wa;Af=1;var t=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],e=typeof globalThis>"u"?zt:globalThis;return Wa=function(){for(var n=[],i=0;i<t.length;i++)typeof e[t[i]]=="function"&&(n[n.length]=t[i]);return n},Wa}var za,If;function Cm(){if(If)return za;If=1;var t=Lw(),e=Fw(),r=Dm(),n=Tm(),i=ad(),o=n("Object.prototype.toString"),s=id()(),a=typeof globalThis>"u"?zt:globalThis,l=e(),g=n("String.prototype.slice"),_=Object.getPrototypeOf,b=n("Array.prototype.indexOf",!0)||function(C,m){for(var D=0;D<C.length;D+=1)if(C[D]===m)return D;return-1},T={__proto__:null};s&&i&&_?t(l,function(v){var C=new a[v];if(Symbol.toStringTag in C){var m=_(C),D=i(m,Symbol.toStringTag);if(!D){var S=_(m);D=i(S,Symbol.toStringTag)}T["$"+v]=r(D.get)}}):t(l,function(v){var C=new a[v],m=C.slice||C.set;m&&(T["$"+v]=r(m))});var w=function(C){var m=!1;return t(T,function(D,S){if(!m)try{"$"+D(C)===S&&(m=g(S,1))}catch{}}),m},x=function(C){var m=!1;return t(T,function(D,S){if(!m)try{D(C),m=g(S,1)}catch{}}),m};return za=function(C){if(!C||typeof C!="object")return!1;if(!s){var m=g(o(C),8,-1);return b(l,m)>-1?m:m!=="Object"?!1:x(C)}return i?w(C):null},za}var Ga,kf;function Pw(){if(kf)return Ga;kf=1;var t=Cm();return Ga=function(r){return!!t(r)},Ga}var Of;function Mw(){return Of||(Of=1,function(t){var e=Ow(),r=Rw(),n=Cm(),i=Pw();function o(d){return d.call.bind(d)}var s=typeof BigInt<"u",a=typeof Symbol<"u",l=o(Object.prototype.toString),g=o(Number.prototype.valueOf),_=o(String.prototype.valueOf),b=o(Boolean.prototype.valueOf);if(s)var T=o(BigInt.prototype.valueOf);if(a)var w=o(Symbol.prototype.valueOf);function x(d,R){if(typeof d!="object")return!1;try{return R(d),!0}catch{return!1}}t.isArgumentsObject=e,t.isGeneratorFunction=r,t.isTypedArray=i;function v(d){return typeof Promise<"u"&&d instanceof Promise||d!==null&&typeof d=="object"&&typeof d.then=="function"&&typeof d.catch=="function"}t.isPromise=v;function C(d){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(d):i(d)||z(d)}t.isArrayBufferView=C;function m(d){return n(d)==="Uint8Array"}t.isUint8Array=m;function D(d){return n(d)==="Uint8ClampedArray"}t.isUint8ClampedArray=D;function S(d){return n(d)==="Uint16Array"}t.isUint16Array=S;function N(d){return n(d)==="Uint32Array"}t.isUint32Array=N;function M(d){return n(d)==="Int8Array"}t.isInt8Array=M;function te(d){return n(d)==="Int16Array"}t.isInt16Array=te;function V(d){return n(d)==="Int32Array"}t.isInt32Array=V;function ne(d){return n(d)==="Float32Array"}t.isFloat32Array=ne;function A(d){return n(d)==="Float64Array"}t.isFloat64Array=A;function ce(d){return n(d)==="BigInt64Array"}t.isBigInt64Array=ce;function pe(d){return n(d)==="BigUint64Array"}t.isBigUint64Array=pe;function L(d){return l(d)==="[object Map]"}L.working=typeof Map<"u"&&L(new Map);function K(d){return typeof Map>"u"?!1:L.working?L(d):d instanceof Map}t.isMap=K;function E(d){return l(d)==="[object Set]"}E.working=typeof Set<"u"&&E(new Set);function Z(d){return typeof Set>"u"?!1:E.working?E(d):d instanceof Set}t.isSet=Z;function he(d){return l(d)==="[object WeakMap]"}he.working=typeof WeakMap<"u"&&he(new WeakMap);function J(d){return typeof WeakMap>"u"?!1:he.working?he(d):d instanceof WeakMap}t.isWeakMap=J;function ve(d){return l(d)==="[object WeakSet]"}ve.working=typeof WeakSet<"u"&&ve(new WeakSet);function oe(d){return ve(d)}t.isWeakSet=oe;function ge(d){return l(d)==="[object ArrayBuffer]"}ge.working=typeof ArrayBuffer<"u"&&ge(new ArrayBuffer);function G(d){return typeof ArrayBuffer>"u"?!1:ge.working?ge(d):d instanceof ArrayBuffer}t.isArrayBuffer=G;function k(d){return l(d)==="[object DataView]"}k.working=typeof ArrayBuffer<"u"&&typeof DataView<"u"&&k(new DataView(new ArrayBuffer(1),0,1));function z(d){return typeof DataView>"u"?!1:k.working?k(d):d instanceof DataView}t.isDataView=z;var $=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:void 0;function ie(d){return l(d)==="[object SharedArrayBuffer]"}function j(d){return typeof $>"u"?!1:(typeof ie.working>"u"&&(ie.working=ie(new $)),ie.working?ie(d):d instanceof $)}t.isSharedArrayBuffer=j;function p(d){return l(d)==="[object AsyncFunction]"}t.isAsyncFunction=p;function f(d){return l(d)==="[object Map Iterator]"}t.isMapIterator=f;function B(d){return l(d)==="[object Set Iterator]"}t.isSetIterator=B;function F(d){return l(d)==="[object Generator]"}t.isGeneratorObject=F;function I(d){return l(d)==="[object WebAssembly.Module]"}t.isWebAssemblyCompiledModule=I;function O(d){return x(d,g)}t.isNumberObject=O;function re(d){return x(d,_)}t.isStringObject=re;function h(d){return x(d,b)}t.isBooleanObject=h;function q(d){return s&&x(d,T)}t.isBigIntObject=q;function y(d){return a&&x(d,w)}t.isSymbolObject=y;function u(d){return O(d)||re(d)||h(d)||q(d)||y(d)}t.isBoxedPrimitive=u;function c(d){return typeof Uint8Array<"u"&&(G(d)||j(d))}t.isAnyArrayBuffer=c,["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(d){Object.defineProperty(t,d,{enumerable:!1,value:function(){throw new Error(d+" is not supported in userland")}})})}(xa)),xa}var $a,Rf;function Bw(){return Rf||(Rf=1,$a=function(e){return e&&typeof e=="object"&&typeof e.copy=="function"&&typeof e.fill=="function"&&typeof e.readUInt8=="function"}),$a}var Nf;function Sm(){return Nf||(Nf=1,function(t){var e=Object.getOwnPropertyDescriptors||function(z){for(var $=Object.keys(z),ie={},j=0;j<$.length;j++)ie[$[j]]=Object.getOwnPropertyDescriptor(z,$[j]);return ie},r=/%[sdj%]/g;t.format=function(k){if(!M(k)){for(var z=[],$=0;$<arguments.length;$++)z.push(s(arguments[$]));return z.join(" ")}for(var $=1,ie=arguments,j=ie.length,p=String(k).replace(r,function(B){if(B==="%%")return"%";if($>=j)return B;switch(B){case"%s":return String(ie[$++]);case"%d":return Number(ie[$++]);case"%j":try{return JSON.stringify(ie[$++])}catch{return"[Circular]"}default:return B}}),f=ie[$];$<j;f=ie[++$])D(f)||!A(f)?p+=" "+f:p+=" "+s(f);return p},t.deprecate=function(k,z){if(typeof Ae<"u"&&Ae.noDeprecation===!0)return k;if(typeof Ae>"u")return function(){return t.deprecate(k,z).apply(this,arguments)};var $=!1;function ie(){if(!$){if(Ae.throwDeprecation)throw new Error(z);Ae.traceDeprecation?console.trace(z):console.error(z),$=!0}return k.apply(this,arguments)}return ie};var n={},i=/^$/;if(Ae.env.NODE_DEBUG){var o=Ae.env.NODE_DEBUG;o=o.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),i=new RegExp("^"+o+"$","i")}t.debuglog=function(k){if(k=k.toUpperCase(),!n[k])if(i.test(k)){var z=Ae.pid;n[k]=function(){var $=t.format.apply(t,arguments);console.error("%s %d: %s",k,z,$)}}else n[k]=function(){};return n[k]};function s(k,z){var $={seen:[],stylize:l};return arguments.length>=3&&($.depth=arguments[2]),arguments.length>=4&&($.colors=arguments[3]),m(z)?$.showHidden=z:z&&t._extend($,z),V($.showHidden)&&($.showHidden=!1),V($.depth)&&($.depth=2),V($.colors)&&($.colors=!1),V($.customInspect)&&($.customInspect=!0),$.colors&&($.stylize=a),_($,k,$.depth)}t.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function a(k,z){var $=s.styles[z];return $?"\x1B["+s.colors[$][0]+"m"+k+"\x1B["+s.colors[$][1]+"m":k}function l(k,z){return k}function g(k){var z={};return k.forEach(function($,ie){z[$]=!0}),z}function _(k,z,$){if(k.customInspect&&z&&L(z.inspect)&&z.inspect!==t.inspect&&!(z.constructor&&z.constructor.prototype===z)){var ie=z.inspect($,k);return M(ie)||(ie=_(k,ie,$)),ie}var j=b(k,z);if(j)return j;var p=Object.keys(z),f=g(p);if(k.showHidden&&(p=Object.getOwnPropertyNames(z)),pe(z)&&(p.indexOf("message")>=0||p.indexOf("description")>=0))return T(z);if(p.length===0){if(L(z)){var B=z.name?": "+z.name:"";return k.stylize("[Function"+B+"]","special")}if(ne(z))return k.stylize(RegExp.prototype.toString.call(z),"regexp");if(ce(z))return k.stylize(Date.prototype.toString.call(z),"date");if(pe(z))return T(z)}var F="",I=!1,O=["{","}"];if(C(z)&&(I=!0,O=["[","]"]),L(z)){var re=z.name?": "+z.name:"";F=" [Function"+re+"]"}if(ne(z)&&(F=" "+RegExp.prototype.toString.call(z)),ce(z)&&(F=" "+Date.prototype.toUTCString.call(z)),pe(z)&&(F=" "+T(z)),p.length===0&&(!I||z.length==0))return O[0]+F+O[1];if($<0)return ne(z)?k.stylize(RegExp.prototype.toString.call(z),"regexp"):k.stylize("[Object]","special");k.seen.push(z);var h;return I?h=w(k,z,$,f,p):h=p.map(function(q){return x(k,z,$,f,q,I)}),k.seen.pop(),v(h,F,O)}function b(k,z){if(V(z))return k.stylize("undefined","undefined");if(M(z)){var $="'"+JSON.stringify(z).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return k.stylize($,"string")}if(N(z))return k.stylize(""+z,"number");if(m(z))return k.stylize(""+z,"boolean");if(D(z))return k.stylize("null","null")}function T(k){return"["+Error.prototype.toString.call(k)+"]"}function w(k,z,$,ie,j){for(var p=[],f=0,B=z.length;f<B;++f)ve(z,String(f))?p.push(x(k,z,$,ie,String(f),!0)):p.push("");return j.forEach(function(F){F.match(/^\d+$/)||p.push(x(k,z,$,ie,F,!0))}),p}function x(k,z,$,ie,j,p){var f,B,F;if(F=Object.getOwnPropertyDescriptor(z,j)||{value:z[j]},F.get?F.set?B=k.stylize("[Getter/Setter]","special"):B=k.stylize("[Getter]","special"):F.set&&(B=k.stylize("[Setter]","special")),ve(ie,j)||(f="["+j+"]"),B||(k.seen.indexOf(F.value)<0?(D($)?B=_(k,F.value,null):B=_(k,F.value,$-1),B.indexOf(`
`)>-1&&(p?B=B.split(`
`).map(function(I){return"  "+I}).join(`
`).slice(2):B=`
`+B.split(`
`).map(function(I){return"   "+I}).join(`
`))):B=k.stylize("[Circular]","special")),V(f)){if(p&&j.match(/^\d+$/))return B;f=JSON.stringify(""+j),f.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(f=f.slice(1,-1),f=k.stylize(f,"name")):(f=f.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),f=k.stylize(f,"string"))}return f+": "+B}function v(k,z,$){var ie=k.reduce(function(j,p){return p.indexOf(`
`)>=0,j+p.replace(/\u001b\[\d\d?m/g,"").length+1},0);return ie>60?$[0]+(z===""?"":z+`
 `)+" "+k.join(`,
  `)+" "+$[1]:$[0]+z+" "+k.join(", ")+" "+$[1]}t.types=Mw();function C(k){return Array.isArray(k)}t.isArray=C;function m(k){return typeof k=="boolean"}t.isBoolean=m;function D(k){return k===null}t.isNull=D;function S(k){return k==null}t.isNullOrUndefined=S;function N(k){return typeof k=="number"}t.isNumber=N;function M(k){return typeof k=="string"}t.isString=M;function te(k){return typeof k=="symbol"}t.isSymbol=te;function V(k){return k===void 0}t.isUndefined=V;function ne(k){return A(k)&&E(k)==="[object RegExp]"}t.isRegExp=ne,t.types.isRegExp=ne;function A(k){return typeof k=="object"&&k!==null}t.isObject=A;function ce(k){return A(k)&&E(k)==="[object Date]"}t.isDate=ce,t.types.isDate=ce;function pe(k){return A(k)&&(E(k)==="[object Error]"||k instanceof Error)}t.isError=pe,t.types.isNativeError=pe;function L(k){return typeof k=="function"}t.isFunction=L;function K(k){return k===null||typeof k=="boolean"||typeof k=="number"||typeof k=="string"||typeof k=="symbol"||typeof k>"u"}t.isPrimitive=K,t.isBuffer=Bw();function E(k){return Object.prototype.toString.call(k)}function Z(k){return k<10?"0"+k.toString(10):k.toString(10)}var he=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function J(){var k=new Date,z=[Z(k.getHours()),Z(k.getMinutes()),Z(k.getSeconds())].join(":");return[k.getDate(),he[k.getMonth()],z].join(" ")}t.log=function(){console.log("%s - %s",J(),t.format.apply(t,arguments))},t.inherits=Ar,t._extend=function(k,z){if(!z||!A(z))return k;for(var $=Object.keys(z),ie=$.length;ie--;)k[$[ie]]=z[$[ie]];return k};function ve(k,z){return Object.prototype.hasOwnProperty.call(k,z)}var oe=typeof Symbol<"u"?Symbol("util.promisify.custom"):void 0;t.promisify=function(z){if(typeof z!="function")throw new TypeError('The "original" argument must be of type Function');if(oe&&z[oe]){var $=z[oe];if(typeof $!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty($,oe,{value:$,enumerable:!1,writable:!1,configurable:!0}),$}function $(){for(var ie,j,p=new Promise(function(F,I){ie=F,j=I}),f=[],B=0;B<arguments.length;B++)f.push(arguments[B]);f.push(function(F,I){F?j(F):ie(I)});try{z.apply(this,f)}catch(F){j(F)}return p}return Object.setPrototypeOf($,Object.getPrototypeOf(z)),oe&&Object.defineProperty($,oe,{value:$,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties($,e(z))},t.promisify.custom=oe;function ge(k,z){if(!k){var $=new Error("Promise was rejected with a falsy value");$.reason=k,k=$}return z(k)}function G(k){if(typeof k!="function")throw new TypeError('The "original" argument must be of type Function');function z(){for(var $=[],ie=0;ie<arguments.length;ie++)$.push(arguments[ie]);var j=$.pop();if(typeof j!="function")throw new TypeError("The last argument must be of type Function");var p=this,f=function(){return j.apply(p,arguments)};k.apply(this,$).then(function(B){Ae.nextTick(f.bind(null,null,B))},function(B){Ae.nextTick(ge.bind(null,B,f))})}return Object.setPrototypeOf(z,Object.getPrototypeOf(k)),Object.defineProperties(z,e(k)),z}t.callbackify=G}(Ea)),Ea}var Va,Lf;function Uw(){if(Lf)return Va;Lf=1;function t(T,w){var x=Object.keys(T);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(T);w&&(v=v.filter(function(C){return Object.getOwnPropertyDescriptor(T,C).enumerable})),x.push.apply(x,v)}return x}function e(T){for(var w=1;w<arguments.length;w++){var x=arguments[w]!=null?arguments[w]:{};w%2?t(Object(x),!0).forEach(function(v){r(T,v,x[v])}):Object.getOwnPropertyDescriptors?Object.defineProperties(T,Object.getOwnPropertyDescriptors(x)):t(Object(x)).forEach(function(v){Object.defineProperty(T,v,Object.getOwnPropertyDescriptor(x,v))})}return T}function r(T,w,x){return w in T?Object.defineProperty(T,w,{value:x,enumerable:!0,configurable:!0,writable:!0}):T[w]=x,T}function n(T,w){if(!(T instanceof w))throw new TypeError("Cannot call a class as a function")}function i(T,w){for(var x=0;x<w.length;x++){var v=w[x];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(T,v.key,v)}}function o(T,w,x){return w&&i(T.prototype,w),x&&i(T,x),T}var s=Uo(),a=s.Buffer,l=Sm(),g=l.inspect,_=g&&g.custom||"inspect";function b(T,w,x){a.prototype.copy.call(T,w,x)}return Va=function(){function T(){n(this,T),this.head=null,this.tail=null,this.length=0}return o(T,[{key:"push",value:function(x){var v={data:x,next:null};this.length>0?this.tail.next=v:this.head=v,this.tail=v,++this.length}},{key:"unshift",value:function(x){var v={data:x,next:this.head};this.length===0&&(this.tail=v),this.head=v,++this.length}},{key:"shift",value:function(){if(this.length!==0){var x=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,x}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(x){if(this.length===0)return"";for(var v=this.head,C=""+v.data;v=v.next;)C+=x+v.data;return C}},{key:"concat",value:function(x){if(this.length===0)return a.alloc(0);for(var v=a.allocUnsafe(x>>>0),C=this.head,m=0;C;)b(C.data,v,m),m+=C.data.length,C=C.next;return v}},{key:"consume",value:function(x,v){var C;return x<this.head.data.length?(C=this.head.data.slice(0,x),this.head.data=this.head.data.slice(x)):x===this.head.data.length?C=this.shift():C=v?this._getString(x):this._getBuffer(x),C}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(x){var v=this.head,C=1,m=v.data;for(x-=m.length;v=v.next;){var D=v.data,S=x>D.length?D.length:x;if(S===D.length?m+=D:m+=D.slice(0,x),x-=S,x===0){S===D.length?(++C,v.next?this.head=v.next:this.head=this.tail=null):(this.head=v,v.data=D.slice(S));break}++C}return this.length-=C,m}},{key:"_getBuffer",value:function(x){var v=a.allocUnsafe(x),C=this.head,m=1;for(C.data.copy(v),x-=C.data.length;C=C.next;){var D=C.data,S=x>D.length?D.length:x;if(D.copy(v,v.length-x,0,S),x-=S,x===0){S===D.length?(++m,C.next?this.head=C.next:this.head=this.tail=null):(this.head=C,C.data=D.slice(S));break}++m}return this.length-=m,v}},{key:_,value:function(x,v){return g(this,e({},v,{depth:0,customInspect:!1}))}}]),T}(),Va}var Ka,Ff;function Am(){if(Ff)return Ka;Ff=1;function t(s,a){var l=this,g=this._readableState&&this._readableState.destroyed,_=this._writableState&&this._writableState.destroyed;return g||_?(a?a(s):s&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,Ae.nextTick(i,this,s)):Ae.nextTick(i,this,s)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(s||null,function(b){!a&&b?l._writableState?l._writableState.errorEmitted?Ae.nextTick(r,l):(l._writableState.errorEmitted=!0,Ae.nextTick(e,l,b)):Ae.nextTick(e,l,b):a?(Ae.nextTick(r,l),a(b)):Ae.nextTick(r,l)}),this)}function e(s,a){i(s,a),r(s)}function r(s){s._writableState&&!s._writableState.emitClose||s._readableState&&!s._readableState.emitClose||s.emit("close")}function n(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function i(s,a){s.emit("error",a)}function o(s,a){var l=s._readableState,g=s._writableState;l&&l.autoDestroy||g&&g.autoDestroy?s.destroy(a):s.emit("error",a)}return Ka={destroy:t,undestroy:n,errorOrDestroy:o},Ka}var qa={},Pf;function Cn(){if(Pf)return qa;Pf=1;function t(a,l){a.prototype=Object.create(l.prototype),a.prototype.constructor=a,a.__proto__=l}var e={};function r(a,l,g){g||(g=Error);function _(T,w,x){return typeof l=="string"?l:l(T,w,x)}var b=function(T){t(w,T);function w(x,v,C){return T.call(this,_(x,v,C))||this}return w}(g);b.prototype.name=g.name,b.prototype.code=a,e[a]=b}function n(a,l){if(Array.isArray(a)){var g=a.length;return a=a.map(function(_){return String(_)}),g>2?"one of ".concat(l," ").concat(a.slice(0,g-1).join(", "),", or ")+a[g-1]:g===2?"one of ".concat(l," ").concat(a[0]," or ").concat(a[1]):"of ".concat(l," ").concat(a[0])}else return"of ".concat(l," ").concat(String(a))}function i(a,l,g){return a.substr(!g||g<0?0:+g,l.length)===l}function o(a,l,g){return(g===void 0||g>a.length)&&(g=a.length),a.substring(g-l.length,g)===l}function s(a,l,g){return typeof g!="number"&&(g=0),g+l.length>a.length?!1:a.indexOf(l,g)!==-1}return r("ERR_INVALID_OPT_VALUE",function(a,l){return'The value "'+l+'" is invalid for option "'+a+'"'},TypeError),r("ERR_INVALID_ARG_TYPE",function(a,l,g){var _;typeof l=="string"&&i(l,"not ")?(_="must not be",l=l.replace(/^not /,"")):_="must be";var b;if(o(a," argument"))b="The ".concat(a," ").concat(_," ").concat(n(l,"type"));else{var T=s(a,".")?"property":"argument";b='The "'.concat(a,'" ').concat(T," ").concat(_," ").concat(n(l,"type"))}return b+=". Received type ".concat(typeof g),b},TypeError),r("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),r("ERR_METHOD_NOT_IMPLEMENTED",function(a){return"The "+a+" method is not implemented"}),r("ERR_STREAM_PREMATURE_CLOSE","Premature close"),r("ERR_STREAM_DESTROYED",function(a){return"Cannot call "+a+" after a stream was destroyed"}),r("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),r("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),r("ERR_STREAM_WRITE_AFTER_END","write after end"),r("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),r("ERR_UNKNOWN_ENCODING",function(a){return"Unknown encoding: "+a},TypeError),r("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),qa.codes=e,qa}var Ya,Mf;function Im(){if(Mf)return Ya;Mf=1;var t=Cn().codes.ERR_INVALID_OPT_VALUE;function e(n,i,o){return n.highWaterMark!=null?n.highWaterMark:i?n[o]:null}function r(n,i,o,s){var a=e(i,s,o);if(a!=null){if(!(isFinite(a)&&Math.floor(a)===a)||a<0){var l=s?o:"highWaterMark";throw new t(l,a)}return Math.floor(a)}return n.objectMode?16:16*1024}return Ya={getHighWaterMark:r},Ya}var Xa,Bf;function jw(){if(Bf)return Xa;Bf=1,Xa=t;function t(r,n){if(e("noDeprecation"))return r;var i=!1;function o(){if(!i){if(e("throwDeprecation"))throw new Error(n);e("traceDeprecation")?console.trace(n):console.warn(n),i=!0}return r.apply(this,arguments)}return o}function e(r){try{if(!zt.localStorage)return!1}catch{return!1}var n=zt.localStorage[r];return n==null?!1:String(n).toLowerCase()==="true"}return Xa}var Za,Uf;function km(){if(Uf)return Za;Uf=1,Za=ne;function t(j){var p=this;this.next=null,this.entry=null,this.finish=function(){ie(p,j)}}var e;ne.WritableState=te;var r={deprecate:jw()},n=bm(),i=Uo().Buffer,o=zt.Uint8Array||function(){};function s(j){return i.from(j)}function a(j){return i.isBuffer(j)||j instanceof o}var l=Am(),g=Im(),_=g.getHighWaterMark,b=Cn().codes,T=b.ERR_INVALID_ARG_TYPE,w=b.ERR_METHOD_NOT_IMPLEMENTED,x=b.ERR_MULTIPLE_CALLBACK,v=b.ERR_STREAM_CANNOT_PIPE,C=b.ERR_STREAM_DESTROYED,m=b.ERR_STREAM_NULL_VALUES,D=b.ERR_STREAM_WRITE_AFTER_END,S=b.ERR_UNKNOWN_ENCODING,N=l.errorOrDestroy;Ar(ne,n);function M(){}function te(j,p,f){e=e||_n(),j=j||{},typeof f!="boolean"&&(f=p instanceof e),this.objectMode=!!j.objectMode,f&&(this.objectMode=this.objectMode||!!j.writableObjectMode),this.highWaterMark=_(this,j,"writableHighWaterMark",f),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var B=j.decodeStrings===!1;this.decodeStrings=!B,this.defaultEncoding=j.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(F){he(p,F)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=j.emitClose!==!1,this.autoDestroy=!!j.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new t(this)}te.prototype.getBuffer=function(){for(var p=this.bufferedRequest,f=[];p;)f.push(p),p=p.next;return f},function(){try{Object.defineProperty(te.prototype,"buffer",{get:r.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var V;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(V=Function.prototype[Symbol.hasInstance],Object.defineProperty(ne,Symbol.hasInstance,{value:function(p){return V.call(this,p)?!0:this!==ne?!1:p&&p._writableState instanceof te}})):V=function(p){return p instanceof this};function ne(j){e=e||_n();var p=this instanceof e;if(!p&&!V.call(ne,this))return new ne(j);this._writableState=new te(j,this,p),this.writable=!0,j&&(typeof j.write=="function"&&(this._write=j.write),typeof j.writev=="function"&&(this._writev=j.writev),typeof j.destroy=="function"&&(this._destroy=j.destroy),typeof j.final=="function"&&(this._final=j.final)),n.call(this)}ne.prototype.pipe=function(){N(this,new v)};function A(j,p){var f=new D;N(j,f),Ae.nextTick(p,f)}function ce(j,p,f,B){var F;return f===null?F=new m:typeof f!="string"&&!p.objectMode&&(F=new T("chunk",["string","Buffer"],f)),F?(N(j,F),Ae.nextTick(B,F),!1):!0}ne.prototype.write=function(j,p,f){var B=this._writableState,F=!1,I=!B.objectMode&&a(j);return I&&!i.isBuffer(j)&&(j=s(j)),typeof p=="function"&&(f=p,p=null),I?p="buffer":p||(p=B.defaultEncoding),typeof f!="function"&&(f=M),B.ending?A(this,f):(I||ce(this,B,j,f))&&(B.pendingcb++,F=L(this,B,I,j,p,f)),F},ne.prototype.cork=function(){this._writableState.corked++},ne.prototype.uncork=function(){var j=this._writableState;j.corked&&(j.corked--,!j.writing&&!j.corked&&!j.bufferProcessing&&j.bufferedRequest&&oe(this,j))},ne.prototype.setDefaultEncoding=function(p){if(typeof p=="string"&&(p=p.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((p+"").toLowerCase())>-1))throw new S(p);return this._writableState.defaultEncoding=p,this},Object.defineProperty(ne.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function pe(j,p,f){return!j.objectMode&&j.decodeStrings!==!1&&typeof p=="string"&&(p=i.from(p,f)),p}Object.defineProperty(ne.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function L(j,p,f,B,F,I){if(!f){var O=pe(p,B,F);B!==O&&(f=!0,F="buffer",B=O)}var re=p.objectMode?1:B.length;p.length+=re;var h=p.length<p.highWaterMark;if(h||(p.needDrain=!0),p.writing||p.corked){var q=p.lastBufferedRequest;p.lastBufferedRequest={chunk:B,encoding:F,isBuf:f,callback:I,next:null},q?q.next=p.lastBufferedRequest:p.bufferedRequest=p.lastBufferedRequest,p.bufferedRequestCount+=1}else K(j,p,!1,re,B,F,I);return h}function K(j,p,f,B,F,I,O){p.writelen=B,p.writecb=O,p.writing=!0,p.sync=!0,p.destroyed?p.onwrite(new C("write")):f?j._writev(F,p.onwrite):j._write(F,I,p.onwrite),p.sync=!1}function E(j,p,f,B,F){--p.pendingcb,f?(Ae.nextTick(F,B),Ae.nextTick(z,j,p),j._writableState.errorEmitted=!0,N(j,B)):(F(B),j._writableState.errorEmitted=!0,N(j,B),z(j,p))}function Z(j){j.writing=!1,j.writecb=null,j.length-=j.writelen,j.writelen=0}function he(j,p){var f=j._writableState,B=f.sync,F=f.writecb;if(typeof F!="function")throw new x;if(Z(f),p)E(j,f,B,p,F);else{var I=ge(f)||j.destroyed;!I&&!f.corked&&!f.bufferProcessing&&f.bufferedRequest&&oe(j,f),B?Ae.nextTick(J,j,f,I,F):J(j,f,I,F)}}function J(j,p,f,B){f||ve(j,p),p.pendingcb--,B(),z(j,p)}function ve(j,p){p.length===0&&p.needDrain&&(p.needDrain=!1,j.emit("drain"))}function oe(j,p){p.bufferProcessing=!0;var f=p.bufferedRequest;if(j._writev&&f&&f.next){var B=p.bufferedRequestCount,F=new Array(B),I=p.corkedRequestsFree;I.entry=f;for(var O=0,re=!0;f;)F[O]=f,f.isBuf||(re=!1),f=f.next,O+=1;F.allBuffers=re,K(j,p,!0,p.length,F,"",I.finish),p.pendingcb++,p.lastBufferedRequest=null,I.next?(p.corkedRequestsFree=I.next,I.next=null):p.corkedRequestsFree=new t(p),p.bufferedRequestCount=0}else{for(;f;){var h=f.chunk,q=f.encoding,y=f.callback,u=p.objectMode?1:h.length;if(K(j,p,!1,u,h,q,y),f=f.next,p.bufferedRequestCount--,p.writing)break}f===null&&(p.lastBufferedRequest=null)}p.bufferedRequest=f,p.bufferProcessing=!1}ne.prototype._write=function(j,p,f){f(new w("_write()"))},ne.prototype._writev=null,ne.prototype.end=function(j,p,f){var B=this._writableState;return typeof j=="function"?(f=j,j=null,p=null):typeof p=="function"&&(f=p,p=null),j!=null&&this.write(j,p),B.corked&&(B.corked=1,this.uncork()),B.ending||$(this,B,f),this},Object.defineProperty(ne.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function ge(j){return j.ending&&j.length===0&&j.bufferedRequest===null&&!j.finished&&!j.writing}function G(j,p){j._final(function(f){p.pendingcb--,f&&N(j,f),p.prefinished=!0,j.emit("prefinish"),z(j,p)})}function k(j,p){!p.prefinished&&!p.finalCalled&&(typeof j._final=="function"&&!p.destroyed?(p.pendingcb++,p.finalCalled=!0,Ae.nextTick(G,j,p)):(p.prefinished=!0,j.emit("prefinish")))}function z(j,p){var f=ge(p);if(f&&(k(j,p),p.pendingcb===0&&(p.finished=!0,j.emit("finish"),p.autoDestroy))){var B=j._readableState;(!B||B.autoDestroy&&B.endEmitted)&&j.destroy()}return f}function $(j,p,f){p.ending=!0,z(j,p),f&&(p.finished?Ae.nextTick(f):j.once("finish",f)),p.ended=!0,j.writable=!1}function ie(j,p,f){var B=j.entry;for(j.entry=null;B;){var F=B.callback;p.pendingcb--,F(f),B=B.next}p.corkedRequestsFree.next=j}return Object.defineProperty(ne.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(p){this._writableState&&(this._writableState.destroyed=p)}}),ne.prototype.destroy=l.destroy,ne.prototype._undestroy=l.undestroy,ne.prototype._destroy=function(j,p){p(j)},Za}var Qa,jf;function _n(){if(jf)return Qa;jf=1;var t=Object.keys||function(g){var _=[];for(var b in g)_.push(b);return _};Qa=s;var e=Om(),r=km();Ar(s,e);for(var n=t(r.prototype),i=0;i<n.length;i++){var o=n[i];s.prototype[o]||(s.prototype[o]=r.prototype[o])}function s(g){if(!(this instanceof s))return new s(g);e.call(this,g),r.call(this,g),this.allowHalfOpen=!0,g&&(g.readable===!1&&(this.readable=!1),g.writable===!1&&(this.writable=!1),g.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",a)))}Object.defineProperty(s.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(s.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(s.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function a(){this._writableState.ended||Ae.nextTick(l,this)}function l(g){g.end()}return Object.defineProperty(s.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(_){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=_,this._writableState.destroyed=_)}}),Qa}var Ja={},Ji={exports:{}},Hf;function Hw(){return Hf||(Hf=1,function(t,e){var r=Uo(),n=r.Buffer;function i(s,a){for(var l in s)a[l]=s[l]}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?t.exports=r:(i(r,e),e.Buffer=o);function o(s,a,l){return n(s,a,l)}i(n,o),o.from=function(s,a,l){if(typeof s=="number")throw new TypeError("Argument must not be a number");return n(s,a,l)},o.alloc=function(s,a,l){if(typeof s!="number")throw new TypeError("Argument must be a number");var g=n(s);return a!==void 0?typeof l=="string"?g.fill(a,l):g.fill(a):g.fill(0),g},o.allocUnsafe=function(s){if(typeof s!="number")throw new TypeError("Argument must be a number");return n(s)},o.allocUnsafeSlow=function(s){if(typeof s!="number")throw new TypeError("Argument must be a number");return r.SlowBuffer(s)}}(Ji,Ji.exports)),Ji.exports}var Wf;function hs(){if(Wf)return Ja;Wf=1;var t=Hw().Buffer,e=t.isEncoding||function(m){switch(m=""+m,m&&m.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function r(m){if(!m)return"utf8";for(var D;;)switch(m){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return m;default:if(D)return;m=(""+m).toLowerCase(),D=!0}}function n(m){var D=r(m);if(typeof D!="string"&&(t.isEncoding===e||!e(m)))throw new Error("Unknown encoding: "+m);return D||m}Ja.StringDecoder=i;function i(m){this.encoding=n(m);var D;switch(this.encoding){case"utf16le":this.text=b,this.end=T,D=4;break;case"utf8":this.fillLast=l,D=4;break;case"base64":this.text=w,this.end=x,D=3;break;default:this.write=v,this.end=C;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=t.allocUnsafe(D)}i.prototype.write=function(m){if(m.length===0)return"";var D,S;if(this.lastNeed){if(D=this.fillLast(m),D===void 0)return"";S=this.lastNeed,this.lastNeed=0}else S=0;return S<m.length?D?D+this.text(m,S):this.text(m,S):D||""},i.prototype.end=_,i.prototype.text=g,i.prototype.fillLast=function(m){if(this.lastNeed<=m.length)return m.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);m.copy(this.lastChar,this.lastTotal-this.lastNeed,0,m.length),this.lastNeed-=m.length};function o(m){return m<=127?0:m>>5===6?2:m>>4===14?3:m>>3===30?4:m>>6===2?-1:-2}function s(m,D,S){var N=D.length-1;if(N<S)return 0;var M=o(D[N]);return M>=0?(M>0&&(m.lastNeed=M-1),M):--N<S||M===-2?0:(M=o(D[N]),M>=0?(M>0&&(m.lastNeed=M-2),M):--N<S||M===-2?0:(M=o(D[N]),M>=0?(M>0&&(M===2?M=0:m.lastNeed=M-3),M):0))}function a(m,D,S){if((D[0]&192)!==128)return m.lastNeed=0,"\uFFFD";if(m.lastNeed>1&&D.length>1){if((D[1]&192)!==128)return m.lastNeed=1,"\uFFFD";if(m.lastNeed>2&&D.length>2&&(D[2]&192)!==128)return m.lastNeed=2,"\uFFFD"}}function l(m){var D=this.lastTotal-this.lastNeed,S=a(this,m);if(S!==void 0)return S;if(this.lastNeed<=m.length)return m.copy(this.lastChar,D,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);m.copy(this.lastChar,D,0,m.length),this.lastNeed-=m.length}function g(m,D){var S=s(this,m,D);if(!this.lastNeed)return m.toString("utf8",D);this.lastTotal=S;var N=m.length-(S-this.lastNeed);return m.copy(this.lastChar,0,N),m.toString("utf8",D,N)}function _(m){var D=m&&m.length?this.write(m):"";return this.lastNeed?D+"\uFFFD":D}function b(m,D){if((m.length-D)%2===0){var S=m.toString("utf16le",D);if(S){var N=S.charCodeAt(S.length-1);if(N>=55296&&N<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=m[m.length-2],this.lastChar[1]=m[m.length-1],S.slice(0,-1)}return S}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=m[m.length-1],m.toString("utf16le",D,m.length-1)}function T(m){var D=m&&m.length?this.write(m):"";if(this.lastNeed){var S=this.lastTotal-this.lastNeed;return D+this.lastChar.toString("utf16le",0,S)}return D}function w(m,D){var S=(m.length-D)%3;return S===0?m.toString("base64",D):(this.lastNeed=3-S,this.lastTotal=3,S===1?this.lastChar[0]=m[m.length-1]:(this.lastChar[0]=m[m.length-2],this.lastChar[1]=m[m.length-1]),m.toString("base64",D,m.length-S))}function x(m){var D=m&&m.length?this.write(m):"";return this.lastNeed?D+this.lastChar.toString("base64",0,3-this.lastNeed):D}function v(m){return m.toString(this.encoding)}function C(m){return m&&m.length?this.write(m):""}return Ja}var es,zf;function sd(){if(zf)return es;zf=1;var t=Cn().codes.ERR_STREAM_PREMATURE_CLOSE;function e(o){var s=!1;return function(){if(!s){s=!0;for(var a=arguments.length,l=new Array(a),g=0;g<a;g++)l[g]=arguments[g];o.apply(this,l)}}}function r(){}function n(o){return o.setHeader&&typeof o.abort=="function"}function i(o,s,a){if(typeof s=="function")return i(o,null,s);s||(s={}),a=e(a||r);var l=s.readable||s.readable!==!1&&o.readable,g=s.writable||s.writable!==!1&&o.writable,_=function(){o.writable||T()},b=o._writableState&&o._writableState.finished,T=function(){g=!1,b=!0,l||a.call(o)},w=o._readableState&&o._readableState.endEmitted,x=function(){l=!1,w=!0,g||a.call(o)},v=function(S){a.call(o,S)},C=function(){var S;if(l&&!w)return(!o._readableState||!o._readableState.ended)&&(S=new t),a.call(o,S);if(g&&!b)return(!o._writableState||!o._writableState.ended)&&(S=new t),a.call(o,S)},m=function(){o.req.on("finish",T)};return n(o)?(o.on("complete",T),o.on("abort",C),o.req?m():o.on("request",m)):g&&!o._writableState&&(o.on("end",_),o.on("close",_)),o.on("end",x),o.on("finish",T),s.error!==!1&&o.on("error",v),o.on("close",C),function(){o.removeListener("complete",T),o.removeListener("abort",C),o.removeListener("request",m),o.req&&o.req.removeListener("finish",T),o.removeListener("end",_),o.removeListener("close",_),o.removeListener("finish",T),o.removeListener("end",x),o.removeListener("error",v),o.removeListener("close",C)}}return es=i,es}var ts,Gf;function Ww(){if(Gf)return ts;Gf=1;var t;function e(m,D,S){return D in m?Object.defineProperty(m,D,{value:S,enumerable:!0,configurable:!0,writable:!0}):m[D]=S,m}var r=sd(),n=Symbol("lastResolve"),i=Symbol("lastReject"),o=Symbol("error"),s=Symbol("ended"),a=Symbol("lastPromise"),l=Symbol("handlePromise"),g=Symbol("stream");function _(m,D){return{value:m,done:D}}function b(m){var D=m[n];if(D!==null){var S=m[g].read();S!==null&&(m[a]=null,m[n]=null,m[i]=null,D(_(S,!1)))}}function T(m){Ae.nextTick(b,m)}function w(m,D){return function(S,N){m.then(function(){if(D[s]){S(_(void 0,!0));return}D[l](S,N)},N)}}var x=Object.getPrototypeOf(function(){}),v=Object.setPrototypeOf((t={get stream(){return this[g]},next:function(){var D=this,S=this[o];if(S!==null)return Promise.reject(S);if(this[s])return Promise.resolve(_(void 0,!0));if(this[g].destroyed)return new Promise(function(V,ne){Ae.nextTick(function(){D[o]?ne(D[o]):V(_(void 0,!0))})});var N=this[a],M;if(N)M=new Promise(w(N,this));else{var te=this[g].read();if(te!==null)return Promise.resolve(_(te,!1));M=new Promise(this[l])}return this[a]=M,M}},e(t,Symbol.asyncIterator,function(){return this}),e(t,"return",function(){var D=this;return new Promise(function(S,N){D[g].destroy(null,function(M){if(M){N(M);return}S(_(void 0,!0))})})}),t),x),C=function(D){var S,N=Object.create(v,(S={},e(S,g,{value:D,writable:!0}),e(S,n,{value:null,writable:!0}),e(S,i,{value:null,writable:!0}),e(S,o,{value:null,writable:!0}),e(S,s,{value:D._readableState.endEmitted,writable:!0}),e(S,l,{value:function(te,V){var ne=N[g].read();ne?(N[a]=null,N[n]=null,N[i]=null,te(_(ne,!1))):(N[n]=te,N[i]=V)},writable:!0}),S));return N[a]=null,r(D,function(M){if(M&&M.code!=="ERR_STREAM_PREMATURE_CLOSE"){var te=N[i];te!==null&&(N[a]=null,N[n]=null,N[i]=null,te(M)),N[o]=M;return}var V=N[n];V!==null&&(N[a]=null,N[n]=null,N[i]=null,V(_(void 0,!0))),N[s]=!0}),D.on("readable",T.bind(null,N)),N};return ts=C,ts}var rs,$f;function zw(){return $f||($f=1,rs=function(){throw new Error("Readable.from is not available in the browser")}),rs}var ns,Vf;function Om(){if(Vf)return ns;Vf=1,ns=A;var t;A.ReadableState=ne,nd.EventEmitter;var e=function(O,re){return O.listeners(re).length},r=bm(),n=Uo().Buffer,i=zt.Uint8Array||function(){};function o(I){return n.from(I)}function s(I){return n.isBuffer(I)||I instanceof i}var a=Sm(),l;a&&a.debuglog?l=a.debuglog("stream"):l=function(){};var g=Uw(),_=Am(),b=Im(),T=b.getHighWaterMark,w=Cn().codes,x=w.ERR_INVALID_ARG_TYPE,v=w.ERR_STREAM_PUSH_AFTER_EOF,C=w.ERR_METHOD_NOT_IMPLEMENTED,m=w.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,D,S,N;Ar(A,r);var M=_.errorOrDestroy,te=["error","close","destroy","pause","resume"];function V(I,O,re){if(typeof I.prependListener=="function")return I.prependListener(O,re);!I._events||!I._events[O]?I.on(O,re):Array.isArray(I._events[O])?I._events[O].unshift(re):I._events[O]=[re,I._events[O]]}function ne(I,O,re){t=t||_n(),I=I||{},typeof re!="boolean"&&(re=O instanceof t),this.objectMode=!!I.objectMode,re&&(this.objectMode=this.objectMode||!!I.readableObjectMode),this.highWaterMark=T(this,I,"readableHighWaterMark",re),this.buffer=new g,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=I.emitClose!==!1,this.autoDestroy=!!I.autoDestroy,this.destroyed=!1,this.defaultEncoding=I.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,I.encoding&&(D||(D=hs().StringDecoder),this.decoder=new D(I.encoding),this.encoding=I.encoding)}function A(I){if(t=t||_n(),!(this instanceof A))return new A(I);var O=this instanceof t;this._readableState=new ne(I,this,O),this.readable=!0,I&&(typeof I.read=="function"&&(this._read=I.read),typeof I.destroy=="function"&&(this._destroy=I.destroy)),r.call(this)}Object.defineProperty(A.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(O){this._readableState&&(this._readableState.destroyed=O)}}),A.prototype.destroy=_.destroy,A.prototype._undestroy=_.undestroy,A.prototype._destroy=function(I,O){O(I)},A.prototype.push=function(I,O){var re=this._readableState,h;return re.objectMode?h=!0:typeof I=="string"&&(O=O||re.defaultEncoding,O!==re.encoding&&(I=n.from(I,O),O=""),h=!0),ce(this,I,O,!1,h)},A.prototype.unshift=function(I){return ce(this,I,null,!0,!1)};function ce(I,O,re,h,q){l("readableAddChunk",O);var y=I._readableState;if(O===null)y.reading=!1,he(I,y);else{var u;if(q||(u=L(y,O)),u)M(I,u);else if(y.objectMode||O&&O.length>0)if(typeof O!="string"&&!y.objectMode&&Object.getPrototypeOf(O)!==n.prototype&&(O=o(O)),h)y.endEmitted?M(I,new m):pe(I,y,O,!0);else if(y.ended)M(I,new v);else{if(y.destroyed)return!1;y.reading=!1,y.decoder&&!re?(O=y.decoder.write(O),y.objectMode||O.length!==0?pe(I,y,O,!1):oe(I,y)):pe(I,y,O,!1)}else h||(y.reading=!1,oe(I,y))}return!y.ended&&(y.length<y.highWaterMark||y.length===0)}function pe(I,O,re,h){O.flowing&&O.length===0&&!O.sync?(O.awaitDrain=0,I.emit("data",re)):(O.length+=O.objectMode?1:re.length,h?O.buffer.unshift(re):O.buffer.push(re),O.needReadable&&J(I)),oe(I,O)}function L(I,O){var re;return!s(O)&&typeof O!="string"&&O!==void 0&&!I.objectMode&&(re=new x("chunk",["string","Buffer","Uint8Array"],O)),re}A.prototype.isPaused=function(){return this._readableState.flowing===!1},A.prototype.setEncoding=function(I){D||(D=hs().StringDecoder);var O=new D(I);this._readableState.decoder=O,this._readableState.encoding=this._readableState.decoder.encoding;for(var re=this._readableState.buffer.head,h="";re!==null;)h+=O.write(re.data),re=re.next;return this._readableState.buffer.clear(),h!==""&&this._readableState.buffer.push(h),this._readableState.length=h.length,this};var K=1073741824;function E(I){return I>=K?I=K:(I--,I|=I>>>1,I|=I>>>2,I|=I>>>4,I|=I>>>8,I|=I>>>16,I++),I}function Z(I,O){return I<=0||O.length===0&&O.ended?0:O.objectMode?1:I!==I?O.flowing&&O.length?O.buffer.head.data.length:O.length:(I>O.highWaterMark&&(O.highWaterMark=E(I)),I<=O.length?I:O.ended?O.length:(O.needReadable=!0,0))}A.prototype.read=function(I){l("read",I),I=parseInt(I,10);var O=this._readableState,re=I;if(I!==0&&(O.emittedReadable=!1),I===0&&O.needReadable&&((O.highWaterMark!==0?O.length>=O.highWaterMark:O.length>0)||O.ended))return l("read: emitReadable",O.length,O.ended),O.length===0&&O.ended?f(this):J(this),null;if(I=Z(I,O),I===0&&O.ended)return O.length===0&&f(this),null;var h=O.needReadable;l("need readable",h),(O.length===0||O.length-I<O.highWaterMark)&&(h=!0,l("length less than watermark",h)),O.ended||O.reading?(h=!1,l("reading or ended",h)):h&&(l("do read"),O.reading=!0,O.sync=!0,O.length===0&&(O.needReadable=!0),this._read(O.highWaterMark),O.sync=!1,O.reading||(I=Z(re,O)));var q;return I>0?q=p(I,O):q=null,q===null?(O.needReadable=O.length<=O.highWaterMark,I=0):(O.length-=I,O.awaitDrain=0),O.length===0&&(O.ended||(O.needReadable=!0),re!==I&&O.ended&&f(this)),q!==null&&this.emit("data",q),q};function he(I,O){if(l("onEofChunk"),!O.ended){if(O.decoder){var re=O.decoder.end();re&&re.length&&(O.buffer.push(re),O.length+=O.objectMode?1:re.length)}O.ended=!0,O.sync?J(I):(O.needReadable=!1,O.emittedReadable||(O.emittedReadable=!0,ve(I)))}}function J(I){var O=I._readableState;l("emitReadable",O.needReadable,O.emittedReadable),O.needReadable=!1,O.emittedReadable||(l("emitReadable",O.flowing),O.emittedReadable=!0,Ae.nextTick(ve,I))}function ve(I){var O=I._readableState;l("emitReadable_",O.destroyed,O.length,O.ended),!O.destroyed&&(O.length||O.ended)&&(I.emit("readable"),O.emittedReadable=!1),O.needReadable=!O.flowing&&!O.ended&&O.length<=O.highWaterMark,j(I)}function oe(I,O){O.readingMore||(O.readingMore=!0,Ae.nextTick(ge,I,O))}function ge(I,O){for(;!O.reading&&!O.ended&&(O.length<O.highWaterMark||O.flowing&&O.length===0);){var re=O.length;if(l("maybeReadMore read 0"),I.read(0),re===O.length)break}O.readingMore=!1}A.prototype._read=function(I){M(this,new C("_read()"))},A.prototype.pipe=function(I,O){var re=this,h=this._readableState;switch(h.pipesCount){case 0:h.pipes=I;break;case 1:h.pipes=[h.pipes,I];break;default:h.pipes.push(I);break}h.pipesCount+=1,l("pipe count=%d opts=%j",h.pipesCount,O);var q=(!O||O.end!==!1)&&I!==Ae.stdout&&I!==Ae.stderr,y=q?c:fe;h.endEmitted?Ae.nextTick(y):re.once("end",y),I.on("unpipe",u);function u(Ee,De){l("onunpipe"),Ee===re&&De&&De.hasUnpiped===!1&&(De.hasUnpiped=!0,U())}function c(){l("onend"),I.end()}var d=G(re);I.on("drain",d);var R=!1;function U(){l("cleanup"),I.removeListener("close",de),I.removeListener("finish",se),I.removeListener("drain",d),I.removeListener("error",ae),I.removeListener("unpipe",u),re.removeListener("end",c),re.removeListener("end",fe),re.removeListener("data",P),R=!0,h.awaitDrain&&(!I._writableState||I._writableState.needDrain)&&d()}re.on("data",P);function P(Ee){l("ondata");var De=I.write(Ee);l("dest.write",De),De===!1&&((h.pipesCount===1&&h.pipes===I||h.pipesCount>1&&F(h.pipes,I)!==-1)&&!R&&(l("false write response, pause",h.awaitDrain),h.awaitDrain++),re.pause())}function ae(Ee){l("onerror",Ee),fe(),I.removeListener("error",ae),e(I,"error")===0&&M(I,Ee)}V(I,"error",ae);function de(){I.removeListener("finish",se),fe()}I.once("close",de);function se(){l("onfinish"),I.removeListener("close",de),fe()}I.once("finish",se);function fe(){l("unpipe"),re.unpipe(I)}return I.emit("pipe",re),h.flowing||(l("pipe resume"),re.resume()),I};function G(I){return function(){var re=I._readableState;l("pipeOnDrain",re.awaitDrain),re.awaitDrain&&re.awaitDrain--,re.awaitDrain===0&&e(I,"data")&&(re.flowing=!0,j(I))}}A.prototype.unpipe=function(I){var O=this._readableState,re={hasUnpiped:!1};if(O.pipesCount===0)return this;if(O.pipesCount===1)return I&&I!==O.pipes?this:(I||(I=O.pipes),O.pipes=null,O.pipesCount=0,O.flowing=!1,I&&I.emit("unpipe",this,re),this);if(!I){var h=O.pipes,q=O.pipesCount;O.pipes=null,O.pipesCount=0,O.flowing=!1;for(var y=0;y<q;y++)h[y].emit("unpipe",this,{hasUnpiped:!1});return this}var u=F(O.pipes,I);return u===-1?this:(O.pipes.splice(u,1),O.pipesCount-=1,O.pipesCount===1&&(O.pipes=O.pipes[0]),I.emit("unpipe",this,re),this)},A.prototype.on=function(I,O){var re=r.prototype.on.call(this,I,O),h=this._readableState;return I==="data"?(h.readableListening=this.listenerCount("readable")>0,h.flowing!==!1&&this.resume()):I==="readable"&&!h.endEmitted&&!h.readableListening&&(h.readableListening=h.needReadable=!0,h.flowing=!1,h.emittedReadable=!1,l("on readable",h.length,h.reading),h.length?J(this):h.reading||Ae.nextTick(z,this)),re},A.prototype.addListener=A.prototype.on,A.prototype.removeListener=function(I,O){var re=r.prototype.removeListener.call(this,I,O);return I==="readable"&&Ae.nextTick(k,this),re},A.prototype.removeAllListeners=function(I){var O=r.prototype.removeAllListeners.apply(this,arguments);return(I==="readable"||I===void 0)&&Ae.nextTick(k,this),O};function k(I){var O=I._readableState;O.readableListening=I.listenerCount("readable")>0,O.resumeScheduled&&!O.paused?O.flowing=!0:I.listenerCount("data")>0&&I.resume()}function z(I){l("readable nexttick read 0"),I.read(0)}A.prototype.resume=function(){var I=this._readableState;return I.flowing||(l("resume"),I.flowing=!I.readableListening,$(this,I)),I.paused=!1,this};function $(I,O){O.resumeScheduled||(O.resumeScheduled=!0,Ae.nextTick(ie,I,O))}function ie(I,O){l("resume",O.reading),O.reading||I.read(0),O.resumeScheduled=!1,I.emit("resume"),j(I),O.flowing&&!O.reading&&I.read(0)}A.prototype.pause=function(){return l("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(l("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function j(I){var O=I._readableState;for(l("flow",O.flowing);O.flowing&&I.read()!==null;);}A.prototype.wrap=function(I){var O=this,re=this._readableState,h=!1;I.on("end",function(){if(l("wrapped end"),re.decoder&&!re.ended){var u=re.decoder.end();u&&u.length&&O.push(u)}O.push(null)}),I.on("data",function(u){if(l("wrapped data"),re.decoder&&(u=re.decoder.write(u)),!(re.objectMode&&u==null)&&!(!re.objectMode&&(!u||!u.length))){var c=O.push(u);c||(h=!0,I.pause())}});for(var q in I)this[q]===void 0&&typeof I[q]=="function"&&(this[q]=function(c){return function(){return I[c].apply(I,arguments)}}(q));for(var y=0;y<te.length;y++)I.on(te[y],this.emit.bind(this,te[y]));return this._read=function(u){l("wrapped _read",u),h&&(h=!1,I.resume())},this},typeof Symbol=="function"&&(A.prototype[Symbol.asyncIterator]=function(){return S===void 0&&(S=Ww()),S(this)}),Object.defineProperty(A.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(A.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(A.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(O){this._readableState&&(this._readableState.flowing=O)}}),A._fromList=p,Object.defineProperty(A.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function p(I,O){if(O.length===0)return null;var re;return O.objectMode?re=O.buffer.shift():!I||I>=O.length?(O.decoder?re=O.buffer.join(""):O.buffer.length===1?re=O.buffer.first():re=O.buffer.concat(O.length),O.buffer.clear()):re=O.buffer.consume(I,O.decoder),re}function f(I){var O=I._readableState;l("endReadable",O.endEmitted),O.endEmitted||(O.ended=!0,Ae.nextTick(B,O,I))}function B(I,O){if(l("endReadableNT",I.endEmitted,I.length),!I.endEmitted&&I.length===0&&(I.endEmitted=!0,O.readable=!1,O.emit("end"),I.autoDestroy)){var re=O._writableState;(!re||re.autoDestroy&&re.finished)&&O.destroy()}}typeof Symbol=="function"&&(A.from=function(I,O){return N===void 0&&(N=zw()),N(A,I,O)});function F(I,O){for(var re=0,h=I.length;re<h;re++)if(I[re]===O)return re;return-1}return ns}var is,Kf;function Rm(){if(Kf)return is;Kf=1,is=a;var t=Cn().codes,e=t.ERR_METHOD_NOT_IMPLEMENTED,r=t.ERR_MULTIPLE_CALLBACK,n=t.ERR_TRANSFORM_ALREADY_TRANSFORMING,i=t.ERR_TRANSFORM_WITH_LENGTH_0,o=_n();Ar(a,o);function s(_,b){var T=this._transformState;T.transforming=!1;var w=T.writecb;if(w===null)return this.emit("error",new r);T.writechunk=null,T.writecb=null,b!=null&&this.push(b),w(_);var x=this._readableState;x.reading=!1,(x.needReadable||x.length<x.highWaterMark)&&this._read(x.highWaterMark)}function a(_){if(!(this instanceof a))return new a(_);o.call(this,_),this._transformState={afterTransform:s.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,_&&(typeof _.transform=="function"&&(this._transform=_.transform),typeof _.flush=="function"&&(this._flush=_.flush)),this.on("prefinish",l)}function l(){var _=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(b,T){g(_,b,T)}):g(this,null,null)}a.prototype.push=function(_,b){return this._transformState.needTransform=!1,o.prototype.push.call(this,_,b)},a.prototype._transform=function(_,b,T){T(new e("_transform()"))},a.prototype._write=function(_,b,T){var w=this._transformState;if(w.writecb=T,w.writechunk=_,w.writeencoding=b,!w.transforming){var x=this._readableState;(w.needTransform||x.needReadable||x.length<x.highWaterMark)&&this._read(x.highWaterMark)}},a.prototype._read=function(_){var b=this._transformState;b.writechunk!==null&&!b.transforming?(b.transforming=!0,this._transform(b.writechunk,b.writeencoding,b.afterTransform)):b.needTransform=!0},a.prototype._destroy=function(_,b){o.prototype._destroy.call(this,_,function(T){b(T)})};function g(_,b,T){if(b)return _.emit("error",b);if(T!=null&&_.push(T),_._writableState.length)throw new i;if(_._transformState.transforming)throw new n;return _.push(null)}return is}var os,qf;function Gw(){if(qf)return os;qf=1,os=e;var t=Rm();Ar(e,t);function e(r){if(!(this instanceof e))return new e(r);t.call(this,r)}return e.prototype._transform=function(r,n,i){i(null,r)},os}var as,Yf;function $w(){if(Yf)return as;Yf=1;var t;function e(T){var w=!1;return function(){w||(w=!0,T.apply(void 0,arguments))}}var r=Cn().codes,n=r.ERR_MISSING_ARGS,i=r.ERR_STREAM_DESTROYED;function o(T){if(T)throw T}function s(T){return T.setHeader&&typeof T.abort=="function"}function a(T,w,x,v){v=e(v);var C=!1;T.on("close",function(){C=!0}),t===void 0&&(t=sd()),t(T,{readable:w,writable:x},function(D){if(D)return v(D);C=!0,v()});var m=!1;return function(D){if(!C&&!m){if(m=!0,s(T))return T.abort();if(typeof T.destroy=="function")return T.destroy();v(D||new i("pipe"))}}}function l(T){T()}function g(T,w){return T.pipe(w)}function _(T){return!T.length||typeof T[T.length-1]!="function"?o:T.pop()}function b(){for(var T=arguments.length,w=new Array(T),x=0;x<T;x++)w[x]=arguments[x];var v=_(w);if(Array.isArray(w[0])&&(w=w[0]),w.length<2)throw new n("streams");var C,m=w.map(function(D,S){var N=S<w.length-1,M=S>0;return a(D,N,M,function(te){C||(C=te),te&&m.forEach(l),!N&&(m.forEach(l),v(C))})});return w.reduce(g)}return as=b,as}var ud=St,cd=nd.EventEmitter,Vw=Ar;Vw(St,cd);St.Readable=Om();St.Writable=km();St.Duplex=_n();St.Transform=Rm();St.PassThrough=Gw();St.finished=sd();St.pipeline=$w();St.Stream=St;function St(){cd.call(this)}St.prototype.pipe=function(t,e){var r=this;function n(_){t.writable&&t.write(_)===!1&&r.pause&&r.pause()}r.on("data",n);function i(){r.readable&&r.resume&&r.resume()}t.on("drain",i),!t._isStdio&&(!e||e.end!==!1)&&(r.on("end",s),r.on("close",a));var o=!1;function s(){o||(o=!0,t.end())}function a(){o||(o=!0,typeof t.destroy=="function"&&t.destroy())}function l(_){if(g(),cd.listenerCount(this,"error")===0)throw _}r.on("error",l),t.on("error",l);function g(){r.removeListener("data",n),t.removeListener("drain",i),r.removeListener("end",s),r.removeListener("close",a),r.removeListener("error",l),t.removeListener("error",l),r.removeListener("end",g),r.removeListener("close",g),t.removeListener("close",g)}return r.on("end",g),r.on("close",g),t.on("close",g),t.emit("pipe",r),t};(function(t){(function(e){e.parser=function(p,f){return new n(p,f)},e.SAXParser=n,e.SAXStream=_,e.createStream=g,e.MAX_BUFFER_LENGTH=64*1024;var r=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];e.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function n(p,f){if(!(this instanceof n))return new n(p,f);var B=this;o(B),B.q=B.c="",B.bufferCheckPosition=e.MAX_BUFFER_LENGTH,B.opt=f||{},B.opt.lowercase=B.opt.lowercase||B.opt.lowercasetags,B.looseCase=B.opt.lowercase?"toLowerCase":"toUpperCase",B.tags=[],B.closed=B.closedRoot=B.sawRoot=!1,B.tag=B.error=null,B.strict=!!p,B.noscript=!!(p||B.opt.noscript),B.state=A.BEGIN,B.strictEntities=B.opt.strictEntities,B.ENTITIES=B.strictEntities?Object.create(e.XML_ENTITIES):Object.create(e.ENTITIES),B.attribList=[],B.opt.xmlns&&(B.ns=Object.create(v)),B.trackPosition=B.opt.position!==!1,B.trackPosition&&(B.position=B.line=B.column=0),pe(B,"onready")}Object.create||(Object.create=function(p){function f(){}f.prototype=p;var B=new f;return B}),Object.keys||(Object.keys=function(p){var f=[];for(var B in p)p.hasOwnProperty(B)&&f.push(B);return f});function i(p){for(var f=Math.max(e.MAX_BUFFER_LENGTH,10),B=0,F=0,I=r.length;F<I;F++){var O=p[r[F]].length;if(O>f)switch(r[F]){case"textNode":K(p);break;case"cdata":L(p,"oncdata",p.cdata),p.cdata="";break;case"script":L(p,"onscript",p.script),p.script="";break;default:Z(p,"Max buffer length exceeded: "+r[F])}B=Math.max(B,O)}var re=e.MAX_BUFFER_LENGTH-B;p.bufferCheckPosition=re+p.position}function o(p){for(var f=0,B=r.length;f<B;f++)p[r[f]]=""}function s(p){K(p),p.cdata!==""&&(L(p,"oncdata",p.cdata),p.cdata=""),p.script!==""&&(L(p,"onscript",p.script),p.script="")}n.prototype={end:function(){he(this)},write:j,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){s(this)}};var a;try{a=ud.Stream}catch{a=function(){}}var l=e.EVENTS.filter(function(p){return p!=="error"&&p!=="end"});function g(p,f){return new _(p,f)}function _(p,f){if(!(this instanceof _))return new _(p,f);a.apply(this),this._parser=new n(p,f),this.writable=!0,this.readable=!0;var B=this;this._parser.onend=function(){B.emit("end")},this._parser.onerror=function(F){B.emit("error",F),B._parser.error=null},this._decoder=null,l.forEach(function(F){Object.defineProperty(B,"on"+F,{get:function(){return B._parser["on"+F]},set:function(I){if(!I)return B.removeAllListeners(F),B._parser["on"+F]=I,I;B.on(F,I)},enumerable:!0,configurable:!1})})}_.prototype=Object.create(a.prototype,{constructor:{value:_}}),_.prototype.write=function(p){if(typeof Buffer=="function"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(p)){if(!this._decoder){var f=hs().StringDecoder;this._decoder=new f("utf8")}p=this._decoder.write(p)}return this._parser.write(p.toString()),this.emit("data",p),!0},_.prototype.end=function(p){return p&&p.length&&this.write(p),this._parser.end(),!0},_.prototype.on=function(p,f){var B=this;return!B._parser["on"+p]&&l.indexOf(p)!==-1&&(B._parser["on"+p]=function(){var F=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);F.splice(0,0,p),B.emit.apply(B,F)}),a.prototype.on.call(B,p,f)};var b="[CDATA[",T="DOCTYPE",w="http://www.w3.org/XML/1998/namespace",x="http://www.w3.org/2000/xmlns/",v={xml:w,xmlns:x},C=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,m=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,D=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,S=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function N(p){return p===" "||p===`
`||p==="\r"||p==="	"}function M(p){return p==='"'||p==="'"}function te(p){return p===">"||N(p)}function V(p,f){return p.test(f)}function ne(p,f){return!V(p,f)}var A=0;e.STATE={BEGIN:A++,BEGIN_WHITESPACE:A++,TEXT:A++,TEXT_ENTITY:A++,OPEN_WAKA:A++,SGML_DECL:A++,SGML_DECL_QUOTED:A++,DOCTYPE:A++,DOCTYPE_QUOTED:A++,DOCTYPE_DTD:A++,DOCTYPE_DTD_QUOTED:A++,COMMENT_STARTING:A++,COMMENT:A++,COMMENT_ENDING:A++,COMMENT_ENDED:A++,CDATA:A++,CDATA_ENDING:A++,CDATA_ENDING_2:A++,PROC_INST:A++,PROC_INST_BODY:A++,PROC_INST_ENDING:A++,OPEN_TAG:A++,OPEN_TAG_SLASH:A++,ATTRIB:A++,ATTRIB_NAME:A++,ATTRIB_NAME_SAW_WHITE:A++,ATTRIB_VALUE:A++,ATTRIB_VALUE_QUOTED:A++,ATTRIB_VALUE_CLOSED:A++,ATTRIB_VALUE_UNQUOTED:A++,ATTRIB_VALUE_ENTITY_Q:A++,ATTRIB_VALUE_ENTITY_U:A++,CLOSE_TAG:A++,CLOSE_TAG_SAW_WHITE:A++,SCRIPT:A++,SCRIPT_ENDING:A++},e.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},e.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(e.ENTITIES).forEach(function(p){var f=e.ENTITIES[p],B=typeof f=="number"?String.fromCharCode(f):f;e.ENTITIES[p]=B});for(var ce in e.STATE)e.STATE[e.STATE[ce]]=ce;A=e.STATE;function pe(p,f,B){p[f]&&p[f](B)}function L(p,f,B){p.textNode&&K(p),pe(p,f,B)}function K(p){p.textNode=E(p.opt,p.textNode),p.textNode&&pe(p,"ontext",p.textNode),p.textNode=""}function E(p,f){return p.trim&&(f=f.trim()),p.normalize&&(f=f.replace(/\s+/g," ")),f}function Z(p,f){return K(p),p.trackPosition&&(f+=`
Line: `+p.line+`
Column: `+p.column+`
Char: `+p.c),f=new Error(f),p.error=f,pe(p,"onerror",f),p}function he(p){return p.sawRoot&&!p.closedRoot&&J(p,"Unclosed root tag"),p.state!==A.BEGIN&&p.state!==A.BEGIN_WHITESPACE&&p.state!==A.TEXT&&Z(p,"Unexpected end"),K(p),p.c="",p.closed=!0,pe(p,"onend"),n.call(p,p.strict,p.opt),p}function J(p,f){if(typeof p!="object"||!(p instanceof n))throw new Error("bad call to strictFail");p.strict&&Z(p,f)}function ve(p){p.strict||(p.tagName=p.tagName[p.looseCase]());var f=p.tags[p.tags.length-1]||p,B=p.tag={name:p.tagName,attributes:{}};p.opt.xmlns&&(B.ns=f.ns),p.attribList.length=0,L(p,"onopentagstart",B)}function oe(p,f){var B=p.indexOf(":"),F=B<0?["",p]:p.split(":"),I=F[0],O=F[1];return f&&p==="xmlns"&&(I="xmlns",O=""),{prefix:I,local:O}}function ge(p){if(p.strict||(p.attribName=p.attribName[p.looseCase]()),p.attribList.indexOf(p.attribName)!==-1||p.tag.attributes.hasOwnProperty(p.attribName)){p.attribName=p.attribValue="";return}if(p.opt.xmlns){var f=oe(p.attribName,!0),B=f.prefix,F=f.local;if(B==="xmlns")if(F==="xml"&&p.attribValue!==w)J(p,"xml: prefix must be bound to "+w+`
Actual: `+p.attribValue);else if(F==="xmlns"&&p.attribValue!==x)J(p,"xmlns: prefix must be bound to "+x+`
Actual: `+p.attribValue);else{var I=p.tag,O=p.tags[p.tags.length-1]||p;I.ns===O.ns&&(I.ns=Object.create(O.ns)),I.ns[F]=p.attribValue}p.attribList.push([p.attribName,p.attribValue])}else p.tag.attributes[p.attribName]=p.attribValue,L(p,"onattribute",{name:p.attribName,value:p.attribValue});p.attribName=p.attribValue=""}function G(p,f){if(p.opt.xmlns){var B=p.tag,F=oe(p.tagName);B.prefix=F.prefix,B.local=F.local,B.uri=B.ns[F.prefix]||"",B.prefix&&!B.uri&&(J(p,"Unbound namespace prefix: "+JSON.stringify(p.tagName)),B.uri=F.prefix);var I=p.tags[p.tags.length-1]||p;B.ns&&I.ns!==B.ns&&Object.keys(B.ns).forEach(function(P){L(p,"onopennamespace",{prefix:P,uri:B.ns[P]})});for(var O=0,re=p.attribList.length;O<re;O++){var h=p.attribList[O],q=h[0],y=h[1],u=oe(q,!0),c=u.prefix,d=u.local,R=c===""?"":B.ns[c]||"",U={name:q,value:y,prefix:c,local:d,uri:R};c&&c!=="xmlns"&&!R&&(J(p,"Unbound namespace prefix: "+JSON.stringify(c)),U.uri=c),p.tag.attributes[q]=U,L(p,"onattribute",U)}p.attribList.length=0}p.tag.isSelfClosing=!!f,p.sawRoot=!0,p.tags.push(p.tag),L(p,"onopentag",p.tag),f||(!p.noscript&&p.tagName.toLowerCase()==="script"?p.state=A.SCRIPT:p.state=A.TEXT,p.tag=null,p.tagName=""),p.attribName=p.attribValue="",p.attribList.length=0}function k(p){if(!p.tagName){J(p,"Weird empty close tag."),p.textNode+="</>",p.state=A.TEXT;return}if(p.script){if(p.tagName!=="script"){p.script+="</"+p.tagName+">",p.tagName="",p.state=A.SCRIPT;return}L(p,"onscript",p.script),p.script=""}var f=p.tags.length,B=p.tagName;p.strict||(B=B[p.looseCase]());for(var F=B;f--;){var I=p.tags[f];if(I.name!==F)J(p,"Unexpected close tag");else break}if(f<0){J(p,"Unmatched closing tag: "+p.tagName),p.textNode+="</"+p.tagName+">",p.state=A.TEXT;return}p.tagName=B;for(var O=p.tags.length;O-- >f;){var re=p.tag=p.tags.pop();p.tagName=p.tag.name,L(p,"onclosetag",p.tagName);var h={};for(var q in re.ns)h[q]=re.ns[q];var y=p.tags[p.tags.length-1]||p;p.opt.xmlns&&re.ns!==y.ns&&Object.keys(re.ns).forEach(function(u){var c=re.ns[u];L(p,"onclosenamespace",{prefix:u,uri:c})})}f===0&&(p.closedRoot=!0),p.tagName=p.attribValue=p.attribName="",p.attribList.length=0,p.state=A.TEXT}function z(p){var f=p.entity,B=f.toLowerCase(),F,I="";return p.ENTITIES[f]?p.ENTITIES[f]:p.ENTITIES[B]?p.ENTITIES[B]:(f=B,f.charAt(0)==="#"&&(f.charAt(1)==="x"?(f=f.slice(2),F=parseInt(f,16),I=F.toString(16)):(f=f.slice(1),F=parseInt(f,10),I=F.toString(10))),f=f.replace(/^0+/,""),isNaN(F)||I.toLowerCase()!==f?(J(p,"Invalid character entity"),"&"+p.entity+";"):String.fromCodePoint(F))}function $(p,f){f==="<"?(p.state=A.OPEN_WAKA,p.startTagPosition=p.position):N(f)||(J(p,"Non-whitespace before first tag."),p.textNode=f,p.state=A.TEXT)}function ie(p,f){var B="";return f<p.length&&(B=p.charAt(f)),B}function j(p){var f=this;if(this.error)throw this.error;if(f.closed)return Z(f,"Cannot write after close. Assign an onready handler.");if(p===null)return he(f);typeof p=="object"&&(p=p.toString());for(var B=0,F="";F=ie(p,B++),f.c=F,!!F;)switch(f.trackPosition&&(f.position++,F===`
`?(f.line++,f.column=0):f.column++),f.state){case A.BEGIN:if(f.state=A.BEGIN_WHITESPACE,F==="\uFEFF")continue;$(f,F);continue;case A.BEGIN_WHITESPACE:$(f,F);continue;case A.TEXT:if(f.sawRoot&&!f.closedRoot){for(var I=B-1;F&&F!=="<"&&F!=="&";)F=ie(p,B++),F&&f.trackPosition&&(f.position++,F===`
`?(f.line++,f.column=0):f.column++);f.textNode+=p.substring(I,B-1)}F==="<"&&!(f.sawRoot&&f.closedRoot&&!f.strict)?(f.state=A.OPEN_WAKA,f.startTagPosition=f.position):(!N(F)&&(!f.sawRoot||f.closedRoot)&&J(f,"Text data outside of root node."),F==="&"?f.state=A.TEXT_ENTITY:f.textNode+=F);continue;case A.SCRIPT:F==="<"?f.state=A.SCRIPT_ENDING:f.script+=F;continue;case A.SCRIPT_ENDING:F==="/"?f.state=A.CLOSE_TAG:(f.script+="<"+F,f.state=A.SCRIPT);continue;case A.OPEN_WAKA:if(F==="!")f.state=A.SGML_DECL,f.sgmlDecl="";else if(!N(F))if(V(C,F))f.state=A.OPEN_TAG,f.tagName=F;else if(F==="/")f.state=A.CLOSE_TAG,f.tagName="";else if(F==="?")f.state=A.PROC_INST,f.procInstName=f.procInstBody="";else{if(J(f,"Unencoded <"),f.startTagPosition+1<f.position){var O=f.position-f.startTagPosition;F=new Array(O).join(" ")+F}f.textNode+="<"+F,f.state=A.TEXT}continue;case A.SGML_DECL:(f.sgmlDecl+F).toUpperCase()===b?(L(f,"onopencdata"),f.state=A.CDATA,f.sgmlDecl="",f.cdata=""):f.sgmlDecl+F==="--"?(f.state=A.COMMENT,f.comment="",f.sgmlDecl=""):(f.sgmlDecl+F).toUpperCase()===T?(f.state=A.DOCTYPE,(f.doctype||f.sawRoot)&&J(f,"Inappropriately located doctype declaration"),f.doctype="",f.sgmlDecl=""):F===">"?(L(f,"onsgmldeclaration",f.sgmlDecl),f.sgmlDecl="",f.state=A.TEXT):(M(F)&&(f.state=A.SGML_DECL_QUOTED),f.sgmlDecl+=F);continue;case A.SGML_DECL_QUOTED:F===f.q&&(f.state=A.SGML_DECL,f.q=""),f.sgmlDecl+=F;continue;case A.DOCTYPE:F===">"?(f.state=A.TEXT,L(f,"ondoctype",f.doctype),f.doctype=!0):(f.doctype+=F,F==="["?f.state=A.DOCTYPE_DTD:M(F)&&(f.state=A.DOCTYPE_QUOTED,f.q=F));continue;case A.DOCTYPE_QUOTED:f.doctype+=F,F===f.q&&(f.q="",f.state=A.DOCTYPE);continue;case A.DOCTYPE_DTD:f.doctype+=F,F==="]"?f.state=A.DOCTYPE:M(F)&&(f.state=A.DOCTYPE_DTD_QUOTED,f.q=F);continue;case A.DOCTYPE_DTD_QUOTED:f.doctype+=F,F===f.q&&(f.state=A.DOCTYPE_DTD,f.q="");continue;case A.COMMENT:F==="-"?f.state=A.COMMENT_ENDING:f.comment+=F;continue;case A.COMMENT_ENDING:F==="-"?(f.state=A.COMMENT_ENDED,f.comment=E(f.opt,f.comment),f.comment&&L(f,"oncomment",f.comment),f.comment=""):(f.comment+="-"+F,f.state=A.COMMENT);continue;case A.COMMENT_ENDED:F!==">"?(J(f,"Malformed comment"),f.comment+="--"+F,f.state=A.COMMENT):f.state=A.TEXT;continue;case A.CDATA:F==="]"?f.state=A.CDATA_ENDING:f.cdata+=F;continue;case A.CDATA_ENDING:F==="]"?f.state=A.CDATA_ENDING_2:(f.cdata+="]"+F,f.state=A.CDATA);continue;case A.CDATA_ENDING_2:F===">"?(f.cdata&&L(f,"oncdata",f.cdata),L(f,"onclosecdata"),f.cdata="",f.state=A.TEXT):F==="]"?f.cdata+="]":(f.cdata+="]]"+F,f.state=A.CDATA);continue;case A.PROC_INST:F==="?"?f.state=A.PROC_INST_ENDING:N(F)?f.state=A.PROC_INST_BODY:f.procInstName+=F;continue;case A.PROC_INST_BODY:if(!f.procInstBody&&N(F))continue;F==="?"?f.state=A.PROC_INST_ENDING:f.procInstBody+=F;continue;case A.PROC_INST_ENDING:F===">"?(L(f,"onprocessinginstruction",{name:f.procInstName,body:f.procInstBody}),f.procInstName=f.procInstBody="",f.state=A.TEXT):(f.procInstBody+="?"+F,f.state=A.PROC_INST_BODY);continue;case A.OPEN_TAG:V(m,F)?f.tagName+=F:(ve(f),F===">"?G(f):F==="/"?f.state=A.OPEN_TAG_SLASH:(N(F)||J(f,"Invalid character in tag name"),f.state=A.ATTRIB));continue;case A.OPEN_TAG_SLASH:F===">"?(G(f,!0),k(f)):(J(f,"Forward-slash in opening tag not followed by >"),f.state=A.ATTRIB);continue;case A.ATTRIB:if(N(F))continue;F===">"?G(f):F==="/"?f.state=A.OPEN_TAG_SLASH:V(C,F)?(f.attribName=F,f.attribValue="",f.state=A.ATTRIB_NAME):J(f,"Invalid attribute name");continue;case A.ATTRIB_NAME:F==="="?f.state=A.ATTRIB_VALUE:F===">"?(J(f,"Attribute without value"),f.attribValue=f.attribName,ge(f),G(f)):N(F)?f.state=A.ATTRIB_NAME_SAW_WHITE:V(m,F)?f.attribName+=F:J(f,"Invalid attribute name");continue;case A.ATTRIB_NAME_SAW_WHITE:if(F==="=")f.state=A.ATTRIB_VALUE;else{if(N(F))continue;J(f,"Attribute without value"),f.tag.attributes[f.attribName]="",f.attribValue="",L(f,"onattribute",{name:f.attribName,value:""}),f.attribName="",F===">"?G(f):V(C,F)?(f.attribName=F,f.state=A.ATTRIB_NAME):(J(f,"Invalid attribute name"),f.state=A.ATTRIB)}continue;case A.ATTRIB_VALUE:if(N(F))continue;M(F)?(f.q=F,f.state=A.ATTRIB_VALUE_QUOTED):(J(f,"Unquoted attribute value"),f.state=A.ATTRIB_VALUE_UNQUOTED,f.attribValue=F);continue;case A.ATTRIB_VALUE_QUOTED:if(F!==f.q){F==="&"?f.state=A.ATTRIB_VALUE_ENTITY_Q:f.attribValue+=F;continue}ge(f),f.q="",f.state=A.ATTRIB_VALUE_CLOSED;continue;case A.ATTRIB_VALUE_CLOSED:N(F)?f.state=A.ATTRIB:F===">"?G(f):F==="/"?f.state=A.OPEN_TAG_SLASH:V(C,F)?(J(f,"No whitespace between attributes"),f.attribName=F,f.attribValue="",f.state=A.ATTRIB_NAME):J(f,"Invalid attribute name");continue;case A.ATTRIB_VALUE_UNQUOTED:if(!te(F)){F==="&"?f.state=A.ATTRIB_VALUE_ENTITY_U:f.attribValue+=F;continue}ge(f),F===">"?G(f):f.state=A.ATTRIB;continue;case A.CLOSE_TAG:if(f.tagName)F===">"?k(f):V(m,F)?f.tagName+=F:f.script?(f.script+="</"+f.tagName,f.tagName="",f.state=A.SCRIPT):(N(F)||J(f,"Invalid tagname in closing tag"),f.state=A.CLOSE_TAG_SAW_WHITE);else{if(N(F))continue;ne(C,F)?f.script?(f.script+="</"+F,f.state=A.SCRIPT):J(f,"Invalid tagname in closing tag."):f.tagName=F}continue;case A.CLOSE_TAG_SAW_WHITE:if(N(F))continue;F===">"?k(f):J(f,"Invalid characters in closing tag");continue;case A.TEXT_ENTITY:case A.ATTRIB_VALUE_ENTITY_Q:case A.ATTRIB_VALUE_ENTITY_U:var re,h;switch(f.state){case A.TEXT_ENTITY:re=A.TEXT,h="textNode";break;case A.ATTRIB_VALUE_ENTITY_Q:re=A.ATTRIB_VALUE_QUOTED,h="attribValue";break;case A.ATTRIB_VALUE_ENTITY_U:re=A.ATTRIB_VALUE_UNQUOTED,h="attribValue";break}F===";"?(f[h]+=z(f),f.entity="",f.state=re):V(f.entity.length?S:D,F)?f.entity+=F:(J(f,"Invalid character in entity name"),f[h]+="&"+f.entity+F,f.entity="",f.state=re);continue;default:throw new Error(f,"Unknown state: "+f.state)}return f.position>=f.bufferCheckPosition&&i(f),f}String.fromCodePoint||function(){var p=String.fromCharCode,f=Math.floor,B=function(){var F=16384,I=[],O,re,h=-1,q=arguments.length;if(!q)return"";for(var y="";++h<q;){var u=Number(arguments[h]);if(!isFinite(u)||u<0||u>1114111||f(u)!==u)throw RangeError("Invalid code point: "+u);u<=65535?I.push(u):(u-=65536,O=(u>>10)+55296,re=u%1024+56320,I.push(O,re)),(h+1===q||I.length>F)&&(y+=p.apply(null,I),I.length=0)}return y};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:B,configurable:!0,writable:!0}):String.fromCodePoint=B}()})(t)})(um);var ld={isArray:function(t){return Array.isArray?Array.isArray(t):Object.prototype.toString.call(t)==="[object Array]"}},Kw=ld.isArray,dd={copyOptions:function(t){var e,r={};for(e in t)t.hasOwnProperty(e)&&(r[e]=t[e]);return r},ensureFlagExists:function(t,e){(!(t in e)||typeof e[t]!="boolean")&&(e[t]=!1)},ensureSpacesExists:function(t){(!("spaces"in t)||typeof t.spaces!="number"&&typeof t.spaces!="string")&&(t.spaces=0)},ensureAlwaysArrayExists:function(t){(!("alwaysArray"in t)||typeof t.alwaysArray!="boolean"&&!Kw(t.alwaysArray))&&(t.alwaysArray=!1)},ensureKeyExists:function(t,e){(!(t+"Key"in e)||typeof e[t+"Key"]!="string")&&(e[t+"Key"]=e.compact?"_"+t:t)},checkFnExists:function(t,e){return t+"Fn"in e}},qw=um,Se=dd,pn=ld.isArray,ee,Te;function Yw(t){return ee=Se.copyOptions(t),Se.ensureFlagExists("ignoreDeclaration",ee),Se.ensureFlagExists("ignoreInstruction",ee),Se.ensureFlagExists("ignoreAttributes",ee),Se.ensureFlagExists("ignoreText",ee),Se.ensureFlagExists("ignoreComment",ee),Se.ensureFlagExists("ignoreCdata",ee),Se.ensureFlagExists("ignoreDoctype",ee),Se.ensureFlagExists("compact",ee),Se.ensureFlagExists("alwaysChildren",ee),Se.ensureFlagExists("addParent",ee),Se.ensureFlagExists("trim",ee),Se.ensureFlagExists("nativeType",ee),Se.ensureFlagExists("nativeTypeAttributes",ee),Se.ensureFlagExists("sanitize",ee),Se.ensureFlagExists("instructionHasAttributes",ee),Se.ensureFlagExists("captureSpacesBetweenElements",ee),Se.ensureAlwaysArrayExists(ee),Se.ensureKeyExists("declaration",ee),Se.ensureKeyExists("instruction",ee),Se.ensureKeyExists("attributes",ee),Se.ensureKeyExists("text",ee),Se.ensureKeyExists("comment",ee),Se.ensureKeyExists("cdata",ee),Se.ensureKeyExists("doctype",ee),Se.ensureKeyExists("type",ee),Se.ensureKeyExists("name",ee),Se.ensureKeyExists("elements",ee),Se.ensureKeyExists("parent",ee),Se.checkFnExists("doctype",ee),Se.checkFnExists("instruction",ee),Se.checkFnExists("cdata",ee),Se.checkFnExists("comment",ee),Se.checkFnExists("text",ee),Se.checkFnExists("instructionName",ee),Se.checkFnExists("elementName",ee),Se.checkFnExists("attributeName",ee),Se.checkFnExists("attributeValue",ee),Se.checkFnExists("attributes",ee),ee}function Nm(t){var e=Number(t);if(!isNaN(e))return e;var r=t.toLowerCase();return r==="true"?!0:r==="false"?!1:t}function si(t,e){var r;if(ee.compact){if(!Te[ee[t+"Key"]]&&(pn(ee.alwaysArray)?ee.alwaysArray.indexOf(ee[t+"Key"])!==-1:ee.alwaysArray)&&(Te[ee[t+"Key"]]=[]),Te[ee[t+"Key"]]&&!pn(Te[ee[t+"Key"]])&&(Te[ee[t+"Key"]]=[Te[ee[t+"Key"]]]),t+"Fn"in ee&&typeof e=="string"&&(e=ee[t+"Fn"](e,Te)),t==="instruction"&&("instructionFn"in ee||"instructionNameFn"in ee)){for(r in e)if(e.hasOwnProperty(r))if("instructionFn"in ee)e[r]=ee.instructionFn(e[r],r,Te);else{var n=e[r];delete e[r],e[ee.instructionNameFn(r,n,Te)]=n}}pn(Te[ee[t+"Key"]])?Te[ee[t+"Key"]].push(e):Te[ee[t+"Key"]]=e}else{Te[ee.elementsKey]||(Te[ee.elementsKey]=[]);var i={};if(i[ee.typeKey]=t,t==="instruction"){for(r in e)if(e.hasOwnProperty(r))break;i[ee.nameKey]="instructionNameFn"in ee?ee.instructionNameFn(r,e,Te):r,ee.instructionHasAttributes?(i[ee.attributesKey]=e[r][ee.attributesKey],"instructionFn"in ee&&(i[ee.attributesKey]=ee.instructionFn(i[ee.attributesKey],r,Te))):("instructionFn"in ee&&(e[r]=ee.instructionFn(e[r],r,Te)),i[ee.instructionKey]=e[r])}else t+"Fn"in ee&&(e=ee[t+"Fn"](e,Te)),i[ee[t+"Key"]]=e;ee.addParent&&(i[ee.parentKey]=Te),Te[ee.elementsKey].push(i)}}function Lm(t){if("attributesFn"in ee&&t&&(t=ee.attributesFn(t,Te)),(ee.trim||"attributeValueFn"in ee||"attributeNameFn"in ee||ee.nativeTypeAttributes)&&t){var e;for(e in t)if(t.hasOwnProperty(e)&&(ee.trim&&(t[e]=t[e].trim()),ee.nativeTypeAttributes&&(t[e]=Nm(t[e])),"attributeValueFn"in ee&&(t[e]=ee.attributeValueFn(t[e],e,Te)),"attributeNameFn"in ee)){var r=t[e];delete t[e],t[ee.attributeNameFn(e,t[e],Te)]=r}}return t}function Xw(t){var e={};if(t.body&&(t.name.toLowerCase()==="xml"||ee.instructionHasAttributes)){for(var r=/([\w:-]+)\s*=\s*(?:"([^"]*)"|'([^']*)'|(\w+))\s*/g,n;(n=r.exec(t.body))!==null;)e[n[1]]=n[2]||n[3]||n[4];e=Lm(e)}if(t.name.toLowerCase()==="xml"){if(ee.ignoreDeclaration)return;Te[ee.declarationKey]={},Object.keys(e).length&&(Te[ee.declarationKey][ee.attributesKey]=e),ee.addParent&&(Te[ee.declarationKey][ee.parentKey]=Te)}else{if(ee.ignoreInstruction)return;ee.trim&&(t.body=t.body.trim());var i={};ee.instructionHasAttributes&&Object.keys(e).length?(i[t.name]={},i[t.name][ee.attributesKey]=e):i[t.name]=t.body,si("instruction",i)}}function Zw(t,e){var r;if(typeof t=="object"&&(e=t.attributes,t=t.name),e=Lm(e),"elementNameFn"in ee&&(t=ee.elementNameFn(t,Te)),ee.compact){if(r={},!ee.ignoreAttributes&&e&&Object.keys(e).length){r[ee.attributesKey]={};var n;for(n in e)e.hasOwnProperty(n)&&(r[ee.attributesKey][n]=e[n])}!(t in Te)&&(pn(ee.alwaysArray)?ee.alwaysArray.indexOf(t)!==-1:ee.alwaysArray)&&(Te[t]=[]),Te[t]&&!pn(Te[t])&&(Te[t]=[Te[t]]),pn(Te[t])?Te[t].push(r):Te[t]=r}else Te[ee.elementsKey]||(Te[ee.elementsKey]=[]),r={},r[ee.typeKey]="element",r[ee.nameKey]=t,!ee.ignoreAttributes&&e&&Object.keys(e).length&&(r[ee.attributesKey]=e),ee.alwaysChildren&&(r[ee.elementsKey]=[]),Te[ee.elementsKey].push(r);r[ee.parentKey]=Te,Te=r}function Qw(t){ee.ignoreText||!t.trim()&&!ee.captureSpacesBetweenElements||(ee.trim&&(t=t.trim()),ee.nativeType&&(t=Nm(t)),ee.sanitize&&(t=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),si("text",t))}function Jw(t){ee.ignoreComment||(ee.trim&&(t=t.trim()),si("comment",t))}function ey(t){var e=Te[ee.parentKey];ee.addParent||delete Te[ee.parentKey],Te=e}function ty(t){ee.ignoreCdata||(ee.trim&&(t=t.trim()),si("cdata",t))}function ry(t){ee.ignoreDoctype||(t=t.replace(/^ /,""),ee.trim&&(t=t.trim()),si("doctype",t))}function ny(t){t.note=t}var Fm=function(t,e){var r=qw.parser(!0,{}),n={};if(Te=n,ee=Yw(e),r.opt={strictEntities:!0},r.onopentag=Zw,r.ontext=Qw,r.oncomment=Jw,r.onclosetag=ey,r.onerror=ny,r.oncdata=ty,r.ondoctype=ry,r.onprocessinginstruction=Xw,r.write(t).close(),n[ee.elementsKey]){var i=n[ee.elementsKey];delete n[ee.elementsKey],n[ee.elementsKey]=i,delete n.text}return n},Xf=dd,iy=Fm;function oy(t){var e=Xf.copyOptions(t);return Xf.ensureSpacesExists(e),e}var ay=function(t,e){var r,n,i,o;return r=oy(e),n=iy(t,r),o="compact"in r&&r.compact?"_parent":"parent","addParent"in r&&r.addParent?i=JSON.stringify(n,function(s,a){return s===o?"_":a},r.spaces):i=JSON.stringify(n,null,r.spaces),i.replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")},ke=dd,sy=ld.isArray,ot,at;function uy(t){var e=ke.copyOptions(t);return ke.ensureFlagExists("ignoreDeclaration",e),ke.ensureFlagExists("ignoreInstruction",e),ke.ensureFlagExists("ignoreAttributes",e),ke.ensureFlagExists("ignoreText",e),ke.ensureFlagExists("ignoreComment",e),ke.ensureFlagExists("ignoreCdata",e),ke.ensureFlagExists("ignoreDoctype",e),ke.ensureFlagExists("compact",e),ke.ensureFlagExists("indentText",e),ke.ensureFlagExists("indentCdata",e),ke.ensureFlagExists("indentAttributes",e),ke.ensureFlagExists("indentInstruction",e),ke.ensureFlagExists("fullTagEmptyElement",e),ke.ensureFlagExists("noQuotesForNativeAttributes",e),ke.ensureSpacesExists(e),typeof e.spaces=="number"&&(e.spaces=Array(e.spaces+1).join(" ")),ke.ensureKeyExists("declaration",e),ke.ensureKeyExists("instruction",e),ke.ensureKeyExists("attributes",e),ke.ensureKeyExists("text",e),ke.ensureKeyExists("comment",e),ke.ensureKeyExists("cdata",e),ke.ensureKeyExists("doctype",e),ke.ensureKeyExists("type",e),ke.ensureKeyExists("name",e),ke.ensureKeyExists("elements",e),ke.checkFnExists("doctype",e),ke.checkFnExists("instruction",e),ke.checkFnExists("cdata",e),ke.checkFnExists("comment",e),ke.checkFnExists("text",e),ke.checkFnExists("instructionName",e),ke.checkFnExists("elementName",e),ke.checkFnExists("attributeName",e),ke.checkFnExists("attributeValue",e),ke.checkFnExists("attributes",e),ke.checkFnExists("fullTagEmptyElement",e),e}function Wt(t,e,r){return(!r&&t.spaces?`
`:"")+Array(e+1).join(t.spaces)}function jo(t,e,r){if(e.ignoreAttributes)return"";"attributesFn"in e&&(t=e.attributesFn(t,at,ot));var n,i,o,s,a=[];for(n in t)t.hasOwnProperty(n)&&t[n]!==null&&t[n]!==void 0&&(s=e.noQuotesForNativeAttributes&&typeof t[n]!="string"?"":'"',i=""+t[n],i=i.replace(/"/g,"&quot;"),o="attributeNameFn"in e?e.attributeNameFn(n,i,at,ot):n,a.push(e.spaces&&e.indentAttributes?Wt(e,r+1,!1):" "),a.push(o+"="+s+("attributeValueFn"in e?e.attributeValueFn(i,n,at,ot):i)+s));return t&&Object.keys(t).length&&e.spaces&&e.indentAttributes&&a.push(Wt(e,r,!1)),a.join("")}function Pm(t,e,r){return ot=t,at="xml",e.ignoreDeclaration?"":"<?xml"+jo(t[e.attributesKey],e,r)+"?>"}function Mm(t,e,r){if(e.ignoreInstruction)return"";var n;for(n in t)if(t.hasOwnProperty(n))break;var i="instructionNameFn"in e?e.instructionNameFn(n,t[n],at,ot):n;if(typeof t[n]=="object")return ot=t,at=i,"<?"+i+jo(t[n][e.attributesKey],e,r)+"?>";var o=t[n]?t[n]:"";return"instructionFn"in e&&(o=e.instructionFn(o,n,at,ot)),"<?"+i+(o?" "+o:"")+"?>"}function Bm(t,e){return e.ignoreComment?"":"<!--"+("commentFn"in e?e.commentFn(t,at,ot):t)+"-->"}function Um(t,e){return e.ignoreCdata?"":"<![CDATA["+("cdataFn"in e?e.cdataFn(t,at,ot):t.replace("]]>","]]]]><![CDATA[>"))+"]]>"}function jm(t,e){return e.ignoreDoctype?"":"<!DOCTYPE "+("doctypeFn"in e?e.doctypeFn(t,at,ot):t)+">"}function hd(t,e){return e.ignoreText?"":(t=""+t,t=t.replace(/&amp;/g,"&"),t=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"textFn"in e?e.textFn(t,at,ot):t)}function cy(t,e){var r;if(t.elements&&t.elements.length)for(r=0;r<t.elements.length;++r)switch(t.elements[r][e.typeKey]){case"text":if(e.indentText)return!0;break;case"cdata":if(e.indentCdata)return!0;break;case"instruction":if(e.indentInstruction)return!0;break;case"doctype":case"comment":case"element":return!0;default:return!0}return!1}function ly(t,e,r){ot=t,at=t.name;var n=[],i="elementNameFn"in e?e.elementNameFn(t.name,t):t.name;n.push("<"+i),t[e.attributesKey]&&n.push(jo(t[e.attributesKey],e,r));var o=t[e.elementsKey]&&t[e.elementsKey].length||t[e.attributesKey]&&t[e.attributesKey]["xml:space"]==="preserve";return o||("fullTagEmptyElementFn"in e?o=e.fullTagEmptyElementFn(t.name,t):o=e.fullTagEmptyElement),o?(n.push(">"),t[e.elementsKey]&&t[e.elementsKey].length&&(n.push(Hm(t[e.elementsKey],e,r+1)),ot=t,at=t.name),n.push(e.spaces&&cy(t,e)?`
`+Array(r+1).join(e.spaces):""),n.push("</"+i+">")):n.push("/>"),n.join("")}function Hm(t,e,r,n){return t.reduce(function(i,o){var s=Wt(e,r,n&&!i);switch(o.type){case"element":return i+s+ly(o,e,r);case"comment":return i+s+Bm(o[e.commentKey],e);case"doctype":return i+s+jm(o[e.doctypeKey],e);case"cdata":return i+(e.indentCdata?s:"")+Um(o[e.cdataKey],e);case"text":return i+(e.indentText?s:"")+hd(o[e.textKey],e);case"instruction":var a={};return a[o[e.nameKey]]=o[e.attributesKey]?o:o[e.instructionKey],i+(e.indentInstruction?s:"")+Mm(a,e,r)}},"")}function Wm(t,e,r){var n;for(n in t)if(t.hasOwnProperty(n))switch(n){case e.parentKey:case e.attributesKey:break;case e.textKey:if(e.indentText||r)return!0;break;case e.cdataKey:if(e.indentCdata||r)return!0;break;case e.instructionKey:if(e.indentInstruction||r)return!0;break;case e.doctypeKey:case e.commentKey:return!0;default:return!0}return!1}function dy(t,e,r,n,i){ot=t,at=e;var o="elementNameFn"in r?r.elementNameFn(e,t):e;if(typeof t>"u"||t===null||t==="")return"fullTagEmptyElementFn"in r&&r.fullTagEmptyElementFn(e,t)||r.fullTagEmptyElement?"<"+o+"></"+o+">":"<"+o+"/>";var s=[];if(e){if(s.push("<"+o),typeof t!="object")return s.push(">"+hd(t,r)+"</"+o+">"),s.join("");t[r.attributesKey]&&s.push(jo(t[r.attributesKey],r,n));var a=Wm(t,r,!0)||t[r.attributesKey]&&t[r.attributesKey]["xml:space"]==="preserve";if(a||("fullTagEmptyElementFn"in r?a=r.fullTagEmptyElementFn(e,t):a=r.fullTagEmptyElement),a)s.push(">");else return s.push("/>"),s.join("")}return s.push(zm(t,r,n+1,!1)),ot=t,at=e,e&&s.push((i?Wt(r,n,!1):"")+"</"+o+">"),s.join("")}function zm(t,e,r,n){var i,o,s,a=[];for(o in t)if(t.hasOwnProperty(o))for(s=sy(t[o])?t[o]:[t[o]],i=0;i<s.length;++i){switch(o){case e.declarationKey:a.push(Pm(s[i],e,r));break;case e.instructionKey:a.push((e.indentInstruction?Wt(e,r,n):"")+Mm(s[i],e,r));break;case e.attributesKey:case e.parentKey:break;case e.textKey:a.push((e.indentText?Wt(e,r,n):"")+hd(s[i],e));break;case e.cdataKey:a.push((e.indentCdata?Wt(e,r,n):"")+Um(s[i],e));break;case e.doctypeKey:a.push(Wt(e,r,n)+jm(s[i],e));break;case e.commentKey:a.push(Wt(e,r,n)+Bm(s[i],e));break;default:a.push(Wt(e,r,n)+dy(s[i],o,e,r,Wm(s[i],e)))}n=n&&!a.length}return a.join("")}var Gm=function(t,e){e=uy(e);var r=[];return ot=t,at="_root_",e.compact?r.push(zm(t,e,0,!0)):(t[e.declarationKey]&&r.push(Pm(t[e.declarationKey],e,0)),t[e.elementsKey]&&t[e.elementsKey].length&&r.push(Hm(t[e.elementsKey],e,0,!r.length))),r.join("")},hy=Gm,fy=function(t,e){t instanceof Buffer&&(t=t.toString());var r=null;if(typeof t=="string")try{r=JSON.parse(t)}catch{throw new Error("The JSON structure is invalid")}else r=t;return hy(r,e)},my=Fm,py=ay,gy=Gm,wy=fy,$m={xml2js:my,xml2json:py,js2xml:gy,json2xml:wy},fd=t=>{switch(t.type){case void 0:case"element":let e=new ms(t.name,t.attributes),r=t.elements||[];for(let n of r){let i=fd(n);i!==void 0&&e.push(i)}return e;case"text":return t.text;default:return}},fs=class extends me{},ms=class extends Y{static fromXmlString(e){let r=$m.xml2js(e,{compact:!1});return fd(r)}constructor(e,r){super(e),r&&this.root.push(new fs(r))}push(e){this.root.push(e)}},ps=class extends Y{constructor(e){super(""),this._attr=e}prepForXml(e){return{_attr:this._attr}}};var so=class extends Y{constructor(e,r){super(e),r&&(this.root=r.root)}},st=t=>{if(isNaN(t))throw new Error(`Invalid value '${t}' specified. Must be an integer.`);return Math.floor(t)},Ho=t=>{let e=st(t);if(e<0)throw new Error(`Invalid value '${t}' specified. Must be a positive integer.`);return e},Vm=(t,e)=>{let r=e*2;if(t.length!==r||isNaN(+`0x${t}`))throw new Error(`Invalid hex value '${t}'. Expected ${r} digit hex value`);return t};var Zf=t=>Vm(t,1),md=t=>{let e=t.slice(-2),r=t.substring(0,t.length-2);return`${Number(r)}${e}`},Km=t=>{let e=md(t);if(parseFloat(e)<0)throw new Error(`Invalid value '${e}' specified. Expected a positive number.`);return e},vn=t=>{if(t==="auto")return t;let e=t.charAt(0)==="#"?t.substring(1):t;return Vm(e,3)},er=t=>typeof t=="string"?md(t):st(t),yy=t=>typeof t=="string"?Km(t):Ho(t);var it=t=>typeof t=="string"?Km(t):Ho(t),_y=t=>{let e=t.substring(0,t.length-1);return`${Number(e)}%`},vy=t=>typeof t=="number"?st(t):t.slice(-1)==="%"?_y(t):md(t),by=Ho,Ey=Ho,xy=t=>t.toISOString(),ue=class extends Y{constructor(e,r=!0){super(e),r!==!0&&this.root.push(new Ue({val:r}))}},Yn=class extends Y{constructor(e,r){super(e),this.root.push(new Ue({val:yy(r)}))}};var rr=class extends Y{constructor(e,r){super(e),this.root.push(new Ue({val:r}))}},Vn=(t,e)=>new nt({name:t,attributes:{value:{key:"w:val",value:e}}}),Jn=class extends Y{constructor(e,r){super(e),this.root.push(new Ue({val:r}))}},gs=class extends Y{constructor(e,r){super(e),this.root.push(new Ue({val:r}))}},Qt=class extends Y{constructor(e,r){super(e),this.root.push(r)}},nt=class extends Y{constructor({name:e,attributes:r,children:n}){super(e),r&&this.root.push(new Ot(r)),n&&this.root.push(...n)}},pt={START:"start",CENTER:"center",END:"end",BOTH:"both",MEDIUM_KASHIDA:"mediumKashida",DISTRIBUTE:"distribute",NUM_TAB:"numTab",HIGH_KASHIDA:"highKashida",LOW_KASHIDA:"lowKashida",THAI_DISTRIBUTE:"thaiDistribute",LEFT:"left",RIGHT:"right",JUSTIFIED:"both"},ws=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{val:"w:val"})}},uo=class extends Y{constructor(e){super("w:jc"),this.root.push(new ws({val:e}))}},Ne=class extends Y{constructor(e,{color:r,size:n,space:i,style:o}){super(e),this.root.push(new ys({style:o,color:r===void 0?void 0:vn(r),size:n===void 0?void 0:by(n),space:i===void 0?void 0:Ey(i)}))}},ys=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{style:"w:val",color:"w:color",size:"w:sz",space:"w:space"})}},pd={SINGLE:"single",DASH_DOT_STROKED:"dashDotStroked",DASHED:"dashed",DASH_SMALL_GAP:"dashSmallGap",DOT_DASH:"dotDash",DOT_DOT_DASH:"dotDotDash",DOTTED:"dotted",DOUBLE:"double",DOUBLE_WAVE:"doubleWave",INSET:"inset",NIL:"nil",NONE:"none",OUTSET:"outset",THICK:"thick",THICK_THIN_LARGE_GAP:"thickThinLargeGap",THICK_THIN_MEDIUM_GAP:"thickThinMediumGap",THICK_THIN_SMALL_GAP:"thickThinSmallGap",THIN_THICK_LARGE_GAP:"thinThickLargeGap",THIN_THICK_MEDIUM_GAP:"thinThickMediumGap",THIN_THICK_SMALL_GAP:"thinThickSmallGap",THIN_THICK_THIN_LARGE_GAP:"thinThickThinLargeGap",THIN_THICK_THIN_MEDIUM_GAP:"thinThickThinMediumGap",THIN_THICK_THIN_SMALL_GAP:"thinThickThinSmallGap",THREE_D_EMBOSS:"threeDEmboss",THREE_D_ENGRAVE:"threeDEngrave",TRIPLE:"triple",WAVE:"wave"},_s=class extends kt{constructor(e){super("w:pBdr"),e.top&&this.root.push(new Ne("w:top",e.top)),e.bottom&&this.root.push(new Ne("w:bottom",e.bottom)),e.left&&this.root.push(new Ne("w:left",e.left)),e.right&&this.root.push(new Ne("w:right",e.right))}},vs=class extends Y{constructor(){super("w:pBdr");let e=new Ne("w:bottom",{color:"auto",space:1,style:pd.SINGLE,size:6});this.root.push(e)}},bs=class extends Y{constructor({start:e,end:r,left:n,right:i,hanging:o,firstLine:s}){super("w:ind"),this.root.push(new Ot({start:{key:"w:start",value:e===void 0?void 0:er(e)},end:{key:"w:end",value:r===void 0?void 0:er(r)},left:{key:"w:left",value:n===void 0?void 0:er(n)},right:{key:"w:right",value:i===void 0?void 0:er(i)},hanging:{key:"w:hanging",value:o===void 0?void 0:it(o)},firstLine:{key:"w:firstLine",value:s===void 0?void 0:it(s)}}))}},Dy=class extends Y{constructor(){super("w:br")}},gd={BEGIN:"begin",END:"end",SEPARATE:"separate"},ei=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{type:"w:fldCharType",dirty:"w:dirty"})}},ln=class extends Y{constructor(e){super("w:fldChar"),this.root.push(new ei({type:gd.BEGIN,dirty:e}))}},dn=class extends Y{constructor(e){super("w:fldChar"),this.root.push(new ei({type:gd.SEPARATE,dirty:e}))}},hn=class extends Y{constructor(e){super("w:fldChar"),this.root.push(new ei({type:gd.END,dirty:e}))}};var bn={DEFAULT:"default",PRESERVE:"preserve"},gr=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{space:"xml:space"})}},Es=class extends Y{constructor(){super("w:instrText"),this.root.push(new gr({space:bn.PRESERVE})),this.root.push("PAGE")}},xs=class extends Y{constructor(){super("w:instrText"),this.root.push(new gr({space:bn.PRESERVE})),this.root.push("NUMPAGES")}},Ds=class extends Y{constructor(){super("w:instrText"),this.root.push(new gr({space:bn.PRESERVE})),this.root.push("SECTIONPAGES")}},Ts=class extends Y{constructor(){super("w:instrText"),this.root.push(new gr({space:bn.PRESERVE})),this.root.push("SECTION")}},Cs=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{fill:"w:fill",color:"w:color",type:"w:val"})}},En=class extends Y{constructor({fill:e,color:r,type:n}){super("w:shd"),this.root.push(new Cs({fill:e===void 0?void 0:vn(e),color:r===void 0?void 0:vn(r),type:n}))}};var Ss=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{id:"w:id",author:"w:author",date:"w:date"})}},Ty={DOT:"dot"},As=class extends Y{constructor(e){super("w:em"),this.root.push(new Ue({val:e}))}},Is=class extends As{constructor(e=Ty.DOT){super(e)}};var ks=class extends Y{constructor(e){super("w:spacing"),this.root.push(new Ue({val:er(e)}))}},Os=class extends Y{constructor(e){super("w:color"),this.root.push(new Ue({val:vn(e)}))}},Rs=class extends Y{constructor(e){super("w:highlight"),this.root.push(new Ue({val:e}))}},Ns=class extends Y{constructor(e){super("w:highlightCs"),this.root.push(new Ue({val:e}))}},Cy=t=>new nt({name:"w:lang",attributes:{value:{key:"w:val",value:t.value},eastAsia:{key:"w:eastAsia",value:t.eastAsia},bidirectional:{key:"w:bidi",value:t.bidirectional}}}),co=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{ascii:"w:ascii",cs:"w:cs",eastAsia:"w:eastAsia",hAnsi:"w:hAnsi",hint:"w:hint"})}},Xn=class extends Y{constructor(e,r){if(super("w:rFonts"),typeof e=="string"){let n=e;this.root.push(new co({ascii:n,cs:n,eastAsia:n,hAnsi:n,hint:r}))}else{let n=e;this.root.push(new co(n))}}},qm=class extends Y{constructor(e){super("w:vertAlign"),this.root.push(new Ue({val:e}))}},Ls=class extends qm{constructor(){super("superscript")}},Fs=class extends qm{constructor(){super("subscript")}},Ym={SINGLE:"single",WORDS:"words",DOUBLE:"double",THICK:"thick",DOTTED:"dotted",DOTTEDHEAVY:"dottedHeavy",DASH:"dash",DASHEDHEAVY:"dashedHeavy",DASHLONG:"dashLong",DASHLONGHEAVY:"dashLongHeavy",DOTDASH:"dotDash",DASHDOTHEAVY:"dashDotHeavy",DOTDOTDASH:"dotDotDash",DASHDOTDOTHEAVY:"dashDotDotHeavy",WAVE:"wave",WAVYHEAVY:"wavyHeavy",WAVYDOUBLE:"wavyDouble",NONE:"none"},Ps=class extends Y{constructor(e=Ym.SINGLE,r){super("w:u"),this.root.push(new Ue({val:e,color:r===void 0?void 0:vn(r)}))}};var nr=class extends kt{constructor(e){var r,n;if(super("w:rPr"),!e)return;e.noProof!==void 0&&this.push(new ue("w:noProof",e.noProof)),e.bold!==void 0&&this.push(new ue("w:b",e.bold)),(e.boldComplexScript===void 0&&e.bold!==void 0||e.boldComplexScript)&&this.push(new ue("w:bCs",(r=e.boldComplexScript)!=null?r:e.bold)),e.italics!==void 0&&this.push(new ue("w:i",e.italics)),(e.italicsComplexScript===void 0&&e.italics!==void 0||e.italicsComplexScript)&&this.push(new ue("w:iCs",(n=e.italicsComplexScript)!=null?n:e.italics)),e.underline&&this.push(new Ps(e.underline.type,e.underline.color)),e.effect&&this.push(new rr("w:effect",e.effect)),e.emphasisMark&&this.push(new Is(e.emphasisMark.type)),e.color&&this.push(new Os(e.color)),e.kern&&this.push(new Yn("w:kern",e.kern)),e.position&&this.push(new rr("w:position",e.position)),e.size!==void 0&&this.push(new Yn("w:sz",e.size));let i=e.sizeComplexScript===void 0||e.sizeComplexScript===!0?e.size:e.sizeComplexScript;i&&this.push(new Yn("w:szCs",i)),e.rightToLeft!==void 0&&this.push(new ue("w:rtl",e.rightToLeft)),e.smallCaps!==void 0?this.push(new ue("w:smallCaps",e.smallCaps)):e.allCaps!==void 0&&this.push(new ue("w:caps",e.allCaps)),e.strike!==void 0&&this.push(new ue("w:strike",e.strike)),e.doubleStrike!==void 0&&this.push(new ue("w:dstrike",e.doubleStrike)),e.subScript&&this.push(new Fs),e.superScript&&this.push(new Ls),e.style&&this.push(new rr("w:rStyle",e.style)),e.font&&(typeof e.font=="string"?this.push(new Xn(e.font)):"name"in e.font?this.push(new Xn(e.font.name,e.font.hint)):this.push(new Xn(e.font))),e.highlight&&this.push(new Rs(e.highlight));let o=e.highlightComplexScript===void 0||e.highlightComplexScript===!0?e.highlight:e.highlightComplexScript;o&&this.push(new Ns(o)),e.characterSpacing&&this.push(new ks(e.characterSpacing)),e.emboss!==void 0&&this.push(new ue("w:emboss",e.emboss)),e.imprint!==void 0&&this.push(new ue("w:imprint",e.imprint)),e.shading&&this.push(new En(e.shading)),e.revision&&this.push(new Ms(e.revision)),e.border&&this.push(new Ne("w:bdr",e.border)),e.snapToGrid!==void 0&&this.push(new ue("w:snapToGrid",e.snapToGrid)),e.vanish&&this.push(new ue("w:vanish",e.vanish)),e.specVanish&&this.push(new ue("w:specVanish",e.vanish)),e.scale!==void 0&&this.push(new Jn("w:w",e.scale)),e.language&&this.push(Cy(e.language)),e.math&&this.push(new ue("w:oMath",e.math))}push(e){this.root.push(e)}},Ms=class extends Y{constructor(e){super("w:rPrChange"),this.root.push(new Ss({id:e.id,author:e.author,date:e.date})),this.addChildElement(new nr(e))}},ti=class extends Y{constructor(e){var r;return super("w:t"),typeof e=="string"?(this.root.push(new gr({space:bn.PRESERVE})),this.root.push(e),this):(this.root.push(new gr({space:(r=e.space)!=null?r:bn.DEFAULT})),this.root.push(e.text),this)}},eo={CURRENT:"CURRENT",TOTAL_PAGES:"TOTAL_PAGES",TOTAL_PAGES_IN_SECTION:"TOTAL_PAGES_IN_SECTION",CURRENT_SECTION:"SECTION"},Tr=class extends Y{constructor(e){if(super("w:r"),X(this,"properties"),this.properties=new nr(e),this.root.push(this.properties),e.break)for(let r=0;r<e.break;r++)this.root.push(new Dy);if(e.children)for(let r of e.children){if(typeof r=="string"){switch(r){case eo.CURRENT:this.root.push(new ln),this.root.push(new Es),this.root.push(new dn),this.root.push(new hn);break;case eo.TOTAL_PAGES:this.root.push(new ln),this.root.push(new xs),this.root.push(new dn),this.root.push(new hn);break;case eo.TOTAL_PAGES_IN_SECTION:this.root.push(new ln),this.root.push(new Ds),this.root.push(new dn),this.root.push(new hn);break;case eo.CURRENT_SECTION:this.root.push(new ln),this.root.push(new Ts),this.root.push(new dn),this.root.push(new hn);break;default:this.root.push(new ti(r));break}continue}this.root.push(r)}else e.text&&this.root.push(new ti(e.text))}},Cr=class extends Tr{constructor(e){if(typeof e=="string")return super({}),this.root.push(new ti(e)),this;super(e)}};var Sy="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",Ay=(t,e=21)=>(r=e)=>{let n="",i=r;for(;i--;)n+=t[Math.random()*t.length|0];return n},Iy=(t=21)=>{let e="",r=t;for(;r--;)e+=Sy[Math.random()*64|0];return e};var It=t=>Math.floor(t*72*20),Wo=(t=0)=>{let e=t;return()=>++e},ky=()=>Wo(),Oy=()=>Wo(1),Ry=()=>Wo(),Ny=()=>Wo(),Xm=()=>Iy().toLowerCase(),Kn=t=>Ay("1234567890abcdef",t)(),Ly=()=>`${Kn(8)}-${Kn(4)}-${Kn(4)}-${Kn(4)}-${Kn(12)}`,Fy={CHARACTER:"character",COLUMN:"column",INSIDE_MARGIN:"insideMargin",LEFT_MARGIN:"leftMargin",MARGIN:"margin",OUTSIDE_MARGIN:"outsideMargin",PAGE:"page",RIGHT_MARGIN:"rightMargin"},Py={BOTTOM_MARGIN:"bottomMargin",INSIDE_MARGIN:"insideMargin",LINE:"line",MARGIN:"margin",OUTSIDE_MARGIN:"outsideMargin",PAGE:"page",PARAGRAPH:"paragraph",TOP_MARGIN:"topMargin"},Bs=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{x:"x",y:"y"})}},Us=class extends Y{constructor(){super("wp:simplePos"),this.root.push(new Bs({x:0,y:0}))}},lo=class extends Y{constructor(e){super("wp:align"),this.root.push(e)}},ho=class extends Y{constructor(e){super("wp:posOffset"),this.root.push(e.toString())}},js=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{relativeFrom:"relativeFrom"})}},Hs=class extends Y{constructor(e){if(super("wp:positionH"),this.root.push(new js({relativeFrom:e.relative||Fy.PAGE})),e.align)this.root.push(new lo(e.align));else if(e.offset!==void 0)this.root.push(new ho(e.offset));else throw new Error("There is no configuration provided for floating position (Align or offset)")}},Ws=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{relativeFrom:"relativeFrom"})}},zs=class extends Y{constructor(e){if(super("wp:positionV"),this.root.push(new Ws({relativeFrom:e.relative||Py.PAGE})),e.align)this.root.push(new lo(e.align));else if(e.offset!==void 0)this.root.push(new ho(e.offset));else throw new Error("There is no configuration provided for floating position (Align or offset)")}},Gs=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{uri:"uri"})}},$s=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{embed:"r:embed",cstate:"cstate"})}},Vs=class extends Y{constructor(e){super("a:blip"),this.root.push(new $s({embed:`rId{${e.fileName}}`,cstate:"none"}))}},Ks=class extends Y{constructor(){super("a:srcRect")}},qs=class extends Y{constructor(){super("a:fillRect")}},Ys=class extends Y{constructor(){super("a:stretch"),this.root.push(new qs)}},Xs=class extends Y{constructor(e){super("pic:blipFill"),this.root.push(new Vs(e)),this.root.push(new Ks),this.root.push(new Ys)}},Zs=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{noChangeAspect:"noChangeAspect",noChangeArrowheads:"noChangeArrowheads"})}},Qs=class extends Y{constructor(){super("a:picLocks"),this.root.push(new Zs({noChangeAspect:1,noChangeArrowheads:1}))}},Js=class extends Y{constructor(){super("pic:cNvPicPr"),this.root.push(new Qs)}},Zm=(t,e)=>new nt({name:"a:hlinkClick",attributes:wn(Oe({},e?{xmlns:{key:"xmlns:a",value:"http://schemas.openxmlformats.org/drawingml/2006/main"}}:{}),{id:{key:"r:id",value:`rId${t}`}})}),eu=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{id:"id",name:"name",descr:"descr"})}},tu=class extends Y{constructor(){super("pic:cNvPr"),this.root.push(new eu({id:0,name:"",descr:""}))}prepForXml(e){for(let r=e.stack.length-1;r>=0;r--){let n=e.stack[r];if(n instanceof ri){this.root.push(Zm(n.linkId,!1));break}}return super.prepForXml(e)}},ru=class extends Y{constructor(){super("pic:nvPicPr"),this.root.push(new tu),this.root.push(new Js)}},nu=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{xmlns:"xmlns:pic"})}},iu=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{cx:"cx",cy:"cy"})}},ou=class extends Y{constructor(e,r){super("a:ext"),X(this,"attributes"),this.attributes=new iu({cx:e,cy:r}),this.root.push(this.attributes)}},au=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{x:"x",y:"y"})}},su=class extends Y{constructor(){super("a:off"),this.root.push(new au({x:0,y:0}))}},uu=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{flipVertical:"flipV",flipHorizontal:"flipH",rotation:"rot"})}},cu=class extends Y{constructor(e){var r,n;super("a:xfrm"),X(this,"extents"),this.root.push(new uu({flipVertical:(r=e.flip)==null?void 0:r.vertical,flipHorizontal:(n=e.flip)==null?void 0:n.horizontal,rotation:e.rotation})),this.extents=new ou(e.emus.x,e.emus.y),this.root.push(new su),this.root.push(this.extents)}},Qm=()=>new nt({name:"a:noFill"}),My=t=>new nt({name:"a:schemeClr",attributes:{value:{key:"val",value:t.value}}}),By=t=>new nt({name:"a:srgbClr",attributes:{value:{key:"val",value:t.value}}}),Qf=t=>new nt({name:"a:solidFill",children:[t.type==="rgb"?By(t):My(t)]}),Uy=t=>new nt({name:"a:ln",attributes:{width:{key:"w",value:t.width},cap:{key:"cap",value:t.cap},compoundLine:{key:"cmpd",value:t.compoundLine},align:{key:"algn",value:t.align}},children:[t.type==="noFill"?Qm():t.solidFillType==="rgb"?Qf({type:"rgb",value:t.value}):Qf({type:"scheme",value:t.value})]}),lu=class extends Y{constructor(){super("a:avLst")}},du=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{prst:"prst"})}},hu=class extends Y{constructor(){super("a:prstGeom"),this.root.push(new du({prst:"rect"})),this.root.push(new lu)}},fu=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{bwMode:"bwMode"})}},mu=class extends Y{constructor({outline:e,transform:r}){super("pic:spPr"),X(this,"form"),this.root.push(new fu({bwMode:"auto"})),this.form=new cu(r),this.root.push(this.form),this.root.push(new hu),e&&(this.root.push(Qm()),this.root.push(Uy(e)))}},pu=class extends Y{constructor({mediaData:e,transform:r,outline:n}){super("pic:pic"),this.root.push(new nu({xmlns:"http://schemas.openxmlformats.org/drawingml/2006/picture"})),this.root.push(new ru),this.root.push(new Xs(e)),this.root.push(new mu({transform:r,outline:n}))}},gu=class extends Y{constructor({mediaData:e,transform:r,outline:n}){super("a:graphicData"),X(this,"pic"),this.root.push(new Gs({uri:"http://schemas.openxmlformats.org/drawingml/2006/picture"})),this.pic=new pu({mediaData:e,transform:r,outline:n}),this.root.push(this.pic)}},wu=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{a:"xmlns:a"})}},fo=class extends Y{constructor({mediaData:e,transform:r,outline:n}){super("a:graphic"),X(this,"data"),this.root.push(new wu({a:"http://schemas.openxmlformats.org/drawingml/2006/main"})),this.data=new gu({mediaData:e,transform:r,outline:n}),this.root.push(this.data)}},to={NONE:0,SQUARE:1,TIGHT:2,TOP_AND_BOTTOM:3},jy={BOTH_SIDES:"bothSides",LEFT:"left",RIGHT:"right",LARGEST:"largest"},mo=class extends Y{constructor(){super("wp:wrapNone")}},yu=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{distT:"distT",distB:"distB",distL:"distL",distR:"distR",wrapText:"wrapText"})}},_u=class extends Y{constructor(e,r={top:0,bottom:0,left:0,right:0}){super("wp:wrapSquare"),this.root.push(new yu({wrapText:e.side||jy.BOTH_SIDES,distT:r.top,distB:r.bottom,distL:r.left,distR:r.right}))}},vu=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{distT:"distT",distB:"distB"})}},bu=class extends Y{constructor(e={top:0,bottom:0}){super("wp:wrapTight"),this.root.push(new vu({distT:e.top,distB:e.bottom}))}},Eu=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{distT:"distT",distB:"distB"})}},xu=class extends Y{constructor(e={top:0,bottom:0}){super("wp:wrapTopAndBottom"),this.root.push(new Eu({distT:e.top,distB:e.bottom}))}},po=class extends Y{constructor({name:e,description:r,title:n}={name:"",description:"",title:""}){super("wp:docPr"),X(this,"docPropertiesUniqueNumericId",Ry()),this.root.push(new Ot({id:{key:"id",value:this.docPropertiesUniqueNumericId()},name:{key:"name",value:e},description:{key:"descr",value:r},title:{key:"title",value:n}}))}prepForXml(e){for(let r=e.stack.length-1;r>=0;r--){let n=e.stack[r];if(n instanceof ri){this.root.push(Zm(n.linkId,!0));break}}return super.prepForXml(e)}},Jm=({top:t,right:e,bottom:r,left:n})=>new nt({name:"wp:effectExtent",attributes:{top:{key:"t",value:t},right:{key:"r",value:e},bottom:{key:"b",value:r},left:{key:"l",value:n}}}),Du=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{cx:"cx",cy:"cy"})}},go=class extends Y{constructor(e,r){super("wp:extent"),X(this,"attributes"),this.attributes=new Du({cx:e,cy:r}),this.root.push(this.attributes)}},Tu=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{xmlns:"xmlns:a",noChangeAspect:"noChangeAspect"})}},Cu=class extends Y{constructor(){super("a:graphicFrameLocks"),this.root.push(new Tu({xmlns:"http://schemas.openxmlformats.org/drawingml/2006/main",noChangeAspect:1}))}},wo=class extends Y{constructor(){super("wp:cNvGraphicFramePr"),this.root.push(new Cu)}},Su=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{distT:"distT",distB:"distB",distL:"distL",distR:"distR",allowOverlap:"allowOverlap",behindDoc:"behindDoc",layoutInCell:"layoutInCell",locked:"locked",relativeHeight:"relativeHeight",simplePos:"simplePos"})}},Au=class extends Y{constructor({mediaData:e,transform:r,drawingOptions:n}){super("wp:anchor");let i=Oe({allowOverlap:!0,behindDocument:!1,lockAnchor:!1,layoutInCell:!0,verticalPosition:{},horizontalPosition:{}},n.floating);if(this.root.push(new Su({distT:i.margins&&i.margins.top||0,distB:i.margins&&i.margins.bottom||0,distL:i.margins&&i.margins.left||0,distR:i.margins&&i.margins.right||0,simplePos:"0",allowOverlap:i.allowOverlap===!0?"1":"0",behindDoc:i.behindDocument===!0?"1":"0",locked:i.lockAnchor===!0?"1":"0",layoutInCell:i.layoutInCell===!0?"1":"0",relativeHeight:i.zIndex?i.zIndex:r.emus.y})),this.root.push(new Us),this.root.push(new Hs(i.horizontalPosition)),this.root.push(new zs(i.verticalPosition)),this.root.push(new go(r.emus.x,r.emus.y)),this.root.push(Jm({top:0,right:0,bottom:0,left:0})),n.floating!==void 0&&n.floating.wrap!==void 0)switch(n.floating.wrap.type){case to.SQUARE:this.root.push(new _u(n.floating.wrap,n.floating.margins));break;case to.TIGHT:this.root.push(new bu(n.floating.margins));break;case to.TOP_AND_BOTTOM:this.root.push(new xu(n.floating.margins));break;case to.NONE:default:this.root.push(new mo)}else this.root.push(new mo);this.root.push(new po(n.docProperties)),this.root.push(new wo),this.root.push(new fo({mediaData:e,transform:r,outline:n.outline}))}},Hy=({mediaData:t,transform:e,docProperties:r,outline:n})=>{var i,o,s,a;return new nt({name:"wp:inline",attributes:{distanceTop:{key:"distT",value:0},distanceBottom:{key:"distB",value:0},distanceLeft:{key:"distL",value:0},distanceRight:{key:"distR",value:0}},children:[new go(e.emus.x,e.emus.y),Jm(n?{top:((i=n.width)!=null?i:9525)*2,right:((o=n.width)!=null?o:9525)*2,bottom:((s=n.width)!=null?s:9525)*2,left:((a=n.width)!=null?a:9525)*2}:{top:0,right:0,bottom:0,left:0}),new po(r),new wo,new fo({mediaData:t,transform:e,outline:n})]})},Iu=class extends Y{constructor(e,r={}){super("w:drawing"),r.floating?this.root.push(new Au({mediaData:e,transform:e.transformation,drawingOptions:r})):this.root.push(Hy({mediaData:e,transform:e.transformation,docProperties:r.docProperties,outline:r.outline}))}},yo=class extends Tr{constructor(e){super({}),X(this,"key",`${Xm()}.png`),X(this,"imageData");let r=typeof e.data=="string"?this.convertDataURIToBinary(e.data):e.data;this.imageData={stream:r,fileName:this.key,transformation:{pixels:{x:Math.round(e.transformation.width),y:Math.round(e.transformation.height)},emus:{x:Math.round(e.transformation.width*9525),y:Math.round(e.transformation.height*9525)},flip:e.transformation.flip,rotation:e.transformation.rotation?e.transformation.rotation*6e4:void 0}};let n=new Iu(this.imageData,{floating:e.floating,docProperties:e.altText,outline:e.outline});this.root.push(n)}prepForXml(e){return e.file.Media.addImage(this.key,this.imageData),super.prepForXml(e)}convertDataURIToBinary(e){if(typeof atob=="function"){let r=";base64,",n=e.indexOf(r),i=n===-1?0:n+r.length;return new Uint8Array(atob(e.substring(i)).split("").map(o=>o.charCodeAt(0)))}else{let r=up("buffer");return new r.Buffer(e,"base64")}}};var ku=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{id:"w:id",initials:"w:initials",author:"w:author",date:"w:date"})}};var Ou=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{"xmlns:cx":"xmlns:cx","xmlns:cx1":"xmlns:cx1","xmlns:cx2":"xmlns:cx2","xmlns:cx3":"xmlns:cx3","xmlns:cx4":"xmlns:cx4","xmlns:cx5":"xmlns:cx5","xmlns:cx6":"xmlns:cx6","xmlns:cx7":"xmlns:cx7","xmlns:cx8":"xmlns:cx8","xmlns:mc":"xmlns:mc","xmlns:aink":"xmlns:aink","xmlns:am3d":"xmlns:am3d","xmlns:o":"xmlns:o","xmlns:r":"xmlns:r","xmlns:m":"xmlns:m","xmlns:v":"xmlns:v","xmlns:wp14":"xmlns:wp14","xmlns:wp":"xmlns:wp","xmlns:w10":"xmlns:w10","xmlns:w":"xmlns:w","xmlns:w14":"xmlns:w14","xmlns:w15":"xmlns:w15","xmlns:w16cex":"xmlns:w16cex","xmlns:w16cid":"xmlns:w16cid","xmlns:w16":"xmlns:w16","xmlns:w16sdtdh":"xmlns:w16sdtdh","xmlns:w16se":"xmlns:w16se","xmlns:wpg":"xmlns:wpg","xmlns:wpi":"xmlns:wpi","xmlns:wne":"xmlns:wne","xmlns:wps":"xmlns:wps"})}};var Ru=class extends Y{constructor({id:e,initials:r,author:n,date:i=new Date,children:o}){super("w:comment"),this.root.push(new ku({id:e,initials:r,author:n,date:i.toISOString()}));for(let s of o)this.root.push(s)}},Nu=class extends Y{constructor({children:e}){super("w:comments"),this.root.push(new Ou({"xmlns:cx":"http://schemas.microsoft.com/office/drawing/2014/chartex","xmlns:cx1":"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex","xmlns:cx2":"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex","xmlns:cx3":"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex","xmlns:cx4":"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex","xmlns:cx5":"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex","xmlns:cx6":"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex","xmlns:cx7":"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex","xmlns:cx8":"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","xmlns:aink":"http://schemas.microsoft.com/office/drawing/2016/ink","xmlns:am3d":"http://schemas.microsoft.com/office/drawing/2017/model3d","xmlns:o":"urn:schemas-microsoft-com:office:office","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:m":"http://schemas.openxmlformats.org/officeDocument/2006/math","xmlns:v":"urn:schemas-microsoft-com:vml","xmlns:wp14":"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing","xmlns:wp":"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing","xmlns:w10":"urn:schemas-microsoft-com:office:word","xmlns:w":"http://schemas.openxmlformats.org/wordprocessingml/2006/main","xmlns:w14":"http://schemas.microsoft.com/office/word/2010/wordml","xmlns:w15":"http://schemas.microsoft.com/office/word/2012/wordml","xmlns:w16cex":"http://schemas.microsoft.com/office/word/2018/wordml/cex","xmlns:w16cid":"http://schemas.microsoft.com/office/word/2016/wordml/cid","xmlns:w16":"http://schemas.microsoft.com/office/word/2018/wordml","xmlns:w16sdtdh":"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash","xmlns:w16se":"http://schemas.microsoft.com/office/word/2015/wordml/symex","xmlns:wpg":"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup","xmlns:wpi":"http://schemas.microsoft.com/office/word/2010/wordprocessingInk","xmlns:wne":"http://schemas.microsoft.com/office/word/2006/wordml","xmlns:wps":"http://schemas.microsoft.com/office/word/2010/wordprocessingShape"}));for(let r of e)this.root.push(new Ru(r))}};var Lu=class extends Y{constructor(){super("w:pageBreakBefore")}},Fu={AT_LEAST:"atLeast",EXACTLY:"exactly",EXACT:"exact",AUTO:"auto"},Pu=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{after:"w:after",before:"w:before",line:"w:line",lineRule:"w:lineRule"})}},Mu=class extends Y{constructor(e){super("w:spacing"),this.root.push(new Pu(e))}};var ro=class extends Y{constructor(e){super("w:pStyle"),this.root.push(new Ue({val:e}))}},Bu=class extends Y{constructor(e){super("w:tabs");for(let r of e)this.root.push(new ju(r))}},Jf={LEFT:"left",RIGHT:"right",CENTER:"center",BAR:"bar",CLEAR:"clear",DECIMAL:"decimal",END:"end",NUM:"num",START:"start"};var Uu=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{val:"w:val",pos:"w:pos",leader:"w:leader"})}},ju=class extends Y{constructor({type:e,position:r,leader:n}){super("w:tab"),this.root.push(new Uu({val:e,pos:r,leader:n}))}},_o=class extends Y{constructor(e,r){super("w:numPr"),this.root.push(new Hu(r)),this.root.push(new Wu(e))}},Hu=class extends Y{constructor(e){if(super("w:ilvl"),e>9)throw new Error("Level cannot be greater than 9. Read more here: https://answers.microsoft.com/en-us/msoffice/forum/all/does-word-support-more-than-9-list-levels/d130fdcd-1781-446d-8c84-c6c79124e4d7");this.root.push(new Ue({val:e}))}},Wu=class extends Y{constructor(e){super("w:numId"),this.root.push(new Ue({val:typeof e=="string"?`{${e}}`:e}))}},vo=class extends Y{constructor(){super(...arguments),X(this,"fileChild",Symbol())}},zu=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{id:"Id",type:"Type",target:"Target",targetMode:"TargetMode"})}},Wy={EXTERNAL:"External"},Gu=class extends Y{constructor(e,r,n,i){super("Relationship"),this.root.push(new zu({id:e,type:r,target:n,targetMode:i}))}},$u=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{id:"r:id",history:"w:history",anchor:"w:anchor"})}};var ri=class extends Y{constructor(e,r,n){super("w:hyperlink"),X(this,"linkId"),this.linkId=r;let i={history:1,anchor:n||void 0,id:n?void 0:`rId${this.linkId}`},o=new $u(i);this.root.push(o),e.forEach(s=>{this.root.push(s)})}};var Vu=class extends Y{constructor(e){super("w:externalHyperlink"),this.options=e}},Ku=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{id:"w:id",name:"w:name"})}},qu=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{id:"w:id"})}},Yu=class{constructor(e){X(this,"bookmarkUniqueNumericId",Ny()),X(this,"start"),X(this,"children"),X(this,"end");let r=this.bookmarkUniqueNumericId();this.start=new Xu(e.id,r),this.children=e.children,this.end=new Zu(r)}},Xu=class extends Y{constructor(e,r){super("w:bookmarkStart");let n=new Ku({name:e,id:r});this.root.push(n)}},Zu=class extends Y{constructor(e){super("w:bookmarkEnd");let r=new qu({id:e});this.root.push(r)}},Qu=class extends Y{constructor(e){super("w:outlineLvl"),this.level=e,this.root.push(new Ue({val:e}))}};var eD={BOTTOM:"bottom",CENTER:"center",TOP:"top"},Ju=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{verticalAlign:"w:val"})}},bo=class extends Y{constructor(e){super("w:vAlign"),this.root.push(new Ju({verticalAlign:e}))}},gn={DEFAULT:"default",FIRST:"first",EVEN:"even"},ec=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{type:"w:type",id:"r:id"})}},em={HEADER:"w:headerReference",FOOTER:"w:footerReference"},Zn=class extends Y{constructor(e,r){super(e),this.root.push(new ec({type:r.type||gn.DEFAULT,id:`rId${r.id}`}))}},tc=class extends Y{constructor({space:e,count:r,separate:n,equalWidth:i,children:o}){super("w:cols"),this.root.push(new Ot({space:{key:"w:space",value:e===void 0?void 0:it(e)},count:{key:"w:num",value:r===void 0?void 0:st(r)},separate:{key:"w:sep",value:n},equalWidth:{key:"w:equalWidth",value:i}})),!i&&o&&o.forEach(s=>this.addChildElement(s))}};var rc=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{type:"w:type",linePitch:"w:linePitch",charSpace:"w:charSpace"})}},nc=class extends Y{constructor(e,r,n){super("w:docGrid"),this.root.push(new rc({type:n,linePitch:st(e),charSpace:r?st(r):void 0}))}};var zy=({countBy:t,start:e,restart:r,distance:n})=>new nt({name:"w:lnNumType",attributes:{countBy:{key:"w:countBy",value:t===void 0?void 0:st(t)},start:{key:"w:start",value:e===void 0?void 0:st(e)},restart:{key:"w:restart",value:r},distance:{key:"w:distance",value:n===void 0?void 0:it(n)}}});var Eo=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{display:"w:display",offsetFrom:"w:offsetFrom",zOrder:"w:zOrder"})}},ic=class extends kt{constructor(e){if(super("w:pgBorders"),!e)return this;e.pageBorders?this.root.push(new Eo({display:e.pageBorders.display,offsetFrom:e.pageBorders.offsetFrom,zOrder:e.pageBorders.zOrder})):this.root.push(new Eo({})),e.pageBorderTop&&this.root.push(new Ne("w:top",e.pageBorderTop)),e.pageBorderLeft&&this.root.push(new Ne("w:left",e.pageBorderLeft)),e.pageBorderBottom&&this.root.push(new Ne("w:bottom",e.pageBorderBottom)),e.pageBorderRight&&this.root.push(new Ne("w:right",e.pageBorderRight))}},oc=class extends Y{constructor(e,r,n,i,o,s,a){super("w:pgMar"),this.root.push(new Ot({top:{key:"w:top",value:er(e)},right:{key:"w:right",value:it(r)},bottom:{key:"w:bottom",value:er(n)},left:{key:"w:left",value:it(i)},header:{key:"w:header",value:it(o)},footer:{key:"w:footer",value:it(s)},gutter:{key:"w:gutter",value:it(a)}}))}};var ac=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{start:"w:start",formatType:"w:fmt",separator:"w:chapSep"})}},sc=class extends Y{constructor({start:e,formatType:r,separator:n}){super("w:pgNumType"),this.root.push(new ac({start:e===void 0?void 0:st(e),formatType:r,separator:n}))}},ep={PORTRAIT:"portrait",LANDSCAPE:"landscape"},uc=class extends Y{constructor(e,r,n){super("w:pgSz");let i=n===ep.LANDSCAPE,o=it(e),s=it(r);this.root.push(new Ot({width:{key:"w:w",value:i?s:o},height:{key:"w:h",value:i?o:s},orientation:{key:"w:orient",value:n}}))}};var cc=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{val:"w:val"})}},lc=class extends Y{constructor(e){super("w:textDirection"),this.root.push(new cc({val:e}))}};var dc=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{val:"w:val"})}},hc=class extends Y{constructor(e){super("w:type"),this.root.push(new dc({val:e}))}},xr={TOP:1440,RIGHT:1440,BOTTOM:1440,LEFT:1440,HEADER:708,FOOTER:708,GUTTER:0},ss={WIDTH:11906,HEIGHT:16838,ORIENTATION:ep.PORTRAIT},fc=class extends Y{constructor({page:{size:{width:e=ss.WIDTH,height:r=ss.HEIGHT,orientation:n=ss.ORIENTATION}={},margin:{top:i=xr.TOP,right:o=xr.RIGHT,bottom:s=xr.BOTTOM,left:a=xr.LEFT,header:l=xr.HEADER,footer:g=xr.FOOTER,gutter:_=xr.GUTTER}={},pageNumbers:b={},borders:T,textDirection:w}={},grid:{linePitch:x=360,charSpace:v,type:C}={},headerWrapperGroup:m={},footerWrapperGroup:D={},lineNumbers:S,titlePage:N,verticalAlign:M,column:te,type:V}={}){super("w:sectPr"),this.addHeaderFooterGroup(em.HEADER,m),this.addHeaderFooterGroup(em.FOOTER,D),V&&this.root.push(new hc(V)),this.root.push(new uc(e,r,n)),this.root.push(new oc(i,o,s,a,l,g,_)),T&&this.root.push(new ic(T)),S&&this.root.push(zy(S)),this.root.push(new sc(b)),te&&this.root.push(new tc(te)),M&&this.root.push(new bo(M)),N!==void 0&&this.root.push(new ue("w:titlePg",N)),w&&this.root.push(new lc(w)),this.root.push(new nc(x,v,C))}addHeaderFooterGroup(e,r){r.default&&this.root.push(new Zn(e,{type:gn.DEFAULT,id:r.default.View.ReferenceId})),r.first&&this.root.push(new Zn(e,{type:gn.FIRST,id:r.first.View.ReferenceId})),r.even&&this.root.push(new Zn(e,{type:gn.EVEN,id:r.even.View.ReferenceId}))}},mc=class extends Y{constructor(){super("w:body"),X(this,"sections",[])}addSection(e){let r=this.sections.pop();this.root.push(this.createSectionParagraph(r)),this.sections.push(new fc(e))}prepForXml(e){return this.sections.length===1&&(this.root.splice(0,1),this.root.push(this.sections.pop())),super.prepForXml(e)}push(e){this.root.push(e)}createSectionParagraph(e){let r=new Me({}),n=new yr({});return n.push(e),r.addChildElement(n),r}};var Sr=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type",cx:"xmlns:cx",cx1:"xmlns:cx1",cx2:"xmlns:cx2",cx3:"xmlns:cx3",cx4:"xmlns:cx4",cx5:"xmlns:cx5",cx6:"xmlns:cx6",cx7:"xmlns:cx7",cx8:"xmlns:cx8",aink:"xmlns:aink",am3d:"xmlns:am3d",w16cex:"xmlns:w16cex",w16cid:"xmlns:w16cid",w16:"xmlns:w16",w16sdtdh:"xmlns:w16sdtdh",w16se:"xmlns:w16se"})}},pc=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{color:"w:color",themeColor:"w:themeColor",themeShade:"w:themeShade",themeTint:"w:themeTint"})}},gc=class extends Y{constructor(e){super("w:background"),this.root.push(new pc({color:e.color===void 0?void 0:vn(e.color),themeColor:e.themeColor,themeShade:e.themeShade===void 0?void 0:Zf(e.themeShade),themeTint:e.themeTint===void 0?void 0:Zf(e.themeTint)}))}},wc=class extends Y{constructor(e){super("w:document"),X(this,"body"),this.root.push(new Sr({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",cx:"http://schemas.microsoft.com/office/drawing/2014/chartex",cx1:"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex",cx2:"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex",cx3:"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex",cx4:"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex",cx5:"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex",cx6:"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex",cx7:"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex",cx8:"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex",aink:"http://schemas.microsoft.com/office/drawing/2016/ink",am3d:"http://schemas.microsoft.com/office/drawing/2017/model3d",w16cex:"http://schemas.microsoft.com/office/word/2018/wordml/cex",w16cid:"http://schemas.microsoft.com/office/word/2016/wordml/cid",w16:"http://schemas.microsoft.com/office/word/2018/wordml",w16sdtdh:"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash",w16se:"http://schemas.microsoft.com/office/word/2015/wordml/symex",Ignorable:"w14 w15 wp14"})),this.body=new mc,e.background&&this.root.push(new gc(e.background)),this.root.push(this.body)}add(e){return this.body.push(e),this}get Body(){return this.body}},yc=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{xmlns:"xmlns"})}},wr=class extends Y{constructor(){super("Relationships"),this.root.push(new yc({xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"}))}createRelationship(e,r,n,i){let o=new Gu(`rId${e}`,r,n,i);return this.root.push(o),o}get RelationshipCount(){return this.root.length-1}},xo=class{constructor(e){X(this,"document"),X(this,"relationships"),this.document=new wc(e),this.relationships=new wr}get View(){return this.document}get Relationships(){return this.relationships}},_c=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{val:"w:val"})}},vc=class extends Y{constructor(){super("w:wordWrap"),this.root.push(new _c({val:0}))}};var Gy=t=>{var e,r;return new nt({name:"w:framePr",attributes:{anchorLock:{key:"w:anchorLock",value:t.anchorLock},dropCap:{key:"w:dropCap",value:t.dropCap},width:{key:"w:w",value:t.width},height:{key:"w:h",value:t.height},x:{key:"w:x",value:t.position?t.position.x:void 0},y:{key:"w:y",value:t.position?t.position.y:void 0},anchorHorizontal:{key:"w:hAnchor",value:t.anchor.horizontal},anchorVertical:{key:"w:vAnchor",value:t.anchor.vertical},spaceHorizontal:{key:"w:hSpace",value:(e=t.space)==null?void 0:e.horizontal},spaceVertical:{key:"w:vSpace",value:(r=t.space)==null?void 0:r.vertical},rule:{key:"w:hRule",value:t.rule},alignmentX:{key:"w:xAlign",value:t.alignment?t.alignment.x:void 0},alignmentY:{key:"w:yAlign",value:t.alignment?t.alignment.y:void 0},lines:{key:"w:lines",value:t.lines},wrap:{key:"w:wrap",value:t.wrap}}})},yr=class extends kt{constructor(e){var r,n;if(super("w:pPr"),X(this,"numberingReferences",[]),!e)return this;e.heading&&this.push(new ro(e.heading)),e.bullet&&this.push(new ro("ListParagraph")),e.numbering&&!e.style&&!e.heading&&(e.numbering.custom||this.push(new ro("ListParagraph"))),e.style&&this.push(new ro(e.style)),e.keepNext!==void 0&&this.push(new ue("w:keepNext",e.keepNext)),e.keepLines!==void 0&&this.push(new ue("w:keepLines",e.keepLines)),e.pageBreakBefore&&this.push(new Lu),e.frame&&this.push(Gy(e.frame)),e.widowControl!==void 0&&this.push(new ue("w:widowControl",e.widowControl)),e.bullet&&this.push(new _o(1,e.bullet.level)),e.numbering&&(this.numberingReferences.push({reference:e.numbering.reference,instance:(r=e.numbering.instance)!=null?r:0}),this.push(new _o(`${e.numbering.reference}-${(n=e.numbering.instance)!=null?n:0}`,e.numbering.level))),e.border&&this.push(new _s(e.border)),e.thematicBreak&&this.push(new vs),e.shading&&this.push(new En(e.shading)),e.wordWrap&&this.push(new vc),e.overflowPunctuation&&this.push(new ue("w:overflowPunct",e.overflowPunctuation));let i=[...e.rightTabStop!==void 0?[{type:Jf.RIGHT,position:e.rightTabStop}]:[],...e.tabStops?e.tabStops:[],...e.leftTabStop!==void 0?[{type:Jf.LEFT,position:e.leftTabStop}]:[]];i.length>0&&this.push(new Bu(i)),e.bidirectional!==void 0&&this.push(new ue("w:bidi",e.bidirectional)),e.spacing&&this.push(new Mu(e.spacing)),e.indent&&this.push(new bs(e.indent)),e.contextualSpacing!==void 0&&this.push(new ue("w:contextualSpacing",e.contextualSpacing)),e.alignment&&this.push(new uo(e.alignment)),e.outlineLevel!==void 0&&this.push(new Qu(e.outlineLevel)),e.suppressLineNumbers!==void 0&&this.push(new ue("w:suppressLineNumbers",e.suppressLineNumbers)),e.autoSpaceEastAsianText!==void 0&&this.push(new ue("w:autoSpaceDN",e.autoSpaceEastAsianText)),e.run&&this.push(new nr(e.run))}push(e){this.root.push(e)}prepForXml(e){if(e.viewWrapper instanceof xo)for(let r of this.numberingReferences)e.file.Numbering.createConcreteNumberingInstance(r.reference,r.instance);return super.prepForXml(e)}},Me=class extends vo{constructor(e){if(super("w:p"),X(this,"properties"),typeof e=="string")return this.properties=new yr({}),this.root.push(this.properties),this.root.push(new Cr(e)),this;if(this.properties=new yr(e),this.root.push(this.properties),e.text&&this.root.push(new Cr(e.text)),e.children)for(let r of e.children){if(r instanceof Yu){this.root.push(r.start);for(let n of r.children)this.root.push(n);this.root.push(r.end);continue}this.root.push(r)}}prepForXml(e){for(let r of this.root)if(r instanceof Vu){let n=this.root.indexOf(r),i=new ri(r.options.children,Xm());e.viewWrapper.Relationships.createRelationship(i.linkId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",r.options.link,Wy.EXTERNAL),this.root[n]=i}return super.prepForXml(e)}addRunToFront(e){return this.root.splice(1,0,e),this}};var bc=class extends Y{constructor(e){super("w:tblGrid");for(let r of e)this.root.push(new Ec(r))}},Ec=class extends Y{constructor(e){super("w:gridCol"),e!==void 0&&this.root.push(new Ot({width:{key:"w:w",value:it(e)}}))}},tp={TABLE:"w:tblCellMar",TABLE_CELL:"w:tcMar"},Do=class extends kt{constructor(e,{marginUnitType:r=et.DXA,top:n,left:i,bottom:o,right:s}){super(e),n!==void 0&&this.root.push(new tr("w:top",{type:r,size:n})),i!==void 0&&this.root.push(new tr("w:left",{type:r,size:i})),o!==void 0&&this.root.push(new tr("w:bottom",{type:r,size:o})),s!==void 0&&this.root.push(new tr("w:right",{type:r,size:s}))}},et={AUTO:"auto",DXA:"dxa",NIL:"nil",PERCENTAGE:"pct"},tr=class extends Y{constructor(e,{type:r=et.AUTO,size:n}){super(e);let i=n;r===et.PERCENTAGE&&typeof n=="number"&&(i=`${n}%`),this.root.push(new Ot({type:{key:"w:type",value:r},size:{key:"w:w",value:vy(i)}}))}},xc=class extends kt{constructor(e){super("w:tcBorders"),e.top&&this.root.push(new Ne("w:top",e.top)),e.start&&this.root.push(new Ne("w:start",e.start)),e.left&&this.root.push(new Ne("w:left",e.left)),e.bottom&&this.root.push(new Ne("w:bottom",e.bottom)),e.end&&this.root.push(new Ne("w:end",e.end)),e.right&&this.root.push(new Ne("w:right",e.right))}},Dc=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{val:"w:val"})}},Tc=class extends Y{constructor(e){super("w:gridSpan"),this.root.push(new Dc({val:st(e)}))}},rp={CONTINUE:"continue",RESTART:"restart"},Cc=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{val:"w:val"})}},To=class extends Y{constructor(e){super("w:vMerge"),this.root.push(new Cc({val:e}))}};var Sc=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{val:"w:val"})}},Ac=class extends Y{constructor(e){super("w:textDirection"),this.root.push(new Sc({val:e}))}},Ic=class extends kt{constructor(e){super("w:tcPr"),e.width&&this.root.push(new tr("w:tcW",e.width)),e.columnSpan&&this.root.push(new Tc(e.columnSpan)),e.verticalMerge?this.root.push(new To(e.verticalMerge)):e.rowSpan&&e.rowSpan>1&&this.root.push(new To(rp.RESTART)),e.borders&&this.root.push(new xc(e.borders)),e.shading&&this.root.push(new En(e.shading)),e.margins&&this.root.push(new Do(tp.TABLE_CELL,e.margins)),e.textDirection&&this.root.push(new Ac(e.textDirection)),e.verticalAlign&&this.root.push(new bo(e.verticalAlign))}},tt=class extends Y{constructor(e){super("w:tc"),this.options=e,this.root.push(new Ic(e));for(let r of e.children)this.root.push(r)}prepForXml(e){return this.root[this.root.length-1]instanceof Me||this.root.push(new Me({})),super.prepForXml(e)}},un={style:pd.NONE,size:0,color:"auto"},cn={style:pd.SINGLE,size:4,color:"auto"},Co=class extends Y{constructor(e){super("w:tblBorders"),e.top?this.root.push(new Ne("w:top",e.top)):this.root.push(new Ne("w:top",cn)),e.left?this.root.push(new Ne("w:left",e.left)):this.root.push(new Ne("w:left",cn)),e.bottom?this.root.push(new Ne("w:bottom",e.bottom)):this.root.push(new Ne("w:bottom",cn)),e.right?this.root.push(new Ne("w:right",e.right)):this.root.push(new Ne("w:right",cn)),e.insideHorizontal?this.root.push(new Ne("w:insideH",e.insideHorizontal)):this.root.push(new Ne("w:insideH",cn)),e.insideVertical?this.root.push(new Ne("w:insideV",e.insideVertical)):this.root.push(new Ne("w:insideV",cn))}};X(Co,"NONE",{top:un,bottom:un,left:un,right:un,insideHorizontal:un,insideVertical:un});var kc=class extends Y{constructor({horizontalAnchor:e,verticalAnchor:r,absoluteHorizontalPosition:n,relativeHorizontalPosition:i,absoluteVerticalPosition:o,relativeVerticalPosition:s,bottomFromText:a,topFromText:l,leftFromText:g,rightFromText:_,overlap:b}){super("w:tblpPr"),this.root.push(new Ot({leftFromText:{key:"w:leftFromText",value:g===void 0?void 0:it(g)},rightFromText:{key:"w:rightFromText",value:_===void 0?void 0:it(_)},topFromText:{key:"w:topFromText",value:l===void 0?void 0:it(l)},bottomFromText:{key:"w:bottomFromText",value:a===void 0?void 0:it(a)},absoluteHorizontalPosition:{key:"w:tblpX",value:n===void 0?void 0:er(n)},absoluteVerticalPosition:{key:"w:tblpY",value:o===void 0?void 0:er(o)},horizontalAnchor:{key:"w:horzAnchor",value:e===void 0?void 0:e},relativeHorizontalPosition:{key:"w:tblpXSpec",value:i},relativeVerticalPosition:{key:"w:tblpYSpec",value:s},verticalAnchor:{key:"w:vertAnchor",value:r}})),b&&this.root.push(new gs("w:tblOverlap",b))}};var Oc=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{type:"w:type"})}},Rc=class extends Y{constructor(e){super("w:tblLayout"),this.root.push(new Oc({type:e}))}},Nc=class extends kt{constructor(e){super("w:tblPr"),e.style&&this.root.push(new rr("w:tblStyle",e.style)),e.float&&this.root.push(new kc(e.float)),e.visuallyRightToLeft!==void 0&&this.root.push(new ue("w:bidiVisual",e.visuallyRightToLeft)),e.width&&this.root.push(new tr("w:tblW",e.width)),e.alignment&&this.root.push(new uo(e.alignment)),e.indent&&this.root.push(new tr("w:tblInd",e.indent)),e.borders&&this.root.push(new Co(e.borders)),e.shading&&this.root.push(new En(e.shading)),e.layout&&this.root.push(new Rc(e.layout)),e.cellMargin&&this.root.push(new Do(tp.TABLE,e.cellMargin))}},So=class extends vo{constructor({rows:e,width:r,columnWidths:n=Array(Math.max(...e.map(T=>T.CellCount))).fill(100),margins:i,indent:o,float:s,layout:a,style:l,borders:g,alignment:_,visuallyRightToLeft:b}){super("w:tbl"),this.root.push(new Nc({borders:g??{},width:r??{size:100},indent:o,float:s,layout:a,style:l,alignment:_,cellMargin:i,visuallyRightToLeft:b})),this.root.push(new bc(n));for(let T of e)this.root.push(T);e.forEach((T,w)=>{if(w===e.length-1)return;let x=0;T.cells.forEach(v=>{if(v.options.rowSpan&&v.options.rowSpan>1){let C=new tt({rowSpan:v.options.rowSpan-1,columnSpan:v.options.columnSpan,borders:v.options.borders,children:[],verticalMerge:rp.CONTINUE});e[w+1].addCellToColumnIndex(C,x)}x+=v.options.columnSpan||1})})}};var Lc=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{value:"w:val",rule:"w:hRule"})}},Fc=class extends Y{constructor(e,r){super("w:trHeight"),this.root.push(new Lc({value:it(e),rule:r}))}},Pc=class extends kt{constructor(e){super("w:trPr"),e.cantSplit!==void 0&&this.root.push(new ue("w:cantSplit",e.cantSplit)),e.tableHeader!==void 0&&this.root.push(new ue("w:tblHeader",e.tableHeader)),e.height&&this.root.push(new Fc(e.height.value,e.height.rule))}},ni=class extends Y{constructor(e){super("w:tr"),this.options=e,this.root.push(new Pc(e));for(let r of e.children)this.root.push(r)}get CellCount(){return this.options.children.length}get cells(){return this.root.filter(e=>e instanceof tt)}addCellToIndex(e,r){this.root.splice(r+1,0,e)}addCellToColumnIndex(e,r){let n=this.columnIndexToRootIndex(r,!0);this.addCellToIndex(e,n-1)}rootIndexToColumnIndex(e){if(e<1||e>=this.root.length)throw new Error(`cell 'rootIndex' should between 1 to ${this.root.length-1}`);let r=0;for(let n=1;n<e;n++){let i=this.root[n];r+=i.options.columnSpan||1}return r}columnIndexToRootIndex(e,r=!1){if(e<0)throw new Error("cell 'columnIndex' should not less than zero");let n=0,i=1;for(;n<=e;){if(i>=this.root.length){if(r)return this.root.length;throw new Error(`cell 'columnIndex' should not great than ${n-1}`)}let o=this.root[i];i+=1,n+=o&&o.options.columnSpan||1}return i-1}},Mc=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{xmlns:"xmlns",vt:"xmlns:vt"})}},Bc=class extends Y{constructor(){super("Properties"),this.root.push(new Mc({xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"}))}},Uc=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{xmlns:"xmlns"})}},jc=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{contentType:"ContentType",extension:"Extension"})}},Ut=class extends Y{constructor(e,r){super("Default"),this.root.push(new jc({contentType:e,extension:r}))}},Hc=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{contentType:"ContentType",partName:"PartName"})}},mt=class extends Y{constructor(e,r){super("Override"),this.root.push(new Hc({contentType:e,partName:r}))}},Wc=class extends Y{constructor(){super("Types"),this.root.push(new Uc({xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"})),this.root.push(new Ut("image/png","png")),this.root.push(new Ut("image/jpeg","jpeg")),this.root.push(new Ut("image/jpeg","jpg")),this.root.push(new Ut("image/bmp","bmp")),this.root.push(new Ut("image/gif","gif")),this.root.push(new Ut("application/vnd.openxmlformats-package.relationships+xml","rels")),this.root.push(new Ut("application/xml","xml")),this.root.push(new Ut("application/vnd.openxmlformats-officedocument.obfuscatedFont","odttf")),this.root.push(new mt("application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml","/word/document.xml")),this.root.push(new mt("application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml","/word/styles.xml")),this.root.push(new mt("application/vnd.openxmlformats-package.core-properties+xml","/docProps/core.xml")),this.root.push(new mt("application/vnd.openxmlformats-officedocument.custom-properties+xml","/docProps/custom.xml")),this.root.push(new mt("application/vnd.openxmlformats-officedocument.extended-properties+xml","/docProps/app.xml")),this.root.push(new mt("application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml","/word/numbering.xml")),this.root.push(new mt("application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml","/word/footnotes.xml")),this.root.push(new mt("application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml","/word/settings.xml")),this.root.push(new mt("application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml","/word/comments.xml")),this.root.push(new mt("application/vnd.openxmlformats-officedocument.wordprocessingml.fontTable+xml","/word/fontTable.xml"))}addFooter(e){this.root.push(new mt("application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml",`/word/footer${e}.xml`))}addHeader(e){this.root.push(new mt("application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml",`/word/header${e}.xml`))}},zc=class extends Y{constructor(e){super("cp:coreProperties"),this.root.push(new Sr({cp:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",xsi:"http://www.w3.org/2001/XMLSchema-instance"})),e.title&&this.root.push(new Qt("dc:title",e.title)),e.subject&&this.root.push(new Qt("dc:subject",e.subject)),e.creator&&this.root.push(new Qt("dc:creator",e.creator)),e.keywords&&this.root.push(new Qt("cp:keywords",e.keywords)),e.description&&this.root.push(new Qt("dc:description",e.description)),e.lastModifiedBy&&this.root.push(new Qt("cp:lastModifiedBy",e.lastModifiedBy)),e.revision&&this.root.push(new Qt("cp:revision",String(e.revision))),this.root.push(new Ao("dcterms:created")),this.root.push(new Ao("dcterms:modified"))}},Ao=class extends Y{constructor(e){super(e),this.root.push(new Sr({type:"dcterms:W3CDTF"})),this.root.push(xy(new Date))}},Gc=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{xmlns:"xmlns",vt:"xmlns:vt"})}},$c=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{fmtid:"fmtid",pid:"pid",name:"name"})}},Vc=class extends Y{constructor(e,r){super("property"),this.root.push(new $c({fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:e.toString(),name:r.name})),this.root.push(new Kc(r.value))}},Kc=class extends Y{constructor(e){super("vt:lpwstr"),this.root.push(e)}},qc=class extends Y{constructor(e){super("Properties"),X(this,"nextId"),X(this,"properties",[]),this.root.push(new Gc({xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"})),this.nextId=2;for(let r of e)this.addCustomProperty(r)}prepForXml(e){return this.properties.forEach(r=>this.root.push(r)),super.prepForXml(e)}addCustomProperty(e){this.properties.push(new Vc(this.nextId++,e))}},Yc=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type"})}},$y=class extends so{constructor(e,r){super("w:ftr",r),X(this,"refId"),this.refId=e,r||this.root.push(new Yc({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape"}))}get ReferenceId(){return this.refId}add(e){this.root.push(e)}},Xc=class{constructor(e,r,n){X(this,"footer"),X(this,"relationships"),this.media=e,this.footer=new $y(r,n),this.relationships=new wr}add(e){this.footer.add(e)}addChildElement(e){this.footer.addChildElement(e)}get View(){return this.footer}get Relationships(){return this.relationships}get Media(){return this.media}},Zc=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{type:"w:type",id:"w:id"})}},Qc=class extends Y{constructor(){super("w:footnoteRef")}},Jc=class extends Tr{constructor(){super({style:"FootnoteReference"}),this.root.push(new Qc)}},tm={SEPERATOR:"separator",CONTINUATION_SEPERATOR:"continuationSeparator"},Qn=class extends Y{constructor(e){super("w:footnote"),this.root.push(new Zc({type:e.type,id:e.id}));for(let r=0;r<e.children.length;r++){let n=e.children[r];r===0&&n.addRunToFront(new Jc),this.root.push(n)}}},el=class extends Y{constructor(){super("w:continuationSeparator")}},tl=class extends Tr{constructor(){super({}),this.root.push(new el)}},rl=class extends Y{constructor(){super("w:separator")}},nl=class extends Tr{constructor(){super({}),this.root.push(new rl)}},il=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable"})}},ol=class extends Y{constructor(){super("w:footnotes"),this.root.push(new il({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"}));let e=new Qn({id:-1,type:tm.SEPERATOR,children:[new Me({spacing:{after:0,line:240,lineRule:Fu.AUTO},children:[new nl]})]});this.root.push(e);let r=new Qn({id:0,type:tm.CONTINUATION_SEPERATOR,children:[new Me({spacing:{after:0,line:240,lineRule:Fu.AUTO},children:[new tl]})]});this.root.push(r)}createFootNote(e,r){let n=new Qn({id:e,children:r});this.root.push(n)}},al=class{constructor(){X(this,"footnotess"),X(this,"relationships"),this.footnotess=new ol,this.relationships=new wr}get View(){return this.footnotess}get Relationships(){return this.relationships}},sl=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type",cx:"xmlns:cx",cx1:"xmlns:cx1",cx2:"xmlns:cx2",cx3:"xmlns:cx3",cx4:"xmlns:cx4",cx5:"xmlns:cx5",cx6:"xmlns:cx6",cx7:"xmlns:cx7",cx8:"xmlns:cx8",w16cid:"xmlns:w16cid",w16se:"xmlns:w16se"})}},Vy=class extends so{constructor(e,r){super("w:hdr",r),X(this,"refId"),this.refId=e,r||this.root.push(new sl({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",cx:"http://schemas.microsoft.com/office/drawing/2014/chartex",cx1:"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex",cx2:"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex",cx3:"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex",cx4:"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex",cx5:"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex",cx6:"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex",cx7:"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex",cx8:"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex",w16cid:"http://schemas.microsoft.com/office/word/2016/wordml/cid",w16se:"http://schemas.microsoft.com/office/word/2015/wordml/symex"}))}get ReferenceId(){return this.refId}add(e){this.root.push(e)}},ul=class{constructor(e,r,n){X(this,"header"),X(this,"relationships"),this.media=e,this.header=new Vy(r,n),this.relationships=new wr}add(e){return this.header.add(e),this}addChildElement(e){this.header.addChildElement(e)}get View(){return this.header}get Relationships(){return this.relationships}get Media(){return this.media}},cl=class{constructor(){X(this,"map"),this.map=new Map}addImage(e,r){this.map.set(e,r)}get Array(){return Array.from(this.map.values())}};var Zt={DECIMAL:"decimal",UPPER_ROMAN:"upperRoman",LOWER_ROMAN:"lowerRoman",UPPER_LETTER:"upperLetter",LOWER_LETTER:"lowerLetter",ORDINAL:"ordinal",CARDINAL_TEXT:"cardinalText",ORDINAL_TEXT:"ordinalText",HEX:"hex",CHICAGO:"chicago",IDEOGRAPH__DIGITAL:"ideographDigital",JAPANESE_COUNTING:"japaneseCounting",AIUEO:"aiueo",IROHA:"iroha",DECIMAL_FULL_WIDTH:"decimalFullWidth",DECIMAL_HALF_WIDTH:"decimalHalfWidth",JAPANESE_LEGAL:"japaneseLegal",JAPANESE_DIGITAL_TEN_THOUSAND:"japaneseDigitalTenThousand",DECIMAL_ENCLOSED_CIRCLE:"decimalEnclosedCircle",DECIMAL_FULL_WIDTH2:"decimalFullWidth2",AIUEO_FULL_WIDTH:"aiueoFullWidth",IROHA_FULL_WIDTH:"irohaFullWidth",DECIMAL_ZERO:"decimalZero",BULLET:"bullet",GANADA:"ganada",CHOSUNG:"chosung",DECIMAL_ENCLOSED_FULLSTOP:"decimalEnclosedFullstop",DECIMAL_ENCLOSED_PARENTHESES:"decimalEnclosedParen",DECIMAL_ENCLOSED_CIRCLE_CHINESE:"decimalEnclosedCircleChinese",IDEOGRAPH_ENCLOSED_CIRCLE:"ideographEnclosedCircle",IDEOGRAPH_TRADITIONAL:"ideographTraditional",IDEOGRAPH_ZODIAC:"ideographZodiac",IDEOGRAPH_ZODIAC_TRADITIONAL:"ideographZodiacTraditional",TAIWANESE_COUNTING:"taiwaneseCounting",IDEOGRAPH_LEGAL_TRADITIONAL:"ideographLegalTraditional",TAIWANESE_COUNTING_THOUSAND:"taiwaneseCountingThousand",TAIWANESE_DIGITAL:"taiwaneseDigital",CHINESE_COUNTING:"chineseCounting",CHINESE_LEGAL_SIMPLIFIED:"chineseLegalSimplified",CHINESE_COUNTING_THOUSAND:"chineseCountingThousand",KOREAN_DIGITAL:"koreanDigital",KOREAN_COUNTING:"koreanCounting",KOREAN_LEGAL:"koreanLegal",KOREAN_DIGITAL2:"koreanDigital2",VIETNAMESE_COUNTING:"vietnameseCounting",RUSSIAN_LOWER:"russianLower",RUSSIAN_UPPER:"russianUpper",NONE:"none",NUMBER_IN_DASH:"numberInDash",HEBREW1:"hebrew1",HEBREW2:"hebrew2",ARABIC_ALPHA:"arabicAlpha",ARABIC_ABJAD:"arabicAbjad",HINDI_VOWELS:"hindiVowels",HINDI_CONSONANTS:"hindiConsonants",HINDI_NUMBERS:"hindiNumbers",HINDI_COUNTING:"hindiCounting",THAI_LETTERS:"thaiLetters",THAI_NUMBERS:"thaiNumbers",THAI_COUNTING:"thaiCounting",BAHT_TEXT:"bahtText",DOLLAR_TEXT:"dollarText",CUSTOM:"custom"},ll=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{ilvl:"w:ilvl",tentative:"w15:tentative"})}},dl=class extends Y{constructor(e){super("w:numFmt"),this.root.push(new Ue({val:e}))}},hl=class extends Y{constructor(e){super("w:lvlText"),this.root.push(new Ue({val:e}))}},fl=class extends Y{constructor(e){super("w:lvlJc"),this.root.push(new Ue({val:e}))}};var ml=class extends Y{constructor(e){super("w:suff"),this.root.push(new Ue({val:e}))}},pl=class extends Y{constructor(){super("w:isLgl")}},gl=class extends Y{constructor({level:e,format:r,text:n,alignment:i=pt.START,start:o=1,style:s,suffix:a,isLegalNumberingStyle:l}){if(super("w:lvl"),X(this,"paragraphProperties"),X(this,"runProperties"),this.root.push(new Jn("w:start",st(o))),r&&this.root.push(new dl(r)),a&&this.root.push(new ml(a)),l&&this.root.push(new pl),n&&this.root.push(new hl(n)),this.root.push(new fl(i)),this.paragraphProperties=new yr(s&&s.paragraph),this.runProperties=new nr(s&&s.run),this.root.push(this.paragraphProperties),this.root.push(this.runProperties),e>9)throw new Error("Level cannot be greater than 9. Read more here: https://answers.microsoft.com/en-us/msoffice/forum/all/does-word-support-more-than-9-list-levels/d130fdcd-1781-446d-8c84-c6c79124e4d7");this.root.push(new ll({ilvl:st(e),tentative:1}))}},wl=class extends gl{};var yl=class extends Y{constructor(e){super("w:multiLevelType"),this.root.push(new Ue({val:e}))}},_l=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{abstractNumId:"w:abstractNumId",restartNumberingAfterBreak:"w15:restartNumberingAfterBreak"})}},Io=class extends Y{constructor(e,r){super("w:abstractNum"),X(this,"id"),this.root.push(new _l({abstractNumId:st(e),restartNumberingAfterBreak:0})),this.root.push(new yl("hybridMultilevel")),this.id=e;for(let n of r)this.root.push(new wl(n))}},vl=class extends Y{constructor(e){super("w:abstractNumId"),this.root.push(new Ue({val:e}))}},bl=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{numId:"w:numId"})}},ko=class extends Y{constructor(e){if(super("w:num"),X(this,"numId"),X(this,"reference"),X(this,"instance"),this.numId=e.numId,this.reference=e.reference,this.instance=e.instance,this.root.push(new bl({numId:st(e.numId)})),this.root.push(new vl(st(e.abstractNumId))),e.overrideLevels&&e.overrideLevels.length)for(let r of e.overrideLevels)this.root.push(new xl(r.num,r.start))}},El=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{ilvl:"w:ilvl"})}},xl=class extends Y{constructor(e,r){super("w:lvlOverride"),this.root.push(new El({ilvl:e})),r!==void 0&&this.root.push(new Tl(r))}},Dl=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{val:"w:val"})}},Tl=class extends Y{constructor(e){super("w:startOverride"),this.root.push(new Dl({val:e}))}},Cl=class extends Y{constructor(e){super("w:numbering"),X(this,"abstractNumberingMap",new Map),X(this,"concreteNumberingMap",new Map),X(this,"referenceConfigMap",new Map),X(this,"abstractNumUniqueNumericId",ky()),X(this,"concreteNumUniqueNumericId",Oy()),this.root.push(new Sr({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"}));let r=new Io(this.abstractNumUniqueNumericId(),[{level:0,format:Zt.BULLET,text:"\u25CF",alignment:pt.LEFT,style:{paragraph:{indent:{left:It(.5),hanging:It(.25)}}}},{level:1,format:Zt.BULLET,text:"\u25CB",alignment:pt.LEFT,style:{paragraph:{indent:{left:It(1),hanging:It(.25)}}}},{level:2,format:Zt.BULLET,text:"\u25A0",alignment:pt.LEFT,style:{paragraph:{indent:{left:2160,hanging:It(.25)}}}},{level:3,format:Zt.BULLET,text:"\u25CF",alignment:pt.LEFT,style:{paragraph:{indent:{left:2880,hanging:It(.25)}}}},{level:4,format:Zt.BULLET,text:"\u25CB",alignment:pt.LEFT,style:{paragraph:{indent:{left:3600,hanging:It(.25)}}}},{level:5,format:Zt.BULLET,text:"\u25A0",alignment:pt.LEFT,style:{paragraph:{indent:{left:4320,hanging:It(.25)}}}},{level:6,format:Zt.BULLET,text:"\u25CF",alignment:pt.LEFT,style:{paragraph:{indent:{left:5040,hanging:It(.25)}}}},{level:7,format:Zt.BULLET,text:"\u25CF",alignment:pt.LEFT,style:{paragraph:{indent:{left:5760,hanging:It(.25)}}}},{level:8,format:Zt.BULLET,text:"\u25CF",alignment:pt.LEFT,style:{paragraph:{indent:{left:6480,hanging:It(.25)}}}}]);this.concreteNumberingMap.set("default-bullet-numbering",new ko({numId:1,abstractNumId:r.id,reference:"default-bullet-numbering",instance:0,overrideLevels:[{num:0,start:1}]})),this.abstractNumberingMap.set("default-bullet-numbering",r);for(let n of e.config)this.abstractNumberingMap.set(n.reference,new Io(this.abstractNumUniqueNumericId(),n.levels)),this.referenceConfigMap.set(n.reference,n.levels)}prepForXml(e){for(let r of this.abstractNumberingMap.values())this.root.push(r);for(let r of this.concreteNumberingMap.values())this.root.push(r);return super.prepForXml(e)}createConcreteNumberingInstance(e,r){let n=this.abstractNumberingMap.get(e);if(!n)return;let i=`${e}-${r}`;if(this.concreteNumberingMap.has(i))return;let o=this.referenceConfigMap.get(e),s=o&&o[0].start,a={numId:this.concreteNumUniqueNumericId(),abstractNumId:n.id,reference:e,instance:r,overrideLevels:[s&&Number.isInteger(s)?{num:0,start:s}:{num:0,start:1}]};this.concreteNumberingMap.set(i,new ko(a))}get ConcreteNumbering(){return Array.from(this.concreteNumberingMap.values())}get ReferenceConfig(){return Array.from(this.referenceConfigMap.values())}},Sl=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{version:"w:val",name:"w:name",uri:"w:uri"})}},Al=class extends Y{constructor(e){super("w:compatSetting"),this.root.push(new Sl({version:e,uri:"http://schemas.microsoft.com/office/word",name:"compatibilityMode"}))}},Il=class extends Y{constructor(e){super("w:compat"),e.version&&this.root.push(new Al(e.version)),e.useSingleBorderforContiguousCells&&this.root.push(new ue("w:useSingleBorderforContiguousCells",e.useSingleBorderforContiguousCells)),e.wordPerfectJustification&&this.root.push(new ue("w:wpJustification",e.wordPerfectJustification)),e.noTabStopForHangingIndent&&this.root.push(new ue("w:noTabHangInd",e.noTabStopForHangingIndent)),e.noLeading&&this.root.push(new ue("w:noLeading",e.noLeading)),e.spaceForUnderline&&this.root.push(new ue("w:spaceForUL",e.spaceForUnderline)),e.noColumnBalance&&this.root.push(new ue("w:noColumnBalance",e.noColumnBalance)),e.balanceSingleByteDoubleByteWidth&&this.root.push(new ue("w:balanceSingleByteDoubleByteWidth",e.balanceSingleByteDoubleByteWidth)),e.noExtraLineSpacing&&this.root.push(new ue("w:noExtraLineSpacing",e.noExtraLineSpacing)),e.doNotLeaveBackslashAlone&&this.root.push(new ue("w:doNotLeaveBackslashAlone",e.doNotLeaveBackslashAlone)),e.underlineTrailingSpaces&&this.root.push(new ue("w:ulTrailSpace",e.underlineTrailingSpaces)),e.doNotExpandShiftReturn&&this.root.push(new ue("w:doNotExpandShiftReturn",e.doNotExpandShiftReturn)),e.spacingInWholePoints&&this.root.push(new ue("w:spacingInWholePoints",e.spacingInWholePoints)),e.lineWrapLikeWord6&&this.root.push(new ue("w:lineWrapLikeWord6",e.lineWrapLikeWord6)),e.printBodyTextBeforeHeader&&this.root.push(new ue("w:printBodyTextBeforeHeader",e.printBodyTextBeforeHeader)),e.printColorsBlack&&this.root.push(new ue("w:printColBlack",e.printColorsBlack)),e.spaceWidth&&this.root.push(new ue("w:wpSpaceWidth",e.spaceWidth)),e.showBreaksInFrames&&this.root.push(new ue("w:showBreaksInFrames",e.showBreaksInFrames)),e.subFontBySize&&this.root.push(new ue("w:subFontBySize",e.subFontBySize)),e.suppressBottomSpacing&&this.root.push(new ue("w:suppressBottomSpacing",e.suppressBottomSpacing)),e.suppressTopSpacing&&this.root.push(new ue("w:suppressTopSpacing",e.suppressTopSpacing)),e.suppressSpacingAtTopOfPage&&this.root.push(new ue("w:suppressSpacingAtTopOfPage",e.suppressSpacingAtTopOfPage)),e.suppressTopSpacingWP&&this.root.push(new ue("w:suppressTopSpacingWP",e.suppressTopSpacingWP)),e.suppressSpBfAfterPgBrk&&this.root.push(new ue("w:suppressSpBfAfterPgBrk",e.suppressSpBfAfterPgBrk)),e.swapBordersFacingPages&&this.root.push(new ue("w:swapBordersFacingPages",e.swapBordersFacingPages)),e.convertMailMergeEsc&&this.root.push(new ue("w:convMailMergeEsc",e.convertMailMergeEsc)),e.truncateFontHeightsLikeWP6&&this.root.push(new ue("w:truncateFontHeightsLikeWP6",e.truncateFontHeightsLikeWP6)),e.macWordSmallCaps&&this.root.push(new ue("w:mwSmallCaps",e.macWordSmallCaps)),e.usePrinterMetrics&&this.root.push(new ue("w:usePrinterMetrics",e.usePrinterMetrics)),e.doNotSuppressParagraphBorders&&this.root.push(new ue("w:doNotSuppressParagraphBorders",e.doNotSuppressParagraphBorders)),e.wrapTrailSpaces&&this.root.push(new ue("w:wrapTrailSpaces",e.wrapTrailSpaces)),e.footnoteLayoutLikeWW8&&this.root.push(new ue("w:footnoteLayoutLikeWW8",e.footnoteLayoutLikeWW8)),e.shapeLayoutLikeWW8&&this.root.push(new ue("w:shapeLayoutLikeWW8",e.shapeLayoutLikeWW8)),e.alignTablesRowByRow&&this.root.push(new ue("w:alignTablesRowByRow",e.alignTablesRowByRow)),e.forgetLastTabAlignment&&this.root.push(new ue("w:forgetLastTabAlignment",e.forgetLastTabAlignment)),e.adjustLineHeightInTable&&this.root.push(new ue("w:adjustLineHeightInTable",e.adjustLineHeightInTable)),e.autoSpaceLikeWord95&&this.root.push(new ue("w:autoSpaceLikeWord95",e.autoSpaceLikeWord95)),e.noSpaceRaiseLower&&this.root.push(new ue("w:noSpaceRaiseLower",e.noSpaceRaiseLower)),e.doNotUseHTMLParagraphAutoSpacing&&this.root.push(new ue("w:doNotUseHTMLParagraphAutoSpacing",e.doNotUseHTMLParagraphAutoSpacing)),e.layoutRawTableWidth&&this.root.push(new ue("w:layoutRawTableWidth",e.layoutRawTableWidth)),e.layoutTableRowsApart&&this.root.push(new ue("w:layoutTableRowsApart",e.layoutTableRowsApart)),e.useWord97LineBreakRules&&this.root.push(new ue("w:useWord97LineBreakRules",e.useWord97LineBreakRules)),e.doNotBreakWrappedTables&&this.root.push(new ue("w:doNotBreakWrappedTables",e.doNotBreakWrappedTables)),e.doNotSnapToGridInCell&&this.root.push(new ue("w:doNotSnapToGridInCell",e.doNotSnapToGridInCell)),e.selectFieldWithFirstOrLastCharacter&&this.root.push(new ue("w:selectFldWithFirstOrLastChar",e.selectFieldWithFirstOrLastCharacter)),e.applyBreakingRules&&this.root.push(new ue("w:applyBreakingRules",e.applyBreakingRules)),e.doNotWrapTextWithPunctuation&&this.root.push(new ue("w:doNotWrapTextWithPunct",e.doNotWrapTextWithPunctuation)),e.doNotUseEastAsianBreakRules&&this.root.push(new ue("w:doNotUseEastAsianBreakRules",e.doNotUseEastAsianBreakRules)),e.useWord2002TableStyleRules&&this.root.push(new ue("w:useWord2002TableStyleRules",e.useWord2002TableStyleRules)),e.growAutofit&&this.root.push(new ue("w:growAutofit",e.growAutofit)),e.useFELayout&&this.root.push(new ue("w:useFELayout",e.useFELayout)),e.useNormalStyleForList&&this.root.push(new ue("w:useNormalStyleForList",e.useNormalStyleForList)),e.doNotUseIndentAsNumberingTabStop&&this.root.push(new ue("w:doNotUseIndentAsNumberingTabStop",e.doNotUseIndentAsNumberingTabStop)),e.useAlternateEastAsianLineBreakRules&&this.root.push(new ue("w:useAltKinsokuLineBreakRules",e.useAlternateEastAsianLineBreakRules)),e.allowSpaceOfSameStyleInTable&&this.root.push(new ue("w:allowSpaceOfSameStyleInTable",e.allowSpaceOfSameStyleInTable)),e.doNotSuppressIndentation&&this.root.push(new ue("w:doNotSuppressIndentation",e.doNotSuppressIndentation)),e.doNotAutofitConstrainedTables&&this.root.push(new ue("w:doNotAutofitConstrainedTables",e.doNotAutofitConstrainedTables)),e.autofitToFirstFixedWidthCell&&this.root.push(new ue("w:autofitToFirstFixedWidthCell",e.autofitToFirstFixedWidthCell)),e.underlineTabInNumberingList&&this.root.push(new ue("w:underlineTabInNumList",e.underlineTabInNumberingList)),e.displayHangulFixedWidth&&this.root.push(new ue("w:displayHangulFixedWidth",e.displayHangulFixedWidth)),e.splitPgBreakAndParaMark&&this.root.push(new ue("w:splitPgBreakAndParaMark",e.splitPgBreakAndParaMark)),e.doNotVerticallyAlignCellWithSp&&this.root.push(new ue("w:doNotVertAlignCellWithSp",e.doNotVerticallyAlignCellWithSp)),e.doNotBreakConstrainedForcedTable&&this.root.push(new ue("w:doNotBreakConstrainedForcedTable",e.doNotBreakConstrainedForcedTable)),e.ignoreVerticalAlignmentInTextboxes&&this.root.push(new ue("w:doNotVertAlignInTxbx",e.ignoreVerticalAlignmentInTextboxes)),e.useAnsiKerningPairs&&this.root.push(new ue("w:useAnsiKerningPairs",e.useAnsiKerningPairs)),e.cachedColumnBalance&&this.root.push(new ue("w:cachedColBalance",e.cachedColumnBalance))}},kl=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable"})}},Ol=class extends Y{constructor(e){var r,n,i,o;super("w:settings"),this.root.push(new kl({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"})),this.root.push(new ue("w:displayBackgroundShape",!0)),e.trackRevisions!==void 0&&this.root.push(new ue("w:trackRevisions",e.trackRevisions)),e.evenAndOddHeaders!==void 0&&this.root.push(new ue("w:evenAndOddHeaders",e.evenAndOddHeaders)),e.updateFields!==void 0&&this.root.push(new ue("w:updateFields",e.updateFields)),e.defaultTabStop!==void 0&&this.root.push(new Jn("w:defaultTabStop",e.defaultTabStop)),this.root.push(new Il(wn(Oe({},(r=e.compatibility)!=null?r:{}),{version:(o=(i=(n=e.compatibility)==null?void 0:n.version)!=null?i:e.compatibilityModeVersion)!=null?o:15})))}},Oo=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{val:"w:val"})}},Rl=class extends Y{constructor(e){super("w:name"),this.root.push(new Oo({val:e}))}},Nl=class extends Y{constructor(e){super("w:uiPriority"),this.root.push(new Oo({val:st(e)}))}},Ll=class extends me{constructor(){super(...arguments),X(this,"xmlKeys",{type:"w:type",styleId:"w:styleId",default:"w:default",customStyle:"w:customStyle"})}},Ro=class extends Y{constructor(e,r){super("w:style"),this.root.push(new Ll(e)),r.name&&this.root.push(new Rl(r.name)),r.basedOn&&this.root.push(new rr("w:basedOn",r.basedOn)),r.next&&this.root.push(new rr("w:next",r.next)),r.link&&this.root.push(new rr("w:link",r.link)),r.uiPriority!==void 0&&this.root.push(new Nl(r.uiPriority)),r.semiHidden!==void 0&&this.root.push(new ue("w:semiHidden",r.semiHidden)),r.unhideWhenUsed!==void 0&&this.root.push(new ue("w:unhideWhenUsed",r.unhideWhenUsed)),r.quickFormat!==void 0&&this.root.push(new ue("w:qFormat",r.quickFormat))}},xn=class extends Ro{constructor(e){super({type:"paragraph",styleId:e.id},e),X(this,"paragraphProperties"),X(this,"runProperties"),this.paragraphProperties=new yr(e.paragraph),this.runProperties=new nr(e.run),this.root.push(this.paragraphProperties),this.root.push(this.runProperties)}},Dn=class extends Ro{constructor(e){super({type:"character",styleId:e.id},Oe({uiPriority:99,unhideWhenUsed:!0},e)),X(this,"runProperties"),this.runProperties=new nr(e.run),this.root.push(this.runProperties)}},Gt=class extends xn{constructor(e){super(Oe({basedOn:"Normal",next:"Normal",quickFormat:!0},e))}},Fl=class extends Gt{constructor(e){super(Oe({id:"Title",name:"Title"},e))}},Pl=class extends Gt{constructor(e){super(Oe({id:"Heading1",name:"Heading 1"},e))}},Ml=class extends Gt{constructor(e){super(Oe({id:"Heading2",name:"Heading 2"},e))}},Bl=class extends Gt{constructor(e){super(Oe({id:"Heading3",name:"Heading 3"},e))}},Ul=class extends Gt{constructor(e){super(Oe({id:"Heading4",name:"Heading 4"},e))}},jl=class extends Gt{constructor(e){super(Oe({id:"Heading5",name:"Heading 5"},e))}},Hl=class extends Gt{constructor(e){super(Oe({id:"Heading6",name:"Heading 6"},e))}},Wl=class extends Gt{constructor(e){super(Oe({id:"Strong",name:"Strong"},e))}},zl=class extends xn{constructor(e){super(Oe({id:"ListParagraph",name:"List Paragraph",basedOn:"Normal",quickFormat:!0},e))}},Gl=class extends xn{constructor(e){super(Oe({id:"FootnoteText",name:"footnote text",link:"FootnoteTextChar",basedOn:"Normal",uiPriority:99,semiHidden:!0,unhideWhenUsed:!0,paragraph:{spacing:{after:0,line:240,lineRule:Fu.AUTO}},run:{size:20}},e))}},$l=class extends Dn{constructor(e){super(Oe({id:"FootnoteReference",name:"footnote reference",basedOn:"DefaultParagraphFont",semiHidden:!0,run:{superScript:!0}},e))}},Vl=class extends Dn{constructor(e){super(Oe({id:"FootnoteTextChar",name:"Footnote Text Char",basedOn:"DefaultParagraphFont",link:"FootnoteText",semiHidden:!0,run:{size:20}},e))}},Kl=class extends Dn{constructor(e){super(Oe({id:"Hyperlink",name:"Hyperlink",basedOn:"DefaultParagraphFont",run:{color:"0563C1",underline:{type:Ym.SINGLE}}},e))}},ii=class extends Y{constructor(e){if(super("w:styles"),e.initialStyles&&this.root.push(e.initialStyles),e.importedStyles)for(let r of e.importedStyles)this.root.push(r);if(e.paragraphStyles)for(let r of e.paragraphStyles)this.root.push(new xn(r));if(e.characterStyles)for(let r of e.characterStyles)this.root.push(new Dn(r))}},ql=class extends Y{constructor(e){super("w:pPrDefault"),this.root.push(new yr(e))}},Yl=class extends Y{constructor(e){super("w:rPrDefault"),this.root.push(new nr(e))}},Xl=class extends Y{constructor(e){super("w:docDefaults"),X(this,"runPropertiesDefaults"),X(this,"paragraphPropertiesDefaults"),this.runPropertiesDefaults=new Yl(e.run),this.paragraphPropertiesDefaults=new ql(e.paragraph),this.root.push(this.runPropertiesDefaults),this.root.push(this.paragraphPropertiesDefaults)}},Zl=class{newInstance(e){let r=$m.xml2js(e,{compact:!1}),n;for(let s of r.elements||[])s.name==="w:styles"&&(n=s);if(n===void 0)throw new Error("can not find styles element");let i=n.elements||[];return new ii({initialStyles:new ps(n.attributes),importedStyles:i.map(s=>fd(s))})}},No=class{newInstance(e={}){var r;return{initialStyles:new Sr({mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",Ignorable:"w14 w15"}),importedStyles:[new Xl((r=e.document)!=null?r:{}),new Fl(Oe({run:{size:56}},e.title)),new Pl(Oe({run:{color:"2E74B5",size:32}},e.heading1)),new Ml(Oe({run:{color:"2E74B5",size:26}},e.heading2)),new Bl(Oe({run:{color:"1F4D78",size:24}},e.heading3)),new Ul(Oe({run:{color:"2E74B5",italics:!0}},e.heading4)),new jl(Oe({run:{color:"2E74B5"}},e.heading5)),new Hl(Oe({run:{color:"1F4D78"}},e.heading6)),new Wl(Oe({run:{bold:!0}},e.strong)),new zl(e.listParagraph||{}),new Kl(e.hyperlink||{}),new $l(e.footnoteReference||{}),new Gl(e.footnoteText||{}),new Vl(e.footnoteTextChar||{})]}}};var no=({id:t,fontKey:e,subsetted:r},n)=>new nt({name:n,attributes:Oe({id:{key:"r:id",value:t}},e?{fontKey:{key:"w:fontKey",value:`{${e}}`}}:{}),children:[...r?[new ue("w:subsetted",r)]:[]]}),Ky=({name:t,altName:e,panose1:r,charset:n,family:i,notTrueType:o,pitch:s,sig:a,embedRegular:l,embedBold:g,embedItalic:_,embedBoldItalic:b})=>new nt({name:"w:font",attributes:{name:{key:"w:name",value:t}},children:[...e?[Vn("w:altName",e)]:[],...r?[Vn("w:panose1",r)]:[],...n?[Vn("w:charset",n)]:[],...i?[Vn("w:family",i)]:[],...o?[new ue("w:notTrueType",o)]:[],...s?[Vn("w:pitch",s)]:[],...a?[new nt({name:"w:sig",attributes:{usb0:{key:"w:usb0",value:a.usb0},usb1:{key:"w:usb1",value:a.usb1},usb2:{key:"w:usb2",value:a.usb2},usb3:{key:"w:usb3",value:a.usb3},csb0:{key:"w:csb0",value:a.csb0},csb1:{key:"w:csb1",value:a.csb1}}})]:[],...l?[no(l,"w:embedRegular")]:[],...g?[no(g,"w:embedBold")]:[],..._?[no(_,"w:embedItalic")]:[],...b?[no(b,"w:embedBoldItalic")]:[]]}),qy=({name:t,index:e,fontKey:r,characterSet:n})=>Ky({name:t,sig:{usb0:"E0002AFF",usb1:"C000247B",usb2:"00000009",usb3:"00000000",csb0:"000001FF",csb1:"00000000"},charset:n,family:"auto",pitch:"variable",embedRegular:{fontKey:r,id:`rId${e}`}}),Yy=t=>new nt({name:"w:fonts",attributes:{mc:{key:"xmlns:mc",value:"http://schemas.openxmlformats.org/markup-compatibility/2006"},r:{key:"xmlns:r",value:"http://schemas.openxmlformats.org/officeDocument/2006/relationships"},w:{key:"xmlns:w",value:"http://schemas.openxmlformats.org/wordprocessingml/2006/main"},w14:{key:"xmlns:w14",value:"http://schemas.microsoft.com/office/word/2010/wordml"},w15:{key:"xmlns:w15",value:"http://schemas.microsoft.com/office/word/2012/wordml"},w16cex:{key:"xmlns:w16cex",value:"http://schemas.microsoft.com/office/word/2018/wordml/cex"},w16cid:{key:"xmlns:w16cid",value:"http://schemas.microsoft.com/office/word/2016/wordml/cid"},w16:{key:"xmlns:w16",value:"http://schemas.microsoft.com/office/word/2018/wordml"},w16sdtdh:{key:"xmlns:w16sdtdh",value:"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash"},w16se:{key:"xmlns:w16se",value:"http://schemas.microsoft.com/office/word/2015/wordml/symex"},Ignorable:{key:"mc:Ignorable",value:"w14 w15 w16se w16cid w16 w16cex w16sdtdh"}},children:t.map((e,r)=>qy({name:e.name,index:r+1,fontKey:e.fontKey}))}),Ql=class{constructor(e){X(this,"fontTable"),X(this,"relationships"),X(this,"fontOptionsWithKey",[]),this.options=e,this.fontOptionsWithKey=e.map(r=>wn(Oe({},r),{fontKey:Ly()})),this.fontTable=Yy(this.fontOptionsWithKey),this.relationships=new wr;for(let r=0;r<e.length;r++)this.relationships.createRelationship(r+1,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/font",`fonts/${e[r].name}.odttf`)}get View(){return this.fontTable}get Relationships(){return this.relationships}},Lo=class{constructor(e){X(this,"currentRelationshipId",1),X(this,"documentWrapper"),X(this,"headers",[]),X(this,"footers",[]),X(this,"coreProperties"),X(this,"numbering"),X(this,"media"),X(this,"fileRelationships"),X(this,"footnotesWrapper"),X(this,"settings"),X(this,"contentTypes"),X(this,"customProperties"),X(this,"appProperties"),X(this,"styles"),X(this,"comments"),X(this,"fontWrapper");var r,n,i,o,s,a,l,g;if(this.coreProperties=new zc(wn(Oe({},e),{creator:(r=e.creator)!=null?r:"Un-named",revision:(n=e.revision)!=null?n:1,lastModifiedBy:(i=e.lastModifiedBy)!=null?i:"Un-named"})),this.numbering=new Cl(e.numbering?e.numbering:{config:[]}),this.comments=new Nu((o=e.comments)!=null?o:{children:[]}),this.fileRelationships=new wr,this.customProperties=new qc((s=e.customProperties)!=null?s:[]),this.appProperties=new Bc,this.footnotesWrapper=new al,this.contentTypes=new Wc,this.documentWrapper=new xo({background:e.background}),this.settings=new Ol({compatibilityModeVersion:e.compatabilityModeVersion,compatibility:e.compatibility,evenAndOddHeaders:!!e.evenAndOddHeaderAndFooters,trackRevisions:(a=e.features)==null?void 0:a.trackRevisions,updateFields:(l=e.features)==null?void 0:l.updateFields,defaultTabStop:e.defaultTabStop}),this.media=new cl,e.externalStyles){let _=new Zl;this.styles=_.newInstance(e.externalStyles)}else if(e.styles){let b=new No().newInstance(e.styles.default);this.styles=new ii(Oe(Oe({},b),e.styles))}else{let _=new No;this.styles=new ii(_.newInstance())}this.addDefaultRelationships();for(let _ of e.sections)this.addSection(_);if(e.footnotes)for(let _ in e.footnotes)this.footnotesWrapper.View.createFootNote(parseFloat(_),e.footnotes[_].children);this.fontWrapper=new Ql((g=e.fonts)!=null?g:[])}addSection({headers:e={},footers:r={},children:n,properties:i}){this.documentWrapper.View.Body.addSection(wn(Oe({},i),{headerWrapperGroup:{default:e.default?this.createHeader(e.default):void 0,first:e.first?this.createHeader(e.first):void 0,even:e.even?this.createHeader(e.even):void 0},footerWrapperGroup:{default:r.default?this.createFooter(r.default):void 0,first:r.first?this.createFooter(r.first):void 0,even:r.even?this.createFooter(r.even):void 0}}));for(let o of n)this.documentWrapper.View.add(o)}createHeader(e){let r=new ul(this.media,this.currentRelationshipId++);for(let n of e.options.children)r.add(n);return this.addHeaderToDocument(r),r}createFooter(e){let r=new Xc(this.media,this.currentRelationshipId++);for(let n of e.options.children)r.add(n);return this.addFooterToDocument(r),r}addHeaderToDocument(e,r=gn.DEFAULT){this.headers.push({header:e,type:r}),this.documentWrapper.Relationships.createRelationship(e.View.ReferenceId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/header",`header${this.headers.length}.xml`),this.contentTypes.addHeader(this.headers.length)}addFooterToDocument(e,r=gn.DEFAULT){this.footers.push({footer:e,type:r}),this.documentWrapper.Relationships.createRelationship(e.View.ReferenceId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer",`footer${this.footers.length}.xml`),this.contentTypes.addFooter(this.footers.length)}addDefaultRelationships(){this.fileRelationships.createRelationship(1,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument","word/document.xml"),this.fileRelationships.createRelationship(2,"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties","docProps/core.xml"),this.fileRelationships.createRelationship(3,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties","docProps/app.xml"),this.fileRelationships.createRelationship(4,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties","docProps/custom.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles","styles.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering","numbering.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes","footnotes.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings","settings.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments","comments.xml")}get Document(){return this.documentWrapper}get Styles(){return this.styles}get CoreProperties(){return this.coreProperties}get Numbering(){return this.numbering}get Media(){return this.media}get FileRelationships(){return this.fileRelationships}get Headers(){return this.headers.map(e=>e.header)}get Footers(){return this.footers.map(e=>e.footer)}get ContentTypes(){return this.contentTypes}get CustomProperties(){return this.customProperties}get AppProperties(){return this.appProperties}get FootNotes(){return this.footnotesWrapper}get Settings(){return this.settings}get Comments(){return this.comments}get FontTable(){return this.fontWrapper}};var rm=class{constructor(e={children:[]}){X(this,"options"),this.options=e}},nm=class{constructor(e={children:[]}){X(this,"options"),this.options=e}};function io(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var np={exports:{}};(function(t,e){(function(r){t.exports=r()})(function(){return function r(n,i,o){function s(g,_){if(!i[g]){if(!n[g]){var b=typeof io=="function"&&io;if(!_&&b)return b(g,!0);if(a)return a(g,!0);var T=new Error("Cannot find module '"+g+"'");throw T.code="MODULE_NOT_FOUND",T}var w=i[g]={exports:{}};n[g][0].call(w.exports,function(x){var v=n[g][1][x];return s(v||x)},w,w.exports,r,n,i,o)}return i[g].exports}for(var a=typeof io=="function"&&io,l=0;l<o.length;l++)s(o[l]);return s}({1:[function(r,n,i){var o=r("./utils"),s=r("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(l){for(var g,_,b,T,w,x,v,C=[],m=0,D=l.length,S=D,N=o.getTypeOf(l)!=="string";m<l.length;)S=D-m,b=N?(g=l[m++],_=m<D?l[m++]:0,m<D?l[m++]:0):(g=l.charCodeAt(m++),_=m<D?l.charCodeAt(m++):0,m<D?l.charCodeAt(m++):0),T=g>>2,w=(3&g)<<4|_>>4,x=1<S?(15&_)<<2|b>>6:64,v=2<S?63&b:64,C.push(a.charAt(T)+a.charAt(w)+a.charAt(x)+a.charAt(v));return C.join("")},i.decode=function(l){var g,_,b,T,w,x,v=0,C=0,m="data:";if(l.substr(0,m.length)===m)throw new Error("Invalid base64 input, it looks like a data url.");var D,S=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===a.charAt(64)&&S--,l.charAt(l.length-2)===a.charAt(64)&&S--,S%1!=0)throw new Error("Invalid base64 input, bad content length.");for(D=s.uint8array?new Uint8Array(0|S):new Array(0|S);v<l.length;)g=a.indexOf(l.charAt(v++))<<2|(T=a.indexOf(l.charAt(v++)))>>4,_=(15&T)<<4|(w=a.indexOf(l.charAt(v++)))>>2,b=(3&w)<<6|(x=a.indexOf(l.charAt(v++))),D[C++]=g,w!==64&&(D[C++]=_),x!==64&&(D[C++]=b);return D}},{"./support":30,"./utils":32}],2:[function(r,n,i){var o=r("./external"),s=r("./stream/DataWorker"),a=r("./stream/Crc32Probe"),l=r("./stream/DataLengthProbe");function g(_,b,T,w,x){this.compressedSize=_,this.uncompressedSize=b,this.crc32=T,this.compression=w,this.compressedContent=x}g.prototype={getContentWorker:function(){var _=new s(o.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),b=this;return _.on("end",function(){if(this.streamInfo.data_length!==b.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),_},getCompressedWorker:function(){return new s(o.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},g.createWorkerFrom=function(_,b,T){return _.pipe(new a).pipe(new l("uncompressedSize")).pipe(b.compressWorker(T)).pipe(new l("compressedSize")).withStreamInfo("compression",b)},n.exports=g},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(r,n,i){var o=r("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new o("STORE compression")},uncompressWorker:function(){return new o("STORE decompression")}},i.DEFLATE=r("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(r,n,i){var o=r("./utils"),s=function(){for(var a,l=[],g=0;g<256;g++){a=g;for(var _=0;_<8;_++)a=1&a?3988292384^a>>>1:a>>>1;l[g]=a}return l}();n.exports=function(a,l){return a!==void 0&&a.length?o.getTypeOf(a)!=="string"?function(g,_,b,T){var w=s,x=T+b;g^=-1;for(var v=T;v<x;v++)g=g>>>8^w[255&(g^_[v])];return-1^g}(0|l,a,a.length,0):function(g,_,b,T){var w=s,x=T+b;g^=-1;for(var v=T;v<x;v++)g=g>>>8^w[255&(g^_.charCodeAt(v))];return-1^g}(0|l,a,a.length,0):0}},{"./utils":32}],5:[function(r,n,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(r,n,i){var o=null;o=typeof Promise<"u"?Promise:r("lie"),n.exports={Promise:o}},{lie:37}],7:[function(r,n,i){var o=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",s=r("pako"),a=r("./utils"),l=r("./stream/GenericWorker"),g=o?"uint8array":"array";function _(b,T){l.call(this,"FlateWorker/"+b),this._pako=null,this._pakoAction=b,this._pakoOptions=T,this.meta={}}i.magic="\b\0",a.inherits(_,l),_.prototype.processChunk=function(b){this.meta=b.meta,this._pako===null&&this._createPako(),this._pako.push(a.transformTo(g,b.data),!1)},_.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},_.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},_.prototype._createPako=function(){this._pako=new s[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var b=this;this._pako.onData=function(T){b.push({data:T,meta:b.meta})}},i.compressWorker=function(b){return new _("Deflate",b)},i.uncompressWorker=function(){return new _("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(r,n,i){function o(w,x){var v,C="";for(v=0;v<x;v++)C+=String.fromCharCode(255&w),w>>>=8;return C}function s(w,x,v,C,m,D){var S,N,M=w.file,te=w.compression,V=D!==g.utf8encode,ne=a.transformTo("string",D(M.name)),A=a.transformTo("string",g.utf8encode(M.name)),ce=M.comment,pe=a.transformTo("string",D(ce)),L=a.transformTo("string",g.utf8encode(ce)),K=A.length!==M.name.length,E=L.length!==ce.length,Z="",he="",J="",ve=M.dir,oe=M.date,ge={crc32:0,compressedSize:0,uncompressedSize:0};x&&!v||(ge.crc32=w.crc32,ge.compressedSize=w.compressedSize,ge.uncompressedSize=w.uncompressedSize);var G=0;x&&(G|=8),V||!K&&!E||(G|=2048);var k=0,z=0;ve&&(k|=16),m==="UNIX"?(z=798,k|=function(ie,j){var p=ie;return ie||(p=j?16893:33204),(65535&p)<<16}(M.unixPermissions,ve)):(z=20,k|=function(ie){return 63&(ie||0)}(M.dosPermissions)),S=oe.getUTCHours(),S<<=6,S|=oe.getUTCMinutes(),S<<=5,S|=oe.getUTCSeconds()/2,N=oe.getUTCFullYear()-1980,N<<=4,N|=oe.getUTCMonth()+1,N<<=5,N|=oe.getUTCDate(),K&&(he=o(1,1)+o(_(ne),4)+A,Z+="up"+o(he.length,2)+he),E&&(J=o(1,1)+o(_(pe),4)+L,Z+="uc"+o(J.length,2)+J);var $="";return $+=`
\0`,$+=o(G,2),$+=te.magic,$+=o(S,2),$+=o(N,2),$+=o(ge.crc32,4),$+=o(ge.compressedSize,4),$+=o(ge.uncompressedSize,4),$+=o(ne.length,2),$+=o(Z.length,2),{fileRecord:b.LOCAL_FILE_HEADER+$+ne+Z,dirRecord:b.CENTRAL_FILE_HEADER+o(z,2)+$+o(pe.length,2)+"\0\0\0\0"+o(k,4)+o(C,4)+ne+Z+pe}}var a=r("../utils"),l=r("../stream/GenericWorker"),g=r("../utf8"),_=r("../crc32"),b=r("../signature");function T(w,x,v,C){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=x,this.zipPlatform=v,this.encodeFileName=C,this.streamFiles=w,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}a.inherits(T,l),T.prototype.push=function(w){var x=w.meta.percent||0,v=this.entriesCount,C=this._sources.length;this.accumulate?this.contentBuffer.push(w):(this.bytesWritten+=w.data.length,l.prototype.push.call(this,{data:w.data,meta:{currentFile:this.currentFile,percent:v?(x+100*(v-C-1))/v:100}}))},T.prototype.openedSource=function(w){this.currentSourceOffset=this.bytesWritten,this.currentFile=w.file.name;var x=this.streamFiles&&!w.file.dir;if(x){var v=s(w,x,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:v.fileRecord,meta:{percent:0}})}else this.accumulate=!0},T.prototype.closedSource=function(w){this.accumulate=!1;var x=this.streamFiles&&!w.file.dir,v=s(w,x,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(v.dirRecord),x)this.push({data:function(C){return b.DATA_DESCRIPTOR+o(C.crc32,4)+o(C.compressedSize,4)+o(C.uncompressedSize,4)}(w),meta:{percent:100}});else for(this.push({data:v.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},T.prototype.flush=function(){for(var w=this.bytesWritten,x=0;x<this.dirRecords.length;x++)this.push({data:this.dirRecords[x],meta:{percent:100}});var v=this.bytesWritten-w,C=function(m,D,S,N,M){var te=a.transformTo("string",M(N));return b.CENTRAL_DIRECTORY_END+"\0\0\0\0"+o(m,2)+o(m,2)+o(D,4)+o(S,4)+o(te.length,2)+te}(this.dirRecords.length,v,w,this.zipComment,this.encodeFileName);this.push({data:C,meta:{percent:100}})},T.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},T.prototype.registerPrevious=function(w){this._sources.push(w);var x=this;return w.on("data",function(v){x.processChunk(v)}),w.on("end",function(){x.closedSource(x.previous.streamInfo),x._sources.length?x.prepareNextSource():x.end()}),w.on("error",function(v){x.error(v)}),this},T.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},T.prototype.error=function(w){var x=this._sources;if(!l.prototype.error.call(this,w))return!1;for(var v=0;v<x.length;v++)try{x[v].error(w)}catch{}return!0},T.prototype.lock=function(){l.prototype.lock.call(this);for(var w=this._sources,x=0;x<w.length;x++)w[x].lock()},n.exports=T},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(r,n,i){var o=r("../compressions"),s=r("./ZipFileWorker");i.generateWorker=function(a,l,g){var _=new s(l.streamFiles,g,l.platform,l.encodeFileName),b=0;try{a.forEach(function(T,w){b++;var x=function(D,S){var N=D||S,M=o[N];if(!M)throw new Error(N+" is not a valid compression method !");return M}(w.options.compression,l.compression),v=w.options.compressionOptions||l.compressionOptions||{},C=w.dir,m=w.date;w._compressWorker(x,v).withStreamInfo("file",{name:T,dir:C,date:m,comment:w.comment||"",unixPermissions:w.unixPermissions,dosPermissions:w.dosPermissions}).pipe(_)}),_.entriesCount=b}catch(T){_.error(T)}return _}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(r,n,i){function o(){if(!(this instanceof o))return new o;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var s=new o;for(var a in this)typeof this[a]!="function"&&(s[a]=this[a]);return s}}(o.prototype=r("./object")).loadAsync=r("./load"),o.support=r("./support"),o.defaults=r("./defaults"),o.version="3.10.1",o.loadAsync=function(s,a){return new o().loadAsync(s,a)},o.external=r("./external"),n.exports=o},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(r,n,i){var o=r("./utils"),s=r("./external"),a=r("./utf8"),l=r("./zipEntries"),g=r("./stream/Crc32Probe"),_=r("./nodejsUtils");function b(T){return new s.Promise(function(w,x){var v=T.decompressed.getContentWorker().pipe(new g);v.on("error",function(C){x(C)}).on("end",function(){v.streamInfo.crc32!==T.decompressed.crc32?x(new Error("Corrupted zip : CRC32 mismatch")):w()}).resume()})}n.exports=function(T,w){var x=this;return w=o.extend(w||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),_.isNode&&_.isStream(T)?s.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):o.prepareContent("the loaded zip file",T,!0,w.optimizedBinaryString,w.base64).then(function(v){var C=new l(w);return C.load(v),C}).then(function(v){var C=[s.Promise.resolve(v)],m=v.files;if(w.checkCRC32)for(var D=0;D<m.length;D++)C.push(b(m[D]));return s.Promise.all(C)}).then(function(v){for(var C=v.shift(),m=C.files,D=0;D<m.length;D++){var S=m[D],N=S.fileNameStr,M=o.resolve(S.fileNameStr);x.file(M,S.decompressed,{binary:!0,optimizedBinaryString:!0,date:S.date,dir:S.dir,comment:S.fileCommentStr.length?S.fileCommentStr:null,unixPermissions:S.unixPermissions,dosPermissions:S.dosPermissions,createFolders:w.createFolders}),S.dir||(x.file(M).unsafeOriginalName=N)}return C.zipComment.length&&(x.comment=C.zipComment),x})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(r,n,i){var o=r("../utils"),s=r("../stream/GenericWorker");function a(l,g){s.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(g)}o.inherits(a,s),a.prototype._bindStream=function(l){var g=this;(this._stream=l).pause(),l.on("data",function(_){g.push({data:_,meta:{percent:0}})}).on("error",function(_){g.isPaused?this.generatedError=_:g.error(_)}).on("end",function(){g.isPaused?g._upstreamEnded=!0:g.end()})},a.prototype.pause=function(){return!!s.prototype.pause.call(this)&&(this._stream.pause(),!0)},a.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},n.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(r,n,i){var o=r("readable-stream").Readable;function s(a,l,g){o.call(this,l),this._helper=a;var _=this;a.on("data",function(b,T){_.push(b)||_._helper.pause(),g&&g(T)}).on("error",function(b){_.emit("error",b)}).on("end",function(){_.push(null)})}r("../utils").inherits(s,o),s.prototype._read=function(){this._helper.resume()},n.exports=s},{"../utils":32,"readable-stream":16}],14:[function(r,n,i){n.exports={isNode:typeof Buffer<"u",newBufferFrom:function(o,s){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(o,s);if(typeof o=="number")throw new Error('The "data" argument must not be a number');return new Buffer(o,s)},allocBuffer:function(o){if(Buffer.alloc)return Buffer.alloc(o);var s=new Buffer(o);return s.fill(0),s},isBuffer:function(o){return Buffer.isBuffer(o)},isStream:function(o){return o&&typeof o.on=="function"&&typeof o.pause=="function"&&typeof o.resume=="function"}}},{}],15:[function(r,n,i){function o(M,te,V){var ne,A=a.getTypeOf(te),ce=a.extend(V||{},_);ce.date=ce.date||new Date,ce.compression!==null&&(ce.compression=ce.compression.toUpperCase()),typeof ce.unixPermissions=="string"&&(ce.unixPermissions=parseInt(ce.unixPermissions,8)),ce.unixPermissions&&16384&ce.unixPermissions&&(ce.dir=!0),ce.dosPermissions&&16&ce.dosPermissions&&(ce.dir=!0),ce.dir&&(M=m(M)),ce.createFolders&&(ne=C(M))&&D.call(this,ne,!0);var pe=A==="string"&&ce.binary===!1&&ce.base64===!1;V&&V.binary!==void 0||(ce.binary=!pe),(te instanceof b&&te.uncompressedSize===0||ce.dir||!te||te.length===0)&&(ce.base64=!1,ce.binary=!0,te="",ce.compression="STORE",A="string");var L=null;L=te instanceof b||te instanceof l?te:x.isNode&&x.isStream(te)?new v(M,te):a.prepareContent(M,te,ce.binary,ce.optimizedBinaryString,ce.base64);var K=new T(M,L,ce);this.files[M]=K}var s=r("./utf8"),a=r("./utils"),l=r("./stream/GenericWorker"),g=r("./stream/StreamHelper"),_=r("./defaults"),b=r("./compressedObject"),T=r("./zipObject"),w=r("./generate"),x=r("./nodejsUtils"),v=r("./nodejs/NodejsStreamInputAdapter"),C=function(M){M.slice(-1)==="/"&&(M=M.substring(0,M.length-1));var te=M.lastIndexOf("/");return 0<te?M.substring(0,te):""},m=function(M){return M.slice(-1)!=="/"&&(M+="/"),M},D=function(M,te){return te=te!==void 0?te:_.createFolders,M=m(M),this.files[M]||o.call(this,M,null,{dir:!0,createFolders:te}),this.files[M]};function S(M){return Object.prototype.toString.call(M)==="[object RegExp]"}var N={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(M){var te,V,ne;for(te in this.files)ne=this.files[te],(V=te.slice(this.root.length,te.length))&&te.slice(0,this.root.length)===this.root&&M(V,ne)},filter:function(M){var te=[];return this.forEach(function(V,ne){M(V,ne)&&te.push(ne)}),te},file:function(M,te,V){if(arguments.length!==1)return M=this.root+M,o.call(this,M,te,V),this;if(S(M)){var ne=M;return this.filter(function(ce,pe){return!pe.dir&&ne.test(ce)})}var A=this.files[this.root+M];return A&&!A.dir?A:null},folder:function(M){if(!M)return this;if(S(M))return this.filter(function(A,ce){return ce.dir&&M.test(A)});var te=this.root+M,V=D.call(this,te),ne=this.clone();return ne.root=V.name,ne},remove:function(M){M=this.root+M;var te=this.files[M];if(te||(M.slice(-1)!=="/"&&(M+="/"),te=this.files[M]),te&&!te.dir)delete this.files[M];else for(var V=this.filter(function(A,ce){return ce.name.slice(0,M.length)===M}),ne=0;ne<V.length;ne++)delete this.files[V[ne].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(M){var te,V={};try{if((V=a.extend(M||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:s.utf8encode})).type=V.type.toLowerCase(),V.compression=V.compression.toUpperCase(),V.type==="binarystring"&&(V.type="string"),!V.type)throw new Error("No output type specified.");a.checkSupport(V.type),V.platform!=="darwin"&&V.platform!=="freebsd"&&V.platform!=="linux"&&V.platform!=="sunos"||(V.platform="UNIX"),V.platform==="win32"&&(V.platform="DOS");var ne=V.comment||this.comment||"";te=w.generateWorker(this,V,ne)}catch(A){(te=new l("error")).error(A)}return new g(te,V.type||"string",V.mimeType)},generateAsync:function(M,te){return this.generateInternalStream(M).accumulate(te)},generateNodeStream:function(M,te){return(M=M||{}).type||(M.type="nodebuffer"),this.generateInternalStream(M).toNodejsStream(te)}};n.exports=N},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(r,n,i){n.exports=r("stream")},{stream:void 0}],17:[function(r,n,i){var o=r("./DataReader");function s(a){o.call(this,a);for(var l=0;l<this.data.length;l++)a[l]=255&a[l]}r("../utils").inherits(s,o),s.prototype.byteAt=function(a){return this.data[this.zero+a]},s.prototype.lastIndexOfSignature=function(a){for(var l=a.charCodeAt(0),g=a.charCodeAt(1),_=a.charCodeAt(2),b=a.charCodeAt(3),T=this.length-4;0<=T;--T)if(this.data[T]===l&&this.data[T+1]===g&&this.data[T+2]===_&&this.data[T+3]===b)return T-this.zero;return-1},s.prototype.readAndCheckSignature=function(a){var l=a.charCodeAt(0),g=a.charCodeAt(1),_=a.charCodeAt(2),b=a.charCodeAt(3),T=this.readData(4);return l===T[0]&&g===T[1]&&_===T[2]&&b===T[3]},s.prototype.readData=function(a){if(this.checkOffset(a),a===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},n.exports=s},{"../utils":32,"./DataReader":18}],18:[function(r,n,i){var o=r("../utils");function s(a){this.data=a,this.length=a.length,this.index=0,this.zero=0}s.prototype={checkOffset:function(a){this.checkIndex(this.index+a)},checkIndex:function(a){if(this.length<this.zero+a||a<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+a+"). Corrupted zip ?")},setIndex:function(a){this.checkIndex(a),this.index=a},skip:function(a){this.setIndex(this.index+a)},byteAt:function(){},readInt:function(a){var l,g=0;for(this.checkOffset(a),l=this.index+a-1;l>=this.index;l--)g=(g<<8)+this.byteAt(l);return this.index+=a,g},readString:function(a){return o.transformTo("string",this.readData(a))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var a=this.readInt(4);return new Date(Date.UTC(1980+(a>>25&127),(a>>21&15)-1,a>>16&31,a>>11&31,a>>5&63,(31&a)<<1))}},n.exports=s},{"../utils":32}],19:[function(r,n,i){var o=r("./Uint8ArrayReader");function s(a){o.call(this,a)}r("../utils").inherits(s,o),s.prototype.readData=function(a){this.checkOffset(a);var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},n.exports=s},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(r,n,i){var o=r("./DataReader");function s(a){o.call(this,a)}r("../utils").inherits(s,o),s.prototype.byteAt=function(a){return this.data.charCodeAt(this.zero+a)},s.prototype.lastIndexOfSignature=function(a){return this.data.lastIndexOf(a)-this.zero},s.prototype.readAndCheckSignature=function(a){return a===this.readData(4)},s.prototype.readData=function(a){this.checkOffset(a);var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},n.exports=s},{"../utils":32,"./DataReader":18}],21:[function(r,n,i){var o=r("./ArrayReader");function s(a){o.call(this,a)}r("../utils").inherits(s,o),s.prototype.readData=function(a){if(this.checkOffset(a),a===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},n.exports=s},{"../utils":32,"./ArrayReader":17}],22:[function(r,n,i){var o=r("../utils"),s=r("../support"),a=r("./ArrayReader"),l=r("./StringReader"),g=r("./NodeBufferReader"),_=r("./Uint8ArrayReader");n.exports=function(b){var T=o.getTypeOf(b);return o.checkSupport(T),T!=="string"||s.uint8array?T==="nodebuffer"?new g(b):s.uint8array?new _(o.transformTo("uint8array",b)):new a(o.transformTo("array",b)):new l(b)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(r,n,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(r,n,i){var o=r("./GenericWorker"),s=r("../utils");function a(l){o.call(this,"ConvertWorker to "+l),this.destType=l}s.inherits(a,o),a.prototype.processChunk=function(l){this.push({data:s.transformTo(this.destType,l.data),meta:l.meta})},n.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(r,n,i){var o=r("./GenericWorker"),s=r("../crc32");function a(){o.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}r("../utils").inherits(a,o),a.prototype.processChunk=function(l){this.streamInfo.crc32=s(l.data,this.streamInfo.crc32||0),this.push(l)},n.exports=a},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(r,n,i){var o=r("../utils"),s=r("./GenericWorker");function a(l){s.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}o.inherits(a,s),a.prototype.processChunk=function(l){if(l){var g=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=g+l.data.length}s.prototype.processChunk.call(this,l)},n.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(r,n,i){var o=r("../utils"),s=r("./GenericWorker");function a(l){s.call(this,"DataWorker");var g=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(_){g.dataIsReady=!0,g.data=_,g.max=_&&_.length||0,g.type=o.getTypeOf(_),g.isPaused||g._tickAndRepeat()},function(_){g.error(_)})}o.inherits(a,s),a.prototype.cleanUp=function(){s.prototype.cleanUp.call(this),this.data=null},a.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,o.delay(this._tickAndRepeat,[],this)),!0)},a.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(o.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},a.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,g=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,g);break;case"uint8array":l=this.data.subarray(this.index,g);break;case"array":case"nodebuffer":l=this.data.slice(this.index,g)}return this.index=g,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=a},{"../utils":32,"./GenericWorker":28}],28:[function(r,n,i){function o(s){this.name=s||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}o.prototype={push:function(s){this.emit("data",s)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(s){this.emit("error",s)}return!0},error:function(s){return!this.isFinished&&(this.isPaused?this.generatedError=s:(this.isFinished=!0,this.emit("error",s),this.previous&&this.previous.error(s),this.cleanUp()),!0)},on:function(s,a){return this._listeners[s].push(a),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(s,a){if(this._listeners[s])for(var l=0;l<this._listeners[s].length;l++)this._listeners[s][l].call(this,a)},pipe:function(s){return s.registerPrevious(this)},registerPrevious:function(s){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=s.streamInfo,this.mergeStreamInfo(),this.previous=s;var a=this;return s.on("data",function(l){a.processChunk(l)}),s.on("end",function(){a.end()}),s.on("error",function(l){a.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var s=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),s=!0),this.previous&&this.previous.resume(),!s},flush:function(){},processChunk:function(s){this.push(s)},withStreamInfo:function(s,a){return this.extraStreamInfo[s]=a,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var s in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,s)&&(this.streamInfo[s]=this.extraStreamInfo[s])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var s="Worker "+this.name;return this.previous?this.previous+" -> "+s:s}},n.exports=o},{}],29:[function(r,n,i){var o=r("../utils"),s=r("./ConvertWorker"),a=r("./GenericWorker"),l=r("../base64"),g=r("../support"),_=r("../external"),b=null;if(g.nodestream)try{b=r("../nodejs/NodejsStreamOutputAdapter")}catch{}function T(x,v){return new _.Promise(function(C,m){var D=[],S=x._internalType,N=x._outputType,M=x._mimeType;x.on("data",function(te,V){D.push(te),v&&v(V)}).on("error",function(te){D=[],m(te)}).on("end",function(){try{var te=function(V,ne,A){switch(V){case"blob":return o.newBlob(o.transformTo("arraybuffer",ne),A);case"base64":return l.encode(ne);default:return o.transformTo(V,ne)}}(N,function(V,ne){var A,ce=0,pe=null,L=0;for(A=0;A<ne.length;A++)L+=ne[A].length;switch(V){case"string":return ne.join("");case"array":return Array.prototype.concat.apply([],ne);case"uint8array":for(pe=new Uint8Array(L),A=0;A<ne.length;A++)pe.set(ne[A],ce),ce+=ne[A].length;return pe;case"nodebuffer":return Buffer.concat(ne);default:throw new Error("concat : unsupported type '"+V+"'")}}(S,D),M);C(te)}catch(V){m(V)}D=[]}).resume()})}function w(x,v,C){var m=v;switch(v){case"blob":case"arraybuffer":m="uint8array";break;case"base64":m="string"}try{this._internalType=m,this._outputType=v,this._mimeType=C,o.checkSupport(m),this._worker=x.pipe(new s(m)),x.lock()}catch(D){this._worker=new a("error"),this._worker.error(D)}}w.prototype={accumulate:function(x){return T(this,x)},on:function(x,v){var C=this;return x==="data"?this._worker.on(x,function(m){v.call(C,m.data,m.meta)}):this._worker.on(x,function(){o.delay(v,arguments,C)}),this},resume:function(){return o.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(x){if(o.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new b(this,{objectMode:this._outputType!=="nodebuffer"},x)}},n.exports=w},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(r,n,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",i.nodebuffer=typeof Buffer<"u",i.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")i.blob=!1;else{var o=new ArrayBuffer(0);try{i.blob=new Blob([o],{type:"application/zip"}).size===0}catch{try{var s=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);s.append(o),i.blob=s.getBlob("application/zip").size===0}catch{i.blob=!1}}}try{i.nodestream=!!r("readable-stream").Readable}catch{i.nodestream=!1}},{"readable-stream":16}],31:[function(r,n,i){for(var o=r("./utils"),s=r("./support"),a=r("./nodejsUtils"),l=r("./stream/GenericWorker"),g=new Array(256),_=0;_<256;_++)g[_]=252<=_?6:248<=_?5:240<=_?4:224<=_?3:192<=_?2:1;g[254]=g[254]=1;function b(){l.call(this,"utf-8 decode"),this.leftOver=null}function T(){l.call(this,"utf-8 encode")}i.utf8encode=function(w){return s.nodebuffer?a.newBufferFrom(w,"utf-8"):function(x){var v,C,m,D,S,N=x.length,M=0;for(D=0;D<N;D++)(64512&(C=x.charCodeAt(D)))==55296&&D+1<N&&(64512&(m=x.charCodeAt(D+1)))==56320&&(C=65536+(C-55296<<10)+(m-56320),D++),M+=C<128?1:C<2048?2:C<65536?3:4;for(v=s.uint8array?new Uint8Array(M):new Array(M),D=S=0;S<M;D++)(64512&(C=x.charCodeAt(D)))==55296&&D+1<N&&(64512&(m=x.charCodeAt(D+1)))==56320&&(C=65536+(C-55296<<10)+(m-56320),D++),C<128?v[S++]=C:(C<2048?v[S++]=192|C>>>6:(C<65536?v[S++]=224|C>>>12:(v[S++]=240|C>>>18,v[S++]=128|C>>>12&63),v[S++]=128|C>>>6&63),v[S++]=128|63&C);return v}(w)},i.utf8decode=function(w){return s.nodebuffer?o.transformTo("nodebuffer",w).toString("utf-8"):function(x){var v,C,m,D,S=x.length,N=new Array(2*S);for(v=C=0;v<S;)if((m=x[v++])<128)N[C++]=m;else if(4<(D=g[m]))N[C++]=65533,v+=D-1;else{for(m&=D===2?31:D===3?15:7;1<D&&v<S;)m=m<<6|63&x[v++],D--;1<D?N[C++]=65533:m<65536?N[C++]=m:(m-=65536,N[C++]=55296|m>>10&1023,N[C++]=56320|1023&m)}return N.length!==C&&(N.subarray?N=N.subarray(0,C):N.length=C),o.applyFromCharCode(N)}(w=o.transformTo(s.uint8array?"uint8array":"array",w))},o.inherits(b,l),b.prototype.processChunk=function(w){var x=o.transformTo(s.uint8array?"uint8array":"array",w.data);if(this.leftOver&&this.leftOver.length){if(s.uint8array){var v=x;(x=new Uint8Array(v.length+this.leftOver.length)).set(this.leftOver,0),x.set(v,this.leftOver.length)}else x=this.leftOver.concat(x);this.leftOver=null}var C=function(D,S){var N;for((S=S||D.length)>D.length&&(S=D.length),N=S-1;0<=N&&(192&D[N])==128;)N--;return N<0||N===0?S:N+g[D[N]]>S?N:S}(x),m=x;C!==x.length&&(s.uint8array?(m=x.subarray(0,C),this.leftOver=x.subarray(C,x.length)):(m=x.slice(0,C),this.leftOver=x.slice(C,x.length))),this.push({data:i.utf8decode(m),meta:w.meta})},b.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=b,o.inherits(T,l),T.prototype.processChunk=function(w){this.push({data:i.utf8encode(w.data),meta:w.meta})},i.Utf8EncodeWorker=T},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(r,n,i){var o=r("./support"),s=r("./base64"),a=r("./nodejsUtils"),l=r("./external");function g(v){return v}function _(v,C){for(var m=0;m<v.length;++m)C[m]=255&v.charCodeAt(m);return C}r("setimmediate"),i.newBlob=function(v,C){i.checkSupport("blob");try{return new Blob([v],{type:C})}catch{try{var m=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return m.append(v),m.getBlob(C)}catch{throw new Error("Bug : can't construct the Blob.")}}};var b={stringifyByChunk:function(v,C,m){var D=[],S=0,N=v.length;if(N<=m)return String.fromCharCode.apply(null,v);for(;S<N;)C==="array"||C==="nodebuffer"?D.push(String.fromCharCode.apply(null,v.slice(S,Math.min(S+m,N)))):D.push(String.fromCharCode.apply(null,v.subarray(S,Math.min(S+m,N)))),S+=m;return D.join("")},stringifyByChar:function(v){for(var C="",m=0;m<v.length;m++)C+=String.fromCharCode(v[m]);return C},applyCanBeUsed:{uint8array:function(){try{return o.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return o.nodebuffer&&String.fromCharCode.apply(null,a.allocBuffer(1)).length===1}catch{return!1}}()}};function T(v){var C=65536,m=i.getTypeOf(v),D=!0;if(m==="uint8array"?D=b.applyCanBeUsed.uint8array:m==="nodebuffer"&&(D=b.applyCanBeUsed.nodebuffer),D)for(;1<C;)try{return b.stringifyByChunk(v,m,C)}catch{C=Math.floor(C/2)}return b.stringifyByChar(v)}function w(v,C){for(var m=0;m<v.length;m++)C[m]=v[m];return C}i.applyFromCharCode=T;var x={};x.string={string:g,array:function(v){return _(v,new Array(v.length))},arraybuffer:function(v){return x.string.uint8array(v).buffer},uint8array:function(v){return _(v,new Uint8Array(v.length))},nodebuffer:function(v){return _(v,a.allocBuffer(v.length))}},x.array={string:T,array:g,arraybuffer:function(v){return new Uint8Array(v).buffer},uint8array:function(v){return new Uint8Array(v)},nodebuffer:function(v){return a.newBufferFrom(v)}},x.arraybuffer={string:function(v){return T(new Uint8Array(v))},array:function(v){return w(new Uint8Array(v),new Array(v.byteLength))},arraybuffer:g,uint8array:function(v){return new Uint8Array(v)},nodebuffer:function(v){return a.newBufferFrom(new Uint8Array(v))}},x.uint8array={string:T,array:function(v){return w(v,new Array(v.length))},arraybuffer:function(v){return v.buffer},uint8array:g,nodebuffer:function(v){return a.newBufferFrom(v)}},x.nodebuffer={string:T,array:function(v){return w(v,new Array(v.length))},arraybuffer:function(v){return x.nodebuffer.uint8array(v).buffer},uint8array:function(v){return w(v,new Uint8Array(v.length))},nodebuffer:g},i.transformTo=function(v,C){if(C=C||"",!v)return C;i.checkSupport(v);var m=i.getTypeOf(C);return x[m][v](C)},i.resolve=function(v){for(var C=v.split("/"),m=[],D=0;D<C.length;D++){var S=C[D];S==="."||S===""&&D!==0&&D!==C.length-1||(S===".."?m.pop():m.push(S))}return m.join("/")},i.getTypeOf=function(v){return typeof v=="string"?"string":Object.prototype.toString.call(v)==="[object Array]"?"array":o.nodebuffer&&a.isBuffer(v)?"nodebuffer":o.uint8array&&v instanceof Uint8Array?"uint8array":o.arraybuffer&&v instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(v){if(!o[v.toLowerCase()])throw new Error(v+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(v){var C,m,D="";for(m=0;m<(v||"").length;m++)D+="\\x"+((C=v.charCodeAt(m))<16?"0":"")+C.toString(16).toUpperCase();return D},i.delay=function(v,C,m){setImmediate(function(){v.apply(m||null,C||[])})},i.inherits=function(v,C){function m(){}m.prototype=C.prototype,v.prototype=new m},i.extend=function(){var v,C,m={};for(v=0;v<arguments.length;v++)for(C in arguments[v])Object.prototype.hasOwnProperty.call(arguments[v],C)&&m[C]===void 0&&(m[C]=arguments[v][C]);return m},i.prepareContent=function(v,C,m,D,S){return l.Promise.resolve(C).then(function(N){return o.blob&&(N instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(N))!==-1)&&typeof FileReader<"u"?new l.Promise(function(M,te){var V=new FileReader;V.onload=function(ne){M(ne.target.result)},V.onerror=function(ne){te(ne.target.error)},V.readAsArrayBuffer(N)}):N}).then(function(N){var M=i.getTypeOf(N);return M?(M==="arraybuffer"?N=i.transformTo("uint8array",N):M==="string"&&(S?N=s.decode(N):m&&D!==!0&&(N=function(te){return _(te,o.uint8array?new Uint8Array(te.length):new Array(te.length))}(N))),N):l.Promise.reject(new Error("Can't read the data of '"+v+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(r,n,i){var o=r("./reader/readerFor"),s=r("./utils"),a=r("./signature"),l=r("./zipEntry"),g=r("./support");function _(b){this.files=[],this.loadOptions=b}_.prototype={checkSignature:function(b){if(!this.reader.readAndCheckSignature(b)){this.reader.index-=4;var T=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+s.pretty(T)+", expected "+s.pretty(b)+")")}},isSignature:function(b,T){var w=this.reader.index;this.reader.setIndex(b);var x=this.reader.readString(4)===T;return this.reader.setIndex(w),x},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var b=this.reader.readData(this.zipCommentLength),T=g.uint8array?"uint8array":"array",w=s.transformTo(T,b);this.zipComment=this.loadOptions.decodeFileName(w)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var b,T,w,x=this.zip64EndOfCentralSize-44;0<x;)b=this.reader.readInt(2),T=this.reader.readInt(4),w=this.reader.readData(T),this.zip64ExtensibleData[b]={id:b,length:T,value:w}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var b,T;for(b=0;b<this.files.length;b++)T=this.files[b],this.reader.setIndex(T.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),T.readLocalPart(this.reader),T.handleUTF8(),T.processAttributes()},readCentralDir:function(){var b;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)(b=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(b);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var b=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(b<0)throw this.isSignature(0,a.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(b);var T=b;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===s.MAX_VALUE_16BITS||this.diskWithCentralDirStart===s.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===s.MAX_VALUE_16BITS||this.centralDirRecords===s.MAX_VALUE_16BITS||this.centralDirSize===s.MAX_VALUE_32BITS||this.centralDirOffset===s.MAX_VALUE_32BITS){if(this.zip64=!0,(b=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(b),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var w=this.centralDirOffset+this.centralDirSize;this.zip64&&(w+=20,w+=12+this.zip64EndOfCentralSize);var x=T-w;if(0<x)this.isSignature(T,a.CENTRAL_FILE_HEADER)||(this.reader.zero=x);else if(x<0)throw new Error("Corrupted zip: missing "+Math.abs(x)+" bytes.")},prepareReader:function(b){this.reader=o(b)},load:function(b){this.prepareReader(b),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=_},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(r,n,i){var o=r("./reader/readerFor"),s=r("./utils"),a=r("./compressedObject"),l=r("./crc32"),g=r("./utf8"),_=r("./compressions"),b=r("./support");function T(w,x){this.options=w,this.loadOptions=x}T.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(w){var x,v;if(w.skip(22),this.fileNameLength=w.readInt(2),v=w.readInt(2),this.fileName=w.readData(this.fileNameLength),w.skip(v),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((x=function(C){for(var m in _)if(Object.prototype.hasOwnProperty.call(_,m)&&_[m].magic===C)return _[m];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+s.pretty(this.compressionMethod)+" unknown (inner file : "+s.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,x,w.readData(this.compressedSize))},readCentralPart:function(w){this.versionMadeBy=w.readInt(2),w.skip(2),this.bitFlag=w.readInt(2),this.compressionMethod=w.readString(2),this.date=w.readDate(),this.crc32=w.readInt(4),this.compressedSize=w.readInt(4),this.uncompressedSize=w.readInt(4);var x=w.readInt(2);if(this.extraFieldsLength=w.readInt(2),this.fileCommentLength=w.readInt(2),this.diskNumberStart=w.readInt(2),this.internalFileAttributes=w.readInt(2),this.externalFileAttributes=w.readInt(4),this.localHeaderOffset=w.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");w.skip(x),this.readExtraFields(w),this.parseZIP64ExtraField(w),this.fileComment=w.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var w=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),w==0&&(this.dosPermissions=63&this.externalFileAttributes),w==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var w=o(this.extraFields[1].value);this.uncompressedSize===s.MAX_VALUE_32BITS&&(this.uncompressedSize=w.readInt(8)),this.compressedSize===s.MAX_VALUE_32BITS&&(this.compressedSize=w.readInt(8)),this.localHeaderOffset===s.MAX_VALUE_32BITS&&(this.localHeaderOffset=w.readInt(8)),this.diskNumberStart===s.MAX_VALUE_32BITS&&(this.diskNumberStart=w.readInt(4))}},readExtraFields:function(w){var x,v,C,m=w.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});w.index+4<m;)x=w.readInt(2),v=w.readInt(2),C=w.readData(v),this.extraFields[x]={id:x,length:v,value:C};w.setIndex(m)},handleUTF8:function(){var w=b.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=g.utf8decode(this.fileName),this.fileCommentStr=g.utf8decode(this.fileComment);else{var x=this.findExtraFieldUnicodePath();if(x!==null)this.fileNameStr=x;else{var v=s.transformTo(w,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(v)}var C=this.findExtraFieldUnicodeComment();if(C!==null)this.fileCommentStr=C;else{var m=s.transformTo(w,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(m)}}},findExtraFieldUnicodePath:function(){var w=this.extraFields[28789];if(w){var x=o(w.value);return x.readInt(1)!==1||l(this.fileName)!==x.readInt(4)?null:g.utf8decode(x.readData(w.length-5))}return null},findExtraFieldUnicodeComment:function(){var w=this.extraFields[25461];if(w){var x=o(w.value);return x.readInt(1)!==1||l(this.fileComment)!==x.readInt(4)?null:g.utf8decode(x.readData(w.length-5))}return null}},n.exports=T},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(r,n,i){function o(x,v,C){this.name=x,this.dir=C.dir,this.date=C.date,this.comment=C.comment,this.unixPermissions=C.unixPermissions,this.dosPermissions=C.dosPermissions,this._data=v,this._dataBinary=C.binary,this.options={compression:C.compression,compressionOptions:C.compressionOptions}}var s=r("./stream/StreamHelper"),a=r("./stream/DataWorker"),l=r("./utf8"),g=r("./compressedObject"),_=r("./stream/GenericWorker");o.prototype={internalStream:function(x){var v=null,C="string";try{if(!x)throw new Error("No output type specified.");var m=(C=x.toLowerCase())==="string"||C==="text";C!=="binarystring"&&C!=="text"||(C="string"),v=this._decompressWorker();var D=!this._dataBinary;D&&!m&&(v=v.pipe(new l.Utf8EncodeWorker)),!D&&m&&(v=v.pipe(new l.Utf8DecodeWorker))}catch(S){(v=new _("error")).error(S)}return new s(v,C,"")},async:function(x,v){return this.internalStream(x).accumulate(v)},nodeStream:function(x,v){return this.internalStream(x||"nodebuffer").toNodejsStream(v)},_compressWorker:function(x,v){if(this._data instanceof g&&this._data.compression.magic===x.magic)return this._data.getCompressedWorker();var C=this._decompressWorker();return this._dataBinary||(C=C.pipe(new l.Utf8EncodeWorker)),g.createWorkerFrom(C,x,v)},_decompressWorker:function(){return this._data instanceof g?this._data.getContentWorker():this._data instanceof _?this._data:new a(this._data)}};for(var b=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],T=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},w=0;w<b.length;w++)o.prototype[b[w]]=T;n.exports=o},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(r,n,i){(function(o){var s,a,l=o.MutationObserver||o.WebKitMutationObserver;if(l){var g=0,_=new l(x),b=o.document.createTextNode("");_.observe(b,{characterData:!0}),s=function(){b.data=g=++g%2}}else if(o.setImmediate||o.MessageChannel===void 0)s="document"in o&&"onreadystatechange"in o.document.createElement("script")?function(){var v=o.document.createElement("script");v.onreadystatechange=function(){x(),v.onreadystatechange=null,v.parentNode.removeChild(v),v=null},o.document.documentElement.appendChild(v)}:function(){setTimeout(x,0)};else{var T=new o.MessageChannel;T.port1.onmessage=x,s=function(){T.port2.postMessage(0)}}var w=[];function x(){var v,C;a=!0;for(var m=w.length;m;){for(C=w,w=[],v=-1;++v<m;)C[v]();m=w.length}a=!1}n.exports=function(v){w.push(v)!==1||a||s()}}).call(this,typeof zt<"u"?zt:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(r,n,i){var o=r("immediate");function s(){}var a={},l=["REJECTED"],g=["FULFILLED"],_=["PENDING"];function b(m){if(typeof m!="function")throw new TypeError("resolver must be a function");this.state=_,this.queue=[],this.outcome=void 0,m!==s&&v(this,m)}function T(m,D,S){this.promise=m,typeof D=="function"&&(this.onFulfilled=D,this.callFulfilled=this.otherCallFulfilled),typeof S=="function"&&(this.onRejected=S,this.callRejected=this.otherCallRejected)}function w(m,D,S){o(function(){var N;try{N=D(S)}catch(M){return a.reject(m,M)}N===m?a.reject(m,new TypeError("Cannot resolve promise with itself")):a.resolve(m,N)})}function x(m){var D=m&&m.then;if(m&&(typeof m=="object"||typeof m=="function")&&typeof D=="function")return function(){D.apply(m,arguments)}}function v(m,D){var S=!1;function N(V){S||(S=!0,a.reject(m,V))}function M(V){S||(S=!0,a.resolve(m,V))}var te=C(function(){D(M,N)});te.status==="error"&&N(te.value)}function C(m,D){var S={};try{S.value=m(D),S.status="success"}catch(N){S.status="error",S.value=N}return S}(n.exports=b).prototype.finally=function(m){if(typeof m!="function")return this;var D=this.constructor;return this.then(function(S){return D.resolve(m()).then(function(){return S})},function(S){return D.resolve(m()).then(function(){throw S})})},b.prototype.catch=function(m){return this.then(null,m)},b.prototype.then=function(m,D){if(typeof m!="function"&&this.state===g||typeof D!="function"&&this.state===l)return this;var S=new this.constructor(s);return this.state!==_?w(S,this.state===g?m:D,this.outcome):this.queue.push(new T(S,m,D)),S},T.prototype.callFulfilled=function(m){a.resolve(this.promise,m)},T.prototype.otherCallFulfilled=function(m){w(this.promise,this.onFulfilled,m)},T.prototype.callRejected=function(m){a.reject(this.promise,m)},T.prototype.otherCallRejected=function(m){w(this.promise,this.onRejected,m)},a.resolve=function(m,D){var S=C(x,D);if(S.status==="error")return a.reject(m,S.value);var N=S.value;if(N)v(m,N);else{m.state=g,m.outcome=D;for(var M=-1,te=m.queue.length;++M<te;)m.queue[M].callFulfilled(D)}return m},a.reject=function(m,D){m.state=l,m.outcome=D;for(var S=-1,N=m.queue.length;++S<N;)m.queue[S].callRejected(D);return m},b.resolve=function(m){return m instanceof this?m:a.resolve(new this(s),m)},b.reject=function(m){var D=new this(s);return a.reject(D,m)},b.all=function(m){var D=this;if(Object.prototype.toString.call(m)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=m.length,N=!1;if(!S)return this.resolve([]);for(var M=new Array(S),te=0,V=-1,ne=new this(s);++V<S;)A(m[V],V);return ne;function A(ce,pe){D.resolve(ce).then(function(L){M[pe]=L,++te!==S||N||(N=!0,a.resolve(ne,M))},function(L){N||(N=!0,a.reject(ne,L))})}},b.race=function(m){var D=this;if(Object.prototype.toString.call(m)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=m.length,N=!1;if(!S)return this.resolve([]);for(var M=-1,te=new this(s);++M<S;)V=m[M],D.resolve(V).then(function(ne){N||(N=!0,a.resolve(te,ne))},function(ne){N||(N=!0,a.reject(te,ne))});var V;return te}},{immediate:36}],38:[function(r,n,i){var o={};(0,r("./lib/utils/common").assign)(o,r("./lib/deflate"),r("./lib/inflate"),r("./lib/zlib/constants")),n.exports=o},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(r,n,i){var o=r("./zlib/deflate"),s=r("./utils/common"),a=r("./utils/strings"),l=r("./zlib/messages"),g=r("./zlib/zstream"),_=Object.prototype.toString,b=0,T=-1,w=0,x=8;function v(m){if(!(this instanceof v))return new v(m);this.options=s.assign({level:T,method:x,chunkSize:16384,windowBits:15,memLevel:8,strategy:w,to:""},m||{});var D=this.options;D.raw&&0<D.windowBits?D.windowBits=-D.windowBits:D.gzip&&0<D.windowBits&&D.windowBits<16&&(D.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new g,this.strm.avail_out=0;var S=o.deflateInit2(this.strm,D.level,D.method,D.windowBits,D.memLevel,D.strategy);if(S!==b)throw new Error(l[S]);if(D.header&&o.deflateSetHeader(this.strm,D.header),D.dictionary){var N;if(N=typeof D.dictionary=="string"?a.string2buf(D.dictionary):_.call(D.dictionary)==="[object ArrayBuffer]"?new Uint8Array(D.dictionary):D.dictionary,(S=o.deflateSetDictionary(this.strm,N))!==b)throw new Error(l[S]);this._dict_set=!0}}function C(m,D){var S=new v(D);if(S.push(m,!0),S.err)throw S.msg||l[S.err];return S.result}v.prototype.push=function(m,D){var S,N,M=this.strm,te=this.options.chunkSize;if(this.ended)return!1;N=D===~~D?D:D===!0?4:0,typeof m=="string"?M.input=a.string2buf(m):_.call(m)==="[object ArrayBuffer]"?M.input=new Uint8Array(m):M.input=m,M.next_in=0,M.avail_in=M.input.length;do{if(M.avail_out===0&&(M.output=new s.Buf8(te),M.next_out=0,M.avail_out=te),(S=o.deflate(M,N))!==1&&S!==b)return this.onEnd(S),!(this.ended=!0);M.avail_out!==0&&(M.avail_in!==0||N!==4&&N!==2)||(this.options.to==="string"?this.onData(a.buf2binstring(s.shrinkBuf(M.output,M.next_out))):this.onData(s.shrinkBuf(M.output,M.next_out)))}while((0<M.avail_in||M.avail_out===0)&&S!==1);return N===4?(S=o.deflateEnd(this.strm),this.onEnd(S),this.ended=!0,S===b):N!==2||(this.onEnd(b),!(M.avail_out=0))},v.prototype.onData=function(m){this.chunks.push(m)},v.prototype.onEnd=function(m){m===b&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=m,this.msg=this.strm.msg},i.Deflate=v,i.deflate=C,i.deflateRaw=function(m,D){return(D=D||{}).raw=!0,C(m,D)},i.gzip=function(m,D){return(D=D||{}).gzip=!0,C(m,D)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(r,n,i){var o=r("./zlib/inflate"),s=r("./utils/common"),a=r("./utils/strings"),l=r("./zlib/constants"),g=r("./zlib/messages"),_=r("./zlib/zstream"),b=r("./zlib/gzheader"),T=Object.prototype.toString;function w(v){if(!(this instanceof w))return new w(v);this.options=s.assign({chunkSize:16384,windowBits:0,to:""},v||{});var C=this.options;C.raw&&0<=C.windowBits&&C.windowBits<16&&(C.windowBits=-C.windowBits,C.windowBits===0&&(C.windowBits=-15)),!(0<=C.windowBits&&C.windowBits<16)||v&&v.windowBits||(C.windowBits+=32),15<C.windowBits&&C.windowBits<48&&!(15&C.windowBits)&&(C.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new _,this.strm.avail_out=0;var m=o.inflateInit2(this.strm,C.windowBits);if(m!==l.Z_OK)throw new Error(g[m]);this.header=new b,o.inflateGetHeader(this.strm,this.header)}function x(v,C){var m=new w(C);if(m.push(v,!0),m.err)throw m.msg||g[m.err];return m.result}w.prototype.push=function(v,C){var m,D,S,N,M,te,V=this.strm,ne=this.options.chunkSize,A=this.options.dictionary,ce=!1;if(this.ended)return!1;D=C===~~C?C:C===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof v=="string"?V.input=a.binstring2buf(v):T.call(v)==="[object ArrayBuffer]"?V.input=new Uint8Array(v):V.input=v,V.next_in=0,V.avail_in=V.input.length;do{if(V.avail_out===0&&(V.output=new s.Buf8(ne),V.next_out=0,V.avail_out=ne),(m=o.inflate(V,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&A&&(te=typeof A=="string"?a.string2buf(A):T.call(A)==="[object ArrayBuffer]"?new Uint8Array(A):A,m=o.inflateSetDictionary(this.strm,te)),m===l.Z_BUF_ERROR&&ce===!0&&(m=l.Z_OK,ce=!1),m!==l.Z_STREAM_END&&m!==l.Z_OK)return this.onEnd(m),!(this.ended=!0);V.next_out&&(V.avail_out!==0&&m!==l.Z_STREAM_END&&(V.avail_in!==0||D!==l.Z_FINISH&&D!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(S=a.utf8border(V.output,V.next_out),N=V.next_out-S,M=a.buf2string(V.output,S),V.next_out=N,V.avail_out=ne-N,N&&s.arraySet(V.output,V.output,S,N,0),this.onData(M)):this.onData(s.shrinkBuf(V.output,V.next_out)))),V.avail_in===0&&V.avail_out===0&&(ce=!0)}while((0<V.avail_in||V.avail_out===0)&&m!==l.Z_STREAM_END);return m===l.Z_STREAM_END&&(D=l.Z_FINISH),D===l.Z_FINISH?(m=o.inflateEnd(this.strm),this.onEnd(m),this.ended=!0,m===l.Z_OK):D!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(V.avail_out=0))},w.prototype.onData=function(v){this.chunks.push(v)},w.prototype.onEnd=function(v){v===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=v,this.msg=this.strm.msg},i.Inflate=w,i.inflate=x,i.inflateRaw=function(v,C){return(C=C||{}).raw=!0,x(v,C)},i.ungzip=x},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(r,n,i){var o=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";i.assign=function(l){for(var g=Array.prototype.slice.call(arguments,1);g.length;){var _=g.shift();if(_){if(typeof _!="object")throw new TypeError(_+"must be non-object");for(var b in _)_.hasOwnProperty(b)&&(l[b]=_[b])}}return l},i.shrinkBuf=function(l,g){return l.length===g?l:l.subarray?l.subarray(0,g):(l.length=g,l)};var s={arraySet:function(l,g,_,b,T){if(g.subarray&&l.subarray)l.set(g.subarray(_,_+b),T);else for(var w=0;w<b;w++)l[T+w]=g[_+w]},flattenChunks:function(l){var g,_,b,T,w,x;for(g=b=0,_=l.length;g<_;g++)b+=l[g].length;for(x=new Uint8Array(b),g=T=0,_=l.length;g<_;g++)w=l[g],x.set(w,T),T+=w.length;return x}},a={arraySet:function(l,g,_,b,T){for(var w=0;w<b;w++)l[T+w]=g[_+w]},flattenChunks:function(l){return[].concat.apply([],l)}};i.setTyped=function(l){l?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,s)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,a))},i.setTyped(o)},{}],42:[function(r,n,i){var o=r("./common"),s=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch{s=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{a=!1}for(var l=new o.Buf8(256),g=0;g<256;g++)l[g]=252<=g?6:248<=g?5:240<=g?4:224<=g?3:192<=g?2:1;function _(b,T){if(T<65537&&(b.subarray&&a||!b.subarray&&s))return String.fromCharCode.apply(null,o.shrinkBuf(b,T));for(var w="",x=0;x<T;x++)w+=String.fromCharCode(b[x]);return w}l[254]=l[254]=1,i.string2buf=function(b){var T,w,x,v,C,m=b.length,D=0;for(v=0;v<m;v++)(64512&(w=b.charCodeAt(v)))==55296&&v+1<m&&(64512&(x=b.charCodeAt(v+1)))==56320&&(w=65536+(w-55296<<10)+(x-56320),v++),D+=w<128?1:w<2048?2:w<65536?3:4;for(T=new o.Buf8(D),v=C=0;C<D;v++)(64512&(w=b.charCodeAt(v)))==55296&&v+1<m&&(64512&(x=b.charCodeAt(v+1)))==56320&&(w=65536+(w-55296<<10)+(x-56320),v++),w<128?T[C++]=w:(w<2048?T[C++]=192|w>>>6:(w<65536?T[C++]=224|w>>>12:(T[C++]=240|w>>>18,T[C++]=128|w>>>12&63),T[C++]=128|w>>>6&63),T[C++]=128|63&w);return T},i.buf2binstring=function(b){return _(b,b.length)},i.binstring2buf=function(b){for(var T=new o.Buf8(b.length),w=0,x=T.length;w<x;w++)T[w]=b.charCodeAt(w);return T},i.buf2string=function(b,T){var w,x,v,C,m=T||b.length,D=new Array(2*m);for(w=x=0;w<m;)if((v=b[w++])<128)D[x++]=v;else if(4<(C=l[v]))D[x++]=65533,w+=C-1;else{for(v&=C===2?31:C===3?15:7;1<C&&w<m;)v=v<<6|63&b[w++],C--;1<C?D[x++]=65533:v<65536?D[x++]=v:(v-=65536,D[x++]=55296|v>>10&1023,D[x++]=56320|1023&v)}return _(D,x)},i.utf8border=function(b,T){var w;for((T=T||b.length)>b.length&&(T=b.length),w=T-1;0<=w&&(192&b[w])==128;)w--;return w<0||w===0?T:w+l[b[w]]>T?w:T}},{"./common":41}],43:[function(r,n,i){n.exports=function(o,s,a,l){for(var g=65535&o|0,_=o>>>16&65535|0,b=0;a!==0;){for(a-=b=2e3<a?2e3:a;_=_+(g=g+s[l++]|0)|0,--b;);g%=65521,_%=65521}return g|_<<16|0}},{}],44:[function(r,n,i){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(r,n,i){var o=function(){for(var s,a=[],l=0;l<256;l++){s=l;for(var g=0;g<8;g++)s=1&s?3988292384^s>>>1:s>>>1;a[l]=s}return a}();n.exports=function(s,a,l,g){var _=o,b=g+l;s^=-1;for(var T=g;T<b;T++)s=s>>>8^_[255&(s^a[T])];return-1^s}},{}],46:[function(r,n,i){var o,s=r("../utils/common"),a=r("./trees"),l=r("./adler32"),g=r("./crc32"),_=r("./messages"),b=0,T=4,w=0,x=-2,v=-1,C=4,m=2,D=8,S=9,N=286,M=30,te=19,V=2*N+1,ne=15,A=3,ce=258,pe=ce+A+1,L=42,K=113,E=1,Z=2,he=3,J=4;function ve(h,q){return h.msg=_[q],q}function oe(h){return(h<<1)-(4<h?9:0)}function ge(h){for(var q=h.length;0<=--q;)h[q]=0}function G(h){var q=h.state,y=q.pending;y>h.avail_out&&(y=h.avail_out),y!==0&&(s.arraySet(h.output,q.pending_buf,q.pending_out,y,h.next_out),h.next_out+=y,q.pending_out+=y,h.total_out+=y,h.avail_out-=y,q.pending-=y,q.pending===0&&(q.pending_out=0))}function k(h,q){a._tr_flush_block(h,0<=h.block_start?h.block_start:-1,h.strstart-h.block_start,q),h.block_start=h.strstart,G(h.strm)}function z(h,q){h.pending_buf[h.pending++]=q}function $(h,q){h.pending_buf[h.pending++]=q>>>8&255,h.pending_buf[h.pending++]=255&q}function ie(h,q){var y,u,c=h.max_chain_length,d=h.strstart,R=h.prev_length,U=h.nice_match,P=h.strstart>h.w_size-pe?h.strstart-(h.w_size-pe):0,ae=h.window,de=h.w_mask,se=h.prev,fe=h.strstart+ce,Ee=ae[d+R-1],De=ae[d+R];h.prev_length>=h.good_match&&(c>>=2),U>h.lookahead&&(U=h.lookahead);do if(ae[(y=q)+R]===De&&ae[y+R-1]===Ee&&ae[y]===ae[d]&&ae[++y]===ae[d+1]){d+=2,y++;do;while(ae[++d]===ae[++y]&&ae[++d]===ae[++y]&&ae[++d]===ae[++y]&&ae[++d]===ae[++y]&&ae[++d]===ae[++y]&&ae[++d]===ae[++y]&&ae[++d]===ae[++y]&&ae[++d]===ae[++y]&&d<fe);if(u=ce-(fe-d),d=fe-ce,R<u){if(h.match_start=q,U<=(R=u))break;Ee=ae[d+R-1],De=ae[d+R]}}while((q=se[q&de])>P&&--c!=0);return R<=h.lookahead?R:h.lookahead}function j(h){var q,y,u,c,d,R,U,P,ae,de,se=h.w_size;do{if(c=h.window_size-h.lookahead-h.strstart,h.strstart>=se+(se-pe)){for(s.arraySet(h.window,h.window,se,se,0),h.match_start-=se,h.strstart-=se,h.block_start-=se,q=y=h.hash_size;u=h.head[--q],h.head[q]=se<=u?u-se:0,--y;);for(q=y=se;u=h.prev[--q],h.prev[q]=se<=u?u-se:0,--y;);c+=se}if(h.strm.avail_in===0)break;if(R=h.strm,U=h.window,P=h.strstart+h.lookahead,ae=c,de=void 0,de=R.avail_in,ae<de&&(de=ae),y=de===0?0:(R.avail_in-=de,s.arraySet(U,R.input,R.next_in,de,P),R.state.wrap===1?R.adler=l(R.adler,U,de,P):R.state.wrap===2&&(R.adler=g(R.adler,U,de,P)),R.next_in+=de,R.total_in+=de,de),h.lookahead+=y,h.lookahead+h.insert>=A)for(d=h.strstart-h.insert,h.ins_h=h.window[d],h.ins_h=(h.ins_h<<h.hash_shift^h.window[d+1])&h.hash_mask;h.insert&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[d+A-1])&h.hash_mask,h.prev[d&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=d,d++,h.insert--,!(h.lookahead+h.insert<A)););}while(h.lookahead<pe&&h.strm.avail_in!==0)}function p(h,q){for(var y,u;;){if(h.lookahead<pe){if(j(h),h.lookahead<pe&&q===b)return E;if(h.lookahead===0)break}if(y=0,h.lookahead>=A&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+A-1])&h.hash_mask,y=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart),y!==0&&h.strstart-y<=h.w_size-pe&&(h.match_length=ie(h,y)),h.match_length>=A)if(u=a._tr_tally(h,h.strstart-h.match_start,h.match_length-A),h.lookahead-=h.match_length,h.match_length<=h.max_lazy_match&&h.lookahead>=A){for(h.match_length--;h.strstart++,h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+A-1])&h.hash_mask,y=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart,--h.match_length!=0;);h.strstart++}else h.strstart+=h.match_length,h.match_length=0,h.ins_h=h.window[h.strstart],h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+1])&h.hash_mask;else u=a._tr_tally(h,0,h.window[h.strstart]),h.lookahead--,h.strstart++;if(u&&(k(h,!1),h.strm.avail_out===0))return E}return h.insert=h.strstart<A-1?h.strstart:A-1,q===T?(k(h,!0),h.strm.avail_out===0?he:J):h.last_lit&&(k(h,!1),h.strm.avail_out===0)?E:Z}function f(h,q){for(var y,u,c;;){if(h.lookahead<pe){if(j(h),h.lookahead<pe&&q===b)return E;if(h.lookahead===0)break}if(y=0,h.lookahead>=A&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+A-1])&h.hash_mask,y=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart),h.prev_length=h.match_length,h.prev_match=h.match_start,h.match_length=A-1,y!==0&&h.prev_length<h.max_lazy_match&&h.strstart-y<=h.w_size-pe&&(h.match_length=ie(h,y),h.match_length<=5&&(h.strategy===1||h.match_length===A&&4096<h.strstart-h.match_start)&&(h.match_length=A-1)),h.prev_length>=A&&h.match_length<=h.prev_length){for(c=h.strstart+h.lookahead-A,u=a._tr_tally(h,h.strstart-1-h.prev_match,h.prev_length-A),h.lookahead-=h.prev_length-1,h.prev_length-=2;++h.strstart<=c&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+A-1])&h.hash_mask,y=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart),--h.prev_length!=0;);if(h.match_available=0,h.match_length=A-1,h.strstart++,u&&(k(h,!1),h.strm.avail_out===0))return E}else if(h.match_available){if((u=a._tr_tally(h,0,h.window[h.strstart-1]))&&k(h,!1),h.strstart++,h.lookahead--,h.strm.avail_out===0)return E}else h.match_available=1,h.strstart++,h.lookahead--}return h.match_available&&(u=a._tr_tally(h,0,h.window[h.strstart-1]),h.match_available=0),h.insert=h.strstart<A-1?h.strstart:A-1,q===T?(k(h,!0),h.strm.avail_out===0?he:J):h.last_lit&&(k(h,!1),h.strm.avail_out===0)?E:Z}function B(h,q,y,u,c){this.good_length=h,this.max_lazy=q,this.nice_length=y,this.max_chain=u,this.func=c}function F(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=D,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new s.Buf16(2*V),this.dyn_dtree=new s.Buf16(2*(2*M+1)),this.bl_tree=new s.Buf16(2*(2*te+1)),ge(this.dyn_ltree),ge(this.dyn_dtree),ge(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new s.Buf16(ne+1),this.heap=new s.Buf16(2*N+1),ge(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new s.Buf16(2*N+1),ge(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function I(h){var q;return h&&h.state?(h.total_in=h.total_out=0,h.data_type=m,(q=h.state).pending=0,q.pending_out=0,q.wrap<0&&(q.wrap=-q.wrap),q.status=q.wrap?L:K,h.adler=q.wrap===2?0:1,q.last_flush=b,a._tr_init(q),w):ve(h,x)}function O(h){var q=I(h);return q===w&&function(y){y.window_size=2*y.w_size,ge(y.head),y.max_lazy_match=o[y.level].max_lazy,y.good_match=o[y.level].good_length,y.nice_match=o[y.level].nice_length,y.max_chain_length=o[y.level].max_chain,y.strstart=0,y.block_start=0,y.lookahead=0,y.insert=0,y.match_length=y.prev_length=A-1,y.match_available=0,y.ins_h=0}(h.state),q}function re(h,q,y,u,c,d){if(!h)return x;var R=1;if(q===v&&(q=6),u<0?(R=0,u=-u):15<u&&(R=2,u-=16),c<1||S<c||y!==D||u<8||15<u||q<0||9<q||d<0||C<d)return ve(h,x);u===8&&(u=9);var U=new F;return(h.state=U).strm=h,U.wrap=R,U.gzhead=null,U.w_bits=u,U.w_size=1<<U.w_bits,U.w_mask=U.w_size-1,U.hash_bits=c+7,U.hash_size=1<<U.hash_bits,U.hash_mask=U.hash_size-1,U.hash_shift=~~((U.hash_bits+A-1)/A),U.window=new s.Buf8(2*U.w_size),U.head=new s.Buf16(U.hash_size),U.prev=new s.Buf16(U.w_size),U.lit_bufsize=1<<c+6,U.pending_buf_size=4*U.lit_bufsize,U.pending_buf=new s.Buf8(U.pending_buf_size),U.d_buf=1*U.lit_bufsize,U.l_buf=3*U.lit_bufsize,U.level=q,U.strategy=d,U.method=y,O(h)}o=[new B(0,0,0,0,function(h,q){var y=65535;for(y>h.pending_buf_size-5&&(y=h.pending_buf_size-5);;){if(h.lookahead<=1){if(j(h),h.lookahead===0&&q===b)return E;if(h.lookahead===0)break}h.strstart+=h.lookahead,h.lookahead=0;var u=h.block_start+y;if((h.strstart===0||h.strstart>=u)&&(h.lookahead=h.strstart-u,h.strstart=u,k(h,!1),h.strm.avail_out===0)||h.strstart-h.block_start>=h.w_size-pe&&(k(h,!1),h.strm.avail_out===0))return E}return h.insert=0,q===T?(k(h,!0),h.strm.avail_out===0?he:J):(h.strstart>h.block_start&&(k(h,!1),h.strm.avail_out),E)}),new B(4,4,8,4,p),new B(4,5,16,8,p),new B(4,6,32,32,p),new B(4,4,16,16,f),new B(8,16,32,32,f),new B(8,16,128,128,f),new B(8,32,128,256,f),new B(32,128,258,1024,f),new B(32,258,258,4096,f)],i.deflateInit=function(h,q){return re(h,q,D,15,8,0)},i.deflateInit2=re,i.deflateReset=O,i.deflateResetKeep=I,i.deflateSetHeader=function(h,q){return h&&h.state?h.state.wrap!==2?x:(h.state.gzhead=q,w):x},i.deflate=function(h,q){var y,u,c,d;if(!h||!h.state||5<q||q<0)return h?ve(h,x):x;if(u=h.state,!h.output||!h.input&&h.avail_in!==0||u.status===666&&q!==T)return ve(h,h.avail_out===0?-5:x);if(u.strm=h,y=u.last_flush,u.last_flush=q,u.status===L)if(u.wrap===2)h.adler=0,z(u,31),z(u,139),z(u,8),u.gzhead?(z(u,(u.gzhead.text?1:0)+(u.gzhead.hcrc?2:0)+(u.gzhead.extra?4:0)+(u.gzhead.name?8:0)+(u.gzhead.comment?16:0)),z(u,255&u.gzhead.time),z(u,u.gzhead.time>>8&255),z(u,u.gzhead.time>>16&255),z(u,u.gzhead.time>>24&255),z(u,u.level===9?2:2<=u.strategy||u.level<2?4:0),z(u,255&u.gzhead.os),u.gzhead.extra&&u.gzhead.extra.length&&(z(u,255&u.gzhead.extra.length),z(u,u.gzhead.extra.length>>8&255)),u.gzhead.hcrc&&(h.adler=g(h.adler,u.pending_buf,u.pending,0)),u.gzindex=0,u.status=69):(z(u,0),z(u,0),z(u,0),z(u,0),z(u,0),z(u,u.level===9?2:2<=u.strategy||u.level<2?4:0),z(u,3),u.status=K);else{var R=D+(u.w_bits-8<<4)<<8;R|=(2<=u.strategy||u.level<2?0:u.level<6?1:u.level===6?2:3)<<6,u.strstart!==0&&(R|=32),R+=31-R%31,u.status=K,$(u,R),u.strstart!==0&&($(u,h.adler>>>16),$(u,65535&h.adler)),h.adler=1}if(u.status===69)if(u.gzhead.extra){for(c=u.pending;u.gzindex<(65535&u.gzhead.extra.length)&&(u.pending!==u.pending_buf_size||(u.gzhead.hcrc&&u.pending>c&&(h.adler=g(h.adler,u.pending_buf,u.pending-c,c)),G(h),c=u.pending,u.pending!==u.pending_buf_size));)z(u,255&u.gzhead.extra[u.gzindex]),u.gzindex++;u.gzhead.hcrc&&u.pending>c&&(h.adler=g(h.adler,u.pending_buf,u.pending-c,c)),u.gzindex===u.gzhead.extra.length&&(u.gzindex=0,u.status=73)}else u.status=73;if(u.status===73)if(u.gzhead.name){c=u.pending;do{if(u.pending===u.pending_buf_size&&(u.gzhead.hcrc&&u.pending>c&&(h.adler=g(h.adler,u.pending_buf,u.pending-c,c)),G(h),c=u.pending,u.pending===u.pending_buf_size)){d=1;break}d=u.gzindex<u.gzhead.name.length?255&u.gzhead.name.charCodeAt(u.gzindex++):0,z(u,d)}while(d!==0);u.gzhead.hcrc&&u.pending>c&&(h.adler=g(h.adler,u.pending_buf,u.pending-c,c)),d===0&&(u.gzindex=0,u.status=91)}else u.status=91;if(u.status===91)if(u.gzhead.comment){c=u.pending;do{if(u.pending===u.pending_buf_size&&(u.gzhead.hcrc&&u.pending>c&&(h.adler=g(h.adler,u.pending_buf,u.pending-c,c)),G(h),c=u.pending,u.pending===u.pending_buf_size)){d=1;break}d=u.gzindex<u.gzhead.comment.length?255&u.gzhead.comment.charCodeAt(u.gzindex++):0,z(u,d)}while(d!==0);u.gzhead.hcrc&&u.pending>c&&(h.adler=g(h.adler,u.pending_buf,u.pending-c,c)),d===0&&(u.status=103)}else u.status=103;if(u.status===103&&(u.gzhead.hcrc?(u.pending+2>u.pending_buf_size&&G(h),u.pending+2<=u.pending_buf_size&&(z(u,255&h.adler),z(u,h.adler>>8&255),h.adler=0,u.status=K)):u.status=K),u.pending!==0){if(G(h),h.avail_out===0)return u.last_flush=-1,w}else if(h.avail_in===0&&oe(q)<=oe(y)&&q!==T)return ve(h,-5);if(u.status===666&&h.avail_in!==0)return ve(h,-5);if(h.avail_in!==0||u.lookahead!==0||q!==b&&u.status!==666){var U=u.strategy===2?function(P,ae){for(var de;;){if(P.lookahead===0&&(j(P),P.lookahead===0)){if(ae===b)return E;break}if(P.match_length=0,de=a._tr_tally(P,0,P.window[P.strstart]),P.lookahead--,P.strstart++,de&&(k(P,!1),P.strm.avail_out===0))return E}return P.insert=0,ae===T?(k(P,!0),P.strm.avail_out===0?he:J):P.last_lit&&(k(P,!1),P.strm.avail_out===0)?E:Z}(u,q):u.strategy===3?function(P,ae){for(var de,se,fe,Ee,De=P.window;;){if(P.lookahead<=ce){if(j(P),P.lookahead<=ce&&ae===b)return E;if(P.lookahead===0)break}if(P.match_length=0,P.lookahead>=A&&0<P.strstart&&(se=De[fe=P.strstart-1])===De[++fe]&&se===De[++fe]&&se===De[++fe]){Ee=P.strstart+ce;do;while(se===De[++fe]&&se===De[++fe]&&se===De[++fe]&&se===De[++fe]&&se===De[++fe]&&se===De[++fe]&&se===De[++fe]&&se===De[++fe]&&fe<Ee);P.match_length=ce-(Ee-fe),P.match_length>P.lookahead&&(P.match_length=P.lookahead)}if(P.match_length>=A?(de=a._tr_tally(P,1,P.match_length-A),P.lookahead-=P.match_length,P.strstart+=P.match_length,P.match_length=0):(de=a._tr_tally(P,0,P.window[P.strstart]),P.lookahead--,P.strstart++),de&&(k(P,!1),P.strm.avail_out===0))return E}return P.insert=0,ae===T?(k(P,!0),P.strm.avail_out===0?he:J):P.last_lit&&(k(P,!1),P.strm.avail_out===0)?E:Z}(u,q):o[u.level].func(u,q);if(U!==he&&U!==J||(u.status=666),U===E||U===he)return h.avail_out===0&&(u.last_flush=-1),w;if(U===Z&&(q===1?a._tr_align(u):q!==5&&(a._tr_stored_block(u,0,0,!1),q===3&&(ge(u.head),u.lookahead===0&&(u.strstart=0,u.block_start=0,u.insert=0))),G(h),h.avail_out===0))return u.last_flush=-1,w}return q!==T?w:u.wrap<=0?1:(u.wrap===2?(z(u,255&h.adler),z(u,h.adler>>8&255),z(u,h.adler>>16&255),z(u,h.adler>>24&255),z(u,255&h.total_in),z(u,h.total_in>>8&255),z(u,h.total_in>>16&255),z(u,h.total_in>>24&255)):($(u,h.adler>>>16),$(u,65535&h.adler)),G(h),0<u.wrap&&(u.wrap=-u.wrap),u.pending!==0?w:1)},i.deflateEnd=function(h){var q;return h&&h.state?(q=h.state.status)!==L&&q!==69&&q!==73&&q!==91&&q!==103&&q!==K&&q!==666?ve(h,x):(h.state=null,q===K?ve(h,-3):w):x},i.deflateSetDictionary=function(h,q){var y,u,c,d,R,U,P,ae,de=q.length;if(!h||!h.state||(d=(y=h.state).wrap)===2||d===1&&y.status!==L||y.lookahead)return x;for(d===1&&(h.adler=l(h.adler,q,de,0)),y.wrap=0,de>=y.w_size&&(d===0&&(ge(y.head),y.strstart=0,y.block_start=0,y.insert=0),ae=new s.Buf8(y.w_size),s.arraySet(ae,q,de-y.w_size,y.w_size,0),q=ae,de=y.w_size),R=h.avail_in,U=h.next_in,P=h.input,h.avail_in=de,h.next_in=0,h.input=q,j(y);y.lookahead>=A;){for(u=y.strstart,c=y.lookahead-(A-1);y.ins_h=(y.ins_h<<y.hash_shift^y.window[u+A-1])&y.hash_mask,y.prev[u&y.w_mask]=y.head[y.ins_h],y.head[y.ins_h]=u,u++,--c;);y.strstart=u,y.lookahead=A-1,j(y)}return y.strstart+=y.lookahead,y.block_start=y.strstart,y.insert=y.lookahead,y.lookahead=0,y.match_length=y.prev_length=A-1,y.match_available=0,h.next_in=U,h.input=P,h.avail_in=R,y.wrap=d,w},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(r,n,i){n.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(r,n,i){n.exports=function(o,s){var a,l,g,_,b,T,w,x,v,C,m,D,S,N,M,te,V,ne,A,ce,pe,L,K,E,Z;a=o.state,l=o.next_in,E=o.input,g=l+(o.avail_in-5),_=o.next_out,Z=o.output,b=_-(s-o.avail_out),T=_+(o.avail_out-257),w=a.dmax,x=a.wsize,v=a.whave,C=a.wnext,m=a.window,D=a.hold,S=a.bits,N=a.lencode,M=a.distcode,te=(1<<a.lenbits)-1,V=(1<<a.distbits)-1;e:do{S<15&&(D+=E[l++]<<S,S+=8,D+=E[l++]<<S,S+=8),ne=N[D&te];t:for(;;){if(D>>>=A=ne>>>24,S-=A,(A=ne>>>16&255)===0)Z[_++]=65535&ne;else{if(!(16&A)){if(!(64&A)){ne=N[(65535&ne)+(D&(1<<A)-1)];continue t}if(32&A){a.mode=12;break e}o.msg="invalid literal/length code",a.mode=30;break e}ce=65535&ne,(A&=15)&&(S<A&&(D+=E[l++]<<S,S+=8),ce+=D&(1<<A)-1,D>>>=A,S-=A),S<15&&(D+=E[l++]<<S,S+=8,D+=E[l++]<<S,S+=8),ne=M[D&V];r:for(;;){if(D>>>=A=ne>>>24,S-=A,!(16&(A=ne>>>16&255))){if(!(64&A)){ne=M[(65535&ne)+(D&(1<<A)-1)];continue r}o.msg="invalid distance code",a.mode=30;break e}if(pe=65535&ne,S<(A&=15)&&(D+=E[l++]<<S,(S+=8)<A&&(D+=E[l++]<<S,S+=8)),w<(pe+=D&(1<<A)-1)){o.msg="invalid distance too far back",a.mode=30;break e}if(D>>>=A,S-=A,(A=_-b)<pe){if(v<(A=pe-A)&&a.sane){o.msg="invalid distance too far back",a.mode=30;break e}if(K=m,(L=0)===C){if(L+=x-A,A<ce){for(ce-=A;Z[_++]=m[L++],--A;);L=_-pe,K=Z}}else if(C<A){if(L+=x+C-A,(A-=C)<ce){for(ce-=A;Z[_++]=m[L++],--A;);if(L=0,C<ce){for(ce-=A=C;Z[_++]=m[L++],--A;);L=_-pe,K=Z}}}else if(L+=C-A,A<ce){for(ce-=A;Z[_++]=m[L++],--A;);L=_-pe,K=Z}for(;2<ce;)Z[_++]=K[L++],Z[_++]=K[L++],Z[_++]=K[L++],ce-=3;ce&&(Z[_++]=K[L++],1<ce&&(Z[_++]=K[L++]))}else{for(L=_-pe;Z[_++]=Z[L++],Z[_++]=Z[L++],Z[_++]=Z[L++],2<(ce-=3););ce&&(Z[_++]=Z[L++],1<ce&&(Z[_++]=Z[L++]))}break}}break}}while(l<g&&_<T);l-=ce=S>>3,D&=(1<<(S-=ce<<3))-1,o.next_in=l,o.next_out=_,o.avail_in=l<g?g-l+5:5-(l-g),o.avail_out=_<T?T-_+257:257-(_-T),a.hold=D,a.bits=S}},{}],49:[function(r,n,i){var o=r("../utils/common"),s=r("./adler32"),a=r("./crc32"),l=r("./inffast"),g=r("./inftrees"),_=1,b=2,T=0,w=-2,x=1,v=852,C=592;function m(L){return(L>>>24&255)+(L>>>8&65280)+((65280&L)<<8)+((255&L)<<24)}function D(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new o.Buf16(320),this.work=new o.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function S(L){var K;return L&&L.state?(K=L.state,L.total_in=L.total_out=K.total=0,L.msg="",K.wrap&&(L.adler=1&K.wrap),K.mode=x,K.last=0,K.havedict=0,K.dmax=32768,K.head=null,K.hold=0,K.bits=0,K.lencode=K.lendyn=new o.Buf32(v),K.distcode=K.distdyn=new o.Buf32(C),K.sane=1,K.back=-1,T):w}function N(L){var K;return L&&L.state?((K=L.state).wsize=0,K.whave=0,K.wnext=0,S(L)):w}function M(L,K){var E,Z;return L&&L.state?(Z=L.state,K<0?(E=0,K=-K):(E=1+(K>>4),K<48&&(K&=15)),K&&(K<8||15<K)?w:(Z.window!==null&&Z.wbits!==K&&(Z.window=null),Z.wrap=E,Z.wbits=K,N(L))):w}function te(L,K){var E,Z;return L?(Z=new D,(L.state=Z).window=null,(E=M(L,K))!==T&&(L.state=null),E):w}var V,ne,A=!0;function ce(L){if(A){var K;for(V=new o.Buf32(512),ne=new o.Buf32(32),K=0;K<144;)L.lens[K++]=8;for(;K<256;)L.lens[K++]=9;for(;K<280;)L.lens[K++]=7;for(;K<288;)L.lens[K++]=8;for(g(_,L.lens,0,288,V,0,L.work,{bits:9}),K=0;K<32;)L.lens[K++]=5;g(b,L.lens,0,32,ne,0,L.work,{bits:5}),A=!1}L.lencode=V,L.lenbits=9,L.distcode=ne,L.distbits=5}function pe(L,K,E,Z){var he,J=L.state;return J.window===null&&(J.wsize=1<<J.wbits,J.wnext=0,J.whave=0,J.window=new o.Buf8(J.wsize)),Z>=J.wsize?(o.arraySet(J.window,K,E-J.wsize,J.wsize,0),J.wnext=0,J.whave=J.wsize):(Z<(he=J.wsize-J.wnext)&&(he=Z),o.arraySet(J.window,K,E-Z,he,J.wnext),(Z-=he)?(o.arraySet(J.window,K,E-Z,Z,0),J.wnext=Z,J.whave=J.wsize):(J.wnext+=he,J.wnext===J.wsize&&(J.wnext=0),J.whave<J.wsize&&(J.whave+=he))),0}i.inflateReset=N,i.inflateReset2=M,i.inflateResetKeep=S,i.inflateInit=function(L){return te(L,15)},i.inflateInit2=te,i.inflate=function(L,K){var E,Z,he,J,ve,oe,ge,G,k,z,$,ie,j,p,f,B,F,I,O,re,h,q,y,u,c=0,d=new o.Buf8(4),R=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!L||!L.state||!L.output||!L.input&&L.avail_in!==0)return w;(E=L.state).mode===12&&(E.mode=13),ve=L.next_out,he=L.output,ge=L.avail_out,J=L.next_in,Z=L.input,oe=L.avail_in,G=E.hold,k=E.bits,z=oe,$=ge,q=T;e:for(;;)switch(E.mode){case x:if(E.wrap===0){E.mode=13;break}for(;k<16;){if(oe===0)break e;oe--,G+=Z[J++]<<k,k+=8}if(2&E.wrap&&G===35615){d[E.check=0]=255&G,d[1]=G>>>8&255,E.check=a(E.check,d,2,0),k=G=0,E.mode=2;break}if(E.flags=0,E.head&&(E.head.done=!1),!(1&E.wrap)||(((255&G)<<8)+(G>>8))%31){L.msg="incorrect header check",E.mode=30;break}if((15&G)!=8){L.msg="unknown compression method",E.mode=30;break}if(k-=4,h=8+(15&(G>>>=4)),E.wbits===0)E.wbits=h;else if(h>E.wbits){L.msg="invalid window size",E.mode=30;break}E.dmax=1<<h,L.adler=E.check=1,E.mode=512&G?10:12,k=G=0;break;case 2:for(;k<16;){if(oe===0)break e;oe--,G+=Z[J++]<<k,k+=8}if(E.flags=G,(255&E.flags)!=8){L.msg="unknown compression method",E.mode=30;break}if(57344&E.flags){L.msg="unknown header flags set",E.mode=30;break}E.head&&(E.head.text=G>>8&1),512&E.flags&&(d[0]=255&G,d[1]=G>>>8&255,E.check=a(E.check,d,2,0)),k=G=0,E.mode=3;case 3:for(;k<32;){if(oe===0)break e;oe--,G+=Z[J++]<<k,k+=8}E.head&&(E.head.time=G),512&E.flags&&(d[0]=255&G,d[1]=G>>>8&255,d[2]=G>>>16&255,d[3]=G>>>24&255,E.check=a(E.check,d,4,0)),k=G=0,E.mode=4;case 4:for(;k<16;){if(oe===0)break e;oe--,G+=Z[J++]<<k,k+=8}E.head&&(E.head.xflags=255&G,E.head.os=G>>8),512&E.flags&&(d[0]=255&G,d[1]=G>>>8&255,E.check=a(E.check,d,2,0)),k=G=0,E.mode=5;case 5:if(1024&E.flags){for(;k<16;){if(oe===0)break e;oe--,G+=Z[J++]<<k,k+=8}E.length=G,E.head&&(E.head.extra_len=G),512&E.flags&&(d[0]=255&G,d[1]=G>>>8&255,E.check=a(E.check,d,2,0)),k=G=0}else E.head&&(E.head.extra=null);E.mode=6;case 6:if(1024&E.flags&&(oe<(ie=E.length)&&(ie=oe),ie&&(E.head&&(h=E.head.extra_len-E.length,E.head.extra||(E.head.extra=new Array(E.head.extra_len)),o.arraySet(E.head.extra,Z,J,ie,h)),512&E.flags&&(E.check=a(E.check,Z,ie,J)),oe-=ie,J+=ie,E.length-=ie),E.length))break e;E.length=0,E.mode=7;case 7:if(2048&E.flags){if(oe===0)break e;for(ie=0;h=Z[J+ie++],E.head&&h&&E.length<65536&&(E.head.name+=String.fromCharCode(h)),h&&ie<oe;);if(512&E.flags&&(E.check=a(E.check,Z,ie,J)),oe-=ie,J+=ie,h)break e}else E.head&&(E.head.name=null);E.length=0,E.mode=8;case 8:if(4096&E.flags){if(oe===0)break e;for(ie=0;h=Z[J+ie++],E.head&&h&&E.length<65536&&(E.head.comment+=String.fromCharCode(h)),h&&ie<oe;);if(512&E.flags&&(E.check=a(E.check,Z,ie,J)),oe-=ie,J+=ie,h)break e}else E.head&&(E.head.comment=null);E.mode=9;case 9:if(512&E.flags){for(;k<16;){if(oe===0)break e;oe--,G+=Z[J++]<<k,k+=8}if(G!==(65535&E.check)){L.msg="header crc mismatch",E.mode=30;break}k=G=0}E.head&&(E.head.hcrc=E.flags>>9&1,E.head.done=!0),L.adler=E.check=0,E.mode=12;break;case 10:for(;k<32;){if(oe===0)break e;oe--,G+=Z[J++]<<k,k+=8}L.adler=E.check=m(G),k=G=0,E.mode=11;case 11:if(E.havedict===0)return L.next_out=ve,L.avail_out=ge,L.next_in=J,L.avail_in=oe,E.hold=G,E.bits=k,2;L.adler=E.check=1,E.mode=12;case 12:if(K===5||K===6)break e;case 13:if(E.last){G>>>=7&k,k-=7&k,E.mode=27;break}for(;k<3;){if(oe===0)break e;oe--,G+=Z[J++]<<k,k+=8}switch(E.last=1&G,k-=1,3&(G>>>=1)){case 0:E.mode=14;break;case 1:if(ce(E),E.mode=20,K!==6)break;G>>>=2,k-=2;break e;case 2:E.mode=17;break;case 3:L.msg="invalid block type",E.mode=30}G>>>=2,k-=2;break;case 14:for(G>>>=7&k,k-=7&k;k<32;){if(oe===0)break e;oe--,G+=Z[J++]<<k,k+=8}if((65535&G)!=(G>>>16^65535)){L.msg="invalid stored block lengths",E.mode=30;break}if(E.length=65535&G,k=G=0,E.mode=15,K===6)break e;case 15:E.mode=16;case 16:if(ie=E.length){if(oe<ie&&(ie=oe),ge<ie&&(ie=ge),ie===0)break e;o.arraySet(he,Z,J,ie,ve),oe-=ie,J+=ie,ge-=ie,ve+=ie,E.length-=ie;break}E.mode=12;break;case 17:for(;k<14;){if(oe===0)break e;oe--,G+=Z[J++]<<k,k+=8}if(E.nlen=257+(31&G),G>>>=5,k-=5,E.ndist=1+(31&G),G>>>=5,k-=5,E.ncode=4+(15&G),G>>>=4,k-=4,286<E.nlen||30<E.ndist){L.msg="too many length or distance symbols",E.mode=30;break}E.have=0,E.mode=18;case 18:for(;E.have<E.ncode;){for(;k<3;){if(oe===0)break e;oe--,G+=Z[J++]<<k,k+=8}E.lens[R[E.have++]]=7&G,G>>>=3,k-=3}for(;E.have<19;)E.lens[R[E.have++]]=0;if(E.lencode=E.lendyn,E.lenbits=7,y={bits:E.lenbits},q=g(0,E.lens,0,19,E.lencode,0,E.work,y),E.lenbits=y.bits,q){L.msg="invalid code lengths set",E.mode=30;break}E.have=0,E.mode=19;case 19:for(;E.have<E.nlen+E.ndist;){for(;B=(c=E.lencode[G&(1<<E.lenbits)-1])>>>16&255,F=65535&c,!((f=c>>>24)<=k);){if(oe===0)break e;oe--,G+=Z[J++]<<k,k+=8}if(F<16)G>>>=f,k-=f,E.lens[E.have++]=F;else{if(F===16){for(u=f+2;k<u;){if(oe===0)break e;oe--,G+=Z[J++]<<k,k+=8}if(G>>>=f,k-=f,E.have===0){L.msg="invalid bit length repeat",E.mode=30;break}h=E.lens[E.have-1],ie=3+(3&G),G>>>=2,k-=2}else if(F===17){for(u=f+3;k<u;){if(oe===0)break e;oe--,G+=Z[J++]<<k,k+=8}k-=f,h=0,ie=3+(7&(G>>>=f)),G>>>=3,k-=3}else{for(u=f+7;k<u;){if(oe===0)break e;oe--,G+=Z[J++]<<k,k+=8}k-=f,h=0,ie=11+(127&(G>>>=f)),G>>>=7,k-=7}if(E.have+ie>E.nlen+E.ndist){L.msg="invalid bit length repeat",E.mode=30;break}for(;ie--;)E.lens[E.have++]=h}}if(E.mode===30)break;if(E.lens[256]===0){L.msg="invalid code -- missing end-of-block",E.mode=30;break}if(E.lenbits=9,y={bits:E.lenbits},q=g(_,E.lens,0,E.nlen,E.lencode,0,E.work,y),E.lenbits=y.bits,q){L.msg="invalid literal/lengths set",E.mode=30;break}if(E.distbits=6,E.distcode=E.distdyn,y={bits:E.distbits},q=g(b,E.lens,E.nlen,E.ndist,E.distcode,0,E.work,y),E.distbits=y.bits,q){L.msg="invalid distances set",E.mode=30;break}if(E.mode=20,K===6)break e;case 20:E.mode=21;case 21:if(6<=oe&&258<=ge){L.next_out=ve,L.avail_out=ge,L.next_in=J,L.avail_in=oe,E.hold=G,E.bits=k,l(L,$),ve=L.next_out,he=L.output,ge=L.avail_out,J=L.next_in,Z=L.input,oe=L.avail_in,G=E.hold,k=E.bits,E.mode===12&&(E.back=-1);break}for(E.back=0;B=(c=E.lencode[G&(1<<E.lenbits)-1])>>>16&255,F=65535&c,!((f=c>>>24)<=k);){if(oe===0)break e;oe--,G+=Z[J++]<<k,k+=8}if(B&&!(240&B)){for(I=f,O=B,re=F;B=(c=E.lencode[re+((G&(1<<I+O)-1)>>I)])>>>16&255,F=65535&c,!(I+(f=c>>>24)<=k);){if(oe===0)break e;oe--,G+=Z[J++]<<k,k+=8}G>>>=I,k-=I,E.back+=I}if(G>>>=f,k-=f,E.back+=f,E.length=F,B===0){E.mode=26;break}if(32&B){E.back=-1,E.mode=12;break}if(64&B){L.msg="invalid literal/length code",E.mode=30;break}E.extra=15&B,E.mode=22;case 22:if(E.extra){for(u=E.extra;k<u;){if(oe===0)break e;oe--,G+=Z[J++]<<k,k+=8}E.length+=G&(1<<E.extra)-1,G>>>=E.extra,k-=E.extra,E.back+=E.extra}E.was=E.length,E.mode=23;case 23:for(;B=(c=E.distcode[G&(1<<E.distbits)-1])>>>16&255,F=65535&c,!((f=c>>>24)<=k);){if(oe===0)break e;oe--,G+=Z[J++]<<k,k+=8}if(!(240&B)){for(I=f,O=B,re=F;B=(c=E.distcode[re+((G&(1<<I+O)-1)>>I)])>>>16&255,F=65535&c,!(I+(f=c>>>24)<=k);){if(oe===0)break e;oe--,G+=Z[J++]<<k,k+=8}G>>>=I,k-=I,E.back+=I}if(G>>>=f,k-=f,E.back+=f,64&B){L.msg="invalid distance code",E.mode=30;break}E.offset=F,E.extra=15&B,E.mode=24;case 24:if(E.extra){for(u=E.extra;k<u;){if(oe===0)break e;oe--,G+=Z[J++]<<k,k+=8}E.offset+=G&(1<<E.extra)-1,G>>>=E.extra,k-=E.extra,E.back+=E.extra}if(E.offset>E.dmax){L.msg="invalid distance too far back",E.mode=30;break}E.mode=25;case 25:if(ge===0)break e;if(ie=$-ge,E.offset>ie){if((ie=E.offset-ie)>E.whave&&E.sane){L.msg="invalid distance too far back",E.mode=30;break}j=ie>E.wnext?(ie-=E.wnext,E.wsize-ie):E.wnext-ie,ie>E.length&&(ie=E.length),p=E.window}else p=he,j=ve-E.offset,ie=E.length;for(ge<ie&&(ie=ge),ge-=ie,E.length-=ie;he[ve++]=p[j++],--ie;);E.length===0&&(E.mode=21);break;case 26:if(ge===0)break e;he[ve++]=E.length,ge--,E.mode=21;break;case 27:if(E.wrap){for(;k<32;){if(oe===0)break e;oe--,G|=Z[J++]<<k,k+=8}if($-=ge,L.total_out+=$,E.total+=$,$&&(L.adler=E.check=E.flags?a(E.check,he,$,ve-$):s(E.check,he,$,ve-$)),$=ge,(E.flags?G:m(G))!==E.check){L.msg="incorrect data check",E.mode=30;break}k=G=0}E.mode=28;case 28:if(E.wrap&&E.flags){for(;k<32;){if(oe===0)break e;oe--,G+=Z[J++]<<k,k+=8}if(G!==(4294967295&E.total)){L.msg="incorrect length check",E.mode=30;break}k=G=0}E.mode=29;case 29:q=1;break e;case 30:q=-3;break e;case 31:return-4;case 32:default:return w}return L.next_out=ve,L.avail_out=ge,L.next_in=J,L.avail_in=oe,E.hold=G,E.bits=k,(E.wsize||$!==L.avail_out&&E.mode<30&&(E.mode<27||K!==4))&&pe(L,L.output,L.next_out,$-L.avail_out)?(E.mode=31,-4):(z-=L.avail_in,$-=L.avail_out,L.total_in+=z,L.total_out+=$,E.total+=$,E.wrap&&$&&(L.adler=E.check=E.flags?a(E.check,he,$,L.next_out-$):s(E.check,he,$,L.next_out-$)),L.data_type=E.bits+(E.last?64:0)+(E.mode===12?128:0)+(E.mode===20||E.mode===15?256:0),(z==0&&$===0||K===4)&&q===T&&(q=-5),q)},i.inflateEnd=function(L){if(!L||!L.state)return w;var K=L.state;return K.window&&(K.window=null),L.state=null,T},i.inflateGetHeader=function(L,K){var E;return L&&L.state&&2&(E=L.state).wrap?((E.head=K).done=!1,T):w},i.inflateSetDictionary=function(L,K){var E,Z=K.length;return L&&L.state?(E=L.state).wrap!==0&&E.mode!==11?w:E.mode===11&&s(1,K,Z,0)!==E.check?-3:pe(L,K,Z,Z)?(E.mode=31,-4):(E.havedict=1,T):w},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(r,n,i){var o=r("../utils/common"),s=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],g=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(_,b,T,w,x,v,C,m){var D,S,N,M,te,V,ne,A,ce,pe=m.bits,L=0,K=0,E=0,Z=0,he=0,J=0,ve=0,oe=0,ge=0,G=0,k=null,z=0,$=new o.Buf16(16),ie=new o.Buf16(16),j=null,p=0;for(L=0;L<=15;L++)$[L]=0;for(K=0;K<w;K++)$[b[T+K]]++;for(he=pe,Z=15;1<=Z&&$[Z]===0;Z--);if(Z<he&&(he=Z),Z===0)return x[v++]=20971520,x[v++]=20971520,m.bits=1,0;for(E=1;E<Z&&$[E]===0;E++);for(he<E&&(he=E),L=oe=1;L<=15;L++)if(oe<<=1,(oe-=$[L])<0)return-1;if(0<oe&&(_===0||Z!==1))return-1;for(ie[1]=0,L=1;L<15;L++)ie[L+1]=ie[L]+$[L];for(K=0;K<w;K++)b[T+K]!==0&&(C[ie[b[T+K]]++]=K);if(V=_===0?(k=j=C,19):_===1?(k=s,z-=257,j=a,p-=257,256):(k=l,j=g,-1),L=E,te=v,ve=K=G=0,N=-1,M=(ge=1<<(J=he))-1,_===1&&852<ge||_===2&&592<ge)return 1;for(;;){for(ne=L-ve,ce=C[K]<V?(A=0,C[K]):C[K]>V?(A=j[p+C[K]],k[z+C[K]]):(A=96,0),D=1<<L-ve,E=S=1<<J;x[te+(G>>ve)+(S-=D)]=ne<<24|A<<16|ce|0,S!==0;);for(D=1<<L-1;G&D;)D>>=1;if(D!==0?(G&=D-1,G+=D):G=0,K++,--$[L]==0){if(L===Z)break;L=b[T+C[K]]}if(he<L&&(G&M)!==N){for(ve===0&&(ve=he),te+=E,oe=1<<(J=L-ve);J+ve<Z&&!((oe-=$[J+ve])<=0);)J++,oe<<=1;if(ge+=1<<J,_===1&&852<ge||_===2&&592<ge)return 1;x[N=G&M]=he<<24|J<<16|te-v|0}}return G!==0&&(x[te+G]=L-ve<<24|64<<16|0),m.bits=he,0}},{"../utils/common":41}],51:[function(r,n,i){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(r,n,i){var o=r("../utils/common"),s=0,a=1;function l(c){for(var d=c.length;0<=--d;)c[d]=0}var g=0,_=29,b=256,T=b+1+_,w=30,x=19,v=2*T+1,C=15,m=16,D=7,S=256,N=16,M=17,te=18,V=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],ne=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],A=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],ce=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],pe=new Array(2*(T+2));l(pe);var L=new Array(2*w);l(L);var K=new Array(512);l(K);var E=new Array(256);l(E);var Z=new Array(_);l(Z);var he,J,ve,oe=new Array(w);function ge(c,d,R,U,P){this.static_tree=c,this.extra_bits=d,this.extra_base=R,this.elems=U,this.max_length=P,this.has_stree=c&&c.length}function G(c,d){this.dyn_tree=c,this.max_code=0,this.stat_desc=d}function k(c){return c<256?K[c]:K[256+(c>>>7)]}function z(c,d){c.pending_buf[c.pending++]=255&d,c.pending_buf[c.pending++]=d>>>8&255}function $(c,d,R){c.bi_valid>m-R?(c.bi_buf|=d<<c.bi_valid&65535,z(c,c.bi_buf),c.bi_buf=d>>m-c.bi_valid,c.bi_valid+=R-m):(c.bi_buf|=d<<c.bi_valid&65535,c.bi_valid+=R)}function ie(c,d,R){$(c,R[2*d],R[2*d+1])}function j(c,d){for(var R=0;R|=1&c,c>>>=1,R<<=1,0<--d;);return R>>>1}function p(c,d,R){var U,P,ae=new Array(C+1),de=0;for(U=1;U<=C;U++)ae[U]=de=de+R[U-1]<<1;for(P=0;P<=d;P++){var se=c[2*P+1];se!==0&&(c[2*P]=j(ae[se]++,se))}}function f(c){var d;for(d=0;d<T;d++)c.dyn_ltree[2*d]=0;for(d=0;d<w;d++)c.dyn_dtree[2*d]=0;for(d=0;d<x;d++)c.bl_tree[2*d]=0;c.dyn_ltree[2*S]=1,c.opt_len=c.static_len=0,c.last_lit=c.matches=0}function B(c){8<c.bi_valid?z(c,c.bi_buf):0<c.bi_valid&&(c.pending_buf[c.pending++]=c.bi_buf),c.bi_buf=0,c.bi_valid=0}function F(c,d,R,U){var P=2*d,ae=2*R;return c[P]<c[ae]||c[P]===c[ae]&&U[d]<=U[R]}function I(c,d,R){for(var U=c.heap[R],P=R<<1;P<=c.heap_len&&(P<c.heap_len&&F(d,c.heap[P+1],c.heap[P],c.depth)&&P++,!F(d,U,c.heap[P],c.depth));)c.heap[R]=c.heap[P],R=P,P<<=1;c.heap[R]=U}function O(c,d,R){var U,P,ae,de,se=0;if(c.last_lit!==0)for(;U=c.pending_buf[c.d_buf+2*se]<<8|c.pending_buf[c.d_buf+2*se+1],P=c.pending_buf[c.l_buf+se],se++,U===0?ie(c,P,d):(ie(c,(ae=E[P])+b+1,d),(de=V[ae])!==0&&$(c,P-=Z[ae],de),ie(c,ae=k(--U),R),(de=ne[ae])!==0&&$(c,U-=oe[ae],de)),se<c.last_lit;);ie(c,S,d)}function re(c,d){var R,U,P,ae=d.dyn_tree,de=d.stat_desc.static_tree,se=d.stat_desc.has_stree,fe=d.stat_desc.elems,Ee=-1;for(c.heap_len=0,c.heap_max=v,R=0;R<fe;R++)ae[2*R]!==0?(c.heap[++c.heap_len]=Ee=R,c.depth[R]=0):ae[2*R+1]=0;for(;c.heap_len<2;)ae[2*(P=c.heap[++c.heap_len]=Ee<2?++Ee:0)]=1,c.depth[P]=0,c.opt_len--,se&&(c.static_len-=de[2*P+1]);for(d.max_code=Ee,R=c.heap_len>>1;1<=R;R--)I(c,ae,R);for(P=fe;R=c.heap[1],c.heap[1]=c.heap[c.heap_len--],I(c,ae,1),U=c.heap[1],c.heap[--c.heap_max]=R,c.heap[--c.heap_max]=U,ae[2*P]=ae[2*R]+ae[2*U],c.depth[P]=(c.depth[R]>=c.depth[U]?c.depth[R]:c.depth[U])+1,ae[2*R+1]=ae[2*U+1]=P,c.heap[1]=P++,I(c,ae,1),2<=c.heap_len;);c.heap[--c.heap_max]=c.heap[1],function(De,ut){var or,Rt,Sn,$e,ui,zo,$t=ut.dyn_tree,yd=ut.max_code,op=ut.stat_desc.static_tree,ap=ut.stat_desc.has_stree,sp=ut.stat_desc.extra_bits,_d=ut.stat_desc.extra_base,An=ut.stat_desc.max_length,ci=0;for($e=0;$e<=C;$e++)De.bl_count[$e]=0;for($t[2*De.heap[De.heap_max]+1]=0,or=De.heap_max+1;or<v;or++)An<($e=$t[2*$t[2*(Rt=De.heap[or])+1]+1]+1)&&($e=An,ci++),$t[2*Rt+1]=$e,yd<Rt||(De.bl_count[$e]++,ui=0,_d<=Rt&&(ui=sp[Rt-_d]),zo=$t[2*Rt],De.opt_len+=zo*($e+ui),ap&&(De.static_len+=zo*(op[2*Rt+1]+ui)));if(ci!==0){do{for($e=An-1;De.bl_count[$e]===0;)$e--;De.bl_count[$e]--,De.bl_count[$e+1]+=2,De.bl_count[An]--,ci-=2}while(0<ci);for($e=An;$e!==0;$e--)for(Rt=De.bl_count[$e];Rt!==0;)yd<(Sn=De.heap[--or])||($t[2*Sn+1]!==$e&&(De.opt_len+=($e-$t[2*Sn+1])*$t[2*Sn],$t[2*Sn+1]=$e),Rt--)}}(c,d),p(ae,Ee,c.bl_count)}function h(c,d,R){var U,P,ae=-1,de=d[1],se=0,fe=7,Ee=4;for(de===0&&(fe=138,Ee=3),d[2*(R+1)+1]=65535,U=0;U<=R;U++)P=de,de=d[2*(U+1)+1],++se<fe&&P===de||(se<Ee?c.bl_tree[2*P]+=se:P!==0?(P!==ae&&c.bl_tree[2*P]++,c.bl_tree[2*N]++):se<=10?c.bl_tree[2*M]++:c.bl_tree[2*te]++,ae=P,Ee=(se=0)===de?(fe=138,3):P===de?(fe=6,3):(fe=7,4))}function q(c,d,R){var U,P,ae=-1,de=d[1],se=0,fe=7,Ee=4;for(de===0&&(fe=138,Ee=3),U=0;U<=R;U++)if(P=de,de=d[2*(U+1)+1],!(++se<fe&&P===de)){if(se<Ee)for(;ie(c,P,c.bl_tree),--se!=0;);else P!==0?(P!==ae&&(ie(c,P,c.bl_tree),se--),ie(c,N,c.bl_tree),$(c,se-3,2)):se<=10?(ie(c,M,c.bl_tree),$(c,se-3,3)):(ie(c,te,c.bl_tree),$(c,se-11,7));ae=P,Ee=(se=0)===de?(fe=138,3):P===de?(fe=6,3):(fe=7,4)}}l(oe);var y=!1;function u(c,d,R,U){$(c,(g<<1)+(U?1:0),3),function(P,ae,de,se){B(P),se&&(z(P,de),z(P,~de)),o.arraySet(P.pending_buf,P.window,ae,de,P.pending),P.pending+=de}(c,d,R,!0)}i._tr_init=function(c){y||(function(){var d,R,U,P,ae,de=new Array(C+1);for(P=U=0;P<_-1;P++)for(Z[P]=U,d=0;d<1<<V[P];d++)E[U++]=P;for(E[U-1]=P,P=ae=0;P<16;P++)for(oe[P]=ae,d=0;d<1<<ne[P];d++)K[ae++]=P;for(ae>>=7;P<w;P++)for(oe[P]=ae<<7,d=0;d<1<<ne[P]-7;d++)K[256+ae++]=P;for(R=0;R<=C;R++)de[R]=0;for(d=0;d<=143;)pe[2*d+1]=8,d++,de[8]++;for(;d<=255;)pe[2*d+1]=9,d++,de[9]++;for(;d<=279;)pe[2*d+1]=7,d++,de[7]++;for(;d<=287;)pe[2*d+1]=8,d++,de[8]++;for(p(pe,T+1,de),d=0;d<w;d++)L[2*d+1]=5,L[2*d]=j(d,5);he=new ge(pe,V,b+1,T,C),J=new ge(L,ne,0,w,C),ve=new ge(new Array(0),A,0,x,D)}(),y=!0),c.l_desc=new G(c.dyn_ltree,he),c.d_desc=new G(c.dyn_dtree,J),c.bl_desc=new G(c.bl_tree,ve),c.bi_buf=0,c.bi_valid=0,f(c)},i._tr_stored_block=u,i._tr_flush_block=function(c,d,R,U){var P,ae,de=0;0<c.level?(c.strm.data_type===2&&(c.strm.data_type=function(se){var fe,Ee=4093624447;for(fe=0;fe<=31;fe++,Ee>>>=1)if(1&Ee&&se.dyn_ltree[2*fe]!==0)return s;if(se.dyn_ltree[18]!==0||se.dyn_ltree[20]!==0||se.dyn_ltree[26]!==0)return a;for(fe=32;fe<b;fe++)if(se.dyn_ltree[2*fe]!==0)return a;return s}(c)),re(c,c.l_desc),re(c,c.d_desc),de=function(se){var fe;for(h(se,se.dyn_ltree,se.l_desc.max_code),h(se,se.dyn_dtree,se.d_desc.max_code),re(se,se.bl_desc),fe=x-1;3<=fe&&se.bl_tree[2*ce[fe]+1]===0;fe--);return se.opt_len+=3*(fe+1)+5+5+4,fe}(c),P=c.opt_len+3+7>>>3,(ae=c.static_len+3+7>>>3)<=P&&(P=ae)):P=ae=R+5,R+4<=P&&d!==-1?u(c,d,R,U):c.strategy===4||ae===P?($(c,2+(U?1:0),3),O(c,pe,L)):($(c,4+(U?1:0),3),function(se,fe,Ee,De){var ut;for($(se,fe-257,5),$(se,Ee-1,5),$(se,De-4,4),ut=0;ut<De;ut++)$(se,se.bl_tree[2*ce[ut]+1],3);q(se,se.dyn_ltree,fe-1),q(se,se.dyn_dtree,Ee-1)}(c,c.l_desc.max_code+1,c.d_desc.max_code+1,de+1),O(c,c.dyn_ltree,c.dyn_dtree)),f(c),U&&B(c)},i._tr_tally=function(c,d,R){return c.pending_buf[c.d_buf+2*c.last_lit]=d>>>8&255,c.pending_buf[c.d_buf+2*c.last_lit+1]=255&d,c.pending_buf[c.l_buf+c.last_lit]=255&R,c.last_lit++,d===0?c.dyn_ltree[2*R]++:(c.matches++,d--,c.dyn_ltree[2*(E[R]+b+1)]++,c.dyn_dtree[2*k(d)]++),c.last_lit===c.lit_bufsize-1},i._tr_align=function(c){$(c,2,3),ie(c,S,pe),function(d){d.bi_valid===16?(z(d,d.bi_buf),d.bi_buf=0,d.bi_valid=0):8<=d.bi_valid&&(d.pending_buf[d.pending++]=255&d.bi_buf,d.bi_buf>>=8,d.bi_valid-=8)}(c)}},{"../utils/common":41}],53:[function(r,n,i){n.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(r,n,i){(function(o){(function(s,a){if(!s.setImmediate){var l,g,_,b,T=1,w={},x=!1,v=s.document,C=Object.getPrototypeOf&&Object.getPrototypeOf(s);C=C&&C.setTimeout?C:s,l={}.toString.call(s.process)==="[object process]"?function(N){Ae.nextTick(function(){D(N)})}:function(){if(s.postMessage&&!s.importScripts){var N=!0,M=s.onmessage;return s.onmessage=function(){N=!1},s.postMessage("","*"),s.onmessage=M,N}}()?(b="setImmediate$"+Math.random()+"$",s.addEventListener?s.addEventListener("message",S,!1):s.attachEvent("onmessage",S),function(N){s.postMessage(b+N,"*")}):s.MessageChannel?((_=new MessageChannel).port1.onmessage=function(N){D(N.data)},function(N){_.port2.postMessage(N)}):v&&"onreadystatechange"in v.createElement("script")?(g=v.documentElement,function(N){var M=v.createElement("script");M.onreadystatechange=function(){D(N),M.onreadystatechange=null,g.removeChild(M),M=null},g.appendChild(M)}):function(N){setTimeout(D,0,N)},C.setImmediate=function(N){typeof N!="function"&&(N=new Function(""+N));for(var M=new Array(arguments.length-1),te=0;te<M.length;te++)M[te]=arguments[te+1];var V={callback:N,args:M};return w[T]=V,l(T),T++},C.clearImmediate=m}function m(N){delete w[N]}function D(N){if(x)setTimeout(D,0,N);else{var M=w[N];if(M){x=!0;try{(function(te){var V=te.callback,ne=te.args;switch(ne.length){case 0:V();break;case 1:V(ne[0]);break;case 2:V(ne[0],ne[1]);break;case 3:V(ne[0],ne[1],ne[2]);break;default:V.apply(a,ne)}})(M)}finally{m(N),x=!1}}}}function S(N){N.source===s&&typeof N.data=="string"&&N.data.indexOf(b)===0&&D(+N.data.slice(b.length))}})(typeof self>"u"?o===void 0?this:o:self)}).call(this,typeof zt<"u"?zt:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(np);var Xy=np.exports,Zy=sm(Xy),Fo={exports:{}},Qy={"&":"&amp;",'"':"&quot;","'":"&apos;","<":"&lt;",">":"&gt;"};function Jy(t){return t&&t.replace?t.replace(/([&"<>'])/g,function(e,r){return Qy[r]}):t}var e_=Jy,Jl=e_,im=ud.Stream,t_="    ";function r_(t,e){typeof e!="object"&&(e={indent:e});var r=e.stream?new im:null,n="",i=!1,o=e.indent?e.indent===!0?t_:e.indent:"",s=!0;function a(T){s?Ae.nextTick(T):T()}function l(T,w){if(w!==void 0&&(n+=w),T&&!i&&(r=r||new im,i=!0),T&&i){var x=n;a(function(){r.emit("data",x)}),n=""}}function g(T,w){wd(l,Po(T,o,o?1:0),w)}function _(){if(r){var T=n;a(function(){r.emit("data",T),r.emit("end"),r.readable=!1,r.emit("close")})}}function b(T){var w=T.encoding||"UTF-8",x={version:"1.0",encoding:w};T.standalone&&(x.standalone=T.standalone),g({"?xml":{_attr:x}}),n=n.replace("/>","?>")}return a(function(){s=!1}),e.declaration&&b(e.declaration),t&&t.forEach?t.forEach(function(T,w){var x;w+1===t.length&&(x=_),g(T,x)}):g(t,_),r?(r.readable=!0,r):n}function n_(){var t=Array.prototype.slice.call(arguments),e={_elem:Po(t)};return e.push=function(r){if(!this.append)throw new Error("not assigned to a parent!");var n=this,i=this._elem.indent;wd(this.append,Po(r,i,this._elem.icount+(i?1:0)),function(){n.append(!0)})},e.close=function(r){r!==void 0&&this.push(r),this.end&&this.end()},e}function i_(t,e){return new Array(e||0).join(t||"")}function Po(t,e,r){r=r||0;var n=i_(e,r),i,o=t,s=!1;if(typeof t=="object"){var a=Object.keys(t);if(i=a[0],o=t[i],o&&o._elem)return o._elem.name=i,o._elem.icount=r,o._elem.indent=e,o._elem.indents=n,o._elem.interrupt=o,o._elem}var l=[],g=[],_;function b(T){var w=Object.keys(T);w.forEach(function(x){l.push(o_(x,T[x]))})}switch(typeof o){case"object":if(o===null)break;o._attr&&b(o._attr),o._cdata&&g.push(("<![CDATA["+o._cdata).replace(/\]\]>/g,"]]]]><![CDATA[>")+"]]>"),o.forEach&&(_=!1,g.push(""),o.forEach(function(T){if(typeof T=="object"){var w=Object.keys(T)[0];w=="_attr"?b(T._attr):g.push(Po(T,e,r+1))}else g.pop(),_=!0,g.push(Jl(T))}),_||g.push(""));break;default:g.push(Jl(o))}return{name:i,interrupt:s,attributes:l,content:g,icount:r,indents:n,indent:e}}function wd(t,e,r){if(typeof e!="object")return t(!1,e);var n=e.interrupt?1:e.content.length;function i(){for(;e.content.length;){var s=e.content.shift();if(s!==void 0){if(o(s))return;wd(t,s)}}t(!1,(n>1?e.indents:"")+(e.name?"</"+e.name+">":"")+(e.indent&&!r?`
`:"")),r&&r()}function o(s){return s.interrupt?(s.interrupt.append=t,s.interrupt.end=i,s.interrupt=!1,t(!0),!0):!1}if(t(!1,e.indents+(e.name?"<"+e.name:"")+(e.attributes.length?" "+e.attributes.join(" "):"")+(n?e.name?">":"":e.name?"/>":"")+(e.indent&&n>1?`
`:"")),!n)return t(!1,e.indent?`
`:"");o(e)||i()}function o_(t,e){return t+'="'+Jl(e)+'"'}Fo.exports=r_;Fo.exports.element=Fo.exports.Element=n_;var a_=Fo.exports,qe=sm(a_),om=0,am=32,s_=32,u_=(t,e)=>{let r=e.replace(/-/g,"");if(r.length!==s_)throw new Error(`Error: Cannot extract GUID from font filename: ${e}`);let i=r.replace(/(..)/g,"$1 ").trim().split(" ").map(l=>parseInt(l,16));i.reverse();let s=t.slice(om,am).map((l,g)=>l^i[g%i.length]);return Buffer.concat([t.slice(0,om),s,t.slice(am)])},oi=class{format(e,r={stack:[]}){let n=e.prepForXml(r);if(n)return n;throw Error("XMLComponent did not format correctly")}},Mo=class{replace(e,r,n){let i=e;return r.forEach((o,s)=>{i=i.replace(new RegExp(`{${o.fileName}}`,"g"),(n+s).toString())}),i}getMediaData(e,r){return r.Array.filter(n=>e.search(`{${n.fileName}}`)>0)}},ed=class{replace(e,r){let n=e;for(let i of r)n=n.replace(new RegExp(`{${i.reference}-${i.instance}}`,"g"),i.numId.toString());return n}},td=class{constructor(){X(this,"formatter"),X(this,"imageReplacer"),X(this,"numberingReplacer"),this.formatter=new oi,this.imageReplacer=new Mo,this.numberingReplacer=new ed}compile(e,r){let n=new Zy,i=this.xmlifyFile(e,r),o=new Map(Object.entries(i));for(let[,s]of o)if(Array.isArray(s))for(let a of s)n.file(a.path,a.data);else n.file(s.path,s.data);for(let{stream:s,fileName:a}of e.Media.Array)n.file(`word/media/${a}`,s);for(let{data:s,name:a,fontKey:l}of e.FontTable.fontOptionsWithKey){let[g]=a.split(".");n.file(`word/fonts/${g}.odttf`,u_(s,l))}return n}xmlifyFile(e,r){let n=e.Document.Relationships.RelationshipCount+1,i=qe(this.formatter.format(e.Document.View,{viewWrapper:e.Document,file:e,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),o=this.imageReplacer.getMediaData(i,e.Media);return{Relationships:{data:(o.forEach((s,a)=>{e.Document.Relationships.createRelationship(n+a,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${s.fileName}`)}),qe(this.formatter.format(e.Document.Relationships,{viewWrapper:e.Document,file:e,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}})),path:"word/_rels/document.xml.rels"},Document:{data:(()=>{let s=this.imageReplacer.replace(i,o,n);return this.numberingReplacer.replace(s,e.Numbering.ConcreteNumbering)})(),path:"word/document.xml"},Styles:{data:(()=>{let s=qe(this.formatter.format(e.Styles,{viewWrapper:e.Document,file:e,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}});return this.numberingReplacer.replace(s,e.Numbering.ConcreteNumbering)})(),path:"word/styles.xml"},Properties:{data:qe(this.formatter.format(e.CoreProperties,{viewWrapper:e.Document,file:e,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/core.xml"},Numbering:{data:qe(this.formatter.format(e.Numbering,{viewWrapper:e.Document,file:e,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/numbering.xml"},FileRelationships:{data:qe(this.formatter.format(e.FileRelationships,{viewWrapper:e.Document,file:e,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:"_rels/.rels"},HeaderRelationships:e.Headers.map((s,a)=>{let l=qe(this.formatter.format(s.View,{viewWrapper:s,file:e,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}});return this.imageReplacer.getMediaData(l,e.Media).forEach((_,b)=>{s.Relationships.createRelationship(b,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${_.fileName}`)}),{data:qe(this.formatter.format(s.Relationships,{viewWrapper:s,file:e,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:`word/_rels/header${a+1}.xml.rels`}}),FooterRelationships:e.Footers.map((s,a)=>{let l=qe(this.formatter.format(s.View,{viewWrapper:s,file:e,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}});return this.imageReplacer.getMediaData(l,e.Media).forEach((_,b)=>{s.Relationships.createRelationship(b,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${_.fileName}`)}),{data:qe(this.formatter.format(s.Relationships,{viewWrapper:s,file:e,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:`word/_rels/footer${a+1}.xml.rels`}}),Headers:e.Headers.map((s,a)=>{let l=qe(this.formatter.format(s.View,{viewWrapper:s,file:e,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),g=this.imageReplacer.getMediaData(l,e.Media),_=this.imageReplacer.replace(l,g,0);return{data:this.numberingReplacer.replace(_,e.Numbering.ConcreteNumbering),path:`word/header${a+1}.xml`}}),Footers:e.Footers.map((s,a)=>{let l=qe(this.formatter.format(s.View,{viewWrapper:s,file:e,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),g=this.imageReplacer.getMediaData(l,e.Media),_=this.imageReplacer.replace(l,g,0);return{data:this.numberingReplacer.replace(_,e.Numbering.ConcreteNumbering),path:`word/footer${a+1}.xml`}}),ContentTypes:{data:qe(this.formatter.format(e.ContentTypes,{viewWrapper:e.Document,file:e,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:"[Content_Types].xml"},CustomProperties:{data:qe(this.formatter.format(e.CustomProperties,{viewWrapper:e.Document,file:e,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/custom.xml"},AppProperties:{data:qe(this.formatter.format(e.AppProperties,{viewWrapper:e.Document,file:e,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/app.xml"},FootNotes:{data:qe(this.formatter.format(e.FootNotes.View,{viewWrapper:e.FootNotes,file:e,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:"word/footnotes.xml"},FootNotesRelationships:{data:qe(this.formatter.format(e.FootNotes.Relationships,{viewWrapper:e.FootNotes,file:e,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:"word/_rels/footnotes.xml.rels"},Settings:{data:qe(this.formatter.format(e.Settings,{viewWrapper:e.Document,file:e,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/settings.xml"},Comments:{data:qe(this.formatter.format(e.Comments,{viewWrapper:e.Document,file:e,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/comments.xml"},FontTable:{data:qe(this.formatter.format(e.FontTable.View,{viewWrapper:e.Document,file:e,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/fontTable.xml"},FontTableRelationships:{data:qe(this.formatter.format(e.FontTable.Relationships,{viewWrapper:e.Document,file:e,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:"word/_rels/fontTable.xml.rels"}}}},c_={NONE:"",WITH_2_BLANKS:"  ",WITH_4_BLANKS:"    ",WITH_TAB:"	"},qn=t=>t===!0?c_.WITH_2_BLANKS:t===!1?void 0:t,ai=class{static toString(e,r){return Zi(this,null,function*(){return yield this.compiler.compile(e,qn(r)).generateAsync({type:"string",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})})}static toBuffer(e,r){return Zi(this,null,function*(){return yield this.compiler.compile(e,qn(r)).generateAsync({type:"nodebuffer",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})})}static toBase64String(e,r){return Zi(this,null,function*(){return yield this.compiler.compile(e,qn(r)).generateAsync({type:"base64",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})})}static toBlob(e,r){return Zi(this,null,function*(){return yield this.compiler.compile(e,qn(r)).generateAsync({type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})})}static toStream(e,r){let n=new ud.Stream;return this.compiler.compile(e,qn(r)).generateAsync({type:"nodebuffer",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"}).then(o=>{n.emit("data",o),n.emit("end")}),n}};X(ai,"compiler",new td);var nD=new oi;var iD=new oi;var oD=new Mo;function l_(t,e){if(t&1&&(W(0,"mat-option",12),Q(1),H()),t&2){let r=e.$implicit;we("value",r),le(),je("",r," \u05E9\u05E0\u05D9\u05DD")}}function d_(t,e){t&1&&(W(0,"th",28),Q(1," \u05EA\u05DE\u05D4\u05D9\u05DC \u05D4\u05D4\u05DC\u05D5\u05D5\u05D0\u05D4 "),H())}function h_(t,e){if(t&1&&(W(0,"td",29),Q(1),H()),t&2){let r=e.$implicit;le(),je(" ",r.type," ")}}function f_(t,e){t&1&&(W(0,"th",28),Q(1," \u05E1\u05DB\u05D5\u05DD \u05D4\u05DC\u05D5\u05D5\u05D0\u05D4 "),H())}function m_(t,e){if(t&1&&(W(0,"td",29),Q(1),H()),t&2){let r=e.$implicit;le(),je(" ",r.loanAmount," ")}}function p_(t,e){t&1&&(W(0,"th",28),Q(1," \u05EA\u05E7\u05D5\u05E4\u05EA \u05D4\u05DC\u05D5\u05D5\u05D0\u05D4 "),H())}function g_(t,e){if(t&1&&(W(0,"td",29),Q(1),H()),t&2){let r=e.$implicit;le(),je(" ",r.term," ")}}function w_(t,e){t&1&&(W(0,"th",28),Q(1," \u05D0\u05D7\u05D5\u05D6 \u05E8\u05D9\u05D1\u05D9\u05EA "),H())}function y_(t,e){if(t&1&&(W(0,"td",29),Q(1),H()),t&2){let r=e.$implicit;le(),je(" ",r.interestRate," ")}}function __(t,e){t&1&&(W(0,"th",28),Q(1," \u05E1\u05DB\u05D5\u05DD \u05D4\u05D7\u05D6\u05E8 \u05D7\u05D5\u05D3\u05E9\u05D9 \u05E8\u05D0\u05E9\u05D5\u05DF "),H())}function v_(t,e){if(t&1&&(W(0,"td",29),Q(1),H()),t&2){let r=e.$implicit;le(),je(" ",r.firstPayment," ")}}function b_(t,e){t&1&&(W(0,"th",28),Q(1," \u05E1\u05DA \u05DB\u05DC \u05D4\u05E1\u05DB\u05D5\u05DD \u05D4\u05E6\u05E4\u05D5\u05D9 "),H())}function E_(t,e){if(t&1&&(W(0,"td",29),Q(1),H()),t&2){let r=e.$implicit;le(),je(" ",r.totalAmount," ")}}function x_(t,e){t&1&&(W(0,"th",28),Q(1," \u05D4\u05E8\u05D9\u05D1\u05D9\u05EA \u05D4\u05DB\u05D5\u05DC\u05DC\u05EA "),H())}function D_(t,e){if(t&1&&(W(0,"td",29),Q(1),H()),t&2){let r=e.$implicit;le(),je(" ",r.totalInterestRate," ")}}function T_(t,e){t&1&&Ce(0,"tr",30)}function C_(t,e){t&1&&Ce(0,"tr",31)}function S_(t,e){if(t&1){let r=ze();W(0,"mat-card-content")(1,"p",2)(2,"span",13),Q(3,"\u05E9\u05D9\u05DE\u05D5 \u2764\uFE0F"),H(),Ce(4,"br"),Q(5,"\u05D4\u05DE\u05D7\u05E9\u05D1\u05D5\u05DF \u05D0\u05D9\u05E0\u05D5 \u05DE\u05D4\u05D5\u05D5\u05D4 \u05EA\u05D7\u05DC\u05D9\u05E3 \u05DC\u05D9\u05D9\u05E2\u05D5\u05E5 \u05DE\u05E7\u05E6\u05D5\u05E2\u05D9."),H(),W(6,"table",14),He(7,15),be(8,d_,2,0,"th",16)(9,h_,2,1,"td",17),We(),He(10,18),be(11,f_,2,0,"th",16)(12,m_,2,1,"td",17),We(),He(13,19),be(14,p_,2,0,"th",16)(15,g_,2,1,"td",17),We(),He(16,20),be(17,w_,2,0,"th",16)(18,y_,2,1,"td",17),We(),He(19,21),be(20,__,2,0,"th",16)(21,v_,2,1,"td",17),We(),He(22,22),be(23,b_,2,0,"th",16)(24,E_,2,1,"td",17),We(),He(25,23),be(26,x_,2,0,"th",16)(27,D_,2,1,"td",17),We(),be(28,T_,1,0,"tr",24)(29,C_,1,0,"tr",25),H(),W(30,"p",26),Q(31),Ei(32,"number"),H(),W(33,"button",27),xe("click",function(){Le(r);let i=ye();return Fe(i.download())}),Q(34,"\u05D4\u05D5\u05E8\u05D3 \u05DE\u05E1\u05DE\u05DA"),H()()}if(t&2){let r=ye();le(6),we("dataSource",r.plans),le(22),we("matHeaderRowDef",r.displayedColumns),le(),we("matRowDefColumns",r.displayedColumns),le(2),je(" \u05E0\u05D5\u05EA\u05E8 \u05DC\u05D4\u05E9\u05DC\u05DE\u05EA \u05E1\u05DB\u05D5\u05DD \u05D4\u05DE\u05E9\u05DB\u05E0\u05EA\u05D0: ",xi(32,4,r.remainingAmount)," \u20AA ")}}var uD=(()=>{let e=class e{constructor(){this.years=[10,15,20,25,30],this.results=!1,this.plans=[],this.displayedColumns=["type","loanAmount","term","interestRate","firstPayment","totalAmount","totalInterestRate"]}calculate(){this.results=!0,this.plans=this.calculatePlans(this.loanAmount,this.loanTerm,this.interestRate),this.remainingAmount=this.calculateRemainingAmount(this.loanAmount,this.loanTerm,this.interestRate,this.paymentsMade)}calculatePlans(n,i,o){return[{type:"\u05E1\u05DC \u05D0\u05D7\u05D9\u05D3 1",loanAmount:n,term:i*12,interestRate:o,firstPayment:this.calculateMonthlyPayment(n,i,o),totalAmount:this.calculateTotalPayment(n,i,o),totalInterestRate:o}]}calculateMonthlyPayment(n,i,o){let s=o/100/12,a=i*12;return Number((n*s/(1-Math.pow(1+s,-a))).toFixed(2))}calculateTotalPayment(n,i,o){return(this.calculateMonthlyPayment(n,i,o)*i*12).toFixed(2)}calculateRemainingAmount(n,i,o,s){let a=this.calculateMonthlyPayment(n,i,o),l=i*12-s;return a*l}download(){return li(this,null,function*(){let s=yield(yield(yield fetch("assets/logo.png")).blob()).arrayBuffer(),a=new Lo({sections:[{properties:{},children:[new Me({children:[new yo({data:s,transformation:{width:100,height:80},floating:{horizontalPosition:{offset:6e6},verticalPosition:{offset:3e5}}})]}),new Me({children:[new Cr({text:"\u05EA\u05D5\u05E6\u05D0\u05D5\u05EA \u05D7\u05D9\u05E9\u05D5\u05D1 \u05D4\u05DE\u05E9\u05DB\u05E0\u05EA\u05D0",bold:!0,size:28})]}),this.generateTable(),new Me({children:[new Cr({text:`\u05E0\u05D5\u05EA\u05E8\u05D5 \u05DC\u05D4\u05E9\u05DC\u05DE\u05EA \u05E1\u05DB\u05D5\u05DD \u05D4\u05DE\u05E9\u05DB\u05E0\u05EA\u05D0: ${this.remainingAmount} \u20AA`,size:24,bold:!0})],alignment:pt.CENTER})]}]});ai.toBlob(a).then(l=>{(0,ip.saveAs)(l,"mortgage-calculation.docx")})})}generateTable(){let n=[];return n.push(new ni({children:[new tt({children:[new Me("\u05EA\u05DE\u05D4\u05D9\u05DC \u05D4\u05D4\u05DC\u05D5\u05D5\u05D0\u05D4")],width:{size:15,type:et.PERCENTAGE}}),new tt({children:[new Me("\u05E1\u05DB\u05D5\u05DD \u05D4\u05DC\u05D5\u05D5\u05D0\u05D4")],width:{size:15,type:et.PERCENTAGE}}),new tt({children:[new Me("\u05EA\u05E7\u05D5\u05E4\u05EA \u05D4\u05DC\u05D5\u05D5\u05D0\u05D4")],width:{size:15,type:et.PERCENTAGE}}),new tt({children:[new Me("\u05D0\u05D7\u05D5\u05D6 \u05E8\u05D9\u05D1\u05D9\u05EA")],width:{size:15,type:et.PERCENTAGE}}),new tt({children:[new Me("\u05E1\u05DB\u05D5\u05DD \u05D4\u05D7\u05D6\u05E8 \u05D7\u05D5\u05D3\u05E9\u05D9 \u05E8\u05D0\u05E9\u05D5\u05DF")],width:{size:20,type:et.PERCENTAGE}}),new tt({children:[new Me("\u05E1\u05DA \u05DB\u05DC \u05D4\u05E1\u05DB\u05D5\u05DD \u05D4\u05E6\u05E4\u05D5\u05D9")],width:{size:10,type:et.PERCENTAGE}}),new tt({children:[new Me("\u05D4\u05E8\u05D9\u05D1\u05D9\u05EA \u05D4\u05DB\u05D5\u05DC\u05DC\u05EA")],width:{size:10,type:et.PERCENTAGE}})]})),this.plans.forEach(i=>{n.push(new ni({children:[new tt({children:[new Me(i.type)],width:{size:15,type:et.PERCENTAGE}}),new tt({children:[new Me(`${i.loanAmount} \u20AA`)],width:{size:15,type:et.PERCENTAGE}}),new tt({children:[new Me(`${i.term} \u05D7\u05D5\u05D3\u05E9\u05D9\u05DD`)],width:{size:15,type:et.PERCENTAGE}}),new tt({children:[new Me(`${i.interestRate}%`)],width:{size:15,type:et.PERCENTAGE}}),new tt({children:[new Me(`${i.firstPayment} \u20AA`)],width:{size:20,type:et.PERCENTAGE}}),new tt({children:[new Me(`${i.totalAmount} \u20AA`)],width:{size:10,type:et.PERCENTAGE}}),new tt({children:[new Me(`${i.totalInterestRate}%`)],width:{size:10,type:et.PERCENTAGE}})]}))}),new So({rows:n,width:{size:100,type:et.PERCENTAGE},alignment:pt.CENTER})}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Be({type:e,selectors:[["app-mortgage-calculator"]],decls:31,vars:6,consts:[["id","main"],[1,"mortgage-calculator"],[1,"warning-text"],["dir","rtl",3,"ngSubmit"],["appearance","outline"],["matInput","","type","number","placeholder","3,600,000","name","loanAmount","required","",3,"ngModelChange","ngModel"],["name","loanTerm","required","",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["matInput","","type","number","placeholder","5","name","interestRate","required","",3,"ngModelChange","ngModel"],["matInput","","type","number","placeholder","24","name","paymentsMade","required","",3,"ngModelChange","ngModel"],["mat-raised-button","","color","primary","type","submit",2,"width","100%","font-size","1.2em"],[4,"ngIf"],[3,"value"],[2,"color","red"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","type"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","loanAmount"],["matColumnDef","term"],["matColumnDef","interestRate"],["matColumnDef","firstPayment"],["matColumnDef","totalAmount"],["matColumnDef","totalInterestRate"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[2,"text-align","center","font-weight","bold","margin-top","20px"],["mat-raised-button","","color","primary","matTooltip","\u05D4\u05D5\u05E8\u05D3\u05EA \u05EA\u05D5\u05E6\u05D0\u05D5\u05EA \u05D4\u05D7\u05D9\u05E9\u05D5\u05D1","matTooltipPosition","left","matTooltipShowDelay","1500",2,"margin-top","20px","width","100%",3,"click"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""]],template:function(i,o){i&1&&(W(0,"div",0)(1,"mat-card",1)(2,"mat-card-title"),Q(3,"\u05DE\u05D7\u05E9\u05D1\u05D5\u05DF \u05DE\u05E9\u05DB\u05E0\u05EA\u05D0\u05D5\u05EA\u{1F3E0}"),H(),W(4,"p",2),Q(5,"\u05DE\u05D7\u05E9\u05D1\u05D5\u05DF \u05D4\u05DE\u05E9\u05DB\u05E0\u05EA\u05D0 \u05D4\u05D5\u05D0 \u05DB\u05DC\u05D9 \u05E2\u05D6\u05E8 \u05D1\u05D0\u05DE\u05E6\u05E2\u05D5\u05EA\u05D5 \u05EA\u05D5\u05DB\u05DC\u05D5 \u05DC\u05D1\u05E6\u05E2 \u05E1\u05D9\u05DE\u05D5\u05DC\u05E6\u05D9\u05D5\u05EA \u05E9\u05D9\u05E1\u05D9\u05D9\u05E2\u05D5 \u05DC\u05DB\u05DD \u05D1\u05EA\u05D4\u05DC\u05D9\u05DA \u05EA\u05DB\u05E0\u05D5\u05DF \u05D4\u05DE\u05E9\u05DB\u05E0\u05EA\u05D0. "),Ce(6,"br"),Q(7," \u05D9\u05E9 \u05DC\u05D4\u05E7\u05DC\u05D9\u05D3 \u05D0\u05EA \u05E1\u05DB\u05D5\u05DD \u05D4\u05D4\u05DC\u05D5\u05D5\u05D0\u05D4 \u05D4\u05DE\u05D1\u05D5\u05E7\u05E9 \u05D5\u05DC\u05D1\u05D7\u05D5\u05E8 \u05D0\u05EA \u05EA\u05E7\u05D5\u05E4\u05EA \u05D4\u05D4\u05DC\u05D5\u05D5\u05D0\u05D4. "),H(),W(8,"mat-card-content")(9,"form",3),xe("ngSubmit",function(){return o.calculate()}),W(10,"mat-form-field",4)(11,"mat-label"),Q(12,"\u05E1\u05DB\u05D5\u05DD \u05D4\u05DE\u05E9\u05DB\u05E0\u05EA\u05D0 \u05E9\u05E0\u05E6\u05D8\u05E8\u05DA (\u20AA):"),H(),W(13,"input",5),Fn("ngModelChange",function(a){return Ln(o.loanAmount,a)||(o.loanAmount=a),a}),H()(),W(14,"mat-form-field",4)(15,"mat-label"),Q(16,"\u05DE\u05E9\u05DB\u05E0\u05EA\u05D0 \u05DC\u05EA\u05E7\u05D5\u05E4\u05D4 \u05E9\u05DC:"),H(),W(17,"mat-select",6),Fn("ngModelChange",function(a){return Ln(o.loanTerm,a)||(o.loanTerm=a),a}),be(18,l_,2,2,"mat-option",7),H()(),W(19,"mat-form-field",4)(20,"mat-label"),Q(21,"\u05D0\u05D7\u05D5\u05D6 \u05E8\u05D9\u05D1\u05D9\u05EA:"),H(),W(22,"input",8),Fn("ngModelChange",function(a){return Ln(o.interestRate,a)||(o.interestRate=a),a}),H()(),W(23,"mat-form-field",4)(24,"mat-label"),Q(25,"\u05DE\u05E1\u05E4\u05E8 \u05EA\u05E9\u05DC\u05D5\u05DE\u05D9\u05DD \u05E9\u05D1\u05D5\u05E6\u05E2\u05D5:"),H(),W(26,"input",9),Fn("ngModelChange",function(a){return Ln(o.paymentsMade,a)||(o.paymentsMade=a),a}),H()(),W(27,"button",10),Q(28,"\u05D0\u05D9\u05E9\u05D5\u05E8"),H()()(),Ce(29,"br"),be(30,S_,35,6,"mat-card-content",11),H()()),i&2&&(le(13),Nn("ngModel",o.loanAmount),le(4),Nn("ngModel",o.loanTerm),le(),we("ngForOf",o.years),le(4),Nn("ngModel",o.interestRate),le(4),Nn("ngModel",o.paymentsMade),le(4),we("ngIf",o.results))},dependencies:[ur,bt,dr,Nt,Kd,Lt,lr,Lr,Vd,Gd,Et,Mr,Ur,zr,jr,Br,Gr,Hr,Wr,$r,Vr,Ft,Mt,Pt,Dt,xt,Tt,ht,Yr,cr,Xr,Pd],styles:[".mortgage-calculator[_ngcontent-%COMP%]{max-width:800px;margin:2em auto;padding:2em;background:#f5f5f5;border-radius:10px;box-shadow:0 3px 10px #0003}#main[_ngcontent-%COMP%]{background-color:#ffffff8e;width:99%;border-radius:10px;border:5px solid rgba(128,128,128,.13)}table[_ngcontent-%COMP%]{width:100%;margin-top:20px}mat-card-title[_ngcontent-%COMP%], mat-card-content[_ngcontent-%COMP%]{text-align:right;direction:rtl}mat-card-title[_ngcontent-%COMP%]{font-size:2em;text-align:center;margin-bottom:1em;color:#3f51b5}.warning-text[_ngcontent-%COMP%]{font-size:.9em;color:gray}mat-form-field[_ngcontent-%COMP%]{width:100%;margin-left:10px;margin-right:10px}"]});let t=e;return t})();var gD=(t,e)=>{let r=wt(Ke),n=wt(ct);return r.isLoggedIn()?r.isAdmin()?!0:(alert("!\u05E2\u05DC \u05E4\u05D9 \u05D3\u05E8\u05D2\u05EA\u05DA \u05D1\u05DE\u05E2\u05E8\u05DB\u05EA \u05D6\u05D5 \u05D0\u05D9\u05E0\u05DA \u05DE\u05D5\u05E8\u05E9\u05D4 \u05DC\u05D2\u05DC\u05D5\u05E9 \u05D1\u05DE\u05E1\u05DA \u05D6\u05D4"),n.navigate(["customer"]),!1):(n.navigate(["auth/login"]),!1)},wD=(t,e)=>{let r=wt(Ke),n=wt(ct);return r.isLoggedIn()?(console.log("here"),r.isAdmin()?(alert("!\u05E2\u05DC \u05E4\u05D9 \u05D3\u05E8\u05D2\u05EA\u05DA \u05D1\u05DE\u05E2\u05E8\u05DB\u05EA \u05D6\u05D5 \u05D0\u05D9\u05E0\u05DA \u05DE\u05D5\u05E8\u05E9\u05D4 \u05DC\u05D2\u05DC\u05D5\u05E9 \u05D1\u05DE\u05E1\u05DA \u05D6\u05D4"),n.navigate(["admin"]),!1):!0):(n.navigate(["auth/login"]),!1)};export{Th as a,h1 as b,xh as c,en as d,tn as e,Dh as f,W1 as g,Un as h,aa as i,Hi as j,Hn as k,Ch as l,ha as m,Bt as n,Sh as o,Db as p,Ob as q,Tx as r,Ax as s,pt as t,Cr as u,yo as v,eD as w,Me as x,et as y,tt as z,So as A,ni as B,Lo as C,rm as D,nm as E,ai as F,Xi as G,Ux as H,Yx as I,uD as J,gD as K,wD as L,c1 as M,tb as N};
