import './polyfills.server.mjs';
import{A as T,C as K,Ca as G,F as A,H as N,N as L,Qa as Q,Ta as $,Z as j,_ as R,aa as V,ba as q,ca as z,i as y,j as H,m as S,n as p,o as I,p as k,u as F,x as B,y as O}from"./chunk-VVYNGIND.mjs";import{r as x,u as M,w as h}from"./chunk-LLLXJOQE.mjs";import{Bb as n,Cb as r,Db as w,Kb as D,Mb as E,Vb as u,Wb as C,Xc as b,Ya as s,Z as _,Za as c,bd as J,ga as v,ha as P,qb as f,sb as l}from"./chunk-MPTJKU3H.mjs";function lt(e,o){e&1&&(n(0,"div"),u(1,"Email is required."),r())}function mt(e,o){e&1&&(n(0,"div"),u(1,"\u05D0\u05D9\u05DE\u05D9\u05D9\u05DC \u05DC\u05D0 \u05EA\u05E7\u05D9\u05DF."),r())}function dt(e,o){if(e&1&&(n(0,"mat-error"),f(1,lt,2,0,"div",8)(2,mt,2,0,"div",8),r()),e&2){let i=E();s(),l("ngIf",i.email==null||i.email.errors==null?null:i.email.errors.required),s(),l("ngIf",i.email==null||i.email.errors==null?null:i.email.errors.email)}}function ct(e,o){e&1&&(n(0,"div"),u(1,"\u05E9\u05D3\u05D4 \u05D7\u05D5\u05D1\u05D4"),r())}function pt(e,o){e&1&&(n(0,"div"),u(1,"\u05D4\u05E1\u05D9\u05E1\u05DE\u05D0 \u05D7\u05D9\u05D9\u05D1\u05EA \u05DC\u05D4\u05DB\u05D9\u05DC \u05DC\u05E4\u05D7\u05D5\u05EA 6 \u05EA\u05D5\u05D5\u05D9\u05DD"),r())}function ft(e,o){e&1&&(n(0,"div"),u(1,"\u05D4\u05E1\u05D9\u05E1\u05DE\u05D0 \u05DC\u05D0 \u05D9\u05DB\u05D5\u05DC\u05D4 \u05DC\u05D4\u05DB\u05D9\u05DC \u05E8\u05D5\u05D5\u05D7\u05D9\u05DD"),r())}function gt(e,o){if(e&1&&(n(0,"mat-error"),f(1,ct,2,0,"div",8)(2,pt,2,0,"div",8)(3,ft,2,0,"div",8),r()),e&2){let i=E();s(),l("ngIf",i.password==null||i.password.errors==null?null:i.password.errors.required),s(),l("ngIf",i.password==null||i.password.errors==null?null:i.password.errors.minlength),s(),l("ngIf",i.password==null||i.password.errors==null?null:i.password.errors.pattern)}}var Z=(()=>{let o=class o{constructor(m,a,t,d,g){this.route=m,this.loginService=a,this.fb=t,this.snackBar=d,this.router=g,this.color="rgba(255, 255, 255, 0.553)",this.hidePassword=!0,this.loginForm=this.fb.group({email:["",[p.required,p.email]],password:["",[p.required,p.minLength(6),p.pattern(/^\S*$/)]]})}get email(){return this.loginForm.get("email")}get password(){return this.loginForm.get("password")}submit(){if(this.loginForm.valid){let{email:m,password:a}=this.loginForm.value;this.loginService.login(m,a).subscribe(t=>{let d=JSON.parse(t);sessionStorage.setItem("token",d.token),this.userByToken=this.loginService.decodeToken(this.loginService.GetToken()),console.log("what the user and role",this.userByToken,this.userByToken.role),String(this.userByToken.role)=="Admin"?(console.log("admin"),this.router.navigate(["/admin"]),console.log("after navigate")):String(this.userByToken.role)=="Customer"&&(console.log("customer"),console.log(" herere="+this.loginService.CurrentcustomerId),this.loginService.CurrentcustomerId=this.userByToken.customerId,this.router.navigate(["/customer"]))},t=>{console.log("Login failed",t),this.snackBar.open("\u05D4\u05DE\u05E9\u05EA\u05DE\u05E9 \u05DC\u05D0 \u05E7\u05D9\u05D9\u05DD \u05D1\u05DE\u05E2\u05E8\u05DB\u05EA","Close",{duration:8e3,panelClass:["error-snackbar"]})})}}togglePasswordVisibility(){this.hidePassword=!this.hidePassword}forgotPassword(){if(!this.loginForm.value.email)this.snackBar.open("\u05D1\u05D1\u05E7\u05E9\u05D4 \u05EA\u05DB\u05E0\u05D9\u05E1 \u05DB\u05EA\u05D5\u05D1\u05EA \u05DE\u05D9\u05D9\u05DC \u05E9\u05DC\u05DA \u05D4\u05E9\u05DE\u05D5\u05E8\u05D4 \u05D1\u05DE\u05E2\u05E8\u05DB\u05EA","Close",{duration:7e3});else{let m=this.loginForm.get("email").value;this.loginService.resetPassword(m).subscribe(a=>{this.snackBar.open("\u05E0\u05E9\u05DC\u05D7 \u05D0\u05D9\u05DE\u05D9\u05D9\u05DC \u05DC\u05D0\u05D9\u05E4\u05D5\u05E1 \u05D4\u05E1\u05D9\u05E1\u05DE\u05D4 \u05E9\u05DC\u05DA","Close",{duration:7e3})},a=>{this.snackBar.open("\u05D4\u05DE\u05E9\u05EA\u05DE\u05E9 \u05DC\u05D0 \u05E7\u05D9\u05D9\u05DD \u05D1\u05DE\u05E2\u05E8\u05DB\u05EA. \u05D1\u05D1\u05E7\u05E9\u05D4 \u05E0\u05E1\u05D4 \u05E9\u05D5\u05D1.","Close",{duration:7e3}),console.log(a),console.log(a.error.errors)})}}};o.\u0275fac=function(a){return new(a||o)(c(x),c($),c(T),c(G),c(M))},o.\u0275cmp=v({type:o,selectors:[["app-login"]],decls:29,vars:6,consts:[[1,"login-container"],[1,"login-card"],[1,"card-title"],[3,"ngSubmit","formGroup"],[1,"form-group"],["appearance","outline","dir","rtl",1,"full-width"],[1,"material-icons"],["matInput","","type","email","formControlName","email","placeholder","you@example.com"],[4,"ngIf"],["matInput","","formControlName","password","placeholder","Password",3,"type"],["mat-icon-button","","matSuffix","","type","button",3,"click"],["mat-button","","mat-raised-button","","color","primary","type","submit",1,"submit-btn",3,"disabled"],[1,"forgot-password"],["dir","rtl",1,"text-muted",3,"click"]],template:function(a,t){a&1&&(n(0,"div",0)(1,"div",1)(2,"h3",2),u(3," \u05D4\u05D9\u05E8\u05E9\u05DD \u05DC\u05DB\u05E0\u05D9\u05E1\u05D4 "),r(),n(4,"form",3),D("ngSubmit",function(){return t.submit()}),n(5,"div",4)(6,"mat-form-field",5)(7,"mat-label")(8,"i",6),u(9,"email"),r(),u(10," \u05DB\u05EA\u05D5\u05D1\u05EA \u05D0\u05DE\u05D9\u05D9\u05DC"),r(),w(11,"input",7),f(12,dt,3,2,"mat-error",8),r()(),n(13,"div",4)(14,"mat-form-field",5)(15,"mat-label")(16,"i",6),u(17,"lock"),r(),u(18," \u05E1\u05D9\u05E1\u05DE\u05D4"),r(),w(19,"input",9),n(20,"button",10),D("click",function(){return t.togglePasswordVisibility()}),n(21,"mat-icon"),u(22),r()(),f(23,gt,4,3,"mat-error",8),r()(),n(24,"button",11),u(25,"\u05D4\u05EA\u05D7\u05D1\u05E8\u05D5\u05EA"),r()(),n(26,"div",12)(27,"a",13),D("click",function(){return t.forgotPassword()}),u(28,"\u05E9\u05DB\u05D7\u05EA \u05E1\u05D9\u05E1\u05DE\u05D0?"),r()()()()),a&2&&(s(4),l("formGroup",t.loginForm),s(8),l("ngIf",(t.email==null?null:t.email.invalid)&&((t.email==null?null:t.email.dirty)||(t.email==null?null:t.email.touched))),s(7),l("type",t.hidePassword?"password":"text"),s(3),C(t.hidePassword?"visibility_off":"visibility"),s(),l("ngIf",(t.password==null?null:t.password.invalid)&&((t.password==null?null:t.password.dirty)||(t.password==null?null:t.password.touched))),s(),l("disabled",t.loginForm.invalid))},dependencies:[b,y,L,q,j,R,V,z,A,N,F,S,I,k,B,O],styles:[".login-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:100vh;background-color:#f5f5f5}.login-card[_ngcontent-%COMP%]{text-align:right;background-color:#fff;border-radius:20px;padding:20px;box-shadow:0 8px 40px #0000001a;width:100%;max-width:400px}.card-title[_ngcontent-%COMP%]{text-align:center;font-size:1.5rem;margin-bottom:20px;color:#333}.form-group[_ngcontent-%COMP%]{margin-bottom:20px}.full-width[_ngcontent-%COMP%], .mat-form-field[_ngcontent-%COMP%]{width:100%}.mat-form-field-appearance-fill[_ngcontent-%COMP%]   .mat-form-field-flex[_ngcontent-%COMP%]{background-color:#f5f5f5;border-radius:5px}.mat-form-field.mat-focused[_ngcontent-%COMP%]   .mat-form-field-label[_ngcontent-%COMP%]{color:#4285f4}.mat-icon-button[_ngcontent-%COMP%]{cursor:pointer}.submit-btn[_ngcontent-%COMP%]{width:100%;padding:10px;font-size:1.1rem}.text-danger[_ngcontent-%COMP%]{font-size:.875em;color:red}.forgot-password[_ngcontent-%COMP%]{text-align:center;margin-top:15px}.text-muted[_ngcontent-%COMP%]{color:#6c757d;text-decoration:underline}.text-muted[_ngcontent-%COMP%]:hover{cursor:pointer;color:#000086}[_nghost-%COMP%]{background-color:transparent}"]});let e=o;return e})();function Dt(e,o){e&1&&(n(0,"div"),u(1,"\u05E0\u05D3\u05E8\u05E9\u05EA \u05E1\u05D9\u05E1\u05DE\u05D0 \u05D7\u05D3\u05E9\u05D4"),r())}function wt(e,o){e&1&&(n(0,"div"),u(1,"\u05D4\u05E1\u05D9\u05E1\u05DE\u05D4 \u05D7\u05D9\u05D9\u05D1\u05EA \u05DC\u05D4\u05D9\u05D5\u05EA \u05DC\u05E4\u05D7\u05D5\u05EA 6 \u05EA\u05D5\u05D5\u05D9\u05DD."),r())}function Et(e,o){e&1&&(n(0,"div"),u(1,"\u05D4\u05E1\u05D9\u05E1\u05DE\u05D4 \u05D7\u05D9\u05D9\u05D1\u05EA \u05DC\u05D4\u05DB\u05D9\u05DC \u05D0\u05D5\u05EA \u05D2\u05D3\u05D5\u05DC\u05D4, \u05D0\u05D5\u05EA \u05E7\u05D8\u05E0\u05D4, \u05DE\u05E1\u05E4\u05E8 \u05D5\u05EA\u05D5 \u05DE\u05D9\u05D5\u05D7\u05D3."),r())}function ht(e,o){if(e&1&&(n(0,"mat-error"),f(1,Dt,2,0,"div",9)(2,wt,2,0,"div",9)(3,Et,2,0,"div",9),r()),e&2){let i=E();s(),l("ngIf",i.newPassword==null||i.newPassword.errors==null?null:i.newPassword.errors.required),s(),l("ngIf",i.newPassword==null||i.newPassword.errors==null?null:i.newPassword.errors.minlength),s(),l("ngIf",i.newPassword==null||i.newPassword.errors==null?null:i.newPassword.errors.pattern)}}function _t(e,o){e&1&&(n(0,"div"),u(1,"\u05D0\u05D9\u05E9\u05D5\u05E8 \u05E1\u05D9\u05E1\u05DE\u05D4 \u05E0\u05D3\u05E8\u05E9."),r())}function vt(e,o){e&1&&(n(0,"div"),u(1,"\u05D4\u05E1\u05D9\u05E1\u05DE\u05D0\u05D5\u05EA \u05D0\u05D9\u05E0\u05DF \u05EA\u05D5\u05D0\u05DE\u05D5\u05EA."),r())}function Pt(e,o){if(e&1&&(n(0,"mat-error"),f(1,_t,2,0,"div",9)(2,vt,2,0,"div",9),r()),e&2){let i=E();s(),l("ngIf",i.confirmPassword==null||i.confirmPassword.errors==null?null:i.confirmPassword.errors.required),s(),l("ngIf",i.confirmPassword==null||i.confirmPassword.errors==null?null:i.confirmPassword.errors.mustMatch)}}var W=(()=>{let o=class o{constructor(m,a,t,d,g){this.fb=m,this.loginService=a,this.snackBar=t,this.route=d,this.router=g,this.user={},this.hidePassword=!0,this.forgotPasswordForm=this.fb.group({newPassword:["",[p.required,p.minLength(6),p.pattern(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&+-/'.,><_=^#])[A-Za-z\d@$!%*?&]{6,}$/)]],confirmPassword:["",p.required]},{validator:this.mustMatch("newPassword","confirmPassword")})}ngOnInit(){let m=this.route.snapshot.paramMap.get("id");m?(this.id=+m,console.log("Userid",this.id)):console.log("cant take id from url")}get newPassword(){return this.forgotPasswordForm.get("newPassword")}get confirmPassword(){return this.forgotPasswordForm.get("confirmPassword")}mustMatch(m,a){return t=>{let d=t.controls[m],g=t.controls[a];g.errors&&!g.errors.mustMatch||(d.value!==g.value?g.setErrors({mustMatch:!0}):g.setErrors(null))}}togglePasswordVisibility(){this.hidePassword=!this.hidePassword}submit(){if(this.forgotPasswordForm.valid){let m=this.forgotPasswordForm.get("newPassword").value;this.loginService.updatePassword(m,this.id).subscribe(a=>{this.snackBar.open("\u05D4\u05E1\u05D9\u05E1\u05DE\u05D4 \u05E2\u05D5\u05D3\u05DB\u05E0\u05D4 \u05D1\u05D4\u05E6\u05DC\u05D7\u05D4","Close",{duration:5e3}),this.router.navigate(["auth/login"])},a=>{this.snackBar.open("Failed to update password. Please try again.","Close",{duration:5e3}),console.log(a),console.log(a.error.errors)})}}};o.\u0275fac=function(a){return new(a||o)(c(T),c($),c(G),c(x),c(M))},o.\u0275cmp=v({type:o,selectors:[["forgot-password"]],decls:28,vars:6,consts:[[1,"forgot-password-container"],[1,"forgot-password-card","login-card"],[1,"card-title"],[1,"material-icons",2,"font-size","30px"],[3,"ngSubmit","formGroup"],[1,"form-group"],["appearance","outline","dir","rtl",1,"full-width"],[1,"material-icons"],["matInput","","type","password","formControlName","newPassword","placeholder","\u05E1\u05D9\u05E1\u05DE\u05D4 \u05D7\u05D3\u05E9\u05D4"],[4,"ngIf"],["matInput","","formControlName","confirmPassword","placeholder","\u05D0\u05E9\u05E8 \u05E1\u05D9\u05E1\u05DE\u05D4",3,"type"],["mat-icon-button","","matSuffix","","type","button",3,"click"],["mat-button","","mat-raised-button","","color","primary","type","submit",1,"submit-btn",3,"disabled"]],template:function(a,t){a&1&&(n(0,"div",0)(1,"div",1)(2,"h3",2)(3,"i",3),u(4,"lock_open"),r(),u(5," \u05E9\u05DB\u05D7\u05EA\u05D9 \u05E1\u05D9\u05E1\u05DE\u05D4 "),r(),n(6,"form",4),D("ngSubmit",function(){return t.submit()}),n(7,"div",5)(8,"mat-form-field",6)(9,"mat-label")(10,"i",7),u(11,"lock"),r(),u(12," \u05E1\u05D9\u05E1\u05DE\u05D4 \u05D7\u05D3\u05E9\u05D4"),r(),w(13,"input",8),f(14,ht,4,3,"mat-error",9),r()(),n(15,"div",5)(16,"mat-form-field",6)(17,"mat-label")(18,"i",7),u(19,"lock"),r(),u(20," \u05D0\u05E9\u05E8 \u05E1\u05D9\u05E1\u05DE\u05D4"),r(),w(21,"input",10),n(22,"button",11),D("click",function(){return t.togglePasswordVisibility()}),n(23,"mat-icon"),u(24),r()(),f(25,Pt,3,2,"mat-error",9),r()(),n(26,"button",12),u(27,"\u05E9\u05DE\u05D5\u05E8 \u05E1\u05D9\u05E1\u05DE\u05D4"),r()()()()),a&2&&(s(6),l("formGroup",t.forgotPasswordForm),s(8),l("ngIf",(t.newPassword==null?null:t.newPassword.invalid)&&((t.newPassword==null?null:t.newPassword.dirty)||(t.newPassword==null?null:t.newPassword.touched))),s(7),l("type",t.hidePassword?"password":"text"),s(3),C(t.hidePassword?"visibility_off":"visibility"),s(),l("ngIf",(t.confirmPassword==null?null:t.confirmPassword.invalid)&&((t.confirmPassword==null?null:t.confirmPassword.dirty)||(t.confirmPassword==null?null:t.confirmPassword.touched))),s(),l("disabled",t.forgotPasswordForm.invalid))},dependencies:[b,y,L,q,j,R,V,z,A,N,F,S,I,k,B,O],styles:[".forgot-password-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:100vh;background-color:#f5f5f5}.forgot-password-card[_ngcontent-%COMP%]{text-align:right;background-color:#fff;border-radius:20px;padding:20px;box-shadow:0 8px 40px #0000001a;width:100%;max-width:400px}.card-title[_ngcontent-%COMP%]{text-align:center;font-size:1.5rem;margin-bottom:20px;color:#333}.form-group[_ngcontent-%COMP%]{margin-bottom:20px}.full-width[_ngcontent-%COMP%], .mat-form-field[_ngcontent-%COMP%]{width:100%}.mat-form-field-appearance-fill[_ngcontent-%COMP%]   .mat-form-field-flex[_ngcontent-%COMP%]{background-color:#f5f5f5;border-radius:5px}.mat-form-field.mat-focused[_ngcontent-%COMP%]   .mat-form-field-label[_ngcontent-%COMP%]{color:#4285f4}.mat-icon-button[_ngcontent-%COMP%]{cursor:pointer}.submit-btn[_ngcontent-%COMP%]{width:100%;padding:10px;font-size:1.1rem;background-color:#3f51b5;color:#fff;border-radius:5px}.text-danger[_ngcontent-%COMP%]{color:red;font-size:12px;margin-top:5px}"]});let e=o;return e})();var Ct=[{path:"",component:Z},{path:"login",component:Z},{path:"forgot-password/:id",component:W}],X=(()=>{let o=class o{};o.\u0275fac=function(a){return new(a||o)},o.\u0275mod=P({type:o}),o.\u0275inj=_({imports:[h.forChild(Ct),h]});let e=o;return e})();var Kt=(()=>{let o=class o{};o.\u0275fac=function(a){return new(a||o)},o.\u0275mod=P({type:o}),o.\u0275inj=_({imports:[J,Q,K,h,H,X]});let e=o;return e})();export{Kt as a};
