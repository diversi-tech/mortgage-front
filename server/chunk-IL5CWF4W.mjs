import './polyfills.server.mjs';
import{$ as H,A as B,Aa as T,C as G,F as V,H as $,M as U,Oa as W,Ra as A,Y as Z,Z as J,aa as K,ba as Q,i as q,j as z,m as S,n as p,o as M,p as y,u as k,x as F,y as I}from"./chunk-NW2DFKJ6.mjs";import{r as b,u as x,w as h}from"./chunk-MR55LIO3.mjs";import{Bb as u,Cb as i,Db as w,Kb as E,Mb as v,Vb as a,Wb as j,Xc as L,Ya as s,Za as m,_ as C,bd as R,ha as _,ia as P,qb as f,sb as d,xb as D}from"./chunk-YZM5RFRX.mjs";function re(e,o){e&1&&(u(0,"div"),a(1,"Email is required."),i())}function ne(e,o){e&1&&(u(0,"div"),a(1,"\u05D0\u05D9\u05DE\u05D9\u05D9\u05DC \u05DC\u05D0 \u05EA\u05E7\u05D9\u05DF."),i())}function ue(e,o){if(e&1&&(u(0,"mat-error"),f(1,re,2,0,"div",8)(2,ne,2,0,"div",8),i()),e&2){let r=v();s(),d("ngIf",r.email==null||r.email.errors==null?null:r.email.errors.required),s(),d("ngIf",r.email==null||r.email.errors==null?null:r.email.errors.email)}}function ae(e,o){e&1&&(u(0,"div"),a(1,"\u05E9\u05D3\u05D4 \u05D7\u05D5\u05D1\u05D4"),i())}function se(e,o){e&1&&(u(0,"div"),a(1,"\u05D4\u05E1\u05D9\u05E1\u05DE\u05D0 \u05D7\u05D9\u05D9\u05D1\u05EA \u05DC\u05D4\u05DB\u05D9\u05DC \u05DC\u05E4\u05D7\u05D5\u05EA 6 \u05EA\u05D5\u05D5\u05D9\u05DD"),i())}function le(e,o){e&1&&(u(0,"div"),a(1,"\u05D4\u05E1\u05D9\u05E1\u05DE\u05D0 \u05DC\u05D0 \u05D9\u05DB\u05D5\u05DC\u05D4 \u05DC\u05D4\u05DB\u05D9\u05DC \u05E8\u05D5\u05D5\u05D7\u05D9\u05DD"),i())}function de(e,o){if(e&1&&(u(0,"mat-error"),f(1,ae,2,0,"div",8)(2,se,2,0,"div",8)(3,le,2,0,"div",8),i()),e&2){let r=v();s(),d("ngIf",r.password==null||r.password.errors==null?null:r.password.errors.required),s(),d("ngIf",r.password==null||r.password.errors==null?null:r.password.errors.minlength),s(),d("ngIf",r.password==null||r.password.errors==null?null:r.password.errors.pattern)}}var N=(()=>{let o=class o{constructor(l,n,t,c,g){this.route=l,this.loginService=n,this.fb=t,this.snackBar=c,this.router=g,this.color="rgba(255, 255, 255, 0.553)",this.hidePassword=!0,this.loginForm=this.fb.group({email:["",[p.required,p.email]],password:["",[p.required,p.minLength(6),p.pattern(/^\S*$/)]]})}get email(){return this.loginForm.get("email")}get password(){return this.loginForm.get("password")}submit(){if(this.loginForm.valid){let{email:l,password:n}=this.loginForm.value;this.loginService.login(l,n).subscribe(t=>{let c=JSON.parse(t);sessionStorage.setItem("token",c.token),this.userByToken=this.loginService.decodeToken(this.loginService.GetToken()),console.log("what the user and role",this.userByToken,this.userByToken.role),String(this.userByToken.role)=="Admin"?(console.log("admin"),this.router.navigate(["/admin"]),console.log("after navigate")):String(this.userByToken.role)=="Customer"&&(console.log("customer"),console.log(" herere="+this.loginService.CurrentcustomerId),this.loginService.CurrentcustomerId=this.userByToken.customerId,this.router.navigate(["/customer"]))},t=>{console.log("Login failed",t),this.snackBar.open("\u05D4\u05DE\u05E9\u05EA\u05DE\u05E9 \u05DC\u05D0 \u05E7\u05D9\u05D9\u05DD \u05D1\u05DE\u05E2\u05E8\u05DB\u05EA","Close",{duration:8e3,panelClass:["error-snackbar"]})})}}togglePasswordVisibility(){this.hidePassword=!this.hidePassword}forgotPassword(){if(!this.loginForm.value.email)this.snackBar.open("\u05D1\u05D1\u05E7\u05E9\u05D4 \u05EA\u05DB\u05E0\u05D9\u05E1 \u05DB\u05EA\u05D5\u05D1\u05EA \u05DE\u05D9\u05D9\u05DC \u05E9\u05DC\u05DA \u05D4\u05E9\u05DE\u05D5\u05E8\u05D4 \u05D1\u05DE\u05E2\u05E8\u05DB\u05EA","Close",{duration:7e3});else{let l=this.loginForm.get("email").value;this.loginService.resetPassword(l).subscribe(n=>{this.snackBar.open("\u05E0\u05E9\u05DC\u05D7 \u05D0\u05D9\u05DE\u05D9\u05D9\u05DC \u05DC\u05D0\u05D9\u05E4\u05D5\u05E1 \u05D4\u05E1\u05D9\u05E1\u05DE\u05D4 \u05E9\u05DC\u05DA","Close",{duration:7e3})},n=>{this.snackBar.open("\u05D4\u05DE\u05E9\u05EA\u05DE\u05E9 \u05DC\u05D0 \u05E7\u05D9\u05D9\u05DD \u05D1\u05DE\u05E2\u05E8\u05DB\u05EA. \u05D1\u05D1\u05E7\u05E9\u05D4 \u05E0\u05E1\u05D4 \u05E9\u05D5\u05D1.","Close",{duration:7e3}),console.log(n),console.log(n.error.errors)})}}};o.\u0275fac=function(n){return new(n||o)(m(b),m(A),m(B),m(T),m(x))},o.\u0275cmp=_({type:o,selectors:[["app-login"]],decls:29,vars:6,consts:[[1,"login-container"],[1,"login-card"],[1,"card-title"],[3,"ngSubmit","formGroup"],[1,"form-group"],["appearance","outline","dir","rtl",1,"full-width"],[1,"material-icons"],["matInput","","type","email","formControlName","email","placeholder","you@example.com"],[4,"ngIf"],["matInput","","formControlName","password","placeholder","Password",3,"type"],["mat-icon-button","","matSuffix","","type","button",3,"click"],["mat-button","","mat-raised-button","","color","primary","type","submit",1,"submit-btn",3,"disabled"],[1,"forgot-password"],["dir","rtl",1,"text-muted",3,"click"]],template:function(n,t){n&1&&(u(0,"div",0)(1,"div",1)(2,"h3",2),a(3," \u05D4\u05D9\u05E8\u05E9\u05DD \u05DC\u05DB\u05E0\u05D9\u05E1\u05D4 "),i(),u(4,"form",3),E("ngSubmit",function(){return t.submit()}),u(5,"div",4)(6,"mat-form-field",5)(7,"mat-label")(8,"i",6),a(9,"email"),i(),a(10," \u05DB\u05EA\u05D5\u05D1\u05EA \u05D0\u05DE\u05D9\u05D9\u05DC"),i(),w(11,"input",7),f(12,ue,3,2,"mat-error",8),i()(),u(13,"div",4)(14,"mat-form-field",5)(15,"mat-label")(16,"i",6),a(17,"lock"),i(),a(18," \u05E1\u05D9\u05E1\u05DE\u05D4"),i(),w(19,"input",9),u(20,"button",10),E("click",function(){return t.togglePasswordVisibility()}),u(21,"mat-icon"),a(22),i()(),f(23,de,4,3,"mat-error",8),i()(),u(24,"button",11),a(25,"\u05D4\u05EA\u05D7\u05D1\u05E8\u05D5\u05EA"),i()(),u(26,"div",12)(27,"a",13),E("click",function(){return t.forgotPassword()}),a(28,"\u05E9\u05DB\u05D7\u05EA \u05E1\u05D9\u05E1\u05DE\u05D0?"),i()()()()),n&2&&(s(4),d("formGroup",t.loginForm),s(8),d("ngIf",(t.email==null?null:t.email.invalid)&&((t.email==null?null:t.email.dirty)||(t.email==null?null:t.email.touched))),s(7),d("type",t.hidePassword?"password":"text"),s(3),j(t.hidePassword?"visibility_off":"visibility"),s(),d("ngIf",(t.password==null?null:t.password.invalid)&&((t.password==null?null:t.password.dirty)||(t.password==null?null:t.password.touched))),s(),d("disabled",t.loginForm.invalid))},dependencies:[L,q,U,K,Z,J,H,Q,V,$,k,S,M,y,F,I],styles:[".login-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:100vh;background-color:#f5f5f5}.login-card[_ngcontent-%COMP%]{text-align:right;background-color:#fff;border-radius:20px;padding:20px;box-shadow:0 8px 40px #0000001a;width:100%;max-width:400px}.card-title[_ngcontent-%COMP%]{text-align:center;font-size:1.5rem;margin-bottom:20px;color:#333}.form-group[_ngcontent-%COMP%]{margin-bottom:20px}.full-width[_ngcontent-%COMP%], .mat-form-field[_ngcontent-%COMP%]{width:100%}.mat-form-field-appearance-fill[_ngcontent-%COMP%]   .mat-form-field-flex[_ngcontent-%COMP%]{background-color:#f5f5f5;border-radius:5px}.mat-form-field.mat-focused[_ngcontent-%COMP%]   .mat-form-field-label[_ngcontent-%COMP%]{color:#4285f4}.mat-icon-button[_ngcontent-%COMP%]{cursor:pointer}.submit-btn[_ngcontent-%COMP%]{width:100%;padding:10px;font-size:1.1rem}.text-danger[_ngcontent-%COMP%]{font-size:.875em;color:red}.forgot-password[_ngcontent-%COMP%]{text-align:center;margin-top:15px}.text-muted[_ngcontent-%COMP%]{color:#6c757d;text-decoration:underline}.text-muted[_ngcontent-%COMP%]:hover{cursor:pointer;color:#000086}[_nghost-%COMP%]{background-color:transparent}"]});let e=o;return e})();function me(e,o){e&1&&(u(0,"div"),a(1," \u05E0\u05D3\u05E8\u05E9\u05EA \u05E1\u05D9\u05E1\u05DE\u05D0 \u05D7\u05D3\u05E9\u05D4"),i())}function ce(e,o){e&1&&(u(0,"div"),a(1,"\u05D4\u05E1\u05D9\u05E1\u05DE\u05D4 \u05D7\u05D9\u05D9\u05D1\u05EA \u05DC\u05D4\u05D9\u05D5\u05EA \u05DC\u05E4\u05D7\u05D5\u05EA 6 \u05EA\u05D5\u05D5\u05D9\u05DD."),i())}function pe(e,o){e&1&&(u(0,"div"),a(1,"\u05D4\u05E1\u05D9\u05E1\u05DE\u05D4 \u05D7\u05D9\u05D9\u05D1\u05EA \u05DC\u05D4\u05DB\u05D9\u05DC \u05D0\u05D5\u05EA \u05D2\u05D3\u05D5\u05DC\u05D4, \u05D0\u05D5\u05EA \u05E7\u05D8\u05E0\u05D4, \u05DE\u05E1\u05E4\u05E8 \u05D5\u05EA\u05D5 \u05DE\u05D9\u05D5\u05D7\u05D3."),i())}function fe(e,o){if(e&1&&(u(0,"div",9),f(1,me,2,0,"div")(2,ce,2,0,"div")(3,pe,2,0,"div"),i()),e&2){let r=v();s(),D(!(r.newPassword==null||r.newPassword.errors==null)&&r.newPassword.errors.required?1:-1),s(),D(!(r.newPassword==null||r.newPassword.errors==null)&&r.newPassword.errors.minlength?2:-1),s(),D(!(r.newPassword==null||r.newPassword.errors==null)&&r.newPassword.errors.pattern?3:-1)}}function ge(e,o){e&1&&(u(0,"div"),a(1,"\u05D0\u05D9\u05E9\u05D5\u05E8 \u05E1\u05D9\u05E1\u05DE\u05D4 \u05E0\u05D3\u05E8\u05E9."),i())}function De(e,o){e&1&&(u(0,"div"),a(1,"\u05D4\u05E1\u05D9\u05E1\u05DE\u05D0\u05D5\u05EA \u05D0\u05D9\u05E0\u05DF \u05EA\u05D5\u05D0\u05DE\u05D5\u05EA."),i())}function we(e,o){if(e&1&&(u(0,"div",9),f(1,ge,2,0,"div")(2,De,2,0,"div"),i()),e&2){let r=v();s(),D(!(r.confirmPassword==null||r.confirmPassword.errors==null)&&r.confirmPassword.errors.required?1:-1),s(),D(!(r.confirmPassword==null||r.confirmPassword.errors==null)&&r.confirmPassword.errors.mustMatch?2:-1)}}var X=(()=>{let o=class o{constructor(l,n,t,c,g){this.fb=l,this.loginService=n,this.snackBar=t,this.route=c,this.router=g,this.user={},this.forgotPasswordForm=this.fb.group({newPassword:["",[p.required,p.minLength(6),p.pattern(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&+-/'.,><_=^#])[A-Za-z\d@$!%*?&]{6,}$/)]],confirmPassword:["",p.required]},{validator:this.mustMatch("newPassword","confirmPassword")})}ngOnInit(){let l=this.route.snapshot.paramMap.get("id");l?(this.id=+l,console.log("Userid",this.id)):console.log("cant take id from url")}get newPassword(){return this.forgotPasswordForm.get("newPassword")}get confirmPassword(){return this.forgotPasswordForm.get("confirmPassword")}mustMatch(l,n){return t=>{let c=t.controls[l],g=t.controls[n];g.errors&&!g.errors.mustMatch||(c.value!==g.value?g.setErrors({mustMatch:!0}):g.setErrors(null))}}submit(){if(this.forgotPasswordForm.valid){let l=this.forgotPasswordForm.get("newPassword").value;this.loginService.updatePassword(l,this.id).subscribe(n=>{console.log("response from put",n),this.snackBar.open("\u05D4\u05E1\u05D9\u05E1\u05DE\u05D4 \u05E2\u05D5\u05D3\u05DB\u05E0\u05D4 \u05D1\u05D4\u05E6\u05DC\u05D7\u05D4","Close",{duration:5e3}),this.router.navigate(["/login"])},n=>{this.snackBar.open("Failed to update password. Please try again.","Close",{duration:5e3}),console.log(n),console.log(n.error.errors)})}}};o.\u0275fac=function(n){return new(n||o)(m(B),m(A),m(T),m(b),m(x))},o.\u0275cmp=_({type:o,selectors:[["forgot-password"]],decls:25,vars:4,consts:[[1,"forgot-password-container"],[1,"forgot-password-card"],[1,"card-title",2,"font-size","40px"],[1,"material-icons",2,"font-size","30px","float","none"],[3,"ngSubmit","formGroup"],[1,"form-group"],["for","newPassword"],[1,"material-icons"],["type","password","id","newPassword","formControlName","newPassword","placeholder","\u05E1\u05D9\u05E1\u05DE\u05D4 \u05D7\u05D3\u05E9\u05D4",1,"form-input"],[1,"text-danger"],["for","confirmPassword"],["type","password","id","confirmPassword","formControlName","confirmPassword","placeholder","\u05D0\u05E9\u05E8 \u05E1\u05D9\u05E1\u05DE\u05D4",1,"form-input"],["type","submit",1,"submit-btn",3,"disabled"]],template:function(n,t){n&1&&(u(0,"p"),a(1,"forgot-password works!"),i(),u(2,"div",0)(3,"div",1)(4,"h3",2)(5,"i",3),a(6,"lock_open"),i(),a(7," \u05E9\u05DB\u05D7\u05EA\u05D9 \u05E1\u05D9\u05E1\u05DE\u05D4 "),i(),u(8,"form",4),E("ngSubmit",function(){return t.submit()}),u(9,"div",5)(10,"label",6)(11,"i",7),a(12,"lock"),i(),a(13," \u05E1\u05D9\u05E1\u05DE\u05D4 \u05D7\u05D3\u05E9\u05D4"),i(),w(14,"input",8),f(15,fe,4,3,"div",9),i(),u(16,"div",5)(17,"label",10)(18,"i",7),a(19,"lock"),i(),a(20," \u05D0\u05E9\u05E8 \u05E1\u05D9\u05E1\u05DE\u05D4"),i(),w(21,"input",11),f(22,we,3,2,"div",9),i(),u(23,"button",12),a(24,"\u05E9\u05DE\u05D5\u05E8 \u05E1\u05D9\u05E1\u05DE\u05D4"),i()()()()),n&2&&(s(8),d("formGroup",t.forgotPasswordForm),s(7),D(t.newPassword!=null&&t.newPassword.invalid&&(t.newPassword!=null&&t.newPassword.dirty||t.newPassword!=null&&t.newPassword.touched)?15:-1),s(7),D(t.confirmPassword!=null&&t.confirmPassword.invalid&&(t.confirmPassword!=null&&t.confirmPassword.dirty||t.confirmPassword!=null&&t.confirmPassword.touched)?22:-1),s(),d("disabled",t.forgotPasswordForm.invalid))},dependencies:[k,S,M,y,F,I],styles:[".forgot-password-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100vh}.forgot-password-card[_ngcontent-%COMP%]{width:400px;padding:20px;border-radius:10px;box-shadow:0 0 15px #0003}.card-title[_ngcontent-%COMP%]{text-align:center;margin-bottom:20px}.form-group[_ngcontent-%COMP%]{margin-bottom:15px}.form-input[_ngcontent-%COMP%]{width:100%;padding:10px;border:1px solid #ccc;border-radius:5px}.submit-btn[_ngcontent-%COMP%]{width:100%;padding:10px;background-color:#3f51b5;color:#fff;border:none;border-radius:5px;cursor:pointer}.submit-btn[_ngcontent-%COMP%]:disabled{background-color:#ccc;cursor:not-allowed}.text-danger[_ngcontent-%COMP%]{color:red;font-size:12px;margin-top:5px}"]});let e=o;return e})();var Ee=[{path:"",component:N},{path:"login",component:N},{path:"forgot-password/:id",component:X}],Y=(()=>{let o=class o{};o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=P({type:o}),o.\u0275inj=C({imports:[h.forChild(Ee),h]});let e=o;return e})();var Qe=(()=>{let o=class o{};o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=P({type:o}),o.\u0275inj=C({imports:[R,W,G,h,z,Y]});let e=o;return e})();export{Qe as a};
