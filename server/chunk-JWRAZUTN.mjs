import './polyfills.server.mjs';
import{a as Re}from"./chunk-ZOCM3RTE.mjs";import{B as Be,E as $e,L as Pe,d as Me,e as je,z as q}from"./chunk-ICBAJPAU.mjs";import{A as ye,C as we,F as Ie,Pa as ke,Ra as U,Z as Fe,_ as xe,ba as Ge,ca as Ne,i as de,k as ce,la as Ve,m as _e,n as D,o as he,p as fe,q as Ee,ra as Le,s as R,sa as Oe,ta as Te,u as ge,ua as Ae,v as Se,va as qe,x as ve,y as Ce,z as be}from"./chunk-ZZWANYAU.mjs";import{q as A,t as De,v as P}from"./chunk-2R3VLJD7.mjs";import{Cb as i,Db as t,Eb as T,Ib as j,Lb as f,Nb as B,Sb as ue,Tb as ae,Ub as se,Wb as o,Xb as C,Xc as me,Yb as $,Yc as le,Za as l,_ as V,_a as g,cd as pe,ha as L,ia as O,p as oe,pa as _,qa as h,rb as c,tb as p}from"./chunk-RV6CGP3N.mjs";import{h as N}from"./chunk-NDYDZJSS.mjs";var b=function(e){return e[e.Single=0]="Single",e[e.Married=1]="Married",e[e.Divorced=2]="Divorced",e[e.Widowed=3]="Widowed",e}(b||{}),k=function(e){return e[e.Employed=0]="Employed",e[e.SelfEmployed=1]="SelfEmployed",e}(k||{}),v=function(e){return e[e.\u05DE\u05D7\u05D9\u05E8_\u05DC\u05DE\u05E9\u05EA\u05DB\u05DF=0]="\u05DE\u05D7\u05D9\u05E8_\u05DC\u05DE\u05E9\u05EA\u05DB\u05DF",e[e.New=1]="New",e[e.Old=2]="Old",e[e.Renovation=3]="Renovation",e[e.Other=4]="Other",e}(v||{}),M=function(e){return e[e.whatup=0]="whatup",e[e.email=1]="email",e}(M||{});function Ue(){return e=>{let n=e.value;return n?/^\d{9}$/.test(n)?Array.from(n,Number).reduce((u,a,r)=>{let m=a*(r%2+1);return u+(m>9?m-9:m)},0)%10!==0?{invalidIsraeliId:!0}:null:{invalidIsraeliId:!0}:null}}function ze(){return e=>{let n=new Date(e.value),E=new Date;return n>E?{invalidBirthDate:!0}:n.getFullYear()>E.getFullYear()?{invalidBirthDate:!0}:null}}var Ze=["stepper"];function He(e,n){e&1&&o(0,"\u05D4\u05D2\u05D3\u05E8\u05EA \u05E9\u05DD \u05DE\u05E9\u05EA\u05DE\u05E9 \u05D5\u05E1\u05D9\u05E1\u05DE\u05D0")}function Ke(e,n){e&1&&(i(0,"mat-error"),o(1,"\u05E9\u05D3\u05D4 \u05D7\u05D5\u05D1\u05D4"),t())}function Xe(e,n){e&1&&(i(0,"mat-error"),o(1,"\u05D0\u05D9\u05DE\u05D9\u05D9\u05DC \u05DC\u05D0 \u05EA\u05E7\u05D9\u05DF"),t())}function et(e,n){e&1&&(i(0,"mat-error"),o(1,"\u05E9\u05D3\u05D4 \u05D7\u05D5\u05D1\u05D4"),t())}function tt(e,n){if(e&1&&(i(0,"li",42),o(1),t()),e&2){let E=n.$implicit;l(),$(" ",E," ")}}function rt(e,n){if(e&1&&(i(0,"li",43),o(1),t()),e&2){let E=n.$implicit;l(),$(" ",E," ")}}function it(e,n){if(e&1&&(i(0,"div")(1,"p"),o(2,"\u05D3\u05E8\u05D9\u05E9\u05D5\u05EA \u05DC\u05E1\u05D9\u05E1\u05DE\u05D4 \u05D7\u05D6\u05E7\u05D4:"),t(),i(3,"ul"),c(4,tt,2,1,"li",40)(5,rt,2,1,"li",41),t()()),e&2){let E=B();l(4),p("ngForOf",E.passwordStrength.valid),l(),p("ngForOf",E.passwordStrength.invalid)}}function nt(e,n){e&1&&o(0,"\u05E2\u05D3\u05DB\u05D5\u05DF \u05E4\u05E8\u05D8\u05D9\u05DD \u05D0\u05D9\u05E9\u05D9\u05D9\u05DD")}function ot(e,n){e&1&&(i(0,"mat-error"),o(1,"\u05E9\u05D3\u05D4 \u05D6\u05D4 \u05D4\u05D5\u05D0 \u05E9\u05D3\u05D4 \u05D7\u05D5\u05D1\u05D4"),t())}function ut(e,n){e&1&&(i(0,"mat-error"),o(1," \u05D9\u05E9 \u05DC\u05DB\u05EA\u05D5\u05D1 \u05D1\u05E9\u05D3\u05D4 \u05D6\u05D4 \u05E8\u05E7 \u05D0\u05D5\u05EA\u05D9\u05D5\u05EA "),t())}function at(e,n){if(e&1&&(i(0,"mat-option",44),o(1),t()),e&2){let E=n.$implicit;p("value",E.value),l(),C(E.label)}}function st(e,n){if(e&1&&(i(0,"mat-option",44),o(1),t()),e&2){let E=n.$implicit;p("value",E.value),l(),C(E.label)}}function mt(e,n){e&1&&(i(0,"mat-error"),o(1,"\u05E9\u05D3\u05D4 \u05D6\u05D4 \u05D4\u05D5\u05D0 \u05E9\u05D3\u05D4 \u05D7\u05D5\u05D1\u05D4"),t())}function lt(e,n){e&1&&(i(0,"mat-error"),o(1,"\u05E9\u05D3\u05D4 \u05D6\u05D4 \u05D4\u05D5\u05D0 \u05E9\u05D3\u05D4 \u05D7\u05D5\u05D1\u05D4"),t())}function pt(e,n){if(e&1&&(i(0,"mat-option",44),o(1),t()),e&2){let E=n.$implicit;p("value",E.value),l(),C(E.label)}}function Dt(e,n){e&1&&(i(0,"mat-error"),o(1,"\u05E9\u05D3\u05D4 \u05D6\u05D4 \u05D4\u05D5\u05D0 \u05E9\u05D3\u05D4 \u05D7\u05D5\u05D1\u05D4"),t())}function dt(e,n){e&1&&(i(0,"mat-error"),o(1,"\u05E9\u05D3\u05D4 \u05D6\u05D4 \u05D4\u05D5\u05D0 \u05E9\u05D3\u05D4 \u05D7\u05D5\u05D1\u05D4"),t())}function ct(e,n){e&1&&(i(0,"mat-error"),o(1,"\u05E9\u05D3\u05D4 \u05D6\u05D4 \u05D4\u05D5\u05D0 \u05E9\u05D3\u05D4 \u05D7\u05D5\u05D1\u05D4"),t())}function _t(e,n){e&1&&(i(0,"mat-error"),o(1,"\u05E9\u05D3\u05D4 \u05D6\u05D4 \u05D4\u05D5\u05D0 \u05E9\u05D3\u05D4 \u05D7\u05D5\u05D1\u05D4"),t())}function ht(e,n){e&1&&(i(0,"mat-error"),o(1,"\u05E9\u05D3\u05D4 \u05D6\u05D4 \u05D4\u05D5\u05D0 \u05E9\u05D3\u05D4 \u05D7\u05D5\u05D1\u05D4 \u05D1\u05DE\u05D9\u05D3\u05D4 \u05D5\u05D0\u05D9\u05DF \u05E7\u05E6\u05D1\u05D0\u05D5\u05EA \u05E0\u05D0 \u05DC\u05D4\u05E7\u05D9\u05E9 0"),t())}function ft(e,n){e&1&&(i(0,"mat-error"),o(1,"\u05E9\u05D3\u05D4 \u05D6\u05D4 \u05D4\u05D5\u05D0 \u05E9\u05D3\u05D4 \u05D7\u05D5\u05D1\u05D4 \u05D1\u05DE\u05D9\u05D3\u05D4 \u05D5\u05D0\u05D9\u05DF \u05DE\u05D6\u05D5\u05E0\u05D5\u05EA \u05E0\u05D0 \u05DC\u05D4\u05E7\u05D9\u05E9 0"),t())}function Et(e,n){e&1&&(i(0,"mat-error"),o(1,"\u05E9\u05D3\u05D4 \u05D6\u05D4 \u05D4\u05D5\u05D0 \u05E9\u05D3\u05D4 \u05D7\u05D5\u05D1\u05D4 \u05D1\u05DE\u05D9\u05D3\u05D4 \u05D5\u05D0\u05D9\u05DF \u05E2\u05D5\u05D3 \u05DE\u05E7\u05D5\u05E8 \u05E0\u05D0 \u05DC\u05D4\u05E7\u05D9\u05E9 0"),t())}function gt(e,n){e&1&&(i(0,"mat-error"),o(1,"\u05E9\u05D3\u05D4 \u05D6\u05D4 \u05D4\u05D5\u05D0 \u05E9\u05D3\u05D4 \u05D7\u05D5\u05D1\u05D4 \u05D1\u05DE\u05D9\u05D3\u05D4 \u05D5\u05D0\u05D9\u05DF \u05E0\u05D0 \u05DC\u05D4\u05E7\u05D9\u05E9 0"),t())}function St(e,n){e&1&&(i(0,"mat-error"),o(1,"\u05E9\u05D3\u05D4 \u05D6\u05D4 \u05D4\u05D5\u05D0 \u05E9\u05D3\u05D4 \u05D7\u05D5\u05D1\u05D4 \u05D1\u05DE\u05D9\u05D3\u05D4 \u05D5\u05D0\u05D9\u05DF \u05E0\u05D0 \u05DC\u05D4\u05E7\u05D9\u05E9 0"),t())}function vt(e,n){e&1&&(i(0,"mat-error"),o(1,"\u05E9\u05D3\u05D4 \u05D6\u05D4 \u05D4\u05D5\u05D0 \u05E9\u05D3\u05D4 \u05D7\u05D5\u05D1\u05D4 \u05D1\u05DE\u05D9\u05D3\u05D4 \u05D5\u05D0\u05D9\u05DF \u05E0\u05D0 \u05DC\u05D4\u05E7\u05D9\u05E9 0"),t())}function Ct(e,n){e&1&&o(0,"\u05E4\u05E8\u05D8\u05D9 \u05D4\u05E0\u05DB\u05E1")}function bt(e,n){e&1&&(i(0,"mat-error"),o(1,"\u05E9\u05D3\u05D4 \u05D7\u05D5\u05D1\u05D4"),t())}function yt(e,n){if(e&1){let E=j();i(0,"mat-option",45),f("click",function(){let a=_(E).$implicit,r=B();return h(r.saveSelectionType(a.value))}),o(1),t()}if(e&2){let E=n.$implicit;p("value",E.value),l(),C(E.label)}}function wt(e,n){e&1&&(i(0,"mat-error"),o(1,"\u05E9\u05D3\u05D4 \u05D7\u05D5\u05D1\u05D4"),t())}function It(e,n){e&1&&(i(0,"mat-error"),o(1,"\u05E9\u05D3\u05D4 \u05D7\u05D5\u05D1\u05D4"),t())}function Ft(e,n){if(e&1&&(i(0,"mat-option",44),o(1),t()),e&2){let E=n.$implicit;p("value",E.value),l(),C(E.label)}}function xt(e,n){e&1&&(i(0,"mat-error"),o(1,"\u05E9\u05D3\u05D4 \u05D7\u05D5\u05D1\u05D4"),t())}function Gt(e,n){e&1&&o(0,"\u05D4\u05E2\u05DC\u05D0\u05EA \u05DE\u05E1\u05DE\u05DB\u05D9\u05DD")}var J=(()=>{let n=class n{constructor(u,a,r,m,d,s,y){this._formBuilder=u,this.customerService=a,this.leadService=r,this.userService=m,this.documentType=d,this.customerTask=s,this.route=y,this.currentStepIndex=0,this.user={id:0,userName:"",password:"",email:"",role:U.Admin,created_at:new Date(Date.now()),updated_at:new Date(Date.now())},this.isCustomer=!1,this.isLinear=!0,this.isAddDocuments=!1,this.r="",this.role=U.Admin,this.isLead=!1,this.lead_id=1,this.uploadedFiles=[],this.showTable=!1,this.tableData=[],this.document={id:0,id2:0,customer_Id:0,task_description:"",document_type_id:0,document_path:"",status:0,status2:0,due_date:new Date(Date.now()),created_at:new Date(Date.now()),updated_at:new Date(Date.now()),isOk:!1},this.customerData={id:0,lead_id:0,last_Name:"",first_Name:"",email:"",phone:"",connection:0,t_z:"",birthDate:new Date(Date.now()),family_status:0,number_of_people_in_house:0,address:"",job_status:0,work_business_name:"",job_description:"",avarage_monthly_salary:0,years_in_current_position:0,income_rent:0,income_Government_Endorsement:0,income_other:0,expenses_rent:0,expenses_loans:0,expenses_other:0,property_city:"",transaction_type:0,estimated_price_by_customer:0,estimated_price_by_sales_agreement:0,has_other_properties:!1,amount_of_loan_requested:0,lastSynced:new Date(Date.now()),isArchived:!1,created_at:new Date(Date.now()),updated_at:new Date(Date.now())},this.familyStatusOptions=[{value:b.Single,label:"\u05E8\u05D5\u05D5\u05E7"},{value:b.Married,label:"\u05E0\u05E9\u05D5\u05D9"},{value:b.Divorced,label:"\u05D2\u05E8\u05D5\u05E9"},{value:b.Widowed,label:"\u05D0\u05DC\u05DE\u05DF"}],this.jobStatusOptions=[{value:k.Employed,label:"\u05E9\u05DB\u05D9\u05E8"},{value:k.SelfEmployed,label:"\u05E2\u05E6\u05DE\u05D0\u05D9"}],this.transactiontypeOptions=[{value:v.\u05DE\u05D7\u05D9\u05E8_\u05DC\u05DE\u05E9\u05EA\u05DB\u05DF,label:"\u05DE\u05D7\u05D9\u05E8 \u05DC\u05DE\u05E9\u05EA\u05DB\u05DF"},{value:v.New,label:"\u05D9\u05D3 \u05E8\u05D0\u05E9\u05D5\u05E0\u05D4"},{value:v.Old,label:"\u05D9\u05D3 \u05E9\u05E0\u05D9\u05D4"},{value:v.Renovation,label:"\u05E9\u05D9\u05E4\u05D5\u05E6\u05D9\u05DD"},{value:v.Other,label:"\u05DC\u05DB\u05DC \u05DE\u05D8\u05E8\u05D4"}],this.connectionOptions=[{value:M.whatup,label:"\u05D5\u05D5\u05D0\u05E6\u05D0\u05E4"},{value:M.email,label:"\u05DE\u05D9\u05D9\u05DC"}],this.hasOtherProperties=[{value:!0,label:"\u05DB\u05DF"},{value:!1,label:"\u05DC\u05D0"}],this.passwordStrength={valid:[],invalid:[]},this.passwordStrengthValidator=w=>{let S=w.value,I=/[A-Z]/.test(S),F=/[a-z]/.test(S),x=/[0-9]/.test(S),G=/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]+/.test(S);return this.passwordStrength.valid=[],this.passwordStrength.invalid=[],S.length>=10?this.passwordStrength.valid.push("\u05D0\u05D5\u05E8\u05DA 10 \u05EA\u05D5\u05D5\u05D9\u05DD \u05DC\u05E4\u05D7\u05D5\u05EA"):this.passwordStrength.invalid.push("\u05D0\u05D5\u05E8\u05DA 10 \u05EA\u05D5\u05D5\u05D9\u05DD \u05DC\u05E4\u05D7\u05D5\u05EA"),I?this.passwordStrength.valid.push("\u05D0\u05D5\u05EA \u05D2\u05D3\u05D5\u05DC\u05D4"):this.passwordStrength.invalid.push("\u05D0\u05D5\u05EA \u05D2\u05D3\u05D5\u05DC\u05D4"),F?this.passwordStrength.valid.push("\u05D0\u05D5\u05EA \u05E7\u05D8\u05E0\u05D4"):this.passwordStrength.invalid.push("\u05D0\u05D5\u05EA \u05E7\u05D8\u05E0\u05D4"),x?this.passwordStrength.valid.push("\u05DE\u05E1\u05E4\u05E8"):this.passwordStrength.invalid.push("\u05DE\u05E1\u05E4\u05E8"),G?this.passwordStrength.valid.push("\u05EA\u05D5 \u05DE\u05D9\u05D5\u05D7\u05D3"):this.passwordStrength.invalid.push("\u05EA\u05D5 \u05DE\u05D9\u05D5\u05D7\u05D3"),this.passwordStrength.invalid.length===0?null:{passwordStrength:!0}},this.firstFormGroup=new Ee({userName:new R({value:"",disabled:!1},[D.required,D.email]),password:new R({value:"",disabled:!1},[D.required,D.minLength(10),this.passwordStrengthValidator])}),this.secondFormGroup=this._formBuilder.group({last_Name:["",[D.pattern("^[a-zA-Z\u05D0-\u05EA ]*$"),D.required]],first_Name:[""],email:[""],phone:[""],connection:[""],t_z:["",[D.required,Ue()]],birthDate:["",[D.required,ze()]],family_status:["",D.required],number_of_people_in_house:["",[D.pattern("^[0-9]*$"),D.required]],address:["",D.required],job_status:[""],work_business_name:["",D.required],job_description:["",D.required],avarage_monthly_salary:["",[D.pattern("^[0-9]*$"),D.required]],years_in_current_position:["",[D.pattern("^[0-9]*$"),D.required]],income_rent:["",[D.pattern("^[0-9]*$"),D.required]],income_Government_Endorsement:["",[D.pattern("^[0-9]*$"),D.required]],income_other:["",[D.pattern("^[0-9]*$"),D.required]],expenses_rent:["",[D.pattern("^[0-9]*$"),D.required]],expenses_loans:["",[D.pattern("^[0-9]*$"),D.required]],expenses_other:["",D.required]}),this.thirdFormGroup=this._formBuilder.group({property_city:["",D.required],transaction_type:["",D.required],estimated_price_by_customer:["",D.required],estimated_price_by_sales_agreement:["",D.required],has_other_properties:["",D.required],amount_of_loan_requested:["",D.required]}),this.fourthFormGroup=this._formBuilder.group({documents:["",D.required]})}ngOnInit(){localStorage.getItem("enterOrNot")===null&&localStorage.setItem("enterOrNot","false");let u=localStorage.getItem("userName"),a=localStorage.getItem("password");u!==null&&a!==null&&(this.firstFormGroup.setValue({userName:JSON.parse(u),password:JSON.parse(a)}),this.firstFormGroup.get("userName")?.disable(),this.firstFormGroup.get("password")?.disable());let r=localStorage.getItem("currentStep");r!==null&&(this.currentStepIndex=parseInt(r,10));let m=localStorage.getItem("tableData");m&&(this.tableData=JSON.parse(m),console.log("tableData",this.tableData)),this.loadCustomerDataFromLocalStorage(),this.loadFormData()}loadCustomerDataFromLocalStorage(){let u=localStorage.getItem("customerData");u&&(this.customerData=JSON.parse(u))}onStepChange(u){this.currentStepIndex=u.selectedIndex,localStorage.setItem("currentStep",this.currentStepIndex.toString())}ngAfterViewInit(){this.loadCurrentStep()}isReturningUser(){return localStorage.getItem("enterOrNot")==="true"}checkUserNameAndPassword(){let u=this.leadService.getLeadById(this.lead_id);this.customerData.phone=u?.phone,this.customerData.email=u?.email,this.customerData.first_Name=u?.first_Name,this.user.id=0,this.user.userName=this.firstFormGroup.value.userName,this.user.password=this.firstFormGroup.value.password,this.user.email=this.customerData.email,this.user.role=this.role,this.user.created_at=new Date(Date.now()),this.user.updated_at=new Date(Date.now()),console.log("user",this.user),this.userService.IsExist(this.user).subscribe(a=>{localStorage.setItem("userName",JSON.stringify(this.user.userName)),localStorage.setItem("password",JSON.stringify(this.user.password)),console.log("IsExist response:",a),this.r=a,a==="200"?localStorage.getItem("enterOrNot")==="true"?this.stepper.next():(console.log("res",a),alert("\u05D0\u05D9\u05D9\u05DE\u05D9\u05DC \u05D0\u05D5 \u05E1\u05D9\u05E1\u05DE\u05D0 \u05EA\u05E4\u05D5\u05E1\u05D9\u05DD \u05E0\u05D0 \u05DC\u05D4\u05DB\u05E0\u05D9\u05E1 \u05D0\u05D7\u05E8")):a==="404"&&this.user!==null&&this.user!==void 0&&this.user.password!==""&&this.user.userName!==""?(localStorage.setItem("enterOrNot","true"),this.stepper.next(),this.userService.createUser(this.user).subscribe({next:r=>{console.log("User created:",this.user),this.customerData.lead_id=this.lead_id,this.customerService.createCustomer(this.customerData).subscribe({next:m=>{console.log("Customer created:",this.customerData)},error:m=>console.error("Error creating customer:",m)})},error:r=>console.error("Error creating user:",r)})):console.error("Unexpected response:",a)},a=>{console.error("Error during user existence check:",a)})}saveFormData(){let u={firstFormGroup:this.firstFormGroup.value,secondFormGroup:this.secondFormGroup.value,thirdFormGroup:this.thirdFormGroup.value,fourthFormGroup:this.fourthFormGroup.value,uploadedFiles:this.uploadedFiles};localStorage.setItem("formData",JSON.stringify(u))}saveCurrentStep(){localStorage.setItem("currentStep",JSON.stringify(this.stepper.selectedIndex))}loadCurrentStep(){let u=localStorage.getItem("currentStep");u&&(this.stepper.selectedIndex=JSON.parse(u))}loadFormData(){let u=localStorage.getItem("formData");if(u){let r=JSON.parse(u);console.log("data",r),this.firstFormGroup.patchValue(r.firstFormGroup),this.secondFormGroup.patchValue(r.secondFormGroup),this.thirdFormGroup.patchValue(r.thirdFormGroup),this.fourthFormGroup.patchValue(r.fourthFormGroup),this.uploadedFiles=r.uploadedFiles||[],this.customerData.last_Name=this.secondFormGroup.value.last_Name,this.customerData.first_Name=this.secondFormGroup.value.first_Name,this.customerData.email=this.secondFormGroup.value.email,this.customerData.phone=this.secondFormGroup.value.phone,this.customerData.connection=this.secondFormGroup.value.connection.toISOString,this.customerData.t_z=this.secondFormGroup.value.t_z,this.customerData.birthDate=this.secondFormGroup.value.birthDate,this.customerData.family_status=this.secondFormGroup.value.family_status.toISOString,this.customerData.number_of_people_in_house=this.secondFormGroup.value.number_of_people_in_house.toISOString,this.customerData.address=this.secondFormGroup.value.address,this.customerData.job_status=this.secondFormGroup.value.job_status.toISOString,this.customerData.work_business_name=this.secondFormGroup.value.work_business_name,this.customerData.job_description=this.secondFormGroup.value.job_description,this.customerData.avarage_monthly_salary=this.secondFormGroup.value.avarage_monthly_salary.toISOString,this.customerData.years_in_current_position=this.secondFormGroup.value.years_in_current_position.toISOString,this.customerData.income_rent=this.secondFormGroup.value.income_rent.toISOString,this.customerData.income_Government_Endorsement=this.secondFormGroup.value.income_Government_Endorsement.toISOString,this.customerData.income_other=this.secondFormGroup.value.income_other.toISOString,this.customerData.expenses_rent=this.secondFormGroup.value.expenses_rent,this.customerData.expenses_loans=this.secondFormGroup.value.expenses_loans,this.customerData.expenses_other=this.secondFormGroup.value.expenses_other,this.customerData.property_city=this.thirdFormGroup.value.property_city,this.customerData.transaction_type=this.thirdFormGroup.value.transaction_type,this.customerData.estimated_price_by_customer=this.thirdFormGroup.value.estimated_price_by_customer.toISOString,this.customerData.estimated_price_by_sales_agreement=this.thirdFormGroup.value.estimated_price_by_sales_agreement.toISOString,this.customerData.has_other_properties=this.thirdFormGroup.value.has_other_properties.toISOString,this.customerData.amount_of_loan_requested=this.thirdFormGroup.value.amount_of_loan_requested.toISOString,this.customerData.isArchived=this.thirdFormGroup.value.isArchived,console.log("customerData1",this.customerData)}let a=localStorage.getItem("customerData")}onInputChange(u,a){let r=a.target.value;this.customerData[u]=r,this.saveFormData()}onSelectionChange(u,a){u=="family_status"?(this.customerData[u]=a,this.customerData.family_status=Number(this.customerData.family_status)):u=="job_status"?(this.customerData[u]=a,this.customerData.job_status=Number(this.customerData.job_status)):u=="transaction_type"?(this.customerData[u]=a,this.customerData.transaction_type=Number(this.customerData.transaction_type)):u=="has_other_properties"?(this.customerData[u]=a,this.customerData.has_other_properties=this.customerData.has_other_properties,a===!0?this.customerData[u]=!0:this.customerData[u]=!1):u=="connection"?(this.customerData[u]=a,this.customerData.connection=Number(this.customerData.connection)):this.customerData[u]=a,this.saveFormData()}onFileChange(u){let a=u.target.files;for(let r=0;r<a.length;r++)this.uploadedFiles.push(a[r]);this.saveFormData()}uploadDocuments(){this.uploadedFiles.length&&console.log("Uploading files:",this.uploadedFiles)}removeFile(u){this.uploadedFiles.splice(u,1)}viewDocument(u){let a=URL.createObjectURL(u);window.open(a)}saveSelectionType(u){localStorage.setItem("tableData",JSON.stringify(this.tableData)),console.log("Selected Transaction Type:","this.selectedTransactionType")}onSubmit(){this.customerService.updateCustomer(this.customerId,this.customerData).subscribe({next:u=>console.log("Customer created not null",this.customerData),error:u=>console.error("Error creating customer:",u)})}save(){return N(this,null,function*(){if(console.log("customerData:",this.customerData),localStorage.getItem("currentStep")==="3"){console.log("Updating customer in step 3",this.customerData);try{yield oe(this.customerService.updateCustomer(1,this.customerData)),console.log("step 3 created"),yield this.getDocuments(),localStorage.getItem("isAddDocuments")!=="true"&&(yield this.addToCustomerTask()),console.log("All steps completed successfully")}catch(a){console.error("Error in the process",a)}}})}saveDocuments(){this.customerService.updateCustomer(1,this.customerData).subscribe({next:u=>{console.log("step 4 created"),localStorage.removeItem("enterOrNot"),localStorage.removeItem("formData"),localStorage.removeItem("currentStep"),localStorage.removeItem("ifEnter"),localStorage.removeItem("currentStepIndex"),localStorage.removeItem("tableData"),localStorage.removeItem("isAddDocuments")}})}getDocuments(){return N(this,null,function*(){console.log("transaction_type",this.customerData.transaction_type),console.log("\u05D4\u05D9\u05D9\u05D9\u05D9 \u05D4\u05D2\u05E2\u05EA\u05D9");let u=Number(this.customerData.transaction_type);return console.log("num",u),new Promise((a,r)=>{this.documentType.getDocsByTransactionType(u).subscribe({next:m=>{this.tableData=m,console.log("tableData",this.tableData),localStorage.setItem("tableData",JSON.stringify(this.tableData)),a(this.tableData)},error:m=>{console.error("Error fetching documents:",m),r(m)}})})})}addToCustomerTask(){return N(this,null,function*(){console.log("\u05D4\u05D2\u05E2\u05EA\u05D9 \u05DC\u05E4\u05D5\u05E0\u05E7\u05E6\u05D9\u05D4"),console.log("tableData in func",this.tableData);let u=this.tableData.map(a=>(this.document={id:0,id2:0,customer_Id:1,task_description:a.document_Name,document_type_id:Number(this.customerData.transaction_type),document_path:"\u05DC\u05D1\u05D3\u05D5\u05E7 \u05DE\u05D4 \u05DB\u05D5\u05EA\u05D1\u05D9\u05DD \u05E4\u05D4",status:0,status2:0,due_date:new Date(Date.now()),created_at:new Date(Date.now()),updated_at:new Date(Date.now()),isOk:!1},console.log("document",this.document),new Promise((r,m)=>{this.customerTask.addDocument(this.document).subscribe({next:d=>{console.log("Add document successed to customerTask"),this.isAddDocuments=!0,localStorage.setItem("isAddDocuments","true"),r(d)},error:d=>{console.log("Failed to add document to CustomerTask"),m(d)}})})));return Promise.all(u)})}};n.\u0275fac=function(a){return new(a||n)(g(ye),g(Me),g(q),g(Be),g($e),g(je),g(A))},n.\u0275cmp=L({type:n,selectors:[["app-lead"]],viewQuery:function(a,r){if(a&1&&ue(Ze,5),a&2){let m;ae(m=se())&&(r.stepper=m.first)}},decls:175,vars:37,consts:[["stepper",""],["myButton",""],["dir","rtl",3,"selectionChange","linear"],[3,"stepControl"],[3,"formGroup"],["matStepLabel",""],["matInput","","formControlName","userName","required",""],[4,"ngIf"],["matInput","","formControlName","password","type","password","required",""],["mat-button","",3,"click","disabled"],["matInput","","formControlName","last_Name",3,"input"],["matInput","","type","number","formControlName","connection",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],["matInput","","type","text","formControlName","t_z",3,"input"],["matInput","","formControlName","birthDate","type","date",3,"input"],["formControlName","family_status",3,"selectionChange"],["matInput","","formControlName","number_of_people_in_house","type","number",3,"input"],["matInput","","formControlName","address","type","text",3,"input"],["formControlName","job_status",3,"selectionChange"],["matInput","","formControlName","work_business_name","type","text",3,"input"],["matInput","","formControlName","job_description","type","text",3,"input"],["matInput","","formControlName","avarage_monthly_salary","type","number",3,"input"],["matInput","","formControlName","years_in_current_position","type","number",3,"input"],["matInput","","formControlName","income_rent","type","number",3,"input"],["matInput","","formControlName","income_Government_Endorsement","type","number",3,"input"],["matInput","","formControlName","income_other","type","number",3,"input"],["matInput","","formControlName","expenses_rent","type","number",3,"input"],["matInput","","formControlName","expenses_loans","type","number",3,"input"],["matInput","","formControlName","expenses_other","type","number",3,"input"],["mat-button","","matStepperPrevious",""],["mat-button","","matStepperNext",""],["matInput","","formControlName","property_city","type","text",3,"input"],["formControlName","transaction_type",3,"selectionChange"],[3,"value","click",4,"ngFor","ngForOf"],["matInput","","formControlName","estimated_price_by_customer","type","number",3,"input"],["matInput","","formControlName","estimated_price_by_sales_agreement","type","number",3,"input"],["formControlName","has_other_properties",3,"selectionChange"],["matInput","","formControlName","amount_of_loan_requested","type","number",3,"input"],["mat-button","","matStepperNext","",3,"click"],["mat-button","",3,"click"],["style","color: green;",4,"ngFor","ngForOf"],["style","color: red;",4,"ngFor","ngForOf"],[2,"color","green"],[2,"color","red"],[3,"value"],[3,"click","value"]],template:function(a,r){if(a&1){let m=j();i(0,"mat-horizontal-stepper",2,0),f("selectionChange",function(s){return _(m),h(r.onStepChange(s))}),i(2,"mat-step",3)(3,"form",4),c(4,He,1,0,"ng-template",5),i(5,"mat-form-field")(6,"mat-label"),o(7,"\u05D0\u05D9\u05DE\u05D9\u05D9\u05DC"),t(),T(8,"input",6),c(9,Ke,2,0,"mat-error",7)(10,Xe,2,0,"mat-error",7),t(),i(11,"mat-form-field")(12,"mat-label"),o(13,"\u05E1\u05D9\u05E1\u05DE\u05D0"),t(),T(14,"input",8),c(15,et,2,0,"mat-error",7),t(),c(16,it,6,2,"div",7),i(17,"div")(18,"button",9,1),f("click",function(){return _(m),h(r.checkUserNameAndPassword())}),o(20,"\u05D4\u05D1\u05D0"),t()()()(),i(21,"mat-step",3)(22,"form",4),c(23,nt,1,0,"ng-template",5),i(24,"mat-form-field")(25,"mat-label"),o(26,"\u05E9\u05DD \u05DE\u05E9\u05E4\u05D7\u05D4"),t(),i(27,"input",10),f("input",function(s){return _(m),h(r.onInputChange("last_Name",s))}),t(),c(28,ot,2,0,"mat-error",7)(29,ut,2,0,"mat-error",7),t(),i(30,"mat-form-field")(31,"mat-label"),o(32,"\u05D7\u05D9\u05D1\u05D5\u05E8"),t(),i(33,"mat-select",11),f("selectionChange",function(s){return _(m),h(r.onSelectionChange("connection",s.value))}),c(34,at,2,2,"mat-option",12),t()(),i(35,"mat-form-field")(36,"mat-label"),o(37,"\u05EA.\u05D6."),t(),i(38,"input",13),f("input",function(s){return _(m),h(r.onInputChange("t_z",s))}),t(),i(39,"mat-error"),o(40," \u05DE\u05E1\u05E4\u05E8 \u05EA\u05E2\u05D5\u05D3\u05EA \u05D6\u05D4\u05D5\u05EA \u05DC\u05D0 \u05EA\u05E7\u05D9\u05DF "),t()(),i(41,"mat-form-field")(42,"mat-label"),o(43,"\u05EA\u05D0\u05E8\u05D9\u05DA \u05DC\u05D9\u05D3\u05D4"),t(),i(44,"input",14),f("input",function(s){return _(m),h(r.onInputChange("birthDate",s))}),t(),i(45,"mat-error"),o(46," \u05E0\u05D0 \u05DC\u05D4\u05DB\u05E0\u05D9\u05E1 \u05EA\u05D0\u05E8\u05D9\u05DA \u05EA\u05E7\u05D9\u05DF \u05E2\u05D3 \u05DC\u05EA\u05D0\u05E8\u05D9\u05DA \u05D4\u05E0\u05D5\u05DB\u05D7\u05D9 "),t()(),i(47,"mat-form-field")(48,"mat-label"),o(49,"\u05DE\u05E6\u05D1 \u05DE\u05E9\u05E4\u05D7\u05EA\u05D9"),t(),i(50,"mat-select",15),f("selectionChange",function(s){return _(m),h(r.onSelectionChange("family_status",s.value))}),c(51,st,2,2,"mat-option",12),t()(),i(52,"mat-form-field")(53,"mat-label"),o(54,"\u05DE\u05E1\u05E4\u05E8 \u05D0\u05E0\u05E9\u05D9\u05DD \u05D1\u05D1\u05D9\u05EA"),t(),i(55,"input",16),f("input",function(s){return _(m),h(r.onInputChange("number_of_people_in_house",s))}),t(),c(56,mt,2,0,"mat-error",7),t(),i(57,"mat-form-field")(58,"mat-label"),o(59,"\u05DB\u05EA\u05D5\u05D1\u05EA"),t(),i(60,"input",17),f("input",function(s){return _(m),h(r.onInputChange("address",s))}),t(),c(61,lt,2,0,"mat-error",7),t(),i(62,"h3"),o(63,"\u05E4\u05E8\u05D8\u05D9 \u05EA\u05E2\u05E1\u05D5\u05E7\u05D4"),t(),i(64,"mat-form-field")(65,"mat-label"),o(66,"\u05E1\u05D8\u05D8\u05D5\u05E1"),t(),i(67,"mat-select",18),f("selectionChange",function(s){return _(m),h(r.onSelectionChange("job_status",s.value))}),c(68,pt,2,2,"mat-option",12),t()(),i(69,"mat-form-field")(70,"mat-label"),o(71,"\u05DE\u05E7\u05D5\u05DD \u05E2\u05D1\u05D5\u05D3\u05D4"),t(),i(72,"input",19),f("input",function(s){return _(m),h(r.onInputChange("work_business_name",s))}),t(),c(73,Dt,2,0,"mat-error",7),t(),i(74,"mat-form-field")(75,"mat-label"),o(76,"\u05EA\u05E4\u05E7\u05D9\u05D3"),t(),i(77,"input",20),f("input",function(s){return _(m),h(r.onInputChange("job_description",s))}),t(),c(78,dt,2,0,"mat-error",7),t(),i(79,"mat-form-field")(80,"mat-label"),o(81,"\u05DE\u05E9\u05DB\u05D5\u05E8\u05EA \u05D7\u05D5\u05D3\u05E9\u05D9\u05EA \u05DE\u05DE\u05D5\u05E6\u05E2\u05EA \u05E0\u05D8\u05D5"),t(),i(82,"input",21),f("input",function(s){return _(m),h(r.onInputChange("avarage_monthly_salary",s))}),t(),c(83,ct,2,0,"mat-error",7),t(),i(84,"mat-form-field")(85,"mat-label"),o(86,"\u05D5\u05EA\u05E7"),t(),i(87,"input",22),f("input",function(s){return _(m),h(r.onInputChange("years_in_current_position",s))}),t(),c(88,_t,2,0,"mat-error",7),t(),i(89,"h3"),o(90,"\u05D4\u05DB\u05E0\u05E1\u05D5\u05EA"),t(),i(91,"mat-form-field")(92,"mat-label"),o(93,"\u05E7\u05E6\u05D1\u05D0\u05D5\u05EA"),t(),i(94,"input",23),f("input",function(s){return _(m),h(r.onInputChange("income_rent",s))}),t(),c(95,ht,2,0,"mat-error",7),t(),i(96,"mat-form-field")(97,"mat-label"),o(98,"\u05DE\u05D6\u05D5\u05E0\u05D5\u05EA"),t(),i(99,"input",24),f("input",function(s){return _(m),h(r.onInputChange("income_Government_Endorsement",s))}),t(),c(100,ft,2,0,"mat-error",7),t(),i(101,"mat-form-field")(102,"mat-label"),o(103,"\u05DE\u05E7\u05D5\u05E8 \u05D0\u05D7\u05E8"),t(),i(104,"input",25),f("input",function(s){return _(m),h(r.onInputChange("income_other",s))}),t(),c(105,Et,2,0,"mat-error",7),t(),i(106,"h3"),o(107,"\u05D4\u05D5\u05E6\u05D0\u05D5\u05EA"),t(),i(108,"mat-form-field")(109,"mat-label"),o(110,"\u05E9\u05DB\u05E8 \u05D3\u05D9\u05E8\u05D4"),t(),i(111,"input",26),f("input",function(s){return _(m),h(r.onInputChange("expenses_rent",s))}),t(),c(112,gt,2,0,"mat-error",7),t(),i(113,"mat-form-field")(114,"mat-label"),o(115,"\u05D4\u05DC\u05D5\u05D5\u05D0\u05D5\u05EA"),t(),i(116,"input",27),f("input",function(s){return _(m),h(r.onInputChange("expenses_loans",s))}),t(),c(117,St,2,0,"mat-error",7),t(),i(118,"mat-form-field")(119,"mat-label"),o(120,"\u05DE\u05E7\u05D5\u05E8 \u05D0\u05D7\u05E8"),t(),i(121,"input",28),f("input",function(s){return _(m),h(r.onInputChange("expenses_other",s))}),t(),c(122,vt,2,0,"mat-error",7),t(),i(123,"div")(124,"button",29),o(125,"\u05D7\u05D6\u05D5\u05E8"),t(),i(126,"button",30),o(127,"\u05D4\u05D1\u05D0"),t()()()(),i(128,"mat-step",3)(129,"form",4),c(130,Ct,1,0,"ng-template",5),i(131,"mat-form-field")(132,"mat-label"),o(133,"\u05D9\u05D9\u05E9\u05D5\u05D1"),t(),i(134,"input",31),f("input",function(s){return _(m),h(r.onInputChange("property_city",s))}),t(),c(135,bt,2,0,"mat-error",7),t(),i(136,"mat-form-field")(137,"mat-label"),o(138,"\u05E1\u05D5\u05D2 \u05E2\u05E1\u05E7\u05D4"),t(),i(139,"mat-select",32),f("selectionChange",function(s){return _(m),h(r.onSelectionChange("transaction_type",s.value))}),c(140,yt,2,2,"mat-option",33),t()(),i(141,"mat-form-field")(142,"mat-label"),o(143,"\u05E9\u05D5\u05D5\u05D9 \u05D4\u05E0\u05DB\u05E1 \u05DC\u05E4\u05D9 \u05D4\u05E2\u05E8\u05DB\u05EA \u05DC\u05D5\u05D5\u05D4"),t(),i(144,"input",34),f("input",function(s){return _(m),h(r.onInputChange("estimated_price_by_customer",s))}),t(),c(145,wt,2,0,"mat-error",7),t(),i(146,"mat-form-field")(147,"mat-label"),o(148,"\u05E9\u05D5\u05D5\u05D4 \u05D4\u05E0\u05DB\u05E1 \u05DC\u05E4\u05D9 \u05D4\u05E1\u05DB\u05DD \u05DE\u05DB\u05E8"),t(),i(149,"input",35),f("input",function(s){return _(m),h(r.onInputChange("estimated_price_by_sales_agreement",s))}),t(),c(150,It,2,0,"mat-error",7),t(),i(151,"mat-form-field")(152,"mat-label"),o(153,"\u05D9\u05E9 \u05E0\u05DB\u05E1\u05D9\u05DD \u05E0\u05D5\u05E1\u05E4\u05D9\u05DD \u05DC\u05DC\u05D5\u05D5\u05D4"),t(),i(154,"mat-select",36),f("selectionChange",function(s){return _(m),h(r.onSelectionChange("has_other_properties",s.value))}),c(155,Ft,2,2,"mat-option",12),t()(),i(156,"mat-form-field")(157,"mat-label"),o(158,"\u05E1\u05DB\u05D5\u05DD \u05D4\u05D4\u05DC\u05D5\u05D5\u05D0\u05D4"),t(),i(159,"input",37),f("input",function(s){return _(m),h(r.onInputChange("amount_of_loan_requested",s))}),t(),c(160,xt,2,0,"mat-error",7),t(),i(161,"div")(162,"button",29),o(163,"\u05D7\u05D6\u05D5\u05E8"),t(),i(164,"button",38),f("click",function(){return _(m),h(r.save())}),o(165,"\u05D4\u05D1\u05D0"),t()()()(),i(166,"mat-step",3)(167,"form",4),c(168,Gt,1,0,"ng-template",5),T(169,"documents-list-customer"),i(170,"div")(171,"button",29),o(172,"\u05D7\u05D6\u05D5\u05E8"),t(),i(173,"button",39),f("click",function(){return _(m),h(r.saveDocuments())}),o(174,"\u05E9\u05DE\u05D5\u05E8"),t()()()()()}if(a&2){let m,d,s,y,w,S,I,F,x,G,Q,W,Y,Z,H,K,X,ee,te,re,ie,ne;p("linear",r.isLinear),l(2),p("stepControl",r.firstFormGroup),l(),p("formGroup",r.firstFormGroup),l(6),p("ngIf",(m=r.firstFormGroup.get("userName"))==null?null:m.hasError("required")),l(),p("ngIf",(d=r.firstFormGroup.get("userName"))==null?null:d.hasError("email")),l(5),p("ngIf",(s=r.firstFormGroup.get("password"))==null?null:s.hasError("required")),l(),p("ngIf",(y=r.firstFormGroup.get("password"))==null?null:y.touched),l(2),p("disabled",r.firstFormGroup.invalid),l(3),p("stepControl",r.secondFormGroup),l(),p("formGroup",r.secondFormGroup),l(6),p("ngIf",(w=r.secondFormGroup.get("last_Name"))==null?null:w.hasError("required")),l(),p("ngIf",(S=r.secondFormGroup.get("last_Name"))==null?null:S.hasError("pattern")),l(5),p("ngForOf",r.connectionOptions),l(17),p("ngForOf",r.familyStatusOptions),l(5),p("ngIf",(I=r.secondFormGroup.get("number_of_people_in_house"))==null?null:I.hasError("required")),l(5),p("ngIf",(F=r.secondFormGroup.get("address"))==null?null:F.hasError("required")),l(7),p("ngForOf",r.jobStatusOptions),l(5),p("ngIf",(x=r.secondFormGroup.get("work_business_name"))==null?null:x.hasError("required")),l(5),p("ngIf",(G=r.secondFormGroup.get("job_description"))==null?null:G.hasError("required")),l(5),p("ngIf",(Q=r.secondFormGroup.get("avarage_monthly_salary"))==null?null:Q.hasError("required")),l(5),p("ngIf",(W=r.secondFormGroup.get("years_in_current_position"))==null?null:W.hasError("required")),l(7),p("ngIf",(Y=r.secondFormGroup.get("income_rent"))==null?null:Y.hasError("required")),l(5),p("ngIf",(Z=r.secondFormGroup.get("income_Government_Endorsement"))==null?null:Z.hasError("required")),l(5),p("ngIf",(H=r.secondFormGroup.get("income_other"))==null?null:H.hasError("required")),l(7),p("ngIf",(K=r.secondFormGroup.get("expenses_rent"))==null?null:K.hasError("required")),l(5),p("ngIf",(X=r.secondFormGroup.get("expenses_loans"))==null?null:X.hasError("required")),l(5),p("ngIf",(ee=r.secondFormGroup.get("expenses_other"))==null?null:ee.hasError("required")),l(6),p("stepControl",r.thirdFormGroup),l(),p("formGroup",r.thirdFormGroup),l(6),p("ngIf",(te=r.thirdFormGroup.get("property_city"))==null?null:te.hasError("required")),l(5),p("ngForOf",r.transactiontypeOptions),l(5),p("ngIf",(re=r.thirdFormGroup.get("estimated_price_by_customer"))==null?null:re.hasError("required")),l(5),p("ngIf",(ie=r.thirdFormGroup.get("estimated_price_by_sales_agreement"))==null?null:ie.hasError("required")),l(5),p("ngForOf",r.hasOtherProperties),l(5),p("ngIf",(ne=r.thirdFormGroup.get("amount_of_loan_requested"))==null?null:ne.hasError("required")),l(6),p("stepControl",r.fourthFormGroup),l(),p("formGroup",r.fourthFormGroup)}},dependencies:[me,le,de,Ge,Fe,xe,Ne,Ie,Oe,Le,Te,Ae,qe,Ve,ce,ge,_e,Se,he,fe,be,ve,Ce,Pe],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%}button[_ngcontent-%COMP%]{margin-right:8px}h3[_ngcontent-%COMP%]{margin-top:20px}.invalid-requirement[_ngcontent-%COMP%]{color:red}.valid-requirement[_ngcontent-%COMP%]{color:green}mat-horizontal-stepper[_ngcontent-%COMP%]{width:50vw;margin:0 auto}#content[_ngcontent-%COMP%]{background-color:#ffffff9a;padding:25px;border-radius:40px;min-width:max-content;min-height:60vh}"]});let e=n;return e})();var Je=(()=>{let n=class n{constructor(u,a,r){this.route=u,this.leadService=a,this.router=r,this.id=null,this.token=null,this.isNotValid=!1}ngOnInit(){this.route.queryParams.subscribe(u=>{this.id=u.id,this.token=u.token,console.log("ID:",this.id),console.log("Token:",this.token)}),this.id!=null&&this.leadService.checkToken(this.id).subscribe(u=>{u.status===200?this.router.navigate([`lead/lead/${this.id}`]):this.isNotValid=!0})}};n.\u0275fac=function(a){return new(a||n)(g(A),g(q),g(De))},n.\u0275cmp=L({type:n,selectors:[["app-magic-link"]],decls:2,vars:0,template:function(a,r){a&1&&(i(0,"p"),o(1,"magic-link works!"),t())}});let e=n;return e})();var Nt=[{path:"",component:J},{path:"lead/:id",component:J},{path:"magic-link",component:Je}],Qe=(()=>{let n=class n{};n.\u0275fac=function(a){return new(a||n)},n.\u0275mod=O({type:n}),n.\u0275inj=V({imports:[P.forChild(Nt),P]});let e=n;return e})();var Fr=(()=>{let n=class n{};n.\u0275fac=function(a){return new(a||n)},n.\u0275mod=O({type:n}),n.\u0275inj=V({imports:[pe,ke,we,Qe,Re]});let e=n;return e})();export{Fr as a};
